{
  "version": 3,
  "sources": ["../node_modules/mithril/render/vnode.js", "../node_modules/mithril/render/hyperscriptVnode.js", "../node_modules/mithril/util/hasOwn.js", "../node_modules/mithril/render/emptyAttrs.js", "../node_modules/mithril/render/cachedAttrsIsStaticMap.js", "../node_modules/mithril/render/hyperscript.js", "../node_modules/mithril/render/trust.js", "../node_modules/mithril/render/fragment.js", "../node_modules/mithril/hyperscript.js", "../node_modules/mithril/render/delayedRemoval.js", "../node_modules/mithril/render/domFor.js", "../node_modules/mithril/render/render.js", "../node_modules/mithril/render.js", "../node_modules/mithril/api/mount-redraw.js", "../node_modules/mithril/mount-redraw.js", "../node_modules/mithril/querystring/build.js", "../node_modules/mithril/pathname/build.js", "../node_modules/mithril/request/request.js", "../node_modules/mithril/request.js", "../node_modules/mithril/util/decodeURIComponentSafe.js", "../node_modules/mithril/querystring/parse.js", "../node_modules/mithril/pathname/parse.js", "../node_modules/mithril/pathname/compileTemplate.js", "../node_modules/mithril/util/censor.js", "../node_modules/mithril/api/router.js", "../node_modules/mithril/route.js", "../node_modules/mithril/index.js", "../node_modules/@noble/ciphers/src/utils.ts", "../node_modules/@noble/ciphers/src/_arx.ts", "../node_modules/@noble/ciphers/src/_poly1305.ts", "../node_modules/@noble/ciphers/src/chacha.ts", "../node_modules/@noble/hashes/src/utils.ts", "../node_modules/@noble/hashes/src/_md.ts", "../node_modules/@noble/hashes/src/_u64.ts", "../node_modules/@noble/hashes/src/sha2.ts", "../node_modules/@noble/curves/src/utils.ts", "../node_modules/@noble/curves/src/abstract/modular.ts", "../node_modules/@noble/curves/src/abstract/curve.ts", "../node_modules/@noble/curves/src/abstract/edwards.ts", "../node_modules/@noble/curves/src/abstract/hash-to-curve.ts", "../node_modules/@noble/curves/src/abstract/montgomery.ts", "../node_modules/@noble/curves/src/abstract/oprf.ts", "../node_modules/@noble/curves/src/ed25519.ts", "../node_modules/@noble/hashes/src/sha3.ts", "../node_modules/@noble/curves/src/ed448.ts", "../node_modules/@noble/hashes/src/hmac.ts", "../node_modules/@noble/curves/src/abstract/weierstrass.ts", "../node_modules/@noble/curves/src/nist.ts", "../src/app.ts", "../src/service/activityPub.ts", "../node_modules/idb/build/index.js", "../src/type/keyPackage.ts", "../node_modules/ts-mls/src/codec/tlsEncoder.ts", "../node_modules/ts-mls/src/codec/number.ts", "../node_modules/ts-mls/src/codec/tlsDecoder.ts", "../node_modules/ts-mls/src/util/enumHelpers.ts", "../node_modules/ts-mls/src/defaultProposalType.ts", "../node_modules/ts-mls/src/defaultExtensionType.ts", "../node_modules/ts-mls/src/mlsError.ts", "../node_modules/ts-mls/src/codec/variableLength.ts", "../node_modules/ts-mls/src/extension.ts", "../node_modules/ts-mls/src/credentialType.ts", "../node_modules/ts-mls/src/credential.ts", "../node_modules/ts-mls/src/externalSender.ts", "../node_modules/ts-mls/src/codec/optional.ts", "../node_modules/ts-mls/src/crypto/ciphersuite.ts", "../node_modules/ts-mls/src/crypto/signature.ts", "../node_modules/ts-mls/src/protocolVersion.ts", "../node_modules/ts-mls/src/capabilities.ts", "../node_modules/ts-mls/src/leafNodeSource.ts", "../node_modules/ts-mls/src/lifetime.ts", "../node_modules/ts-mls/src/leafNode.ts", "../node_modules/ts-mls/src/keyPackage.ts", "../node_modules/ts-mls/src/presharedkey.ts", "../node_modules/ts-mls/src/proposal.ts", "../node_modules/ts-mls/src/proposalOrRefType.ts", "../node_modules/ts-mls/src/groupContext.ts", "../node_modules/ts-mls/src/nodeType.ts", "../node_modules/ts-mls/src/parentNode.ts", "../node_modules/ts-mls/src/ratchetTree.ts", "../node_modules/ts-mls/src/treeHash.ts", "../node_modules/ts-mls/src/parentHash.ts", "../node_modules/ts-mls/src/hpkeCiphertext.ts", "../node_modules/ts-mls/src/updatePath.ts", "../node_modules/ts-mls/src/commit.ts", "../node_modules/ts-mls/src/contentType.ts", "../node_modules/ts-mls/src/wireformat.ts", "../node_modules/ts-mls/src/sender.ts", "../node_modules/ts-mls/src/framedContent.ts", "../node_modules/ts-mls/src/authenticatedContent.ts", "../node_modules/ts-mls/src/publicMessage.ts", "../node_modules/ts-mls/src/requiredCapabilities.ts", "../node_modules/ts-mls/src/groupInfo.ts", "../node_modules/ts-mls/src/transcriptHash.ts", "../node_modules/ts-mls/src/util/byteArray.ts", "../node_modules/ts-mls/src/groupSecrets.ts", "../node_modules/ts-mls/src/welcome.ts", "../node_modules/ts-mls/src/privateMessage.ts", "../node_modules/ts-mls/src/crypto/implementation/default/makeHashImpl.ts", "../node_modules/@hpke/common/esm/src/errors.js", "../node_modules/@hpke/common/esm/_dnt.shims.js", "../node_modules/@hpke/common/esm/src/algorithm.js", "../node_modules/@hpke/common/esm/src/identifiers.js", "../node_modules/@hpke/common/esm/src/consts.js", "../node_modules/@hpke/common/esm/src/interfaces/kemInterface.js", "../node_modules/@hpke/common/esm/src/utils/misc.js", "../node_modules/@hpke/common/esm/src/kems/dhkem.js", "../node_modules/@hpke/common/esm/src/interfaces/dhkemPrimitives.js", "../node_modules/@hpke/common/esm/src/utils/bignum.js", "../node_modules/@hpke/common/esm/src/kems/dhkemPrimitives/ec.js", "../node_modules/@hpke/common/esm/src/kdfs/hkdf.js", "../node_modules/@hpke/common/esm/src/interfaces/aeadEncryptionContext.js", "../node_modules/@hpke/common/esm/src/utils/noble.js", "../node_modules/@hpke/common/esm/src/hash/hmac.js", "../node_modules/@hpke/common/esm/src/curve/montgomery.js", "../node_modules/@hpke/core/esm/src/aeads/aesGcm.js", "../node_modules/@hpke/core/esm/src/utils/emitNotSupported.js", "../node_modules/@hpke/core/esm/src/exporterContext.js", "../node_modules/@hpke/core/esm/src/encryptionContext.js", "../node_modules/@hpke/core/esm/src/mutex.js", "../node_modules/@hpke/core/esm/src/recipientContext.js", "../node_modules/@hpke/core/esm/src/senderContext.js", "../node_modules/@hpke/core/esm/src/cipherSuiteNative.js", "../node_modules/@hpke/core/esm/src/kems/dhkemNative.js", "../node_modules/@hpke/core/esm/src/native.js", "../node_modules/@hpke/core/esm/src/kems/dhkemPrimitives/x25519.js", "../node_modules/@hpke/core/esm/src/kems/dhkemX25519.js", "../node_modules/@hpke/core/esm/src/kems/dhkemPrimitives/x448.js", "../node_modules/@hpke/core/esm/src/kems/dhkemX448.js", "../node_modules/ts-mls/src/crypto/implementation/hpke.ts", "../node_modules/ts-mls/src/crypto/implementation/default/makeAead.ts", "../node_modules/ts-mls/src/crypto/implementation/default/makeKdfImpl.ts", "../node_modules/ts-mls/src/crypto/implementation/default/makeDhKem.ts", "../node_modules/ts-mls/src/crypto/implementation/default/makeHpke.ts", "../node_modules/ts-mls/src/crypto/implementation/default/rng.ts", "../node_modules/ts-mls/src/crypto/implementation/default/makeNobleSignatureImpl.ts", "../node_modules/ts-mls/src/crypto/implementation/default/provider.ts", "../node_modules/ts-mls/src/crypto/getCiphersuiteImpl.ts", "../node_modules/ts-mls/src/message.ts", "../node_modules/ts-mls/src/grease.ts", "../node_modules/ts-mls/src/defaultCapabilities.ts", "../src/service/keyPackage.ts", "../src/service/factory.ts", "../src/viewContainer.tsx"],
  "sourcesContent": ["\"use strict\"\n\nfunction Vnode(tag, key, attrs, children, text, dom) {\n\treturn {tag: tag, key: key, attrs: attrs, children: children, text: text, dom: dom, is: undefined, domSize: undefined, state: undefined, events: undefined, instance: undefined}\n}\nVnode.normalize = function(node) {\n\tif (Array.isArray(node)) return Vnode(\"[\", undefined, undefined, Vnode.normalizeChildren(node), undefined, undefined)\n\tif (node == null || typeof node === \"boolean\") return null\n\tif (typeof node === \"object\") return node\n\treturn Vnode(\"#\", undefined, undefined, String(node), undefined, undefined)\n}\nVnode.normalizeChildren = function(input) {\n\t// Preallocate the array length (initially holey) and fill every index immediately in order.\n\t// Benchmarking shows better performance on V8.\n\tvar children = new Array(input.length)\n\t// Count the number of keyed normalized vnodes for consistency check.\n\t// Note: this is a perf-sensitive check.\n\t// Fun fact: merging the loop like this is somehow faster than splitting\n\t// the check within updateNodes(), noticeably so.\n\tvar numKeyed = 0\n\tfor (var i = 0; i < input.length; i++) {\n\t\tchildren[i] = Vnode.normalize(input[i])\n\t\tif (children[i] !== null && children[i].key != null) numKeyed++\n\t}\n\tif (numKeyed !== 0 && numKeyed !== input.length) {\n\t\tthrow new TypeError(children.includes(null)\n\t\t\t? \"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.\"\n\t\t\t: \"In fragments, vnodes must either all have keys or none have keys.\"\n\t\t)\n\t}\n\treturn children\n}\n\nmodule.exports = Vnode\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\n\n// Note: the processing of variadic parameters is perf-sensitive.\n//\n// In native ES6, it might be preferable to define hyperscript and fragment\n// factories with a final ...args parameter and call hyperscriptVnode(...args),\n// since modern engines can optimize spread calls.\n//\n// However, benchmarks showed this was not faster. As a result, spread is used\n// only in the parameter lists of hyperscript and fragment, while an array is\n// passed to hyperscriptVnode.\nmodule.exports = function(attrs, children) {\n\tif (attrs == null || typeof attrs === \"object\" && attrs.tag == null && !Array.isArray(attrs)) {\n\t\tif (children.length === 1 && Array.isArray(children[0])) children = children[0]\n\t} else {\n\t\tchildren = children.length === 0 && Array.isArray(attrs) ? attrs : [attrs, ...children]\n\t\tattrs = undefined\n\t}\n\n\treturn Vnode(\"\", attrs && attrs.key, attrs, children)\n}\n", "// This exists so I'm only saving it once.\n\"use strict\"\n\nmodule.exports = {}.hasOwnProperty\n", "\"use strict\"\n\n// This is an attrs object that is used by default when attrs is undefined or null.\nmodule.exports = {}\n", "\"use strict\"\n\nvar emptyAttrs = require(\"./emptyAttrs\")\n\n// This Map manages the following:\n// - Whether an attrs is cached attrs generated by compileSelector().\n// - Whether the cached attrs is \"static\", i.e., does not contain any form attributes.\n// These information will be useful to skip updating attrs in render().\n//\n// Since the attrs used as keys in this map are not released from the selectorCache object,\n// there is no risk of memory leaks. Therefore, Map is used here instead of WeakMap.\nmodule.exports = new Map([[emptyAttrs, true]])\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\nvar hyperscriptVnode = require(\"./hyperscriptVnode\")\nvar hasOwn = require(\"../util/hasOwn\")\nvar emptyAttrs = require(\"./emptyAttrs\")\nvar cachedAttrsIsStaticMap = require(\"./cachedAttrsIsStaticMap\")\n\nvar selectorParser = /(?:(^|#|\\.)([^#\\.\\[\\]]+))|(\\[(.+?)(?:\\s*=\\s*(\"|'|)((?:\\\\[\"'\\]]|.)*?)\\5)?\\])/g\nvar selectorCache = Object.create(null)\n\nfunction isEmpty(object) {\n\tfor (var key in object) if (hasOwn.call(object, key)) return false\n\treturn true\n}\n\nfunction isFormAttributeKey(key) {\n\treturn key === \"value\" || key === \"checked\" || key === \"selectedIndex\" || key === \"selected\"\n}\n\nfunction compileSelector(selector) {\n\tvar match, tag = \"div\", classes = [], attrs = {}, isStatic = true\n\twhile (match = selectorParser.exec(selector)) {\n\t\tvar type = match[1], value = match[2]\n\t\tif (type === \"\" && value !== \"\") tag = value\n\t\telse if (type === \"#\") attrs.id = value\n\t\telse if (type === \".\") classes.push(value)\n\t\telse if (match[3][0] === \"[\") {\n\t\t\tvar attrValue = match[6]\n\t\t\tif (attrValue) attrValue = attrValue.replace(/\\\\([\"'])/g, \"$1\").replace(/\\\\\\\\/g, \"\\\\\")\n\t\t\tif (match[4] === \"class\") classes.push(attrValue)\n\t\t\telse {\n\t\t\t\tattrs[match[4]] = attrValue === \"\" ? attrValue : attrValue || true\n\t\t\t\tif (isFormAttributeKey(match[4])) isStatic = false\n\t\t\t}\n\t\t}\n\t}\n\tif (classes.length > 0) attrs.className = classes.join(\" \")\n\tif (isEmpty(attrs)) attrs = emptyAttrs\n\telse cachedAttrsIsStaticMap.set(attrs, isStatic)\n\treturn selectorCache[selector] = {tag: tag, attrs: attrs, is: attrs.is}\n}\n\nfunction execSelector(state, vnode) {\n\tvnode.tag = state.tag\n\n\tvar attrs = vnode.attrs\n\tif (attrs == null) {\n\t\tvnode.attrs = state.attrs\n\t\tvnode.is = state.is\n\t\treturn vnode\n\t}\n\n\tif (hasOwn.call(attrs, \"class\")) {\n\t\tif (attrs.class != null) attrs.className = attrs.class\n\t\tattrs.class = null\n\t}\n\n\tif (state.attrs !== emptyAttrs) {\n\t\tvar className = attrs.className\n\t\tattrs = Object.assign({}, state.attrs, attrs)\n\n\t\tif (state.attrs.className != null) attrs.className =\n\t\t\tclassName != null\n\t\t\t\t? String(state.attrs.className) + \" \" + String(className)\n\t\t\t\t: state.attrs.className\n\t}\n\n\t// workaround for #2622 (reorder keys in attrs to set \"type\" first)\n\t// The DOM does things to inputs based on the \"type\", so it needs set first.\n\t// See: https://github.com/MithrilJS/mithril.js/issues/2622\n\tif (state.tag === \"input\" && hasOwn.call(attrs, \"type\")) {\n\t\tattrs = Object.assign({type: attrs.type}, attrs)\n\t}\n\n\t// This reduces the complexity of the evaluation of \"is\" within the render function.\n\tvnode.is = attrs.is\n\n\tvnode.attrs = attrs\n\n\treturn vnode\n}\n\nfunction hyperscript(selector, attrs, ...children) {\n\tif (selector == null || typeof selector !== \"string\" && typeof selector !== \"function\" && typeof selector.view !== \"function\") {\n\t\tthrow Error(\"The selector must be either a string or a component.\");\n\t}\n\n\tvar vnode = hyperscriptVnode(attrs, children)\n\n\tif (typeof selector === \"string\") {\n\t\tvnode.children = Vnode.normalizeChildren(vnode.children)\n\t\tif (selector !== \"[\") return execSelector(selectorCache[selector] || compileSelector(selector), vnode)\n\t}\n\n\tif (vnode.attrs == null) vnode.attrs = {}\n\tvnode.tag = selector\n\treturn vnode\n}\n\nmodule.exports = hyperscript\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\n\nmodule.exports = function(html) {\n\tif (html == null) html = \"\"\n\treturn Vnode(\"<\", undefined, undefined, html, undefined, undefined)\n}\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\nvar hyperscriptVnode = require(\"./hyperscriptVnode\")\n\nmodule.exports = function(attrs, ...children) {\n\tvar vnode = hyperscriptVnode(attrs, children)\n\n\tif (vnode.attrs == null) vnode.attrs = {}\n\tvnode.tag = \"[\"\n\tvnode.children = Vnode.normalizeChildren(vnode.children)\n\treturn vnode\n}\n", "\"use strict\"\n\nvar hyperscript = require(\"./render/hyperscript\")\n\nhyperscript.trust = require(\"./render/trust\")\nhyperscript.fragment = require(\"./render/fragment\")\n\nmodule.exports = hyperscript\n", "\"use strict\"\n\nmodule.exports = new WeakMap\n", "\"use strict\"\n\nvar delayedRemoval = require(\"./delayedRemoval\")\n\nfunction *domFor(vnode) {\n\t// To avoid unintended mangling of the internal bundler,\n\t// parameter destructuring is not used here.\n\tvar dom = vnode.dom\n\tvar domSize = vnode.domSize\n\tvar generation = delayedRemoval.get(dom)\n\tif (dom != null) do {\n\t\tvar nextSibling = dom.nextSibling\n\n\t\tif (delayedRemoval.get(dom) === generation) {\n\t\t\tyield dom\n\t\t\tdomSize--\n\t\t}\n\n\t\tdom = nextSibling\n\t}\n\twhile (domSize)\n}\n\nmodule.exports = domFor\n", "\"use strict\"\n\nvar Vnode = require(\"./vnode\")\nvar delayedRemoval = require(\"./delayedRemoval\")\nvar domFor = require(\"./domFor\")\nvar cachedAttrsIsStaticMap = require(\"./cachedAttrsIsStaticMap\")\n\nmodule.exports = function() {\n\tvar nameSpace = {\n\t\tsvg: \"http://www.w3.org/2000/svg\",\n\t\tmath: \"http://www.w3.org/1998/Math/MathML\"\n\t}\n\n\tvar currentRedraw\n\tvar currentRender\n\n\tfunction getDocument(dom) {\n\t\treturn dom.ownerDocument;\n\t}\n\n\tfunction getNameSpace(vnode) {\n\t\treturn vnode.attrs && vnode.attrs.xmlns || nameSpace[vnode.tag]\n\t}\n\n\t//sanity check to discourage people from doing `vnode.state = ...`\n\tfunction checkState(vnode, original) {\n\t\tif (vnode.state !== original) throw new Error(\"'vnode.state' must not be modified.\")\n\t}\n\n\t//Note: the hook is passed as the `this` argument to allow proxying the\n\t//arguments without requiring a full array allocation to do so. It also\n\t//takes advantage of the fact the current `vnode` is the first argument in\n\t//all lifecycle methods.\n\tfunction callHook(vnode) {\n\t\tvar original = vnode.state\n\t\ttry {\n\t\t\treturn this.apply(original, arguments)\n\t\t} finally {\n\t\t\tcheckState(vnode, original)\n\t\t}\n\t}\n\n\t// IE11 (at least) throws an UnspecifiedError when accessing document.activeElement when\n\t// inside an iframe. Catch and swallow this error, and heavy-handidly return null.\n\tfunction activeElement(dom) {\n\t\ttry {\n\t\t\treturn getDocument(dom).activeElement\n\t\t} catch (e) {\n\t\t\treturn null\n\t\t}\n\t}\n\t//create\n\tfunction createNodes(parent, vnodes, start, end, hooks, nextSibling, ns) {\n\t\tfor (var i = start; i < end; i++) {\n\t\t\tvar vnode = vnodes[i]\n\t\t\tif (vnode != null) {\n\t\t\t\tcreateNode(parent, vnode, hooks, ns, nextSibling)\n\t\t\t}\n\t\t}\n\t}\n\tfunction createNode(parent, vnode, hooks, ns, nextSibling) {\n\t\tvar tag = vnode.tag\n\t\tif (typeof tag === \"string\") {\n\t\t\tvnode.state = {}\n\t\t\tif (vnode.attrs != null) initLifecycle(vnode.attrs, vnode, hooks)\n\t\t\tswitch (tag) {\n\t\t\t\tcase \"#\": createText(parent, vnode, nextSibling); break\n\t\t\t\tcase \"<\": createHTML(parent, vnode, ns, nextSibling); break\n\t\t\t\tcase \"[\": createFragment(parent, vnode, hooks, ns, nextSibling); break\n\t\t\t\tdefault: createElement(parent, vnode, hooks, ns, nextSibling)\n\t\t\t}\n\t\t}\n\t\telse createComponent(parent, vnode, hooks, ns, nextSibling)\n\t}\n\tfunction createText(parent, vnode, nextSibling) {\n\t\tvnode.dom = getDocument(parent).createTextNode(vnode.children)\n\t\tinsertDOM(parent, vnode.dom, nextSibling)\n\t}\n\tvar possibleParents = {caption: \"table\", thead: \"table\", tbody: \"table\", tfoot: \"table\", tr: \"tbody\", th: \"tr\", td: \"tr\", colgroup: \"table\", col: \"colgroup\"}\n\tfunction createHTML(parent, vnode, ns, nextSibling) {\n\t\tvar match = vnode.children.match(/^\\s*?<(\\w+)/im) || []\n\t\t// not using the proper parent makes the child element(s) vanish.\n\t\t//     var div = document.createElement(\"div\")\n\t\t//     div.innerHTML = \"<td>i</td><td>j</td>\"\n\t\t//     console.log(div.innerHTML)\n\t\t// --> \"ij\", no <td> in sight.\n\t\tvar temp = getDocument(parent).createElement(possibleParents[match[1]] || \"div\")\n\t\tif (ns === \"http://www.w3.org/2000/svg\") {\n\t\t\ttemp.innerHTML = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\">\" + vnode.children + \"</svg>\"\n\t\t\ttemp = temp.firstChild\n\t\t} else {\n\t\t\ttemp.innerHTML = vnode.children\n\t\t}\n\t\tvnode.dom = temp.firstChild\n\t\tvnode.domSize = temp.childNodes.length\n\t\tvar fragment = getDocument(parent).createDocumentFragment()\n\t\tvar child\n\t\twhile (child = temp.firstChild) {\n\t\t\tfragment.appendChild(child)\n\t\t}\n\t\tinsertDOM(parent, fragment, nextSibling)\n\t}\n\tfunction createFragment(parent, vnode, hooks, ns, nextSibling) {\n\t\tvar fragment = getDocument(parent).createDocumentFragment()\n\t\tif (vnode.children != null) {\n\t\t\tvar children = vnode.children\n\t\t\tcreateNodes(fragment, children, 0, children.length, hooks, null, ns)\n\t\t}\n\t\tvnode.dom = fragment.firstChild\n\t\tvnode.domSize = fragment.childNodes.length\n\t\tinsertDOM(parent, fragment, nextSibling)\n\t}\n\tfunction createElement(parent, vnode, hooks, ns, nextSibling) {\n\t\tvar tag = vnode.tag\n\t\tvar attrs = vnode.attrs\n\t\tvar is = vnode.is\n\n\t\tns = getNameSpace(vnode) || ns\n\n\t\tvar element = ns ?\n\t\t\tis ? getDocument(parent).createElementNS(ns, tag, {is: is}) : getDocument(parent).createElementNS(ns, tag) :\n\t\t\tis ? getDocument(parent).createElement(tag, {is: is}) : getDocument(parent).createElement(tag)\n\t\tvnode.dom = element\n\n\t\tif (attrs != null) {\n\t\t\tsetAttrs(vnode, attrs, ns)\n\t\t}\n\n\t\tinsertDOM(parent, element, nextSibling)\n\n\t\tif (!maybeSetContentEditable(vnode)) {\n\t\t\tif (vnode.children != null) {\n\t\t\t\tvar children = vnode.children\n\t\t\t\tcreateNodes(element, children, 0, children.length, hooks, null, ns)\n\t\t\t\tif (vnode.tag === \"select\" && attrs != null) setLateSelectAttrs(vnode, attrs)\n\t\t\t}\n\t\t}\n\t}\n\tfunction initComponent(vnode, hooks) {\n\t\tvar sentinel\n\t\tif (typeof vnode.tag.view === \"function\") {\n\t\t\tvnode.state = Object.create(vnode.tag)\n\t\t\tsentinel = vnode.state.view\n\t\t\tif (sentinel.$$reentrantLock$$ != null) return\n\t\t\tsentinel.$$reentrantLock$$ = true\n\t\t} else {\n\t\t\tvnode.state = void 0\n\t\t\tsentinel = vnode.tag\n\t\t\tif (sentinel.$$reentrantLock$$ != null) return\n\t\t\tsentinel.$$reentrantLock$$ = true\n\t\t\tvnode.state = (vnode.tag.prototype != null && typeof vnode.tag.prototype.view === \"function\") ? new vnode.tag(vnode) : vnode.tag(vnode)\n\t\t}\n\t\tinitLifecycle(vnode.state, vnode, hooks)\n\t\tif (vnode.attrs != null) initLifecycle(vnode.attrs, vnode, hooks)\n\t\tvnode.instance = Vnode.normalize(callHook.call(vnode.state.view, vnode))\n\t\tif (vnode.instance === vnode) throw Error(\"A view cannot return the vnode it received as argument\")\n\t\tsentinel.$$reentrantLock$$ = null\n\t}\n\tfunction createComponent(parent, vnode, hooks, ns, nextSibling) {\n\t\tinitComponent(vnode, hooks)\n\t\tif (vnode.instance != null) {\n\t\t\tcreateNode(parent, vnode.instance, hooks, ns, nextSibling)\n\t\t\tvnode.dom = vnode.instance.dom\n\t\t\tvnode.domSize = vnode.instance.domSize\n\t\t}\n\t\telse {\n\t\t\tvnode.domSize = 0\n\t\t}\n\t}\n\n\t//update\n\t/**\n\t * @param {Element|Fragment} parent - the parent element\n\t * @param {Vnode[] | null} old - the list of vnodes of the last `render()` call for\n\t *                               this part of the tree\n\t * @param {Vnode[] | null} vnodes - as above, but for the current `render()` call.\n\t * @param {Function[]} hooks - an accumulator of post-render hooks (oncreate/onupdate)\n\t * @param {Element | null} nextSibling - the next DOM node if we're dealing with a\n\t *                                       fragment that is not the last item in its\n\t *                                       parent\n\t * @param {'svg' | 'math' | String | null} ns) - the current XML namespace, if any\n\t * @returns void\n\t */\n\t// This function diffs and patches lists of vnodes, both keyed and unkeyed.\n\t//\n\t// We will:\n\t//\n\t// 1. describe its general structure\n\t// 2. focus on the diff algorithm optimizations\n\t// 3. discuss DOM node operations.\n\n\t// ## Overview:\n\t//\n\t// The updateNodes() function:\n\t// - deals with trivial cases\n\t// - determines whether the lists are keyed or unkeyed based on the first non-null node\n\t//   of each list.\n\t// - diffs them and patches the DOM if needed (that's the brunt of the code)\n\t// - manages the leftovers: after diffing, are there:\n\t//   - old nodes left to remove?\n\t// \t - new nodes to insert?\n\t// \t deal with them!\n\t//\n\t// The lists are only iterated over once, with an exception for the nodes in `old` that\n\t// are visited in the fourth part of the diff and in the `removeNodes` loop.\n\n\t// ## Diffing\n\t//\n\t// Reading https://github.com/localvoid/ivi/blob/ddc09d06abaef45248e6133f7040d00d3c6be853/packages/ivi/src/vdom/implementation.ts#L617-L837\n\t// may be good for context on longest increasing subsequence-based logic for moving nodes.\n\t//\n\t// In order to diff keyed lists, one has to\n\t//\n\t// 1) match nodes in both lists, per key, and update them accordingly\n\t// 2) create the nodes present in the new list, but absent in the old one\n\t// 3) remove the nodes present in the old list, but absent in the new one\n\t// 4) figure out what nodes in 1) to move in order to minimize the DOM operations.\n\t//\n\t// To achieve 1) one can create a dictionary of keys => index (for the old list), then iterate\n\t// over the new list and for each new vnode, find the corresponding vnode in the old list using\n\t// the map.\n\t// 2) is achieved in the same step: if a new node has no corresponding entry in the map, it is new\n\t// and must be created.\n\t// For the removals, we actually remove the nodes that have been updated from the old list.\n\t// The nodes that remain in that list after 1) and 2) have been performed can be safely removed.\n\t// The fourth step is a bit more complex and relies on the longest increasing subsequence (LIS)\n\t// algorithm.\n\t//\n\t// the longest increasing subsequence is the list of nodes that can remain in place. Imagine going\n\t// from `1,2,3,4,5` to `4,5,1,2,3` where the numbers are not necessarily the keys, but the indices\n\t// corresponding to the keyed nodes in the old list (keyed nodes `e,d,c,b,a` => `b,a,e,d,c` would\n\t//  match the above lists, for example).\n\t//\n\t// In there are two increasing subsequences: `4,5` and `1,2,3`, the latter being the longest. We\n\t// can update those nodes without moving them, and only call `insertNode` on `4` and `5`.\n\t//\n\t// @localvoid adapted the algo to also support node deletions and insertions (the `lis` is actually\n\t// the longest increasing subsequence *of old nodes still present in the new list*).\n\t//\n\t// It is a general algorithm that is fireproof in all circumstances, but it requires the allocation\n\t// and the construction of a `key => oldIndex` map, and three arrays (one with `newIndex => oldIndex`,\n\t// the `LIS` and a temporary one to create the LIS).\n\t//\n\t// So we cheat where we can: if the tails of the lists are identical, they are guaranteed to be part of\n\t// the LIS and can be updated without moving them.\n\t//\n\t// If two nodes are swapped, they are guaranteed not to be part of the LIS, and must be moved (with\n\t// the exception of the last node if the list is fully reversed).\n\t//\n\t// ## Finding the next sibling.\n\t//\n\t// `updateNode()` and `createNode()` expect a nextSibling parameter to perform DOM operations.\n\t// When the list is being traversed top-down, at any index, the DOM nodes up to the previous\n\t// vnode reflect the content of the new list, whereas the rest of the DOM nodes reflect the old\n\t// list. The next sibling must be looked for in the old list using `getNextSibling(... oldStart + 1 ...)`.\n\t//\n\t// In the other scenarios (swaps, upwards traversal, map-based diff),\n\t// the new vnodes list is traversed upwards. The DOM nodes at the bottom of the list reflect the\n\t// bottom part of the new vnodes list, and we can use the `v.dom`  value of the previous node\n\t// as the next sibling (cached in the `nextSibling` variable).\n\n\n\t// ## DOM node moves\n\t//\n\t// In most scenarios `updateNode()` and `createNode()` perform the DOM operations. However,\n\t// this is not the case if the node moved (second and fourth part of the diff algo). We move\n\t// the old DOM nodes before updateNode runs because it enables us to use the cached `nextSibling`\n\t// variable rather than fetching it using `getNextSibling()`.\n\n\tfunction updateNodes(parent, old, vnodes, hooks, nextSibling, ns) {\n\t\tif (old === vnodes || old == null && vnodes == null) return\n\t\telse if (old == null || old.length === 0) createNodes(parent, vnodes, 0, vnodes.length, hooks, nextSibling, ns)\n\t\telse if (vnodes == null || vnodes.length === 0) removeNodes(parent, old, 0, old.length)\n\t\telse {\n\t\t\tvar isOldKeyed = old[0] != null && old[0].key != null\n\t\t\tvar isKeyed = vnodes[0] != null && vnodes[0].key != null\n\t\t\tvar start = 0, oldStart = 0\n\t\t\tif (!isOldKeyed) while (oldStart < old.length && old[oldStart] == null) oldStart++\n\t\t\tif (!isKeyed) while (start < vnodes.length && vnodes[start] == null) start++\n\t\t\tif (isOldKeyed !== isKeyed) {\n\t\t\t\tremoveNodes(parent, old, oldStart, old.length)\n\t\t\t\tcreateNodes(parent, vnodes, start, vnodes.length, hooks, nextSibling, ns)\n\t\t\t} else if (!isKeyed) {\n\t\t\t\t// Don't index past the end of either list (causes deopts).\n\t\t\t\tvar commonLength = old.length < vnodes.length ? old.length : vnodes.length\n\t\t\t\t// Rewind if necessary to the first non-null index on either side.\n\t\t\t\t// We could alternatively either explicitly create or remove nodes when `start !== oldStart`\n\t\t\t\t// but that would be optimizing for sparse lists which are more rare than dense ones.\n\t\t\t\tstart = start < oldStart ? start : oldStart\n\t\t\t\tfor (; start < commonLength; start++) {\n\t\t\t\t\to = old[start]\n\t\t\t\t\tv = vnodes[start]\n\t\t\t\t\tif (o === v || o == null && v == null) continue\n\t\t\t\t\telse if (o == null) createNode(parent, v, hooks, ns, getNextSibling(old, start + 1, nextSibling))\n\t\t\t\t\telse if (v == null) removeNode(parent, o)\n\t\t\t\t\telse updateNode(parent, o, v, hooks, getNextSibling(old, start + 1, nextSibling), ns)\n\t\t\t\t}\n\t\t\t\tif (old.length > commonLength) removeNodes(parent, old, start, old.length)\n\t\t\t\tif (vnodes.length > commonLength) createNodes(parent, vnodes, start, vnodes.length, hooks, nextSibling, ns)\n\t\t\t} else {\n\t\t\t\t// keyed diff\n\t\t\t\tvar oldEnd = old.length - 1, end = vnodes.length - 1, map, o, v, oe, ve, topSibling\n\n\t\t\t\t// bottom-up\n\t\t\t\twhile (oldEnd >= oldStart && end >= start) {\n\t\t\t\t\toe = old[oldEnd]\n\t\t\t\t\tve = vnodes[end]\n\t\t\t\t\tif (oe.key !== ve.key) break\n\t\t\t\t\tif (oe !== ve) updateNode(parent, oe, ve, hooks, nextSibling, ns)\n\t\t\t\t\tif (ve.dom != null) nextSibling = ve.dom\n\t\t\t\t\toldEnd--, end--\n\t\t\t\t}\n\t\t\t\t// top-down\n\t\t\t\twhile (oldEnd >= oldStart && end >= start) {\n\t\t\t\t\to = old[oldStart]\n\t\t\t\t\tv = vnodes[start]\n\t\t\t\t\tif (o.key !== v.key) break\n\t\t\t\t\toldStart++, start++\n\t\t\t\t\tif (o !== v) updateNode(parent, o, v, hooks, getNextSibling(old, oldStart, nextSibling), ns)\n\t\t\t\t}\n\t\t\t\t// swaps and list reversals\n\t\t\t\twhile (oldEnd >= oldStart && end >= start) {\n\t\t\t\t\tif (start === end) break\n\t\t\t\t\tif (o.key !== ve.key || oe.key !== v.key) break\n\t\t\t\t\ttopSibling = getNextSibling(old, oldStart, nextSibling)\n\t\t\t\t\tmoveDOM(parent, oe, topSibling)\n\t\t\t\t\tif (oe !== v) updateNode(parent, oe, v, hooks, topSibling, ns)\n\t\t\t\t\tif (++start <= --end) moveDOM(parent, o, nextSibling)\n\t\t\t\t\tif (o !== ve) updateNode(parent, o, ve, hooks, nextSibling, ns)\n\t\t\t\t\tif (ve.dom != null) nextSibling = ve.dom\n\t\t\t\t\toldStart++; oldEnd--\n\t\t\t\t\toe = old[oldEnd]\n\t\t\t\t\tve = vnodes[end]\n\t\t\t\t\to = old[oldStart]\n\t\t\t\t\tv = vnodes[start]\n\t\t\t\t}\n\t\t\t\t// bottom up once again\n\t\t\t\twhile (oldEnd >= oldStart && end >= start) {\n\t\t\t\t\tif (oe.key !== ve.key) break\n\t\t\t\t\tif (oe !== ve) updateNode(parent, oe, ve, hooks, nextSibling, ns)\n\t\t\t\t\tif (ve.dom != null) nextSibling = ve.dom\n\t\t\t\t\toldEnd--, end--\n\t\t\t\t\toe = old[oldEnd]\n\t\t\t\t\tve = vnodes[end]\n\t\t\t\t}\n\t\t\t\tif (start > end) removeNodes(parent, old, oldStart, oldEnd + 1)\n\t\t\t\telse if (oldStart > oldEnd) createNodes(parent, vnodes, start, end + 1, hooks, nextSibling, ns)\n\t\t\t\telse {\n\t\t\t\t\t// inspired by ivi https://github.com/ivijs/ivi/ by Boris Kaul\n\t\t\t\t\tvar originalNextSibling = nextSibling, vnodesLength = end - start + 1, oldIndices = new Array(vnodesLength), li=0, i=0, pos = 2147483647, matched = 0, map, lisIndices\n\t\t\t\t\tfor (i = 0; i < vnodesLength; i++) oldIndices[i] = -1\n\t\t\t\t\tfor (i = end; i >= start; i--) {\n\t\t\t\t\t\tif (map == null) map = getKeyMap(old, oldStart, oldEnd + 1)\n\t\t\t\t\t\tve = vnodes[i]\n\t\t\t\t\t\tvar oldIndex = map[ve.key]\n\t\t\t\t\t\tif (oldIndex != null) {\n\t\t\t\t\t\t\tpos = (oldIndex < pos) ? oldIndex : -1 // becomes -1 if nodes were re-ordered\n\t\t\t\t\t\t\toldIndices[i-start] = oldIndex\n\t\t\t\t\t\t\toe = old[oldIndex]\n\t\t\t\t\t\t\told[oldIndex] = null\n\t\t\t\t\t\t\tif (oe !== ve) updateNode(parent, oe, ve, hooks, nextSibling, ns)\n\t\t\t\t\t\t\tif (ve.dom != null) nextSibling = ve.dom\n\t\t\t\t\t\t\tmatched++\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnextSibling = originalNextSibling\n\t\t\t\t\tif (matched !== oldEnd - oldStart + 1) removeNodes(parent, old, oldStart, oldEnd + 1)\n\t\t\t\t\tif (matched === 0) createNodes(parent, vnodes, start, end + 1, hooks, nextSibling, ns)\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (pos === -1) {\n\t\t\t\t\t\t\t// the indices of the indices of the items that are part of the\n\t\t\t\t\t\t\t// longest increasing subsequence in the oldIndices list\n\t\t\t\t\t\t\tlisIndices = makeLisIndices(oldIndices)\n\t\t\t\t\t\t\tli = lisIndices.length - 1\n\t\t\t\t\t\t\tfor (i = end; i >= start; i--) {\n\t\t\t\t\t\t\t\tv = vnodes[i]\n\t\t\t\t\t\t\t\tif (oldIndices[i-start] === -1) createNode(parent, v, hooks, ns, nextSibling)\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tif (lisIndices[li] === i - start) li--\n\t\t\t\t\t\t\t\t\telse moveDOM(parent, v, nextSibling)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (v.dom != null) nextSibling = vnodes[i].dom\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfor (i = end; i >= start; i--) {\n\t\t\t\t\t\t\t\tv = vnodes[i]\n\t\t\t\t\t\t\t\tif (oldIndices[i-start] === -1) createNode(parent, v, hooks, ns, nextSibling)\n\t\t\t\t\t\t\t\tif (v.dom != null) nextSibling = vnodes[i].dom\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfunction updateNode(parent, old, vnode, hooks, nextSibling, ns) {\n\t\tvar oldTag = old.tag, tag = vnode.tag\n\t\tif (oldTag === tag && old.is === vnode.is) {\n\t\t\tvnode.state = old.state\n\t\t\tvnode.events = old.events\n\t\t\tif (shouldNotUpdate(vnode, old)) return\n\t\t\tif (typeof oldTag === \"string\") {\n\t\t\t\tif (vnode.attrs != null) {\n\t\t\t\t\tupdateLifecycle(vnode.attrs, vnode, hooks)\n\t\t\t\t}\n\t\t\t\tswitch (oldTag) {\n\t\t\t\t\tcase \"#\": updateText(old, vnode); break\n\t\t\t\t\tcase \"<\": updateHTML(parent, old, vnode, ns, nextSibling); break\n\t\t\t\t\tcase \"[\": updateFragment(parent, old, vnode, hooks, nextSibling, ns); break\n\t\t\t\t\tdefault: updateElement(old, vnode, hooks, ns)\n\t\t\t\t}\n\t\t\t}\n\t\t\telse updateComponent(parent, old, vnode, hooks, nextSibling, ns)\n\t\t}\n\t\telse {\n\t\t\tremoveNode(parent, old)\n\t\t\tcreateNode(parent, vnode, hooks, ns, nextSibling)\n\t\t}\n\t}\n\tfunction updateText(old, vnode) {\n\t\tif (old.children.toString() !== vnode.children.toString()) {\n\t\t\told.dom.nodeValue = vnode.children\n\t\t}\n\t\tvnode.dom = old.dom\n\t}\n\tfunction updateHTML(parent, old, vnode, ns, nextSibling) {\n\t\tif (old.children !== vnode.children) {\n\t\t\tremoveDOM(parent, old)\n\t\t\tcreateHTML(parent, vnode, ns, nextSibling)\n\t\t}\n\t\telse {\n\t\t\tvnode.dom = old.dom\n\t\t\tvnode.domSize = old.domSize\n\t\t}\n\t}\n\tfunction updateFragment(parent, old, vnode, hooks, nextSibling, ns) {\n\t\tupdateNodes(parent, old.children, vnode.children, hooks, nextSibling, ns)\n\t\tvar domSize = 0, children = vnode.children\n\t\tvnode.dom = null\n\t\tif (children != null) {\n\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\tvar child = children[i]\n\t\t\t\tif (child != null && child.dom != null) {\n\t\t\t\t\tif (vnode.dom == null) vnode.dom = child.dom\n\t\t\t\t\tdomSize += child.domSize || 1\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvnode.domSize = domSize\n\t}\n\tfunction updateElement(old, vnode, hooks, ns) {\n\t\tvar element = vnode.dom = old.dom\n\t\tns = getNameSpace(vnode) || ns\n\n\t\tif (old.attrs != vnode.attrs || (vnode.attrs != null && !cachedAttrsIsStaticMap.get(vnode.attrs))) {\n\t\t\tupdateAttrs(vnode, old.attrs, vnode.attrs, ns)\n\t\t}\n\t\tif (!maybeSetContentEditable(vnode)) {\n\t\t\tupdateNodes(element, old.children, vnode.children, hooks, null, ns)\n\t\t}\n\t}\n\tfunction updateComponent(parent, old, vnode, hooks, nextSibling, ns) {\n\t\tvnode.instance = Vnode.normalize(callHook.call(vnode.state.view, vnode))\n\t\tif (vnode.instance === vnode) throw Error(\"A view cannot return the vnode it received as argument\")\n\t\tupdateLifecycle(vnode.state, vnode, hooks)\n\t\tif (vnode.attrs != null) updateLifecycle(vnode.attrs, vnode, hooks)\n\t\tif (vnode.instance != null) {\n\t\t\tif (old.instance == null) createNode(parent, vnode.instance, hooks, ns, nextSibling)\n\t\t\telse updateNode(parent, old.instance, vnode.instance, hooks, nextSibling, ns)\n\t\t\tvnode.dom = vnode.instance.dom\n\t\t\tvnode.domSize = vnode.instance.domSize\n\t\t}\n\t\telse {\n\t\t\tif (old.instance != null) removeNode(parent, old.instance)\n\t\t\tvnode.domSize = 0\n\t\t}\n\t}\n\tfunction getKeyMap(vnodes, start, end) {\n\t\tvar map = Object.create(null)\n\t\tfor (; start < end; start++) {\n\t\t\tvar vnode = vnodes[start]\n\t\t\tif (vnode != null) {\n\t\t\t\tvar key = vnode.key\n\t\t\t\tif (key != null) map[key] = start\n\t\t\t}\n\t\t}\n\t\treturn map\n\t}\n\t// Lifted from ivi https://github.com/ivijs/ivi/\n\t// takes a list of unique numbers (-1 is special and can\n\t// occur multiple times) and returns an array with the indices\n\t// of the items that are part of the longest increasing\n\t// subsequence\n\tvar lisTemp = []\n\tfunction makeLisIndices(a) {\n\t\tvar result = [0]\n\t\tvar u = 0, v = 0, i = 0\n\t\tvar il = lisTemp.length = a.length\n\t\tfor (var i = 0; i < il; i++) lisTemp[i] = a[i]\n\t\tfor (var i = 0; i < il; ++i) {\n\t\t\tif (a[i] === -1) continue\n\t\t\tvar j = result[result.length - 1]\n\t\t\tif (a[j] < a[i]) {\n\t\t\t\tlisTemp[i] = j\n\t\t\t\tresult.push(i)\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tu = 0\n\t\t\tv = result.length - 1\n\t\t\twhile (u < v) {\n\t\t\t\t// Fast integer average without overflow.\n\t\t\t\t// eslint-disable-next-line no-bitwise\n\t\t\t\tvar c = (u >>> 1) + (v >>> 1) + (u & v & 1)\n\t\t\t\tif (a[result[c]] < a[i]) {\n\t\t\t\t\tu = c + 1\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tv = c\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a[i] < a[result[u]]) {\n\t\t\t\tif (u > 0) lisTemp[i] = result[u - 1]\n\t\t\t\tresult[u] = i\n\t\t\t}\n\t\t}\n\t\tu = result.length\n\t\tv = result[u - 1]\n\t\twhile (u-- > 0) {\n\t\t\tresult[u] = v\n\t\t\tv = lisTemp[v]\n\t\t}\n\t\tlisTemp.length = 0\n\t\treturn result\n\t}\n\n\tfunction getNextSibling(vnodes, i, nextSibling) {\n\t\tfor (; i < vnodes.length; i++) {\n\t\t\tif (vnodes[i] != null && vnodes[i].dom != null) return vnodes[i].dom\n\t\t}\n\t\treturn nextSibling\n\t}\n\n\t// This handles fragments with zombie children (removed from vdom, but persisted in DOM through onbeforeremove)\n\tfunction moveDOM(parent, vnode, nextSibling) {\n\t\tif (vnode.dom != null) {\n\t\t\tvar target\n\t\t\tif (vnode.domSize == null || vnode.domSize === 1) {\n\t\t\t\t// don't allocate for the common case\n\t\t\t\ttarget = vnode.dom\n\t\t\t} else {\n\t\t\t\ttarget = getDocument(parent).createDocumentFragment()\n\t\t\t\tfor (var dom of domFor(vnode)) target.appendChild(dom)\n\t\t\t}\n\t\t\tinsertDOM(parent, target, nextSibling)\n\t\t}\n\t}\n\n\tfunction insertDOM(parent, dom, nextSibling) {\n\t\tif (nextSibling != null) parent.insertBefore(dom, nextSibling)\n\t\telse parent.appendChild(dom)\n\t}\n\n\tfunction maybeSetContentEditable(vnode) {\n\t\tif (vnode.attrs == null || (\n\t\t\tvnode.attrs.contenteditable == null && // attribute\n\t\t\tvnode.attrs.contentEditable == null // property\n\t\t)) return false\n\t\tvar children = vnode.children\n\t\tif (children != null && children.length === 1 && children[0].tag === \"<\") {\n\t\t\tvar content = children[0].children\n\t\t\tif (vnode.dom.innerHTML !== content) vnode.dom.innerHTML = content\n\t\t}\n\t\telse if (children != null && children.length !== 0) throw new Error(\"Child node of a contenteditable must be trusted.\")\n\t\treturn true\n\t}\n\n\t//remove\n\tfunction removeNodes(parent, vnodes, start, end) {\n\t\tfor (var i = start; i < end; i++) {\n\t\t\tvar vnode = vnodes[i]\n\t\t\tif (vnode != null) removeNode(parent, vnode)\n\t\t}\n\t}\n\tfunction tryBlockRemove(parent, vnode, source, counter) {\n\t\tvar original = vnode.state\n\t\tvar result = callHook.call(source.onbeforeremove, vnode)\n\t\tif (result == null) return\n\n\t\tvar generation = currentRender\n\t\tfor (var dom of domFor(vnode)) delayedRemoval.set(dom, generation)\n\t\tcounter.v++\n\n\t\tPromise.resolve(result).finally(function () {\n\t\t\tcheckState(vnode, original)\n\t\t\ttryResumeRemove(parent, vnode, counter)\n\t\t})\n\t}\n\tfunction tryResumeRemove(parent, vnode, counter) {\n\t\tif (--counter.v === 0) {\n\t\t\tonremove(vnode)\n\t\t\tremoveDOM(parent, vnode)\n\t\t}\n\t}\n\tfunction removeNode(parent, vnode) {\n\t\tvar counter = {v: 1}\n\t\tif (typeof vnode.tag !== \"string\" && typeof vnode.state.onbeforeremove === \"function\") tryBlockRemove(parent, vnode, vnode.state, counter)\n\t\tif (vnode.attrs && typeof vnode.attrs.onbeforeremove === \"function\") tryBlockRemove(parent, vnode, vnode.attrs, counter)\n\t\ttryResumeRemove(parent, vnode, counter)\n\t}\n\tfunction removeDOM(parent, vnode) {\n\t\tif (vnode.dom == null) return\n\t\tif (vnode.domSize == null || vnode.domSize === 1) {\n\t\t\tparent.removeChild(vnode.dom)\n\t\t} else {\n\t\t\tfor (var dom of domFor(vnode)) parent.removeChild(dom)\n\t\t}\n\t}\n\n\tfunction onremove(vnode) {\n\t\tif (typeof vnode.tag !== \"string\" && typeof vnode.state.onremove === \"function\") callHook.call(vnode.state.onremove, vnode)\n\t\tif (vnode.attrs && typeof vnode.attrs.onremove === \"function\") callHook.call(vnode.attrs.onremove, vnode)\n\t\tif (typeof vnode.tag !== \"string\") {\n\t\t\tif (vnode.instance != null) onremove(vnode.instance)\n\t\t} else {\n\t\t\tif (vnode.events != null) vnode.events._ = null\n\t\t\tvar children = vnode.children\n\t\t\tif (Array.isArray(children)) {\n\t\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\t\tvar child = children[i]\n\t\t\t\t\tif (child != null) onremove(child)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t//attrs\n\tfunction setAttrs(vnode, attrs, ns) {\n\t\tfor (var key in attrs) {\n\t\t\tsetAttr(vnode, key, null, attrs[key], ns)\n\t\t}\n\t}\n\tfunction setAttr(vnode, key, old, value, ns) {\n\t\tif (key === \"key\" || value == null || isLifecycleMethod(key) || (old === value && !isFormAttribute(vnode, key)) && typeof value !== \"object\") return\n\t\tif (key[0] === \"o\" && key[1] === \"n\") return updateEvent(vnode, key, value)\n\t\tif (key.slice(0, 6) === \"xlink:\") vnode.dom.setAttributeNS(\"http://www.w3.org/1999/xlink\", key.slice(6), value)\n\t\telse if (key === \"style\") updateStyle(vnode.dom, old, value)\n\t\telse if (hasPropertyKey(vnode, key, ns)) {\n\t\t\tif (key === \"value\") {\n\t\t\t\t// Only do the coercion if we're actually going to check the value.\n\t\t\t\t/* eslint-disable no-implicit-coercion */\n\t\t\t\t//setting input[value] to same value by typing on focused element moves cursor to end in Chrome\n\t\t\t\t//setting input[type=file][value] to same value causes an error to be generated if it's non-empty\n\t\t\t\t//minlength/maxlength validation isn't performed on script-set values(#2256)\n\t\t\t\tif ((vnode.tag === \"input\" || vnode.tag === \"textarea\") && vnode.dom.value === \"\" + value) return\n\t\t\t\t//setting select[value] to same value while having select open blinks select dropdown in Chrome\n\t\t\t\tif (vnode.tag === \"select\" && old !== null && vnode.dom.value === \"\" + value) return\n\t\t\t\t//setting option[value] to same value while having select open blinks select dropdown in Chrome\n\t\t\t\tif (vnode.tag === \"option\" && old !== null && vnode.dom.value === \"\" + value) return\n\t\t\t\t//setting input[type=file][value] to different value is an error if it's non-empty\n\t\t\t\t// Not ideal, but it at least works around the most common source of uncaught exceptions for now.\n\t\t\t\tif (vnode.tag === \"input\" && vnode.attrs.type === \"file\" && \"\" + value !== \"\") { console.error(\"`value` is read-only on file inputs!\"); return }\n\t\t\t\t/* eslint-enable no-implicit-coercion */\n\t\t\t}\n\t\t\t// If you assign an input type that is not supported by IE 11 with an assignment expression, an error will occur.\n\t\t\tif (vnode.tag === \"input\" && key === \"type\") vnode.dom.setAttribute(key, value)\n\t\t\telse vnode.dom[key] = value\n\t\t} else {\n\t\t\tif (typeof value === \"boolean\") {\n\t\t\t\tif (value) vnode.dom.setAttribute(key, \"\")\n\t\t\t\telse vnode.dom.removeAttribute(key)\n\t\t\t}\n\t\t\telse vnode.dom.setAttribute(key === \"className\" ? \"class\" : key, value)\n\t\t}\n\t}\n\tfunction removeAttr(vnode, key, old, ns) {\n\t\tif (key === \"key\" || old == null || isLifecycleMethod(key)) return\n\t\tif (key[0] === \"o\" && key[1] === \"n\") updateEvent(vnode, key, undefined)\n\t\telse if (key === \"style\") updateStyle(vnode.dom, old, null)\n\t\telse if (\n\t\t\thasPropertyKey(vnode, key, ns)\n\t\t\t&& key !== \"className\"\n\t\t\t&& key !== \"title\" // creates \"null\" as title\n\t\t\t&& !(key === \"value\" && (\n\t\t\t\tvnode.tag === \"option\"\n\t\t\t\t|| vnode.tag === \"select\" && vnode.dom.selectedIndex === -1 && vnode.dom === activeElement(vnode.dom)\n\t\t\t))\n\t\t\t&& !(vnode.tag === \"input\" && key === \"type\")\n\t\t) {\n\t\t\tvnode.dom[key] = null\n\t\t} else {\n\t\t\tvar nsLastIndex = key.indexOf(\":\")\n\t\t\tif (nsLastIndex !== -1) key = key.slice(nsLastIndex + 1)\n\t\t\tif (old !== false) vnode.dom.removeAttribute(key === \"className\" ? \"class\" : key)\n\t\t}\n\t}\n\tfunction setLateSelectAttrs(vnode, attrs) {\n\t\tif (\"value\" in attrs) {\n\t\t\tif(attrs.value === null) {\n\t\t\t\tif (vnode.dom.selectedIndex !== -1) vnode.dom.value = null\n\t\t\t} else {\n\t\t\t\tvar normalized = \"\" + attrs.value // eslint-disable-line no-implicit-coercion\n\t\t\t\tif (vnode.dom.value !== normalized || vnode.dom.selectedIndex === -1) {\n\t\t\t\t\tvnode.dom.value = normalized\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (\"selectedIndex\" in attrs) setAttr(vnode, \"selectedIndex\", null, attrs.selectedIndex, undefined)\n\t}\n\tfunction updateAttrs(vnode, old, attrs, ns) {\n\t\t// Some attributes may NOT be case-sensitive (e.g. data-***),\n\t\t// so removal should be done first to prevent accidental removal for newly setting values.\n\t\tvar val\n\t\tif (old != null) {\n\t\t\tif (old === attrs && !cachedAttrsIsStaticMap.has(attrs)) {\n\t\t\t\tconsole.warn(\"Don't reuse attrs object, use new object for every redraw, this will throw in next major\")\n\t\t\t}\n\t\t\tfor (var key in old) {\n\t\t\t\tif (((val = old[key]) != null) && (attrs == null || attrs[key] == null)) {\n\t\t\t\t\tremoveAttr(vnode, key, val, ns)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (attrs != null) {\n\t\t\tfor (var key in attrs) {\n\t\t\t\tsetAttr(vnode, key, old && old[key], attrs[key], ns)\n\t\t\t}\n\t\t}\n\t}\n\tfunction isFormAttribute(vnode, attr) {\n\t\treturn attr === \"value\" || attr === \"checked\" || attr === \"selectedIndex\" || attr === \"selected\" && (vnode.dom === activeElement(vnode.dom) || vnode.tag === \"option\" && vnode.dom.parentNode === activeElement(vnode.dom))\n\t}\n\tfunction isLifecycleMethod(attr) {\n\t\treturn attr === \"oninit\" || attr === \"oncreate\" || attr === \"onupdate\" || attr === \"onremove\" || attr === \"onbeforeremove\" || attr === \"onbeforeupdate\"\n\t}\n\tfunction hasPropertyKey(vnode, key, ns) {\n\t\t// Filter out namespaced keys\n\t\treturn ns === undefined && (\n\t\t\t// If it's a custom element, just keep it.\n\t\t\tvnode.tag.indexOf(\"-\") > -1 || vnode.is ||\n\t\t\t// If it's a normal element, let's try to avoid a few browser bugs.\n\t\t\tkey !== \"href\" && key !== \"list\" && key !== \"form\" && key !== \"width\" && key !== \"height\"// && key !== \"type\"\n\t\t\t// Defer the property check until *after* we check everything.\n\t\t) && key in vnode.dom\n\t}\n\n\t//style\n\tfunction updateStyle(element, old, style) {\n\t\tif (old === style) {\n\t\t\t// Styles are equivalent, do nothing.\n\t\t} else if (style == null) {\n\t\t\t// New style is missing, just clear it.\n\t\t\telement.style = \"\"\n\t\t} else if (typeof style !== \"object\") {\n\t\t\t// New style is a string, let engine deal with patching.\n\t\t\telement.style = style\n\t\t} else if (old == null || typeof old !== \"object\") {\n\t\t\t// `old` is missing or a string, `style` is an object.\n\t\t\telement.style = \"\"\n\t\t\t// Add new style properties\n\t\t\tfor (var key in style) {\n\t\t\t\tvar value = style[key]\n\t\t\t\tif (value != null) {\n\t\t\t\t\tif (key.includes(\"-\")) element.style.setProperty(key, String(value))\n\t\t\t\t\telse element.style[key] = String(value)\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Both old & new are (different) objects.\n\t\t\t// Remove style properties that no longer exist\n\t\t\t// Style properties may have two cases(dash-case and camelCase),\n\t\t\t// so removal should be done first to prevent accidental removal for newly setting values.\n\t\t\tfor (var key in old) {\n\t\t\t\tif (old[key] != null && style[key] == null) {\n\t\t\t\t\tif (key.includes(\"-\")) element.style.removeProperty(key)\n\t\t\t\t\telse element.style[key] = \"\"\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Update style properties that have changed\n\t\t\tfor (var key in style) {\n\t\t\t\tvar value = style[key]\n\t\t\t\tif (value != null && (value = String(value)) !== String(old[key])) {\n\t\t\t\t\tif (key.includes(\"-\")) element.style.setProperty(key, value)\n\t\t\t\t\telse element.style[key] = value\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Here's an explanation of how this works:\n\t// 1. The event names are always (by design) prefixed by `on`.\n\t// 2. The EventListener interface accepts either a function or an object\n\t//    with a `handleEvent` method.\n\t// 3. The object does not inherit from `Object.prototype`, to avoid\n\t//    any potential interference with that (e.g. setters).\n\t// 4. The event name is remapped to the handler before calling it.\n\t// 5. In function-based event handlers, `ev.target === this`. We replicate\n\t//    that below.\n\t// 6. In function-based event handlers, `return false` prevents the default\n\t//    action and stops event propagation. We replicate that below.\n\tfunction EventDict() {\n\t\t// Save this, so the current redraw is correctly tracked.\n\t\tthis._ = currentRedraw\n\t}\n\tEventDict.prototype = Object.create(null)\n\tEventDict.prototype.handleEvent = function (ev) {\n\t\tvar handler = this[\"on\" + ev.type]\n\t\tvar result\n\t\tif (typeof handler === \"function\") result = handler.call(ev.currentTarget, ev)\n\t\telse if (typeof handler.handleEvent === \"function\") handler.handleEvent(ev)\n\t\tvar self = this\n\t\tif (self._ != null) {\n\t\t\tif (ev.redraw !== false) (0, self._)()\n\t\t\tif (result != null && typeof result.then === \"function\") {\n\t\t\t\tPromise.resolve(result).then(function () {\n\t\t\t\t\tif (self._ != null && ev.redraw !== false) (0, self._)()\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\tif (result === false) {\n\t\t\tev.preventDefault()\n\t\t\tev.stopPropagation()\n\t\t}\n\t}\n\n\t//event\n\tfunction updateEvent(vnode, key, value) {\n\t\tif (vnode.events != null) {\n\t\t\tvnode.events._ = currentRedraw\n\t\t\tif (vnode.events[key] === value) return\n\t\t\tif (value != null && (typeof value === \"function\" || typeof value === \"object\")) {\n\t\t\t\tif (vnode.events[key] == null) vnode.dom.addEventListener(key.slice(2), vnode.events, false)\n\t\t\t\tvnode.events[key] = value\n\t\t\t} else {\n\t\t\t\tif (vnode.events[key] != null) vnode.dom.removeEventListener(key.slice(2), vnode.events, false)\n\t\t\t\tvnode.events[key] = undefined\n\t\t\t}\n\t\t} else if (value != null && (typeof value === \"function\" || typeof value === \"object\")) {\n\t\t\tvnode.events = new EventDict()\n\t\t\tvnode.dom.addEventListener(key.slice(2), vnode.events, false)\n\t\t\tvnode.events[key] = value\n\t\t}\n\t}\n\n\t//lifecycle\n\tfunction initLifecycle(source, vnode, hooks) {\n\t\tif (typeof source.oninit === \"function\") callHook.call(source.oninit, vnode)\n\t\tif (typeof source.oncreate === \"function\") hooks.push(callHook.bind(source.oncreate, vnode))\n\t}\n\tfunction updateLifecycle(source, vnode, hooks) {\n\t\tif (typeof source.onupdate === \"function\") hooks.push(callHook.bind(source.onupdate, vnode))\n\t}\n\tfunction shouldNotUpdate(vnode, old) {\n\t\tdo {\n\t\t\tif (vnode.attrs != null && typeof vnode.attrs.onbeforeupdate === \"function\") {\n\t\t\t\tvar force = callHook.call(vnode.attrs.onbeforeupdate, vnode, old)\n\t\t\t\tif (force !== undefined && !force) break\n\t\t\t}\n\t\t\tif (typeof vnode.tag !== \"string\" && typeof vnode.state.onbeforeupdate === \"function\") {\n\t\t\t\tvar force = callHook.call(vnode.state.onbeforeupdate, vnode, old)\n\t\t\t\tif (force !== undefined && !force) break\n\t\t\t}\n\t\t\treturn false\n\t\t} while (false); // eslint-disable-line no-constant-condition\n\t\tvnode.dom = old.dom\n\t\tvnode.domSize = old.domSize\n\t\tvnode.instance = old.instance\n\t\t// One would think having the actual latest attributes would be ideal,\n\t\t// but it doesn't let us properly diff based on our current internal\n\t\t// representation. We have to save not only the old DOM info, but also\n\t\t// the attributes used to create it, as we diff *that*, not against the\n\t\t// DOM directly (with a few exceptions in `setAttr`). And, of course, we\n\t\t// need to save the children and text as they are conceptually not\n\t\t// unlike special \"attributes\" internally.\n\t\tvnode.attrs = old.attrs\n\t\tvnode.children = old.children\n\t\tvnode.text = old.text\n\t\treturn true\n\t}\n\n\tvar currentDOM\n\n\treturn function(dom, vnodes, redraw) {\n\t\tif (!dom) throw new TypeError(\"DOM element being rendered to does not exist.\")\n\t\tif (currentDOM != null && dom.contains(currentDOM)) {\n\t\t\tthrow new TypeError(\"Node is currently being rendered to and thus is locked.\")\n\t\t}\n\t\tvar prevRedraw = currentRedraw\n\t\tvar prevDOM = currentDOM\n\t\tvar hooks = []\n\t\tvar active = activeElement(dom)\n\t\tvar namespace = dom.namespaceURI\n\n\t\tcurrentDOM = dom\n\t\tcurrentRedraw = typeof redraw === \"function\" ? redraw : undefined\n\t\tcurrentRender = {}\n\t\ttry {\n\t\t\t// First time rendering into a node clears it out\n\t\t\tif (dom.vnodes == null) dom.textContent = \"\"\n\t\t\tvnodes = Vnode.normalizeChildren(Array.isArray(vnodes) ? vnodes : [vnodes])\n\t\t\tupdateNodes(dom, dom.vnodes, vnodes, hooks, null, namespace === \"http://www.w3.org/1999/xhtml\" ? undefined : namespace)\n\t\t\tdom.vnodes = vnodes\n\t\t\t// `document.activeElement` can return null: https://html.spec.whatwg.org/multipage/interaction.html#dom-document-activeelement\n\t\t\tif (active != null && activeElement(dom) !== active && typeof active.focus === \"function\") active.focus()\n\t\t\tfor (var i = 0; i < hooks.length; i++) hooks[i]()\n\t\t} finally {\n\t\t\tcurrentRedraw = prevRedraw\n\t\t\tcurrentDOM = prevDOM\n\t\t}\n\t}\n}\n", "\"use strict\"\n\nmodule.exports = require(\"./render/render\")()\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\n\nmodule.exports = function(render, schedule, console) {\n\tvar subscriptions = []\n\tvar pending = false\n\tvar offset = -1\n\n\tfunction sync() {\n\t\tfor (offset = 0; offset < subscriptions.length; offset += 2) {\n\t\t\ttry { render(subscriptions[offset], Vnode(subscriptions[offset + 1]), redraw) }\n\t\t\tcatch (e) { console.error(e) }\n\t\t}\n\t\toffset = -1\n\t}\n\n\tfunction redraw() {\n\t\tif (!pending) {\n\t\t\tpending = true\n\t\t\tschedule(function() {\n\t\t\t\tpending = false\n\t\t\t\tsync()\n\t\t\t})\n\t\t}\n\t}\n\n\tredraw.sync = sync\n\n\tfunction mount(root, component) {\n\t\tif (component != null && component.view == null && typeof component !== \"function\") {\n\t\t\tthrow new TypeError(\"m.mount expects a component, not a vnode.\")\n\t\t}\n\n\t\tvar index = subscriptions.indexOf(root)\n\t\tif (index >= 0) {\n\t\t\tsubscriptions.splice(index, 2)\n\t\t\tif (index <= offset) offset -= 2\n\t\t\trender(root, [])\n\t\t}\n\n\t\tif (component != null) {\n\t\t\tsubscriptions.push(root, component)\n\t\t\trender(root, Vnode(component), redraw)\n\t\t}\n\t}\n\n\treturn {mount: mount, redraw: redraw}\n}\n", "\"use strict\"\n\nvar render = require(\"./render\")\n\nmodule.exports = require(\"./api/mount-redraw\")(render, typeof requestAnimationFrame !== \"undefined\" ? requestAnimationFrame : null, typeof console !== \"undefined\" ? console : null)\n", "\"use strict\"\n\nmodule.exports = function(object) {\n\tif (Object.prototype.toString.call(object) !== \"[object Object]\") return \"\"\n\n\tvar args = []\n\tfor (var key in object) {\n\t\tdestructure(key, object[key])\n\t}\n\n\treturn args.join(\"&\")\n\n\tfunction destructure(key, value) {\n\t\tif (Array.isArray(value)) {\n\t\t\tfor (var i = 0; i < value.length; i++) {\n\t\t\t\tdestructure(key + \"[\" + i + \"]\", value[i])\n\t\t\t}\n\t\t}\n\t\telse if (Object.prototype.toString.call(value) === \"[object Object]\") {\n\t\t\tfor (var i in value) {\n\t\t\t\tdestructure(key + \"[\" + i + \"]\", value[i])\n\t\t\t}\n\t\t}\n\t\telse args.push(encodeURIComponent(key) + (value != null && value !== \"\" ? \"=\" + encodeURIComponent(value) : \"\"))\n\t}\n}\n", "\"use strict\"\n\nvar buildQueryString = require(\"../querystring/build\")\n\n// Returns `path` from `template` + `params`\nmodule.exports = function(template, params) {\n\tif ((/:([^\\/\\.-]+)(\\.{3})?:/).test(template)) {\n\t\tthrow new SyntaxError(\"Template parameter names must be separated by either a '/', '-', or '.'.\")\n\t}\n\tif (params == null) return template\n\tvar queryIndex = template.indexOf(\"?\")\n\tvar hashIndex = template.indexOf(\"#\")\n\tvar queryEnd = hashIndex < 0 ? template.length : hashIndex\n\tvar pathEnd = queryIndex < 0 ? queryEnd : queryIndex\n\tvar path = template.slice(0, pathEnd)\n\tvar query = {}\n\n\tObject.assign(query, params)\n\n\tvar resolved = path.replace(/:([^\\/\\.-]+)(\\.{3})?/g, function(m, key, variadic) {\n\t\tdelete query[key]\n\t\t// If no such parameter exists, don't interpolate it.\n\t\tif (params[key] == null) return m\n\t\t// Escape normal parameters, but not variadic ones.\n\t\treturn variadic ? params[key] : encodeURIComponent(String(params[key]))\n\t})\n\n\t// In case the template substitution adds new query/hash parameters.\n\tvar newQueryIndex = resolved.indexOf(\"?\")\n\tvar newHashIndex = resolved.indexOf(\"#\")\n\tvar newQueryEnd = newHashIndex < 0 ? resolved.length : newHashIndex\n\tvar newPathEnd = newQueryIndex < 0 ? newQueryEnd : newQueryIndex\n\tvar result = resolved.slice(0, newPathEnd)\n\n\tif (queryIndex >= 0) result += template.slice(queryIndex, queryEnd)\n\tif (newQueryIndex >= 0) result += (queryIndex < 0 ? \"?\" : \"&\") + resolved.slice(newQueryIndex, newQueryEnd)\n\tvar querystring = buildQueryString(query)\n\tif (querystring) result += (queryIndex < 0 && newQueryIndex < 0 ? \"?\" : \"&\") + querystring\n\tif (hashIndex >= 0) result += template.slice(hashIndex)\n\tif (newHashIndex >= 0) result += (hashIndex < 0 ? \"\" : \"&\") + resolved.slice(newHashIndex)\n\treturn result\n}\n", "\"use strict\"\n\nvar buildPathname = require(\"../pathname/build\")\nvar hasOwn = require(\"../util/hasOwn\")\n\nmodule.exports = function($window, oncompletion) {\n\tfunction PromiseProxy(executor) {\n\t\treturn new Promise(executor)\n\t}\n\n\tfunction makeRequest(url, args) {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\turl = buildPathname(url, args.params)\n\t\t\tvar method = args.method != null ? args.method.toUpperCase() : \"GET\"\n\t\t\tvar body = args.body\n\t\t\tvar assumeJSON = (args.serialize == null || args.serialize === JSON.serialize) && !(body instanceof $window.FormData || body instanceof $window.URLSearchParams)\n\t\t\tvar responseType = args.responseType || (typeof args.extract === \"function\" ? \"\" : \"json\")\n\n\t\t\tvar xhr = new $window.XMLHttpRequest(), aborted = false, isTimeout = false\n\t\t\tvar original = xhr, replacedAbort\n\t\t\tvar abort = xhr.abort\n\n\t\t\txhr.abort = function() {\n\t\t\t\taborted = true\n\t\t\t\tabort.call(this)\n\t\t\t}\n\n\t\t\txhr.open(method, url, args.async !== false, typeof args.user === \"string\" ? args.user : undefined, typeof args.password === \"string\" ? args.password : undefined)\n\n\t\t\tif (assumeJSON && body != null && !hasHeader(args, \"content-type\")) {\n\t\t\t\txhr.setRequestHeader(\"Content-Type\", \"application/json; charset=utf-8\")\n\t\t\t}\n\t\t\tif (typeof args.deserialize !== \"function\" && !hasHeader(args, \"accept\")) {\n\t\t\t\txhr.setRequestHeader(\"Accept\", \"application/json, text/*\")\n\t\t\t}\n\t\t\tif (args.withCredentials) xhr.withCredentials = args.withCredentials\n\t\t\tif (args.timeout) xhr.timeout = args.timeout\n\t\t\txhr.responseType = responseType\n\n\t\t\tfor (var key in args.headers) {\n\t\t\t\tif (hasOwn.call(args.headers, key)) {\n\t\t\t\t\txhr.setRequestHeader(key, args.headers[key])\n\t\t\t\t}\n\t\t\t}\n\n\t\t\txhr.onreadystatechange = function(ev) {\n\t\t\t\t// Don't throw errors on xhr.abort().\n\t\t\t\tif (aborted) return\n\n\t\t\t\tif (ev.target.readyState === 4) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar success = (ev.target.status >= 200 && ev.target.status < 300) || ev.target.status === 304 || (/^file:\\/\\//i).test(url)\n\t\t\t\t\t\t// When the response type isn't \"\" or \"text\",\n\t\t\t\t\t\t// `xhr.responseText` is the wrong thing to use.\n\t\t\t\t\t\t// Browsers do the right thing and throw here, and we\n\t\t\t\t\t\t// should honor that and do the right thing by\n\t\t\t\t\t\t// preferring `xhr.response` where possible/practical.\n\t\t\t\t\t\tvar response = ev.target.response, message\n\n\t\t\t\t\t\tif (responseType === \"json\") {\n\t\t\t\t\t\t\t// For IE and Edge, which don't implement\n\t\t\t\t\t\t\t// `responseType: \"json\"`.\n\t\t\t\t\t\t\tif (!ev.target.responseType && typeof args.extract !== \"function\") {\n\t\t\t\t\t\t\t\t// Handle no-content which will not parse.\n\t\t\t\t\t\t\t\ttry { response = JSON.parse(ev.target.responseText) }\n\t\t\t\t\t\t\t\tcatch (e) { response = null }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (!responseType || responseType === \"text\") {\n\t\t\t\t\t\t\t// Only use this default if it's text. If a parsed\n\t\t\t\t\t\t\t// document is needed on old IE and friends (all\n\t\t\t\t\t\t\t// unsupported), the user should use a custom\n\t\t\t\t\t\t\t// `config` instead. They're already using this at\n\t\t\t\t\t\t\t// their own risk.\n\t\t\t\t\t\t\tif (response == null) response = ev.target.responseText\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (typeof args.extract === \"function\") {\n\t\t\t\t\t\t\tresponse = args.extract(ev.target, args)\n\t\t\t\t\t\t\tsuccess = true\n\t\t\t\t\t\t} else if (typeof args.deserialize === \"function\") {\n\t\t\t\t\t\t\tresponse = args.deserialize(response)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (success) {\n\t\t\t\t\t\t\tif (typeof args.type === \"function\") {\n\t\t\t\t\t\t\t\tif (Array.isArray(response)) {\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < response.length; i++) {\n\t\t\t\t\t\t\t\t\t\tresponse[i] = new args.type(response[i])\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse response = new args.type(response)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve(response)\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tvar completeErrorResponse = function() {\n\t\t\t\t\t\t\t\ttry { message = ev.target.responseText }\n\t\t\t\t\t\t\t\tcatch (e) { message = response }\n\t\t\t\t\t\t\t\tvar error = new Error(message)\n\t\t\t\t\t\t\t\terror.code = ev.target.status\n\t\t\t\t\t\t\t\terror.response = response\n\t\t\t\t\t\t\t\treject(error)\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (xhr.status === 0) {\n\t\t\t\t\t\t\t\t// Use setTimeout to push this code block onto the event queue\n\t\t\t\t\t\t\t\t// This allows `xhr.ontimeout` to run in the case that there is a timeout\n\t\t\t\t\t\t\t\t// Without this setTimeout, `xhr.ontimeout` doesn't have a chance to reject\n\t\t\t\t\t\t\t\t// as `xhr.onreadystatechange` will run before it\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tif (isTimeout) return\n\t\t\t\t\t\t\t\t\tcompleteErrorResponse()\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t} else completeErrorResponse()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {\n\t\t\t\t\t\treject(e)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\txhr.ontimeout = function (ev) {\n\t\t\t\tisTimeout = true\n\t\t\t\tvar error = new Error(\"Request timed out\")\n\t\t\t\terror.code = ev.target.status\n\t\t\t\treject(error)\n\t\t\t}\n\n\t\t\tif (typeof args.config === \"function\") {\n\t\t\t\txhr = args.config(xhr, args, url) || xhr\n\n\t\t\t\t// Propagate the `abort` to any replacement XHR as well.\n\t\t\t\tif (xhr !== original) {\n\t\t\t\t\treplacedAbort = xhr.abort\n\t\t\t\t\txhr.abort = function() {\n\t\t\t\t\t\taborted = true\n\t\t\t\t\t\treplacedAbort.call(this)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (body == null) xhr.send()\n\t\t\telse if (typeof args.serialize === \"function\") xhr.send(args.serialize(body))\n\t\t\telse if (body instanceof $window.FormData || body instanceof $window.URLSearchParams) xhr.send(body)\n\t\t\telse xhr.send(JSON.stringify(body))\n\t\t})\n\t}\n\n\t// In case the global Promise is some userland library's where they rely on\n\t// `foo instanceof this.constructor`, `this.constructor.resolve(value)`, or\n\t// similar. Let's *not* break them.\n\tPromiseProxy.prototype = Promise.prototype\n\tPromiseProxy.__proto__ = Promise // eslint-disable-line no-proto\n\n\tfunction hasHeader(args, name) {\n\t\tfor (var key in args.headers) {\n\t\t\tif (hasOwn.call(args.headers, key) && key.toLowerCase() === name) return true\n\t\t}\n\t\treturn false\n\t}\n\n\treturn {\n\t\trequest: function(url, args) {\n\t\t\tif (typeof url !== \"string\") { args = url; url = url.url }\n\t\t\telse if (args == null) args = {}\n\t\t\tvar promise = makeRequest(url, args)\n\t\t\tif (args.background === true) return promise\n\t\t\tvar count = 0\n\t\t\tfunction complete() {\n\t\t\t\tif (--count === 0 && typeof oncompletion === \"function\") oncompletion()\n\t\t\t}\n\n\t\t\treturn wrap(promise)\n\n\t\t\tfunction wrap(promise) {\n\t\t\t\tvar then = promise.then\n\t\t\t\t// Set the constructor, so engines know to not await or resolve\n\t\t\t\t// this as a native promise. At the time of writing, this is\n\t\t\t\t// only necessary for V8, but their behavior is the correct\n\t\t\t\t// behavior per spec. See this spec issue for more details:\n\t\t\t\t// https://github.com/tc39/ecma262/issues/1577. Also, see the\n\t\t\t\t// corresponding comment in `request/tests/test-request.js` for\n\t\t\t\t// a bit more background on the issue at hand.\n\t\t\t\tpromise.constructor = PromiseProxy\n\t\t\t\tpromise.then = function() {\n\t\t\t\t\tcount++\n\t\t\t\t\tvar next = then.apply(promise, arguments)\n\t\t\t\t\tnext.then(complete, function(e) {\n\t\t\t\t\t\tcomplete()\n\t\t\t\t\t\tif (count === 0) throw e\n\t\t\t\t\t})\n\t\t\t\t\treturn wrap(next)\n\t\t\t\t}\n\t\t\t\treturn promise\n\t\t\t}\n\t\t}\n\t}\n}\n", "\"use strict\"\n\nvar mountRedraw = require(\"./mount-redraw\")\n\nmodule.exports = require(\"./request/request\")(typeof window !== \"undefined\" ? window : null, mountRedraw.redraw)\n", "\"use strict\"\n\n/*\nPercent encodings encode UTF-8 bytes, so this regexp needs to match that.\nHere's how UTF-8 encodes stuff:\n- `00-7F`: 1-byte, for U+0000-U+007F\n- `C2-DF 80-BF`: 2-byte, for U+0080-U+07FF\n- `E0-EF 80-BF 80-BF`: 3-byte, encodes U+0800-U+FFFF\n- `F0-F4 80-BF 80-BF 80-BF`: 4-byte, encodes U+10000-U+10FFFF\nIn this, there's a number of invalid byte sequences:\n- `80-BF`: Continuation byte, invalid as start\n- `C0-C1 80-BF`: Overlong encoding for U+0000-U+007F\n- `E0 80-9F 80-BF`: Overlong encoding for U+0080-U+07FF\n- `ED A0-BF 80-BF`: Encoding for UTF-16 surrogate U+D800-U+DFFF\n- `F0 80-8F 80-BF 80-BF`: Overlong encoding for U+0800-U+FFFF\n- `F4 90-BF`: RFC 3629 restricted UTF-8 to only code points UTF-16 could encode.\n- `F5-FF`: RFC 3629 restricted UTF-8 to only code points UTF-16 could encode.\nSo in reality, only the following sequences can encode are valid characters:\n- 00-7F\n- C2-DF 80-BF\n- E0    A0-BF 80-BF\n- E1-EC 80-BF 80-BF\n- ED    80-9F 80-BF\n- EE-EF 80-BF 80-BF\n- F0    90-BF 80-BF 80-BF\n- F1-F3 80-BF 80-BF 80-BF\n- F4    80-8F 80-BF 80-BF\n\nThe regexp just tries to match this as compactly as possible.\n*/\nvar validUtf8Encodings = /%(?:[0-7]|(?!c[01]|e0%[89]|ed%[ab]|f0%8|f4%[9ab])(?:c|d|(?:e|f[0-4]%[89ab])[\\da-f]%[89ab])[\\da-f]%[89ab])[\\da-f]/gi\n\nmodule.exports = function(str) {\n\treturn String(str).replace(validUtf8Encodings, decodeURIComponent)\n}\n", "\"use strict\"\n\nvar decodeURIComponentSafe = require(\"../util/decodeURIComponentSafe\")\n\nmodule.exports = function(string) {\n\tif (string === \"\" || string == null) return {}\n\tif (string.charAt(0) === \"?\") string = string.slice(1)\n\n\tvar entries = string.split(\"&\"), counters = {}, data = {}\n\tfor (var i = 0; i < entries.length; i++) {\n\t\tvar entry = entries[i].split(\"=\")\n\t\tvar key = decodeURIComponentSafe(entry[0])\n\t\tvar value = entry.length === 2 ? decodeURIComponentSafe(entry[1]) : \"\"\n\n\t\tif (value === \"true\") value = true\n\t\telse if (value === \"false\") value = false\n\n\t\tvar levels = key.split(/\\]\\[?|\\[/)\n\t\tvar cursor = data\n\t\tif (key.indexOf(\"[\") > -1) levels.pop()\n\t\tfor (var j = 0; j < levels.length; j++) {\n\t\t\tvar level = levels[j], nextLevel = levels[j + 1]\n\t\t\tvar isNumber = nextLevel == \"\" || !isNaN(parseInt(nextLevel, 10))\n\t\t\tif (level === \"\") {\n\t\t\t\tvar key = levels.slice(0, j).join()\n\t\t\t\tif (counters[key] == null) {\n\t\t\t\t\tcounters[key] = Array.isArray(cursor) ? cursor.length : 0\n\t\t\t\t}\n\t\t\t\tlevel = counters[key]++\n\t\t\t}\n\t\t\t// Disallow direct prototype pollution\n\t\t\telse if (level === \"__proto__\") break\n\t\t\tif (j === levels.length - 1) cursor[level] = value\n\t\t\telse {\n\t\t\t\t// Read own properties exclusively to disallow indirect\n\t\t\t\t// prototype pollution\n\t\t\t\tvar desc = Object.getOwnPropertyDescriptor(cursor, level)\n\t\t\t\tif (desc != null) desc = desc.value\n\t\t\t\tif (desc == null) cursor[level] = desc = isNumber ? [] : {}\n\t\t\t\tcursor = desc\n\t\t\t}\n\t\t}\n\t}\n\treturn data\n}\n", "\"use strict\"\n\nvar parseQueryString = require(\"../querystring/parse\")\n\n// Returns `{path, params}` from `url`\nmodule.exports = function(url) {\n\tvar queryIndex = url.indexOf(\"?\")\n\tvar hashIndex = url.indexOf(\"#\")\n\tvar queryEnd = hashIndex < 0 ? url.length : hashIndex\n\tvar pathEnd = queryIndex < 0 ? queryEnd : queryIndex\n\tvar path = url.slice(0, pathEnd).replace(/\\/{2,}/g, \"/\")\n\n\tif (!path) path = \"/\"\n\telse {\n\t\tif (path[0] !== \"/\") path = \"/\" + path\n\t}\n\treturn {\n\t\tpath: path,\n\t\tparams: queryIndex < 0\n\t\t\t? {}\n\t\t\t: parseQueryString(url.slice(queryIndex + 1, queryEnd)),\n\t}\n}\n", "\"use strict\"\n\nvar parsePathname = require(\"./parse\")\n\n// Compiles a template into a function that takes a resolved path (without query\n// strings) and returns an object containing the template parameters with their\n// parsed values. This expects the input of the compiled template to be the\n// output of `parsePathname`. Note that it does *not* remove query parameters\n// specified in the template.\nmodule.exports = function(template) {\n\tvar templateData = parsePathname(template)\n\tvar templateKeys = Object.keys(templateData.params)\n\tvar keys = []\n\tvar regexp = new RegExp(\"^\" + templateData.path.replace(\n\t\t// I escape literal text so people can use things like `:file.:ext` or\n\t\t// `:lang-:locale` in routes. This is all merged into one pass so I\n\t\t// don't also accidentally escape `-` and make it harder to detect it to\n\t\t// ban it from template parameters.\n\t\t/:([^\\/.-]+)(\\.{3}|\\.(?!\\.)|-)?|[\\\\^$*+.()|\\[\\]{}]/g,\n\t\tfunction(m, key, extra) {\n\t\t\tif (key == null) return \"\\\\\" + m\n\t\t\tkeys.push({k: key, r: extra === \"...\"})\n\t\t\tif (extra === \"...\") return \"(.*)\"\n\t\t\tif (extra === \".\") return \"([^/]+)\\\\.\"\n\t\t\treturn \"([^/]+)\" + (extra || \"\")\n\t\t}\n\t) + \"\\\\/?$\")\n\treturn function(data) {\n\t\t// First, check the params. Usually, there isn't any, and it's just\n\t\t// checking a static set.\n\t\tfor (var i = 0; i < templateKeys.length; i++) {\n\t\t\tif (templateData.params[templateKeys[i]] !== data.params[templateKeys[i]]) return false\n\t\t}\n\t\t// If no interpolations exist, let's skip all the ceremony\n\t\tif (!keys.length) return regexp.test(data.path)\n\t\tvar values = regexp.exec(data.path)\n\t\tif (values == null) return false\n\t\tfor (var i = 0; i < keys.length; i++) {\n\t\t\tdata.params[keys[i].k] = keys[i].r ? values[i + 1] : decodeURIComponent(values[i + 1])\n\t\t}\n\t\treturn true\n\t}\n}\n", "\"use strict\"\n\n// Note: this is mildly perf-sensitive.\n//\n// It does *not* use `delete` - dynamic `delete`s usually cause objects to bail\n// out into dictionary mode and just generally cause a bunch of optimization\n// issues within engines.\n//\n// Ideally, I would've preferred to do this, if it weren't for the optimization\n// issues:\n//\n// ```js\n// const hasOwn = require(\"./hasOwn\")\n// const magic = [\n//     \"key\", \"oninit\", \"oncreate\", \"onbeforeupdate\", \"onupdate\",\n//     \"onbeforeremove\", \"onremove\",\n// ]\n// module.exports = (attrs, extras) => {\n//     const result = Object.assign(Object.create(null), attrs)\n//     for (const key of magic) delete result[key]\n//     if (extras != null) for (const key of extras) delete result[key]\n//     return result\n// }\n// ```\n\nvar hasOwn = require(\"./hasOwn\")\nvar magic = /^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$/\n\nmodule.exports = function(attrs, extras) {\n\tvar result = {}\n\n\tif (extras != null) {\n\t\tfor (var key in attrs) {\n\t\t\tif (hasOwn.call(attrs, key) && !magic.test(key) && extras.indexOf(key) < 0) {\n\t\t\t\tresult[key] = attrs[key]\n\t\t\t}\n\t\t}\n\t} else {\n\t\tfor (var key in attrs) {\n\t\t\tif (hasOwn.call(attrs, key) && !magic.test(key)) {\n\t\t\t\tresult[key] = attrs[key]\n\t\t\t}\n\t\t}\n\t}\n\n\treturn result\n}\n", "\"use strict\"\n\nvar Vnode = require(\"../render/vnode\")\nvar hyperscript = require(\"../render/hyperscript\")\n\nvar decodeURIComponentSafe = require(\"../util/decodeURIComponentSafe\")\nvar buildPathname = require(\"../pathname/build\")\nvar parsePathname = require(\"../pathname/parse\")\nvar compileTemplate = require(\"../pathname/compileTemplate\")\nvar censor = require(\"../util/censor\")\n\nmodule.exports = function($window, mountRedraw) {\n\tvar p = Promise.resolve()\n\n\tvar scheduled = false\n\n\tvar ready = false\n\tvar hasBeenResolved = false\n\n\tvar dom, compiled, fallbackRoute\n\n\tvar currentResolver, component, attrs, currentPath, lastUpdate\n\n\tvar RouterRoot = {\n\t\tonremove: function() {\n\t\t\tready = hasBeenResolved = false\n\t\t\t$window.removeEventListener(\"popstate\", fireAsync, false)\n\t\t},\n\t\tview: function() {\n\t\t\t// The route has already been resolved.\n\t\t\t// Therefore, the following early return is not needed.\n\t\t\t// if (!hasBeenResolved) return\n\n\t\t\tvar vnode = Vnode(component, attrs.key, attrs)\n\t\t\tif (currentResolver) return currentResolver.render(vnode)\n\t\t\t// Wrap in a fragment to preserve existing key semantics\n\t\t\treturn [vnode]\n\t\t},\n\t}\n\n\tvar SKIP = route.SKIP = {}\n\n\tfunction resolveRoute() {\n\t\tscheduled = false\n\t\t// Consider the pathname holistically. The prefix might even be invalid,\n\t\t// but that's not our problem.\n\t\tvar prefix = $window.location.hash\n\t\tif (route.prefix[0] !== \"#\") {\n\t\t\tprefix = $window.location.search + prefix\n\t\t\tif (route.prefix[0] !== \"?\") {\n\t\t\t\tprefix = $window.location.pathname + prefix\n\t\t\t\tif (prefix[0] !== \"/\") prefix = \"/\" + prefix\n\t\t\t}\n\t\t}\n\t\tvar path = decodeURIComponentSafe(prefix).slice(route.prefix.length)\n\t\tvar data = parsePathname(path)\n\n\t\tObject.assign(data.params, $window.history.state)\n\n\t\tfunction reject(e) {\n\t\t\tconsole.error(e)\n\t\t\troute.set(fallbackRoute, null, {replace: true})\n\t\t}\n\n\t\tloop(0)\n\t\tfunction loop(i) {\n\t\t\tfor (; i < compiled.length; i++) {\n\t\t\t\tif (compiled[i].check(data)) {\n\t\t\t\t\tvar payload = compiled[i].component\n\t\t\t\t\tvar matchedRoute = compiled[i].route\n\t\t\t\t\tvar localComp = payload\n\t\t\t\t\tvar update = lastUpdate = function(comp) {\n\t\t\t\t\t\tif (update !== lastUpdate) return\n\t\t\t\t\t\tif (comp === SKIP) return loop(i + 1)\n\t\t\t\t\t\tcomponent = comp != null && (typeof comp.view === \"function\" || typeof comp === \"function\")? comp : \"div\"\n\t\t\t\t\t\tattrs = data.params, currentPath = path, lastUpdate = null\n\t\t\t\t\t\tcurrentResolver = payload.render ? payload : null\n\t\t\t\t\t\tif (hasBeenResolved) mountRedraw.redraw()\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\thasBeenResolved = true\n\t\t\t\t\t\t\tmountRedraw.mount(dom, RouterRoot)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// There's no understating how much I *wish* I could\n\t\t\t\t\t// use `async`/`await` here...\n\t\t\t\t\tif (payload.view || typeof payload === \"function\") {\n\t\t\t\t\t\tpayload = {}\n\t\t\t\t\t\tupdate(localComp)\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.onmatch) {\n\t\t\t\t\t\tp.then(function () {\n\t\t\t\t\t\t\treturn payload.onmatch(data.params, path, matchedRoute)\n\t\t\t\t\t\t}).then(update, path === fallbackRoute ? null : reject)\n\t\t\t\t\t}\n\t\t\t\t\telse update(/* \"div\" */)\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (path === fallbackRoute) {\n\t\t\t\tthrow new Error(\"Could not resolve default route \" + fallbackRoute + \".\")\n\t\t\t}\n\t\t\troute.set(fallbackRoute, null, {replace: true})\n\t\t}\n\t}\n\n\tfunction fireAsync() {\n\t\tif (!scheduled) {\n\t\t\tscheduled = true\n\t\t\t// TODO: just do `mountRedraw.redraw()` here and elide the timer\n\t\t\t// dependency. Note that this will muck with tests a *lot*, so it's\n\t\t\t// not as easy of a change as it sounds.\n\t\t\tsetTimeout(resolveRoute)\n\t\t}\n\t}\n\n\tfunction route(root, defaultRoute, routes) {\n\t\tif (!root) throw new TypeError(\"DOM element being rendered to does not exist.\")\n\n\t\tcompiled = Object.keys(routes).map(function(route) {\n\t\t\tif (route[0] !== \"/\") throw new SyntaxError(\"Routes must start with a '/'.\")\n\t\t\tif ((/:([^\\/\\.-]+)(\\.{3})?:/).test(route)) {\n\t\t\t\tthrow new SyntaxError(\"Route parameter names must be separated with either '/', '.', or '-'.\")\n\t\t\t}\n\t\t\treturn {\n\t\t\t\troute: route,\n\t\t\t\tcomponent: routes[route],\n\t\t\t\tcheck: compileTemplate(route),\n\t\t\t}\n\t\t})\n\t\tfallbackRoute = defaultRoute\n\t\tif (defaultRoute != null) {\n\t\t\tvar defaultData = parsePathname(defaultRoute)\n\n\t\t\tif (!compiled.some(function (i) { return i.check(defaultData) })) {\n\t\t\t\tthrow new ReferenceError(\"Default route doesn't match any known routes.\")\n\t\t\t}\n\t\t}\n\t\tdom = root\n\n\t\t$window.addEventListener(\"popstate\", fireAsync, false)\n\n\t\tready = true\n\n\t\t// The RouterRoot component is mounted when the route is first resolved.\n\t\tresolveRoute()\n\t}\n\troute.set = function(path, data, options) {\n\t\tif (lastUpdate != null) {\n\t\t\toptions = options || {}\n\t\t\toptions.replace = true\n\t\t}\n\t\tlastUpdate = null\n\n\t\tpath = buildPathname(path, data)\n\t\tif (ready) {\n\t\t\tfireAsync()\n\t\t\tvar state = options ? options.state : null\n\t\t\tvar title = options ? options.title : null\n\t\t\tif (options && options.replace) $window.history.replaceState(state, title, route.prefix + path)\n\t\t\telse $window.history.pushState(state, title, route.prefix + path)\n\t\t}\n\t\telse {\n\t\t\t$window.location.href = route.prefix + path\n\t\t}\n\t}\n\troute.get = function() {return currentPath}\n\troute.prefix = \"#!\"\n\troute.Link = {\n\t\tview: function(vnode) {\n\t\t\t// Omit the used parameters from the rendered element - they are\n\t\t\t// internal. Also, censor the various lifecycle methods.\n\t\t\t//\n\t\t\t// We don't strip the other parameters because for convenience we\n\t\t\t// let them be specified in the selector as well.\n\t\t\tvar child = hyperscript(\n\t\t\t\tvnode.attrs.selector || \"a\",\n\t\t\t\tcensor(vnode.attrs, [\"options\", \"params\", \"selector\", \"onclick\"]),\n\t\t\t\tvnode.children\n\t\t\t)\n\t\t\tvar options, onclick, href\n\n\t\t\t// Let's provide a *right* way to disable a route link, rather than\n\t\t\t// letting people screw up accessibility on accident.\n\t\t\t//\n\t\t\t// The attribute is coerced so users don't get surprised over\n\t\t\t// `disabled: 0` resulting in a button that's somehow routable\n\t\t\t// despite being visibly disabled.\n\t\t\tif (child.attrs.disabled = Boolean(child.attrs.disabled)) {\n\t\t\t\tchild.attrs.href = null\n\t\t\t\tchild.attrs[\"aria-disabled\"] = \"true\"\n\t\t\t\t// If you *really* do want add `onclick` on a disabled link, use\n\t\t\t\t// an `oncreate` hook to add it.\n\t\t\t} else {\n\t\t\t\toptions = vnode.attrs.options\n\t\t\t\tonclick = vnode.attrs.onclick\n\t\t\t\t// Easier to build it now to keep it isomorphic.\n\t\t\t\thref = buildPathname(child.attrs.href, vnode.attrs.params)\n\t\t\t\tchild.attrs.href = route.prefix + href\n\t\t\t\tchild.attrs.onclick = function(e) {\n\t\t\t\t\tvar result\n\t\t\t\t\tif (typeof onclick === \"function\") {\n\t\t\t\t\t\tresult = onclick.call(e.currentTarget, e)\n\t\t\t\t\t} else if (onclick == null || typeof onclick !== \"object\") {\n\t\t\t\t\t\t// do nothing\n\t\t\t\t\t} else if (typeof onclick.handleEvent === \"function\") {\n\t\t\t\t\t\tonclick.handleEvent(e)\n\t\t\t\t\t}\n\n\t\t\t\t\t// Adapted from React Router's implementation:\n\t\t\t\t\t// https://github.com/ReactTraining/react-router/blob/520a0acd48ae1b066eb0b07d6d4d1790a1d02482/packages/react-router-dom/modules/Link.js\n\t\t\t\t\t//\n\t\t\t\t\t// Try to be flexible and intuitive in how we handle links.\n\t\t\t\t\t// Fun fact: links aren't as obvious to get right as you\n\t\t\t\t\t// would expect. There's a lot more valid ways to click a\n\t\t\t\t\t// link than this, and one might want to not simply click a\n\t\t\t\t\t// link, but right click or command-click it to copy the\n\t\t\t\t\t// link target, etc. Nope, this isn't just for blind people.\n\t\t\t\t\tif (\n\t\t\t\t\t\t// Skip if `onclick` prevented default\n\t\t\t\t\t\tresult !== false && !e.defaultPrevented &&\n\t\t\t\t\t\t// Ignore everything but left clicks\n\t\t\t\t\t\t(e.button === 0 || e.which === 0 || e.which === 1) &&\n\t\t\t\t\t\t// Let the browser handle `target=_blank`, etc.\n\t\t\t\t\t\t(!e.currentTarget.target || e.currentTarget.target === \"_self\") &&\n\t\t\t\t\t\t// No modifier keys\n\t\t\t\t\t\t!e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey\n\t\t\t\t\t) {\n\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\te.redraw = false\n\t\t\t\t\t\troute.set(href, null, options)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn child\n\t\t},\n\t}\n\troute.param = function(key) {\n\t\treturn attrs && key != null ? attrs[key] : attrs\n\t}\n\n\treturn route\n}\n", "\"use strict\"\n\nvar mountRedraw = require(\"./mount-redraw\")\n\nmodule.exports = require(\"./api/router\")(typeof window !== \"undefined\" ? window : null, mountRedraw)\n", "\"use strict\"\n\nvar hyperscript = require(\"./hyperscript\")\nvar mountRedraw = require(\"./mount-redraw\")\nvar request = require(\"./request\")\nvar router = require(\"./route\")\n\nvar m = function m() { return hyperscript.apply(this, arguments) }\nm.m = hyperscript\nm.trust = hyperscript.trust\nm.fragment = hyperscript.fragment\nm.Fragment = \"[\"\nm.mount = mountRedraw.mount\nm.route = router\nm.render = require(\"./render\")\nm.redraw = mountRedraw.redraw\nm.request = request.request\nm.parseQueryString = require(\"./querystring/parse\")\nm.buildQueryString = require(\"./querystring/build\")\nm.parsePathname = require(\"./pathname/parse\")\nm.buildPathname = require(\"./pathname/build\")\nm.vnode = require(\"./render/vnode\")\nm.censor = require(\"./util/censor\")\nm.domFor = require(\"./render/domFor\")\n\nmodule.exports = m\n", "/**\n * Utilities for hex, bytes, CSPRNG.\n * @module\n */\n/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */\n\n/** Checks if something is Uint8Array. Be careful: nodejs Buffer will return true. */\nexport function isBytes(a: unknown): a is Uint8Array {\n  return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n\n/** Asserts something is boolean. */\nexport function abool(b: boolean): void {\n  if (typeof b !== 'boolean') throw new Error(`boolean expected, not ${b}`);\n}\n\n/** Asserts something is positive integer. */\nexport function anumber(n: number): void {\n  if (!Number.isSafeInteger(n) || n < 0) throw new Error('positive integer expected, got ' + n);\n}\n\n/** Asserts something is Uint8Array. */\nexport function abytes(value: Uint8Array, length?: number, title: string = ''): Uint8Array {\n  const bytes = isBytes(value);\n  const len = value?.length;\n  const needsLen = length !== undefined;\n  if (!bytes || (needsLen && len !== length)) {\n    const prefix = title && `\"${title}\" `;\n    const ofLen = needsLen ? ` of length ${length}` : '';\n    const got = bytes ? `length=${len}` : `type=${typeof value}`;\n    throw new Error(prefix + 'expected Uint8Array' + ofLen + ', got ' + got);\n  }\n  return value;\n}\n\n/** Asserts a hash instance has not been destroyed / finished */\nexport function aexists(instance: any, checkFinished = true): void {\n  if (instance.destroyed) throw new Error('Hash instance has been destroyed');\n  if (checkFinished && instance.finished) throw new Error('Hash#digest() has already been called');\n}\n\n/** Asserts output is properly-sized byte array */\nexport function aoutput(out: any, instance: any): void {\n  abytes(out, undefined, 'output');\n  const min = instance.outputLen;\n  if (out.length < min) {\n    throw new Error('digestInto() expects output buffer of length at least ' + min);\n  }\n}\n\nexport type IHash = {\n  (data: string | Uint8Array): Uint8Array;\n  blockLen: number;\n  outputLen: number;\n  create: any;\n};\n\n/** Generic type encompassing 8/16/32-byte arrays - but not 64-byte. */\n// prettier-ignore\nexport type TypedArray = Int8Array | Uint8ClampedArray | Uint8Array |\n  Uint16Array | Int16Array | Uint32Array | Int32Array;\n\n/** Cast u8 / u16 / u32 to u8. */\nexport function u8(arr: TypedArray): Uint8Array {\n  return new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n\n/** Cast u8 / u16 / u32 to u32. */\nexport function u32(arr: TypedArray): Uint32Array {\n  return new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n}\n\n/** Zeroize a byte array. Warning: JS provides no guarantees. */\nexport function clean(...arrays: TypedArray[]): void {\n  for (let i = 0; i < arrays.length; i++) {\n    arrays[i].fill(0);\n  }\n}\n\n/** Create DataView of an array for easy byte-level manipulation. */\nexport function createView(arr: TypedArray): DataView {\n  return new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n\n/** Is current platform little-endian? Most are. Big-Endian platform: IBM */\nexport const isLE: boolean = /* @__PURE__ */ (() =>\n  new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44)();\n\n// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex\nconst hasHexBuiltin: boolean = /* @__PURE__ */ (() =>\n  // @ts-ignore\n  typeof Uint8Array.from([]).toHex === 'function' && typeof Uint8Array.fromHex === 'function')();\n\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) =>\n  i.toString(16).padStart(2, '0')\n);\n\n/**\n * Convert byte array to hex string. Uses built-in function, when available.\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes: Uint8Array): string {\n  abytes(bytes);\n  // @ts-ignore\n  if (hasHexBuiltin) return bytes.toHex();\n  // pre-caching improves the speed 6x\n  let hex = '';\n  for (let i = 0; i < bytes.length; i++) {\n    hex += hexes[bytes[i]];\n  }\n  return hex;\n}\n\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 } as const;\nfunction asciiToBase16(ch: number): number | undefined {\n  if (ch >= asciis._0 && ch <= asciis._9) return ch - asciis._0; // '2' => 50-48\n  if (ch >= asciis.A && ch <= asciis.F) return ch - (asciis.A - 10); // 'B' => 66-(65-10)\n  if (ch >= asciis.a && ch <= asciis.f) return ch - (asciis.a - 10); // 'b' => 98-(97-10)\n  return;\n}\n\n/**\n * Convert hex string to byte array. Uses built-in function, when available.\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex: string): Uint8Array {\n  if (typeof hex !== 'string') throw new Error('hex string expected, got ' + typeof hex);\n  // @ts-ignore\n  if (hasHexBuiltin) return Uint8Array.fromHex(hex);\n  const hl = hex.length;\n  const al = hl / 2;\n  if (hl % 2) throw new Error('hex string expected, got unpadded hex of length ' + hl);\n  const array = new Uint8Array(al);\n  for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n    const n1 = asciiToBase16(hex.charCodeAt(hi));\n    const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n    if (n1 === undefined || n2 === undefined) {\n      const char = hex[hi] + hex[hi + 1];\n      throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n    }\n    array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163\n  }\n  return array;\n}\n\n// Used in micro\nexport function hexToNumber(hex: string): bigint {\n  if (typeof hex !== 'string') throw new Error('hex string expected, got ' + typeof hex);\n  return BigInt(hex === '' ? '0' : '0x' + hex); // Big Endian\n}\n\n// Used in ff1\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes: Uint8Array): bigint {\n  return hexToNumber(bytesToHex(bytes));\n}\n\n// Used in micro, ff1\nexport function numberToBytesBE(n: number | bigint, len: number): Uint8Array {\n  return hexToBytes(n.toString(16).padStart(len * 2, '0'));\n}\n\n// Global symbols, but ts doesn't see them: https://github.com/microsoft/TypeScript/issues/31535\ndeclare const TextEncoder: any;\ndeclare const TextDecoder: any;\n\n/**\n * Converts string to bytes using UTF8 encoding.\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str: string): Uint8Array {\n  if (typeof str !== 'string') throw new Error('string expected');\n  return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n\n/**\n * Converts bytes to string using UTF8 encoding.\n * @example bytesToUtf8(new Uint8Array([97, 98, 99])) // 'abc'\n */\nexport function bytesToUtf8(bytes: Uint8Array): string {\n  return new TextDecoder().decode(bytes);\n}\n\n/**\n * Checks if two U8A use same underlying buffer and overlaps.\n * This is invalid and can corrupt data.\n */\nexport function overlapBytes(a: Uint8Array, b: Uint8Array): boolean {\n  return (\n    a.buffer === b.buffer && // best we can do, may fail with an obscure Proxy\n    a.byteOffset < b.byteOffset + b.byteLength && // a starts before b end\n    b.byteOffset < a.byteOffset + a.byteLength // b starts before a end\n  );\n}\n\n/**\n * If input and output overlap and input starts before output, we will overwrite end of input before\n * we start processing it, so this is not supported for most ciphers (except chacha/salse, which designed with this)\n */\nexport function complexOverlapBytes(input: Uint8Array, output: Uint8Array): void {\n  // This is very cursed. It works somehow, but I'm completely unsure,\n  // reasoning about overlapping aligned windows is very hard.\n  if (overlapBytes(input, output) && input.byteOffset < output.byteOffset)\n    throw new Error('complex overlap of input and output is not supported');\n}\n\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays: Uint8Array[]): Uint8Array {\n  let sum = 0;\n  for (let i = 0; i < arrays.length; i++) {\n    const a = arrays[i];\n    abytes(a);\n    sum += a.length;\n  }\n  const res = new Uint8Array(sum);\n  for (let i = 0, pad = 0; i < arrays.length; i++) {\n    const a = arrays[i];\n    res.set(a, pad);\n    pad += a.length;\n  }\n  return res;\n}\n\n// Used in ARX only\ntype EmptyObj = {};\nexport function checkOpts<T1 extends EmptyObj, T2 extends EmptyObj>(\n  defaults: T1,\n  opts: T2\n): T1 & T2 {\n  if (opts == null || typeof opts !== 'object') throw new Error('options must be defined');\n  const merged = Object.assign(defaults, opts);\n  return merged as T1 & T2;\n}\n\n/** Compares 2 uint8array-s in kinda constant time. */\nexport function equalBytes(a: Uint8Array, b: Uint8Array): boolean {\n  if (a.length !== b.length) return false;\n  let diff = 0;\n  for (let i = 0; i < a.length; i++) diff |= a[i] ^ b[i];\n  return diff === 0;\n}\n\n// TODO: remove\nexport interface IHash2 {\n  blockLen: number; // Bytes per block\n  outputLen: number; // Bytes in output\n  update(buf: string | Uint8Array): this;\n  // Writes digest into buf\n  digestInto(buf: Uint8Array): void;\n  digest(): Uint8Array;\n  /**\n   * Resets internal state. Makes Hash instance unusable.\n   * Reset is impossible for keyed hashes if key is consumed into state. If digest is not consumed\n   * by user, they will need to manually call `destroy()` when zeroing is necessary.\n   */\n  destroy(): void;\n}\n\n// This will allow to re-use with composable things like packed & base encoders\n// Also, we probably can make tags composable\n\n/** Sync cipher: takes byte array and returns byte array. */\nexport type Cipher = {\n  encrypt(plaintext: Uint8Array): Uint8Array;\n  decrypt(ciphertext: Uint8Array): Uint8Array;\n};\n\n/** Async cipher e.g. from built-in WebCrypto. */\nexport type AsyncCipher = {\n  encrypt(plaintext: Uint8Array): Promise<Uint8Array>;\n  decrypt(ciphertext: Uint8Array): Promise<Uint8Array>;\n};\n\n/** Cipher with `output` argument which can optimize by doing 1 less allocation. */\nexport type CipherWithOutput = Cipher & {\n  encrypt(plaintext: Uint8Array, output?: Uint8Array): Uint8Array;\n  decrypt(ciphertext: Uint8Array, output?: Uint8Array): Uint8Array;\n};\n\n/**\n * Params are outside of return type, so it is accessible before calling constructor.\n * If function support multiple nonceLength's, we return the best one.\n */\nexport type CipherParams = {\n  blockSize: number;\n  nonceLength?: number;\n  tagLength?: number;\n  varSizeNonce?: boolean;\n};\n/** ARX cipher, like salsa or chacha. */\nexport type ARXCipher = ((\n  key: Uint8Array,\n  nonce: Uint8Array,\n  AAD?: Uint8Array\n) => CipherWithOutput) & {\n  blockSize: number;\n  nonceLength: number;\n  tagLength: number;\n};\nexport type CipherCons<T extends any[]> = (key: Uint8Array, ...args: T) => Cipher;\n/**\n * Wraps a cipher: validates args, ensures encrypt() can only be called once.\n * @__NO_SIDE_EFFECTS__\n */\nexport const wrapCipher = <C extends CipherCons<any>, P extends CipherParams>(\n  params: P,\n  constructor: C\n): C & P => {\n  function wrappedCipher(key: Uint8Array, ...args: any[]): CipherWithOutput {\n    // Validate key\n    abytes(key, undefined, 'key');\n\n    // Big-Endian hardware is rare. Just in case someone still decides to run ciphers:\n    if (!isLE) throw new Error('Non little-endian hardware is not yet supported');\n\n    // Validate nonce if nonceLength is present\n    if (params.nonceLength !== undefined) {\n      const nonce = args[0];\n      abytes(nonce, params.varSizeNonce ? undefined : params.nonceLength, 'nonce');\n    }\n\n    // Validate AAD if tagLength present\n    const tagl = params.tagLength;\n    if (tagl && args[1] !== undefined) abytes(args[1], undefined, 'AAD');\n\n    const cipher = constructor(key, ...args);\n    const checkOutput = (fnLength: number, output?: Uint8Array) => {\n      if (output !== undefined) {\n        if (fnLength !== 2) throw new Error('cipher output not supported');\n        abytes(output, undefined, 'output');\n      }\n    };\n    // Create wrapped cipher with validation and single-use encryption\n    let called = false;\n    const wrCipher = {\n      encrypt(data: Uint8Array, output?: Uint8Array) {\n        if (called) throw new Error('cannot encrypt() twice with same key + nonce');\n        called = true;\n        abytes(data);\n        checkOutput(cipher.encrypt.length, output);\n        return (cipher as CipherWithOutput).encrypt(data, output);\n      },\n      decrypt(data: Uint8Array, output?: Uint8Array) {\n        abytes(data);\n        if (tagl && data.length < tagl)\n          throw new Error('\"ciphertext\" expected length bigger than tagLength=' + tagl);\n        checkOutput(cipher.decrypt.length, output);\n        return (cipher as CipherWithOutput).decrypt(data, output);\n      },\n    };\n\n    return wrCipher;\n  }\n\n  Object.assign(wrappedCipher, params);\n  return wrappedCipher as C & P;\n};\n\n/** Represents salsa / chacha stream. */\nexport type XorStream = (\n  key: Uint8Array,\n  nonce: Uint8Array,\n  data: Uint8Array,\n  output?: Uint8Array,\n  counter?: number\n) => Uint8Array;\n\n/**\n * By default, returns u8a of length.\n * When out is available, it checks it for validity and uses it.\n */\nexport function getOutput(\n  expectedLength: number,\n  out?: Uint8Array,\n  onlyAligned = true\n): Uint8Array {\n  if (out === undefined) return new Uint8Array(expectedLength);\n  if (out.length !== expectedLength)\n    throw new Error(\n      '\"output\" expected Uint8Array of length ' + expectedLength + ', got: ' + out.length\n    );\n  if (onlyAligned && !isAligned32(out)) throw new Error('invalid output, must be aligned');\n  return out;\n}\n\nexport function u64Lengths(dataLength: number, aadLength: number, isLE: boolean): Uint8Array {\n  abool(isLE);\n  const num = new Uint8Array(16);\n  const view = createView(num);\n  view.setBigUint64(0, BigInt(aadLength), isLE);\n  view.setBigUint64(8, BigInt(dataLength), isLE);\n  return num;\n}\n\n// Is byte array aligned to 4 byte offset (u32)?\nexport function isAligned32(bytes: Uint8Array): boolean {\n  return bytes.byteOffset % 4 === 0;\n}\n\n// copy bytes to new u8a (aligned). Because Buffer.slice is broken.\nexport function copyBytes(bytes: Uint8Array): Uint8Array {\n  return Uint8Array.from(bytes);\n}\n\n/** Cryptographically secure PRNG. Uses internal OS-level `crypto.getRandomValues`. */\nexport function randomBytes(bytesLength = 32): Uint8Array {\n  const cr = typeof globalThis === 'object' ? (globalThis as any).crypto : null;\n  if (typeof cr?.getRandomValues !== 'function')\n    throw new Error('crypto.getRandomValues must be defined');\n  return cr.getRandomValues(new Uint8Array(bytesLength));\n}\n\n/**\n * The pseudorandom number generator doesn't wipe current state:\n * instead, it generates new one based on previous state + entropy.\n * Not reseed/rekey, since AES CTR DRBG does rekey on each randomBytes,\n * which is in fact `reseed`, since it changes counter too.\n */\nexport interface PRG {\n  addEntropy(seed: Uint8Array): void;\n  randomBytes(length: number): Uint8Array;\n  clean(): void;\n}\n\ntype RemoveNonceInner<T extends any[], Ret> = ((...args: T) => Ret) extends (\n  arg0: any,\n  arg1: any,\n  ...rest: infer R\n) => any\n  ? (key: Uint8Array, ...args: R) => Ret\n  : never;\n\nexport type RemoveNonce<T extends (...args: any) => any> = RemoveNonceInner<\n  Parameters<T>,\n  ReturnType<T>\n>;\nexport type CipherWithNonce = ((\n  key: Uint8Array,\n  nonce: Uint8Array,\n  ...args: any[]\n) => Cipher | AsyncCipher) & {\n  nonceLength: number;\n};\n\n/**\n * Uses CSPRG for nonce, nonce injected in ciphertext.\n * For `encrypt`, a `nonceBytes`-length buffer is fetched from CSPRNG and\n * prepended to encrypted ciphertext. For `decrypt`, first `nonceBytes` of ciphertext\n * are treated as nonce.\n *\n * NOTE: Under the same key, using random nonces (e.g. `managedNonce`) with AES-GCM and ChaCha\n * should be limited to `2**23` (8M) messages to get a collision chance of `2**-50`. Stretching to  * `2**32` (4B) messages, chance would become `2**-33` - still negligible, but creeping up.\n * @example\n * const gcm = managedNonce(aes.gcm);\n * const ciphr = gcm(key).encrypt(data);\n * const plain = gcm(key).decrypt(ciph);\n */\nexport function managedNonce<T extends CipherWithNonce>(\n  fn: T,\n  randomBytes_: typeof randomBytes = randomBytes\n): RemoveNonce<T> {\n  const { nonceLength } = fn;\n  anumber(nonceLength);\n  const addNonce = (nonce: Uint8Array, ciphertext: Uint8Array) => {\n    const out = concatBytes(nonce, ciphertext);\n    ciphertext.fill(0);\n    return out;\n  };\n  // NOTE: we cannot support DST here, it would be mistake:\n  // - we don't know how much dst length cipher requires\n  // - nonce may unalign dst and break everything\n  // - we create new u8a anyway (concatBytes)\n  // - previously we passed all args to cipher, but that was mistake!\n  return ((key: Uint8Array, ...args: any[]): any => ({\n    encrypt(plaintext: Uint8Array) {\n      abytes(plaintext);\n      const nonce = randomBytes_(nonceLength);\n      const encrypted = fn(key, nonce, ...args).encrypt(plaintext);\n      // @ts-ignore\n      if (encrypted instanceof Promise) return encrypted.then((ct) => addNonce(nonce, ct));\n      return addNonce(nonce, encrypted);\n    },\n    decrypt(ciphertext: Uint8Array) {\n      abytes(ciphertext);\n      const nonce = ciphertext.subarray(0, nonceLength);\n      const decrypted = ciphertext.subarray(nonceLength);\n      return fn(key, nonce, ...args).decrypt(decrypted);\n    },\n  })) as RemoveNonce<T>;\n}\n", "/**\n * Basic utils for ARX (add-rotate-xor) salsa and chacha ciphers.\n\nRFC8439 requires multi-step cipher stream, where\nauthKey starts with counter: 0, actual msg with counter: 1.\n\nFor this, we need a way to re-use nonce / counter:\n\n    const counter = new Uint8Array(4);\n    chacha(..., counter, ...); // counter is now 1\n    chacha(..., counter, ...); // counter is now 2\n\nThis is complicated:\n\n- 32-bit counters are enough, no need for 64-bit: max ArrayBuffer size in JS is 4GB\n- Original papers don't allow mutating counters\n- Counter overflow is undefined [^1]\n- Idea A: allow providing (nonce | counter) instead of just nonce, re-use it\n- Caveat: Cannot be re-used through all cases:\n- * chacha has (counter | nonce)\n- * xchacha has (nonce16 | counter | nonce16)\n- Idea B: separate nonce / counter and provide separate API for counter re-use\n- Caveat: there are different counter sizes depending on an algorithm.\n- salsa & chacha also differ in structures of key & sigma:\n  salsa20:      s[0] | k(4) | s[1] | nonce(2) | cnt(2) | s[2] | k(4) | s[3]\n  chacha:       s(4) | k(8) | cnt(1) | nonce(3)\n  chacha20orig: s(4) | k(8) | cnt(2) | nonce(2)\n- Idea C: helper method such as `setSalsaState(key, nonce, sigma, data)`\n- Caveat: we can't re-use counter array\n\nxchacha [^2] uses the subkey and remaining 8 byte nonce with ChaCha20 as normal\n(prefixed by 4 NUL bytes, since [RFC8439] specifies a 12-byte nonce).\n\n[^1]: https://mailarchive.ietf.org/arch/msg/cfrg/gsOnTJzcbgG6OqD8Sc0GO5aR_tU/\n[^2]: https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha#appendix-A.2\n\n * @module\n */\nimport {\n  type PRG,\n  type XorStream,\n  abool,\n  abytes,\n  anumber,\n  checkOpts,\n  clean,\n  copyBytes,\n  randomBytes,\n  u32,\n} from './utils.ts';\n\n// Replaces `TextEncoder`, which is not available in all environments\nconst encodeStr = (str: string) => Uint8Array.from(str.split(''), (c) => c.charCodeAt(0));\nconst sigma16 = encodeStr('expand 16-byte k');\nconst sigma32 = encodeStr('expand 32-byte k');\nconst sigma16_32 = u32(sigma16);\nconst sigma32_32 = u32(sigma32);\n\n/** Rotate left. */\nexport function rotl(a: number, b: number): number {\n  return (a << b) | (a >>> (32 - b));\n}\n\n/** Ciphers must use u32 for efficiency. */\nexport type CipherCoreFn = (\n  sigma: Uint32Array,\n  key: Uint32Array,\n  nonce: Uint32Array,\n  output: Uint32Array,\n  counter: number,\n  rounds?: number\n) => void;\n\n/** Method which extends key + short nonce into larger nonce / diff key. */\nexport type ExtendNonceFn = (\n  sigma: Uint32Array,\n  key: Uint32Array,\n  input: Uint32Array,\n  output: Uint32Array\n) => void;\n\n/** ARX cipher options.\n * * `allowShortKeys` for 16-byte keys\n * * `counterLength` in bytes\n * * `counterRight`: right: `nonce|counter`; left: `counter|nonce`\n * */\nexport type CipherOpts = {\n  allowShortKeys?: boolean; // Original salsa / chacha allow 16-byte keys\n  extendNonceFn?: ExtendNonceFn;\n  counterLength?: number;\n  counterRight?: boolean;\n  rounds?: number;\n};\n\n// Is byte array aligned to 4 byte offset (u32)?\nfunction isAligned32(b: Uint8Array) {\n  return b.byteOffset % 4 === 0;\n}\n\n// Salsa and Chacha block length is always 512-bit\nconst BLOCK_LEN = 64;\nconst BLOCK_LEN32 = 16;\n\n// new Uint32Array([2**32])   // => Uint32Array(1) [ 0 ]\n// new Uint32Array([2**32-1]) // => Uint32Array(1) [ 4294967295 ]\nconst MAX_COUNTER = 2 ** 32 - 1;\n\nconst U32_EMPTY = Uint32Array.of();\nfunction runCipher(\n  core: CipherCoreFn,\n  sigma: Uint32Array,\n  key: Uint32Array,\n  nonce: Uint32Array,\n  data: Uint8Array,\n  output: Uint8Array,\n  counter: number,\n  rounds: number\n): void {\n  const len = data.length;\n  const block = new Uint8Array(BLOCK_LEN);\n  const b32 = u32(block);\n  // Make sure that buffers aligned to 4 bytes\n  const isAligned = isAligned32(data) && isAligned32(output);\n  const d32 = isAligned ? u32(data) : U32_EMPTY;\n  const o32 = isAligned ? u32(output) : U32_EMPTY;\n  for (let pos = 0; pos < len; counter++) {\n    core(sigma, key, nonce, b32, counter, rounds);\n    if (counter >= MAX_COUNTER) throw new Error('arx: counter overflow');\n    const take = Math.min(BLOCK_LEN, len - pos);\n    // aligned to 4 bytes\n    if (isAligned && take === BLOCK_LEN) {\n      const pos32 = pos / 4;\n      if (pos % 4 !== 0) throw new Error('arx: invalid block position');\n      for (let j = 0, posj: number; j < BLOCK_LEN32; j++) {\n        posj = pos32 + j;\n        o32[posj] = d32[posj] ^ b32[j];\n      }\n      pos += BLOCK_LEN;\n      continue;\n    }\n    for (let j = 0, posj; j < take; j++) {\n      posj = pos + j;\n      output[posj] = data[posj] ^ block[j];\n    }\n    pos += take;\n  }\n}\n\n/** Creates ARX-like (ChaCha, Salsa) cipher stream from core function. */\nexport function createCipher(core: CipherCoreFn, opts: CipherOpts): XorStream {\n  const { allowShortKeys, extendNonceFn, counterLength, counterRight, rounds } = checkOpts(\n    { allowShortKeys: false, counterLength: 8, counterRight: false, rounds: 20 },\n    opts\n  );\n  if (typeof core !== 'function') throw new Error('core must be a function');\n  anumber(counterLength);\n  anumber(rounds);\n  abool(counterRight);\n  abool(allowShortKeys);\n  return (\n    key: Uint8Array,\n    nonce: Uint8Array,\n    data: Uint8Array,\n    output?: Uint8Array,\n    counter = 0\n  ): Uint8Array => {\n    abytes(key, undefined, 'key');\n    abytes(nonce, undefined, 'nonce');\n    abytes(data, undefined, 'data');\n    const len = data.length;\n    if (output === undefined) output = new Uint8Array(len);\n    abytes(output, undefined, 'output');\n    anumber(counter);\n    if (counter < 0 || counter >= MAX_COUNTER) throw new Error('arx: counter overflow');\n    if (output.length < len)\n      throw new Error(`arx: output (${output.length}) is shorter than data (${len})`);\n    const toClean = [];\n\n    // Key & sigma\n    // key=16 -> sigma16, k=key|key\n    // key=32 -> sigma32, k=key\n    let l = key.length;\n    let k: Uint8Array;\n    let sigma: Uint32Array;\n    if (l === 32) {\n      toClean.push((k = copyBytes(key)));\n      sigma = sigma32_32;\n    } else if (l === 16 && allowShortKeys) {\n      k = new Uint8Array(32);\n      k.set(key);\n      k.set(key, 16);\n      sigma = sigma16_32;\n      toClean.push(k);\n    } else {\n      abytes(key, 32, 'arx key');\n      throw new Error('invalid key size');\n      // throw new Error(`\"arx key\" expected Uint8Array of length 32, got length=${l}`);\n    }\n\n    // Nonce\n    // salsa20:      8   (8-byte counter)\n    // chacha20orig: 8   (8-byte counter)\n    // chacha20:     12  (4-byte counter)\n    // xsalsa20:     24  (16 -> hsalsa,  8 -> old nonce)\n    // xchacha20:    24  (16 -> hchacha, 8 -> old nonce)\n    // Align nonce to 4 bytes\n    if (!isAligned32(nonce)) toClean.push((nonce = copyBytes(nonce)));\n\n    const k32 = u32(k);\n    // hsalsa & hchacha: handle extended nonce\n    if (extendNonceFn) {\n      if (nonce.length !== 24) throw new Error(`arx: extended nonce must be 24 bytes`);\n      extendNonceFn(sigma, k32, u32(nonce.subarray(0, 16)), k32);\n      nonce = nonce.subarray(16);\n    }\n\n    // Handle nonce counter\n    const nonceNcLen = 16 - counterLength;\n    if (nonceNcLen !== nonce.length)\n      throw new Error(`arx: nonce must be ${nonceNcLen} or 16 bytes`);\n\n    // Pad counter when nonce is 64 bit\n    if (nonceNcLen !== 12) {\n      const nc = new Uint8Array(12);\n      nc.set(nonce, counterRight ? 0 : 12 - nonce.length);\n      nonce = nc;\n      toClean.push(nonce);\n    }\n    const n32 = u32(nonce);\n    runCipher(core, sigma, k32, n32, data, output, counter, rounds);\n    clean(...toClean);\n    return output;\n  };\n}\n\n/** Internal class which wraps chacha20 or chacha8 to create CSPRNG. */\nexport class _XorStreamPRG implements PRG {\n  readonly blockLen: number;\n  readonly keyLen: number;\n  readonly nonceLen: number;\n  private state: Uint8Array;\n  private buf: Uint8Array;\n  private key: Uint8Array;\n  private nonce: Uint8Array;\n  private pos: number;\n  private ctr: number;\n  private cipher: XorStream;\n  constructor(\n    cipher: XorStream,\n    blockLen: number,\n    keyLen: number,\n    nonceLen: number,\n    seed: Uint8Array\n  ) {\n    this.cipher = cipher;\n    this.blockLen = blockLen;\n    this.keyLen = keyLen;\n    this.nonceLen = nonceLen;\n    this.state = new Uint8Array(this.keyLen + this.nonceLen);\n    this.reseed(seed);\n    this.ctr = 0;\n    this.pos = this.blockLen;\n    this.buf = new Uint8Array(this.blockLen);\n    this.key = this.state.subarray(0, this.keyLen);\n    this.nonce = this.state.subarray(this.keyLen);\n  }\n  private reseed(seed: Uint8Array) {\n    abytes(seed);\n    if (!seed || seed.length === 0) throw new Error('entropy required');\n    for (let i = 0; i < seed.length; i++) this.state[i % this.state.length] ^= seed[i];\n    this.ctr = 0;\n    this.pos = this.blockLen;\n  }\n  addEntropy(seed: Uint8Array): void {\n    this.state.set(this.randomBytes(this.state.length));\n    this.reseed(seed);\n  }\n  randomBytes(len: number): Uint8Array {\n    anumber(len);\n    if (len === 0) return new Uint8Array(0);\n    const out = new Uint8Array(len);\n    let outPos = 0;\n    // Leftovers\n    if (this.pos < this.blockLen) {\n      const take = Math.min(len, this.blockLen - this.pos);\n      out.set(this.buf.subarray(this.pos, this.pos + take), 0);\n      this.pos += take;\n      outPos += take;\n      if (outPos === len) return out; // fast path\n    }\n    // Full blocks directly to out\n    const blocks = Math.floor((len - outPos) / this.blockLen);\n    if (blocks > 0) {\n      const blockBytes = blocks * this.blockLen;\n      const b = out.subarray(outPos, outPos + blockBytes);\n      this.cipher(this.key, this.nonce, b, b, this.ctr);\n      this.ctr += blocks;\n      outPos += blockBytes;\n    }\n    // Save leftovers\n    const left = len - outPos;\n    if (left > 0) {\n      this.buf.fill(0);\n      // NOTE: cipher will handle overflow\n      this.cipher(this.key, this.nonce, this.buf, this.buf, this.ctr++);\n      out.set(this.buf.subarray(0, left), outPos);\n      this.pos = left;\n    }\n    return out;\n  }\n  clone(): _XorStreamPRG {\n    return new _XorStreamPRG(\n      this.cipher,\n      this.blockLen,\n      this.keyLen,\n      this.nonceLen,\n      this.randomBytes(this.state.length)\n    );\n  }\n  clean(): void {\n    this.pos = 0;\n    this.ctr = 0;\n    this.buf.fill(0);\n    this.state.fill(0);\n  }\n}\n\nexport type XorPRG = (seed?: Uint8Array) => _XorStreamPRG;\n\nexport const createPRG = (\n  cipher: XorStream,\n  blockLen: number,\n  keyLen: number,\n  nonceLen: number\n): XorPRG => {\n  return (seed: Uint8Array = randomBytes(32)): _XorStreamPRG =>\n    new _XorStreamPRG(cipher, blockLen, keyLen, nonceLen, seed);\n};\n", "/**\n * Poly1305 ([PDF](https://cr.yp.to/mac/poly1305-20050329.pdf),\n * [wiki](https://en.wikipedia.org/wiki/Poly1305))\n * is a fast and parallel secret-key message-authentication code suitable for\n * a wide variety of applications. It was standardized in\n * [RFC 8439](https://www.rfc-editor.org/rfc/rfc8439) and is now used in TLS 1.3.\n *\n * Polynomial MACs are not perfect for every situation:\n * they lack Random Key Robustness: the MAC can be forged, and can't be used in PAKE schemes.\n * See [invisible salamanders attack](https://keymaterial.net/2020/09/07/invisible-salamanders-in-aes-gcm-siv/).\n * To combat invisible salamanders, `hash(key)` can be included in ciphertext,\n * however, this would violate ciphertext indistinguishability:\n * an attacker would know which key was used - so `HKDF(key, i)`\n * could be used instead.\n *\n * Check out [original website](https://cr.yp.to/mac.html).\n * Based on Public Domain [poly1305-donna](https://github.com/floodyberry/poly1305-donna).\n * @module\n */\n// prettier-ignore\nimport {\n  abytes, aexists, aoutput, bytesToHex,\n  clean, concatBytes, copyBytes, hexToNumber, numberToBytesBE,\n  type IHash2\n} from './utils.ts';\n\nfunction u8to16(a: Uint8Array, i: number) {\n  return (a[i++] & 0xff) | ((a[i++] & 0xff) << 8);\n}\n\nfunction bytesToNumberLE(bytes: Uint8Array): bigint {\n  return hexToNumber(bytesToHex(Uint8Array.from(bytes).reverse()));\n}\n\n/** Small version of `poly1305` without loop unrolling. Unused, provided for auditability. */\nfunction poly1305_small(msg: Uint8Array, key: Uint8Array): Uint8Array {\n  abytes(msg);\n  abytes(key, 32, 'key');\n  const POW_2_130_5 = BigInt(2) ** BigInt(130) - BigInt(5); // 2^130-5\n  const POW_2_128_1 = BigInt(2) ** BigInt(128) - BigInt(1); // 2^128-1\n  const CLAMP_R = BigInt('0x0ffffffc0ffffffc0ffffffc0fffffff');\n  const r = bytesToNumberLE(key.subarray(0, 16)) & CLAMP_R;\n  const s = bytesToNumberLE(key.subarray(16));\n  // Process by 16 byte chunks\n  let acc = BigInt(0);\n  for (let i = 0; i < msg.length; i += 16) {\n    const m = msg.subarray(i, i + 16);\n    const n = bytesToNumberLE(m) | (BigInt(1) << BigInt(8 * m.length));\n    acc = ((acc + n) * r) % POW_2_130_5;\n  }\n  const res = (acc + s) & POW_2_128_1;\n  return numberToBytesBE(res, 16).reverse(); // LE\n}\n\n// Can be used to replace `computeTag` in chacha.ts. Unused, provided for auditability.\n// @ts-expect-error\nfunction poly1305_computeTag_small(\n  authKey: Uint8Array,\n  lengths: Uint8Array,\n  ciphertext: Uint8Array,\n  AAD?: Uint8Array\n): Uint8Array {\n  const res = [];\n  const updatePadded2 = (msg: Uint8Array) => {\n    res.push(msg);\n    const leftover = msg.length % 16;\n    if (leftover) res.push(new Uint8Array(16).slice(leftover));\n  };\n  if (AAD) updatePadded2(AAD);\n  updatePadded2(ciphertext);\n  res.push(lengths);\n  return poly1305_small(concatBytes(...res), authKey);\n}\n\n/** Poly1305 class. Prefer poly1305() function instead. */\nexport class Poly1305 implements IHash2 {\n  readonly blockLen = 16;\n  readonly outputLen = 16;\n  private buffer = new Uint8Array(16);\n  private r = new Uint16Array(10); // Allocating 1 array with .subarray() here is slower than 3\n  private h = new Uint16Array(10);\n  private pad = new Uint16Array(8);\n  private pos = 0;\n  protected finished = false;\n\n  // Can be speed-up using BigUint64Array, at the cost of complexity\n  constructor(key: Uint8Array) {\n    key = copyBytes(abytes(key, 32, 'key'));\n    const t0 = u8to16(key, 0);\n    const t1 = u8to16(key, 2);\n    const t2 = u8to16(key, 4);\n    const t3 = u8to16(key, 6);\n    const t4 = u8to16(key, 8);\n    const t5 = u8to16(key, 10);\n    const t6 = u8to16(key, 12);\n    const t7 = u8to16(key, 14);\n\n    // https://github.com/floodyberry/poly1305-donna/blob/e6ad6e091d30d7f4ec2d4f978be1fcfcbce72781/poly1305-donna-16.h#L47\n    this.r[0] = t0 & 0x1fff;\n    this.r[1] = ((t0 >>> 13) | (t1 << 3)) & 0x1fff;\n    this.r[2] = ((t1 >>> 10) | (t2 << 6)) & 0x1f03;\n    this.r[3] = ((t2 >>> 7) | (t3 << 9)) & 0x1fff;\n    this.r[4] = ((t3 >>> 4) | (t4 << 12)) & 0x00ff;\n    this.r[5] = (t4 >>> 1) & 0x1ffe;\n    this.r[6] = ((t4 >>> 14) | (t5 << 2)) & 0x1fff;\n    this.r[7] = ((t5 >>> 11) | (t6 << 5)) & 0x1f81;\n    this.r[8] = ((t6 >>> 8) | (t7 << 8)) & 0x1fff;\n    this.r[9] = (t7 >>> 5) & 0x007f;\n    for (let i = 0; i < 8; i++) this.pad[i] = u8to16(key, 16 + 2 * i);\n  }\n\n  private process(data: Uint8Array, offset: number, isLast = false) {\n    const hibit = isLast ? 0 : 1 << 11;\n    const { h, r } = this;\n    const r0 = r[0];\n    const r1 = r[1];\n    const r2 = r[2];\n    const r3 = r[3];\n    const r4 = r[4];\n    const r5 = r[5];\n    const r6 = r[6];\n    const r7 = r[7];\n    const r8 = r[8];\n    const r9 = r[9];\n\n    const t0 = u8to16(data, offset + 0);\n    const t1 = u8to16(data, offset + 2);\n    const t2 = u8to16(data, offset + 4);\n    const t3 = u8to16(data, offset + 6);\n    const t4 = u8to16(data, offset + 8);\n    const t5 = u8to16(data, offset + 10);\n    const t6 = u8to16(data, offset + 12);\n    const t7 = u8to16(data, offset + 14);\n\n    let h0 = h[0] + (t0 & 0x1fff);\n    let h1 = h[1] + (((t0 >>> 13) | (t1 << 3)) & 0x1fff);\n    let h2 = h[2] + (((t1 >>> 10) | (t2 << 6)) & 0x1fff);\n    let h3 = h[3] + (((t2 >>> 7) | (t3 << 9)) & 0x1fff);\n    let h4 = h[4] + (((t3 >>> 4) | (t4 << 12)) & 0x1fff);\n    let h5 = h[5] + ((t4 >>> 1) & 0x1fff);\n    let h6 = h[6] + (((t4 >>> 14) | (t5 << 2)) & 0x1fff);\n    let h7 = h[7] + (((t5 >>> 11) | (t6 << 5)) & 0x1fff);\n    let h8 = h[8] + (((t6 >>> 8) | (t7 << 8)) & 0x1fff);\n    let h9 = h[9] + ((t7 >>> 5) | hibit);\n\n    let c = 0;\n\n    let d0 = c + h0 * r0 + h1 * (5 * r9) + h2 * (5 * r8) + h3 * (5 * r7) + h4 * (5 * r6);\n    c = d0 >>> 13;\n    d0 &= 0x1fff;\n    d0 += h5 * (5 * r5) + h6 * (5 * r4) + h7 * (5 * r3) + h8 * (5 * r2) + h9 * (5 * r1);\n    c += d0 >>> 13;\n    d0 &= 0x1fff;\n\n    let d1 = c + h0 * r1 + h1 * r0 + h2 * (5 * r9) + h3 * (5 * r8) + h4 * (5 * r7);\n    c = d1 >>> 13;\n    d1 &= 0x1fff;\n    d1 += h5 * (5 * r6) + h6 * (5 * r5) + h7 * (5 * r4) + h8 * (5 * r3) + h9 * (5 * r2);\n    c += d1 >>> 13;\n    d1 &= 0x1fff;\n\n    let d2 = c + h0 * r2 + h1 * r1 + h2 * r0 + h3 * (5 * r9) + h4 * (5 * r8);\n    c = d2 >>> 13;\n    d2 &= 0x1fff;\n    d2 += h5 * (5 * r7) + h6 * (5 * r6) + h7 * (5 * r5) + h8 * (5 * r4) + h9 * (5 * r3);\n    c += d2 >>> 13;\n    d2 &= 0x1fff;\n\n    let d3 = c + h0 * r3 + h1 * r2 + h2 * r1 + h3 * r0 + h4 * (5 * r9);\n    c = d3 >>> 13;\n    d3 &= 0x1fff;\n    d3 += h5 * (5 * r8) + h6 * (5 * r7) + h7 * (5 * r6) + h8 * (5 * r5) + h9 * (5 * r4);\n    c += d3 >>> 13;\n    d3 &= 0x1fff;\n\n    let d4 = c + h0 * r4 + h1 * r3 + h2 * r2 + h3 * r1 + h4 * r0;\n    c = d4 >>> 13;\n    d4 &= 0x1fff;\n    d4 += h5 * (5 * r9) + h6 * (5 * r8) + h7 * (5 * r7) + h8 * (5 * r6) + h9 * (5 * r5);\n    c += d4 >>> 13;\n    d4 &= 0x1fff;\n\n    let d5 = c + h0 * r5 + h1 * r4 + h2 * r3 + h3 * r2 + h4 * r1;\n    c = d5 >>> 13;\n    d5 &= 0x1fff;\n    d5 += h5 * r0 + h6 * (5 * r9) + h7 * (5 * r8) + h8 * (5 * r7) + h9 * (5 * r6);\n    c += d5 >>> 13;\n    d5 &= 0x1fff;\n\n    let d6 = c + h0 * r6 + h1 * r5 + h2 * r4 + h3 * r3 + h4 * r2;\n    c = d6 >>> 13;\n    d6 &= 0x1fff;\n    d6 += h5 * r1 + h6 * r0 + h7 * (5 * r9) + h8 * (5 * r8) + h9 * (5 * r7);\n    c += d6 >>> 13;\n    d6 &= 0x1fff;\n\n    let d7 = c + h0 * r7 + h1 * r6 + h2 * r5 + h3 * r4 + h4 * r3;\n    c = d7 >>> 13;\n    d7 &= 0x1fff;\n    d7 += h5 * r2 + h6 * r1 + h7 * r0 + h8 * (5 * r9) + h9 * (5 * r8);\n    c += d7 >>> 13;\n    d7 &= 0x1fff;\n\n    let d8 = c + h0 * r8 + h1 * r7 + h2 * r6 + h3 * r5 + h4 * r4;\n    c = d8 >>> 13;\n    d8 &= 0x1fff;\n    d8 += h5 * r3 + h6 * r2 + h7 * r1 + h8 * r0 + h9 * (5 * r9);\n    c += d8 >>> 13;\n    d8 &= 0x1fff;\n\n    let d9 = c + h0 * r9 + h1 * r8 + h2 * r7 + h3 * r6 + h4 * r5;\n    c = d9 >>> 13;\n    d9 &= 0x1fff;\n    d9 += h5 * r4 + h6 * r3 + h7 * r2 + h8 * r1 + h9 * r0;\n    c += d9 >>> 13;\n    d9 &= 0x1fff;\n\n    c = ((c << 2) + c) | 0;\n    c = (c + d0) | 0;\n    d0 = c & 0x1fff;\n    c = c >>> 13;\n    d1 += c;\n\n    h[0] = d0;\n    h[1] = d1;\n    h[2] = d2;\n    h[3] = d3;\n    h[4] = d4;\n    h[5] = d5;\n    h[6] = d6;\n    h[7] = d7;\n    h[8] = d8;\n    h[9] = d9;\n  }\n\n  private finalize() {\n    const { h, pad } = this;\n    const g = new Uint16Array(10);\n    let c = h[1] >>> 13;\n    h[1] &= 0x1fff;\n    for (let i = 2; i < 10; i++) {\n      h[i] += c;\n      c = h[i] >>> 13;\n      h[i] &= 0x1fff;\n    }\n    h[0] += c * 5;\n    c = h[0] >>> 13;\n    h[0] &= 0x1fff;\n    h[1] += c;\n    c = h[1] >>> 13;\n    h[1] &= 0x1fff;\n    h[2] += c;\n\n    g[0] = h[0] + 5;\n    c = g[0] >>> 13;\n    g[0] &= 0x1fff;\n    for (let i = 1; i < 10; i++) {\n      g[i] = h[i] + c;\n      c = g[i] >>> 13;\n      g[i] &= 0x1fff;\n    }\n    g[9] -= 1 << 13;\n\n    let mask = (c ^ 1) - 1;\n    for (let i = 0; i < 10; i++) g[i] &= mask;\n    mask = ~mask;\n    for (let i = 0; i < 10; i++) h[i] = (h[i] & mask) | g[i];\n    h[0] = (h[0] | (h[1] << 13)) & 0xffff;\n    h[1] = ((h[1] >>> 3) | (h[2] << 10)) & 0xffff;\n    h[2] = ((h[2] >>> 6) | (h[3] << 7)) & 0xffff;\n    h[3] = ((h[3] >>> 9) | (h[4] << 4)) & 0xffff;\n    h[4] = ((h[4] >>> 12) | (h[5] << 1) | (h[6] << 14)) & 0xffff;\n    h[5] = ((h[6] >>> 2) | (h[7] << 11)) & 0xffff;\n    h[6] = ((h[7] >>> 5) | (h[8] << 8)) & 0xffff;\n    h[7] = ((h[8] >>> 8) | (h[9] << 5)) & 0xffff;\n\n    let f = h[0] + pad[0];\n    h[0] = f & 0xffff;\n    for (let i = 1; i < 8; i++) {\n      f = (((h[i] + pad[i]) | 0) + (f >>> 16)) | 0;\n      h[i] = f & 0xffff;\n    }\n    clean(g);\n  }\n  update(data: Uint8Array): this {\n    aexists(this);\n    abytes(data);\n    data = copyBytes(data);\n    const { buffer, blockLen } = this;\n    const len = data.length;\n\n    for (let pos = 0; pos < len; ) {\n      const take = Math.min(blockLen - this.pos, len - pos);\n      // Fast path: we have at least one block in input\n      if (take === blockLen) {\n        for (; blockLen <= len - pos; pos += blockLen) this.process(data, pos);\n        continue;\n      }\n      buffer.set(data.subarray(pos, pos + take), this.pos);\n      this.pos += take;\n      pos += take;\n      if (this.pos === blockLen) {\n        this.process(buffer, 0, false);\n        this.pos = 0;\n      }\n    }\n    return this;\n  }\n  destroy(): void {\n    clean(this.h, this.r, this.buffer, this.pad);\n  }\n  digestInto(out: Uint8Array): Uint8Array {\n    aexists(this);\n    aoutput(out, this);\n    this.finished = true;\n    const { buffer, h } = this;\n    let { pos } = this;\n    if (pos) {\n      buffer[pos++] = 1;\n      for (; pos < 16; pos++) buffer[pos] = 0;\n      this.process(buffer, 0, true);\n    }\n    this.finalize();\n    let opos = 0;\n    for (let i = 0; i < 8; i++) {\n      out[opos++] = h[i] >>> 0;\n      out[opos++] = h[i] >>> 8;\n    }\n    return out;\n  }\n  digest(): Uint8Array {\n    const { buffer, outputLen } = this;\n    this.digestInto(buffer);\n    const res = buffer.slice(0, outputLen);\n    this.destroy();\n    return res;\n  }\n}\n\nexport type CHash = ReturnType<typeof wrapConstructorWithKey>;\nexport function wrapConstructorWithKey<H extends IHash2>(\n  hashCons: (key: Uint8Array) => H\n): {\n  (msg: Uint8Array, key: Uint8Array): Uint8Array;\n  outputLen: number;\n  blockLen: number;\n  create(key: Uint8Array): H;\n} {\n  const hashC = (msg: Uint8Array, key: Uint8Array): Uint8Array =>\n    hashCons(key).update(msg).digest();\n  const tmp = hashCons(new Uint8Array(32)); // tmp array, used just once below\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = (key: Uint8Array) => hashCons(key);\n  return hashC;\n}\n\n/** Poly1305 MAC from RFC 8439. */\nexport const poly1305: CHash = /** @__PURE__ */ (() =>\n  wrapConstructorWithKey((key) => new Poly1305(key)))();\n", "/**\n * ChaCha stream cipher, released\n * in 2008. Developed after Salsa20, ChaCha aims to increase diffusion per round.\n * It was standardized in [RFC 8439](https://www.rfc-editor.org/rfc/rfc8439) and\n * is now used in TLS 1.3.\n *\n * [XChaCha20](https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha)\n * extended-nonce variant is also provided. Similar to XSalsa, it's safe to use with\n * randomly-generated nonces.\n *\n * Check out [PDF](http://cr.yp.to/chacha/chacha-20080128.pdf) and\n * [wiki](https://en.wikipedia.org/wiki/Salsa20) and\n * [website](https://cr.yp.to/chacha.html).\n *\n * @module\n */\nimport { type XorPRG, createCipher, createPRG, rotl } from './_arx.ts';\nimport { poly1305 } from './_poly1305.ts';\nimport {\n  type ARXCipher,\n  type CipherWithOutput,\n  type XorStream,\n  abytes,\n  clean,\n  equalBytes,\n  getOutput,\n  u64Lengths,\n  wrapCipher,\n} from './utils.ts';\n\n/**\n * ChaCha core function. It is implemented twice:\n * 1. Simple loop (chachaCore_small, hchacha_small)\n * 2. Unrolled loop (chachaCore, hchacha) - 4x faster, but larger & harder to read\n * The specific implementation is selected in `createCipher` below.\n */\n\n/** quarter-round */\n// prettier-ignore\nfunction chachaQR(x: Uint32Array, a: number, b: number, c: number, d: number) {\n  x[a] = (x[a] + x[b]) | 0; x[d] = rotl(x[d] ^ x[a], 16);\n  x[c] = (x[c] + x[d]) | 0; x[b] = rotl(x[b] ^ x[c], 12);\n  x[a] = (x[a] + x[b]) | 0; x[d] = rotl(x[d] ^ x[a], 8);\n  x[c] = (x[c] + x[d]) | 0; x[b] = rotl(x[b] ^ x[c], 7);\n}\n\n/** single round */\nfunction chachaRound(x: Uint32Array, rounds = 20) {\n  for (let r = 0; r < rounds; r += 2) {\n    chachaQR(x, 0, 4, 8, 12);\n    chachaQR(x, 1, 5, 9, 13);\n    chachaQR(x, 2, 6, 10, 14);\n    chachaQR(x, 3, 7, 11, 15);\n    chachaQR(x, 0, 5, 10, 15);\n    chachaQR(x, 1, 6, 11, 12);\n    chachaQR(x, 2, 7, 8, 13);\n    chachaQR(x, 3, 4, 9, 14);\n  }\n}\n\nconst ctmp = /* @__PURE__ */ new Uint32Array(16);\n\n/** Small version of chacha without loop unrolling. Unused, provided for auditability. */\n// prettier-ignore\nfunction chacha(\n  s: Uint32Array, k: Uint32Array, i: Uint32Array, out: Uint32Array,\n  isHChacha: boolean = true, rounds: number = 20\n): void {\n  // Create initial array using common pattern\n  const y = Uint32Array.from([\n    s[0], s[1], s[2], s[3], // \"expa\"   \"nd 3\"  \"2-by\"  \"te k\"\n    k[0], k[1], k[2], k[3], // Key      Key     Key     Key\n    k[4], k[5], k[6], k[7], // Key      Key     Key     Key\n    i[0], i[1], i[2], i[3], // Counter  Counter Nonce   Nonce\n  ]);\n  const x = ctmp;\n  x.set(y);\n  chachaRound(x, rounds);\n\n  // hchacha extracts 8 specific bytes, chacha adds orig to result\n  if (isHChacha) {\n    const xindexes = [0, 1, 2, 3, 12, 13, 14, 15];\n    for (let i = 0; i < 8; i++) out[i] = x[xindexes[i]];\n  } else {\n    for (let i = 0; i < 16; i++) out[i] = (y[i] + x[i]) | 0;\n  }\n}\n\n/** Identical to `chachaCore`. Unused. */\n// @ts-ignore\nconst chachaCore_small: typeof chachaCore = (s, k, n, out, cnt, rounds) =>\n  chacha(s, k, Uint32Array.from([n[0], n[1], cnt, 0]), out, false, rounds);\n/** Identical to `hchacha`. Unused. */\n// @ts-ignore\nconst hchacha_small: typeof hchacha = chacha;\n\n/** Identical to `chachaCore_small`. Unused. */\n// prettier-ignore\nfunction chachaCore(\n  s: Uint32Array, k: Uint32Array, n: Uint32Array, out: Uint32Array, cnt: number, rounds = 20\n): void {\n  let y00 = s[0], y01 = s[1], y02 = s[2], y03 = s[3], // \"expa\"   \"nd 3\"  \"2-by\"  \"te k\"\n      y04 = k[0], y05 = k[1], y06 = k[2], y07 = k[3], // Key      Key     Key     Key\n      y08 = k[4], y09 = k[5], y10 = k[6], y11 = k[7], // Key      Key     Key     Key\n      y12 = cnt,  y13 = n[0], y14 = n[1], y15 = n[2];  // Counter  Counter\tNonce   Nonce\n  // Save state to temporary variables\n  let x00 = y00, x01 = y01, x02 = y02, x03 = y03,\n      x04 = y04, x05 = y05, x06 = y06, x07 = y07,\n      x08 = y08, x09 = y09, x10 = y10, x11 = y11,\n      x12 = y12, x13 = y13, x14 = y14, x15 = y15;\n  for (let r = 0; r < rounds; r += 2) {\n    x00 = (x00 + x04) | 0; x12 = rotl(x12 ^ x00, 16);\n    x08 = (x08 + x12) | 0; x04 = rotl(x04 ^ x08, 12);\n    x00 = (x00 + x04) | 0; x12 = rotl(x12 ^ x00, 8);\n    x08 = (x08 + x12) | 0; x04 = rotl(x04 ^ x08, 7);\n\n    x01 = (x01 + x05) | 0; x13 = rotl(x13 ^ x01, 16);\n    x09 = (x09 + x13) | 0; x05 = rotl(x05 ^ x09, 12);\n    x01 = (x01 + x05) | 0; x13 = rotl(x13 ^ x01, 8);\n    x09 = (x09 + x13) | 0; x05 = rotl(x05 ^ x09, 7);\n\n    x02 = (x02 + x06) | 0; x14 = rotl(x14 ^ x02, 16);\n    x10 = (x10 + x14) | 0; x06 = rotl(x06 ^ x10, 12);\n    x02 = (x02 + x06) | 0; x14 = rotl(x14 ^ x02, 8);\n    x10 = (x10 + x14) | 0; x06 = rotl(x06 ^ x10, 7);\n\n    x03 = (x03 + x07) | 0; x15 = rotl(x15 ^ x03, 16);\n    x11 = (x11 + x15) | 0; x07 = rotl(x07 ^ x11, 12);\n    x03 = (x03 + x07) | 0; x15 = rotl(x15 ^ x03, 8)\n    x11 = (x11 + x15) | 0; x07 = rotl(x07 ^ x11, 7);\n\n    x00 = (x00 + x05) | 0; x15 = rotl(x15 ^ x00, 16);\n    x10 = (x10 + x15) | 0; x05 = rotl(x05 ^ x10, 12);\n    x00 = (x00 + x05) | 0; x15 = rotl(x15 ^ x00, 8);\n    x10 = (x10 + x15) | 0; x05 = rotl(x05 ^ x10, 7);\n\n    x01 = (x01 + x06) | 0; x12 = rotl(x12 ^ x01, 16);\n    x11 = (x11 + x12) | 0; x06 = rotl(x06 ^ x11, 12);\n    x01 = (x01 + x06) | 0; x12 = rotl(x12 ^ x01, 8);\n    x11 = (x11 + x12) | 0; x06 = rotl(x06 ^ x11, 7);\n\n    x02 = (x02 + x07) | 0; x13 = rotl(x13 ^ x02, 16);\n    x08 = (x08 + x13) | 0; x07 = rotl(x07 ^ x08, 12);\n    x02 = (x02 + x07) | 0; x13 = rotl(x13 ^ x02, 8);\n    x08 = (x08 + x13) | 0; x07 = rotl(x07 ^ x08, 7);\n\n    x03 = (x03 + x04) | 0; x14 = rotl(x14 ^ x03, 16)\n    x09 = (x09 + x14) | 0; x04 = rotl(x04 ^ x09, 12);\n    x03 = (x03 + x04) | 0; x14 = rotl(x14 ^ x03, 8);\n    x09 = (x09 + x14) | 0; x04 = rotl(x04 ^ x09, 7);\n  }\n  // Write output\n  let oi = 0;\n  out[oi++] = (y00 + x00) | 0; out[oi++] = (y01 + x01) | 0;\n  out[oi++] = (y02 + x02) | 0; out[oi++] = (y03 + x03) | 0;\n  out[oi++] = (y04 + x04) | 0; out[oi++] = (y05 + x05) | 0;\n  out[oi++] = (y06 + x06) | 0; out[oi++] = (y07 + x07) | 0;\n  out[oi++] = (y08 + x08) | 0; out[oi++] = (y09 + x09) | 0;\n  out[oi++] = (y10 + x10) | 0; out[oi++] = (y11 + x11) | 0;\n  out[oi++] = (y12 + x12) | 0; out[oi++] = (y13 + x13) | 0;\n  out[oi++] = (y14 + x14) | 0; out[oi++] = (y15 + x15) | 0;\n}\n/**\n * hchacha hashes key and nonce into key' and nonce' for xchacha20.\n * Identical to `hchacha_small`.\n * Need to find a way to merge it with `chachaCore` without 25% performance hit.\n */\n// prettier-ignore\nexport function hchacha(\n  s: Uint32Array, k: Uint32Array, i: Uint32Array, out: Uint32Array\n): void {\n  let x00 = s[0], x01 = s[1], x02 = s[2], x03 = s[3],\n      x04 = k[0], x05 = k[1], x06 = k[2], x07 = k[3],\n      x08 = k[4], x09 = k[5], x10 = k[6], x11 = k[7],\n      x12 = i[0], x13 = i[1], x14 = i[2], x15 = i[3];\n  for (let r = 0; r < 20; r += 2) {\n    x00 = (x00 + x04) | 0; x12 = rotl(x12 ^ x00, 16);\n    x08 = (x08 + x12) | 0; x04 = rotl(x04 ^ x08, 12);\n    x00 = (x00 + x04) | 0; x12 = rotl(x12 ^ x00, 8);\n    x08 = (x08 + x12) | 0; x04 = rotl(x04 ^ x08, 7);\n\n    x01 = (x01 + x05) | 0; x13 = rotl(x13 ^ x01, 16);\n    x09 = (x09 + x13) | 0; x05 = rotl(x05 ^ x09, 12);\n    x01 = (x01 + x05) | 0; x13 = rotl(x13 ^ x01, 8);\n    x09 = (x09 + x13) | 0; x05 = rotl(x05 ^ x09, 7);\n\n    x02 = (x02 + x06) | 0; x14 = rotl(x14 ^ x02, 16);\n    x10 = (x10 + x14) | 0; x06 = rotl(x06 ^ x10, 12);\n    x02 = (x02 + x06) | 0; x14 = rotl(x14 ^ x02, 8);\n    x10 = (x10 + x14) | 0; x06 = rotl(x06 ^ x10, 7);\n\n    x03 = (x03 + x07) | 0; x15 = rotl(x15 ^ x03, 16);\n    x11 = (x11 + x15) | 0; x07 = rotl(x07 ^ x11, 12);\n    x03 = (x03 + x07) | 0; x15 = rotl(x15 ^ x03, 8)\n    x11 = (x11 + x15) | 0; x07 = rotl(x07 ^ x11, 7);\n\n    x00 = (x00 + x05) | 0; x15 = rotl(x15 ^ x00, 16);\n    x10 = (x10 + x15) | 0; x05 = rotl(x05 ^ x10, 12);\n    x00 = (x00 + x05) | 0; x15 = rotl(x15 ^ x00, 8);\n    x10 = (x10 + x15) | 0; x05 = rotl(x05 ^ x10, 7);\n\n    x01 = (x01 + x06) | 0; x12 = rotl(x12 ^ x01, 16);\n    x11 = (x11 + x12) | 0; x06 = rotl(x06 ^ x11, 12);\n    x01 = (x01 + x06) | 0; x12 = rotl(x12 ^ x01, 8);\n    x11 = (x11 + x12) | 0; x06 = rotl(x06 ^ x11, 7);\n\n    x02 = (x02 + x07) | 0; x13 = rotl(x13 ^ x02, 16);\n    x08 = (x08 + x13) | 0; x07 = rotl(x07 ^ x08, 12);\n    x02 = (x02 + x07) | 0; x13 = rotl(x13 ^ x02, 8);\n    x08 = (x08 + x13) | 0; x07 = rotl(x07 ^ x08, 7);\n\n    x03 = (x03 + x04) | 0; x14 = rotl(x14 ^ x03, 16)\n    x09 = (x09 + x14) | 0; x04 = rotl(x04 ^ x09, 12);\n    x03 = (x03 + x04) | 0; x14 = rotl(x14 ^ x03, 8);\n    x09 = (x09 + x14) | 0; x04 = rotl(x04 ^ x09, 7);\n  }\n  let oi = 0;\n  out[oi++] = x00; out[oi++] = x01;\n  out[oi++] = x02; out[oi++] = x03;\n  out[oi++] = x12; out[oi++] = x13;\n  out[oi++] = x14; out[oi++] = x15;\n}\n\n/** Original, non-RFC chacha20 from DJB. 8-byte nonce, 8-byte counter. */\nexport const chacha20orig: XorStream = /* @__PURE__ */ createCipher(chachaCore, {\n  counterRight: false,\n  counterLength: 8,\n  allowShortKeys: true,\n});\n/**\n * ChaCha stream cipher. Conforms to RFC 8439 (IETF, TLS). 12-byte nonce, 4-byte counter.\n * With smaller nonce, it's not safe to make it random (CSPRNG), due to collision chance.\n */\nexport const chacha20: XorStream = /* @__PURE__ */ createCipher(chachaCore, {\n  counterRight: false,\n  counterLength: 4,\n  allowShortKeys: false,\n});\n\n/**\n * XChaCha eXtended-nonce ChaCha. With 24-byte nonce, it's safe to make it random (CSPRNG).\n * See [IRTF draft](https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha).\n */\nexport const xchacha20: XorStream = /* @__PURE__ */ createCipher(chachaCore, {\n  counterRight: false,\n  counterLength: 8,\n  extendNonceFn: hchacha,\n  allowShortKeys: false,\n});\n\n/** Reduced 8-round chacha, described in original paper. */\nexport const chacha8: XorStream = /* @__PURE__ */ createCipher(chachaCore, {\n  counterRight: false,\n  counterLength: 4,\n  rounds: 8,\n});\n\n/** Reduced 12-round chacha, described in original paper. */\nexport const chacha12: XorStream = /* @__PURE__ */ createCipher(chachaCore, {\n  counterRight: false,\n  counterLength: 4,\n  rounds: 12,\n});\n\nconst ZEROS16 = /* @__PURE__ */ new Uint8Array(16);\n// Pad to digest size with zeros\nconst updatePadded = (h: ReturnType<typeof poly1305.create>, msg: Uint8Array) => {\n  h.update(msg);\n  const leftover = msg.length % 16;\n  if (leftover) h.update(ZEROS16.subarray(leftover));\n};\n\nconst ZEROS32 = /* @__PURE__ */ new Uint8Array(32);\nfunction computeTag(\n  fn: XorStream,\n  key: Uint8Array,\n  nonce: Uint8Array,\n  ciphertext: Uint8Array,\n  AAD?: Uint8Array\n): Uint8Array {\n  if (AAD !== undefined) abytes(AAD, undefined, 'AAD');\n  const authKey = fn(key, nonce, ZEROS32);\n  const lengths = u64Lengths(ciphertext.length, AAD ? AAD.length : 0, true);\n\n  // Methods below can be replaced with\n  // return poly1305_computeTag_small(authKey, lengths, ciphertext, AAD)\n  const h = poly1305.create(authKey);\n  if (AAD) updatePadded(h, AAD);\n  updatePadded(h, ciphertext);\n  h.update(lengths);\n  const res = h.digest();\n  clean(authKey, lengths);\n  return res;\n}\n\n/**\n * AEAD algorithm from RFC 8439.\n * Salsa20 and chacha (RFC 8439) use poly1305 differently.\n * We could have composed them, but it's hard because of authKey:\n * In salsa20, authKey changes position in salsa stream.\n * In chacha, authKey can't be computed inside computeTag, it modifies the counter.\n */\nexport const _poly1305_aead =\n  (xorStream: XorStream) =>\n  (key: Uint8Array, nonce: Uint8Array, AAD?: Uint8Array): CipherWithOutput => {\n    const tagLength = 16;\n    return {\n      encrypt(plaintext: Uint8Array, output?: Uint8Array) {\n        const plength = plaintext.length;\n        output = getOutput(plength + tagLength, output, false);\n        output.set(plaintext);\n        const oPlain = output.subarray(0, -tagLength);\n        // Actual encryption\n        xorStream(key, nonce, oPlain, oPlain, 1);\n        const tag = computeTag(xorStream, key, nonce, oPlain, AAD);\n        output.set(tag, plength); // append tag\n        clean(tag);\n        return output;\n      },\n      decrypt(ciphertext: Uint8Array, output?: Uint8Array) {\n        output = getOutput(ciphertext.length - tagLength, output, false);\n        const data = ciphertext.subarray(0, -tagLength);\n        const passedTag = ciphertext.subarray(-tagLength);\n        const tag = computeTag(xorStream, key, nonce, data, AAD);\n        if (!equalBytes(passedTag, tag)) throw new Error('invalid tag');\n        output.set(ciphertext.subarray(0, -tagLength));\n        // Actual decryption\n        xorStream(key, nonce, output, output, 1); // start stream with i=1\n        clean(tag);\n        return output;\n      },\n    };\n  };\n\n/**\n * ChaCha20-Poly1305 from RFC 8439.\n *\n * Unsafe to use random nonces under the same key, due to collision chance.\n * Prefer XChaCha instead.\n */\nexport const chacha20poly1305: ARXCipher = /* @__PURE__ */ wrapCipher(\n  { blockSize: 64, nonceLength: 12, tagLength: 16 },\n  _poly1305_aead(chacha20)\n);\n/**\n * XChaCha20-Poly1305 extended-nonce chacha.\n *\n * Can be safely used with random nonces (CSPRNG).\n * See [IRTF draft](https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha).\n */\nexport const xchacha20poly1305: ARXCipher = /* @__PURE__ */ wrapCipher(\n  { blockSize: 64, nonceLength: 24, tagLength: 16 },\n  _poly1305_aead(xchacha20)\n);\n\n/**\n * Chacha20 CSPRNG (cryptographically secure pseudorandom number generator).\n * It's best to limit usage to non-production, non-critical cases: for example, test-only.\n * Compatible with libtomcrypt. It does not have a specification, so unclear how secure it is.\n */\nexport const rngChacha20: XorPRG = /* @__PURE__ */ createPRG(chacha20orig, 64, 32, 8);\n/**\n * Chacha20/8 CSPRNG (cryptographically secure pseudorandom number generator).\n * It's best to limit usage to non-production, non-critical cases: for example, test-only.\n * Faster than `rngChacha20`.\n */\nexport const rngChacha8: XorPRG = /* @__PURE__ */ createPRG(chacha8, 64, 32, 12);\n", "/**\n * Utilities for hex, bytes, CSPRNG.\n * @module\n */\n/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n/** Checks if something is Uint8Array. Be careful: nodejs Buffer will return true. */\nexport function isBytes(a: unknown): a is Uint8Array {\n  return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n\n/** Asserts something is positive integer. */\nexport function anumber(n: number, title: string = ''): void {\n  if (!Number.isSafeInteger(n) || n < 0) {\n    const prefix = title && `\"${title}\" `;\n    throw new Error(`${prefix}expected integer >= 0, got ${n}`);\n  }\n}\n\n/** Asserts something is Uint8Array. */\nexport function abytes(value: Uint8Array, length?: number, title: string = ''): Uint8Array {\n  const bytes = isBytes(value);\n  const len = value?.length;\n  const needsLen = length !== undefined;\n  if (!bytes || (needsLen && len !== length)) {\n    const prefix = title && `\"${title}\" `;\n    const ofLen = needsLen ? ` of length ${length}` : '';\n    const got = bytes ? `length=${len}` : `type=${typeof value}`;\n    throw new Error(prefix + 'expected Uint8Array' + ofLen + ', got ' + got);\n  }\n  return value;\n}\n\n/** Asserts something is hash */\nexport function ahash(h: CHash): void {\n  if (typeof h !== 'function' || typeof h.create !== 'function')\n    throw new Error('Hash must wrapped by utils.createHasher');\n  anumber(h.outputLen);\n  anumber(h.blockLen);\n}\n\n/** Asserts a hash instance has not been destroyed / finished */\nexport function aexists(instance: any, checkFinished = true): void {\n  if (instance.destroyed) throw new Error('Hash instance has been destroyed');\n  if (checkFinished && instance.finished) throw new Error('Hash#digest() has already been called');\n}\n\n/** Asserts output is properly-sized byte array */\nexport function aoutput(out: any, instance: any): void {\n  abytes(out, undefined, 'digestInto() output');\n  const min = instance.outputLen;\n  if (out.length < min) {\n    throw new Error('\"digestInto() output\" expected to be of length >=' + min);\n  }\n}\n\n/** Generic type encompassing 8/16/32-byte arrays - but not 64-byte. */\n// prettier-ignore\nexport type TypedArray = Int8Array | Uint8ClampedArray | Uint8Array |\n  Uint16Array | Int16Array | Uint32Array | Int32Array;\n\n/** Cast u8 / u16 / u32 to u8. */\nexport function u8(arr: TypedArray): Uint8Array {\n  return new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n\n/** Cast u8 / u16 / u32 to u32. */\nexport function u32(arr: TypedArray): Uint32Array {\n  return new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n}\n\n/** Zeroize a byte array. Warning: JS provides no guarantees. */\nexport function clean(...arrays: TypedArray[]): void {\n  for (let i = 0; i < arrays.length; i++) {\n    arrays[i].fill(0);\n  }\n}\n\n/** Create DataView of an array for easy byte-level manipulation. */\nexport function createView(arr: TypedArray): DataView {\n  return new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n\n/** The rotate right (circular right shift) operation for uint32 */\nexport function rotr(word: number, shift: number): number {\n  return (word << (32 - shift)) | (word >>> shift);\n}\n\n/** The rotate left (circular left shift) operation for uint32 */\nexport function rotl(word: number, shift: number): number {\n  return (word << shift) | ((word >>> (32 - shift)) >>> 0);\n}\n\n/** Is current platform little-endian? Most are. Big-Endian platform: IBM */\nexport const isLE: boolean = /* @__PURE__ */ (() =>\n  new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44)();\n\n/** The byte swap operation for uint32 */\nexport function byteSwap(word: number): number {\n  return (\n    ((word << 24) & 0xff000000) |\n    ((word << 8) & 0xff0000) |\n    ((word >>> 8) & 0xff00) |\n    ((word >>> 24) & 0xff)\n  );\n}\n/** Conditionally byte swap if on a big-endian platform */\nexport const swap8IfBE: (n: number) => number = isLE\n  ? (n: number) => n\n  : (n: number) => byteSwap(n);\n\n/** In place byte swap for Uint32Array */\nexport function byteSwap32(arr: Uint32Array): Uint32Array {\n  for (let i = 0; i < arr.length; i++) {\n    arr[i] = byteSwap(arr[i]);\n  }\n  return arr;\n}\n\nexport const swap32IfBE: (u: Uint32Array) => Uint32Array = isLE\n  ? (u: Uint32Array) => u\n  : byteSwap32;\n\n// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex\nconst hasHexBuiltin: boolean = /* @__PURE__ */ (() =>\n  // @ts-ignore\n  typeof Uint8Array.from([]).toHex === 'function' && typeof Uint8Array.fromHex === 'function')();\n\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) =>\n  i.toString(16).padStart(2, '0')\n);\n\n/**\n * Convert byte array to hex string. Uses built-in function, when available.\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes: Uint8Array): string {\n  abytes(bytes);\n  // @ts-ignore\n  if (hasHexBuiltin) return bytes.toHex();\n  // pre-caching improves the speed 6x\n  let hex = '';\n  for (let i = 0; i < bytes.length; i++) {\n    hex += hexes[bytes[i]];\n  }\n  return hex;\n}\n\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 } as const;\nfunction asciiToBase16(ch: number): number | undefined {\n  if (ch >= asciis._0 && ch <= asciis._9) return ch - asciis._0; // '2' => 50-48\n  if (ch >= asciis.A && ch <= asciis.F) return ch - (asciis.A - 10); // 'B' => 66-(65-10)\n  if (ch >= asciis.a && ch <= asciis.f) return ch - (asciis.a - 10); // 'b' => 98-(97-10)\n  return;\n}\n\n/**\n * Convert hex string to byte array. Uses built-in function, when available.\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex: string): Uint8Array {\n  if (typeof hex !== 'string') throw new Error('hex string expected, got ' + typeof hex);\n  // @ts-ignore\n  if (hasHexBuiltin) return Uint8Array.fromHex(hex);\n  const hl = hex.length;\n  const al = hl / 2;\n  if (hl % 2) throw new Error('hex string expected, got unpadded hex of length ' + hl);\n  const array = new Uint8Array(al);\n  for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n    const n1 = asciiToBase16(hex.charCodeAt(hi));\n    const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n    if (n1 === undefined || n2 === undefined) {\n      const char = hex[hi] + hex[hi + 1];\n      throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n    }\n    array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163\n  }\n  return array;\n}\n\n/**\n * There is no setImmediate in browser and setTimeout is slow.\n * Call of async fn will return Promise, which will be fullfiled only on\n * next scheduler queue processing step and this is exactly what we need.\n */\nexport const nextTick = async (): Promise<void> => {};\n\n/** Returns control to thread each 'tick' ms to avoid blocking. */\nexport async function asyncLoop(\n  iters: number,\n  tick: number,\n  cb: (i: number) => void\n): Promise<void> {\n  let ts = Date.now();\n  for (let i = 0; i < iters; i++) {\n    cb(i);\n    // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n    const diff = Date.now() - ts;\n    if (diff >= 0 && diff < tick) continue;\n    await nextTick();\n    ts += diff;\n  }\n}\n\n// Global symbols, but ts doesn't see them: https://github.com/microsoft/TypeScript/issues/31535\ndeclare const TextEncoder: any;\n\n/**\n * Converts string to bytes using UTF8 encoding.\n * Built-in doesn't validate input to be string: we do the check.\n * @example utf8ToBytes('abc') // Uint8Array.from([97, 98, 99])\n */\nexport function utf8ToBytes(str: string): Uint8Array {\n  if (typeof str !== 'string') throw new Error('string expected');\n  return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n\n/** KDFs can accept string or Uint8Array for user convenience. */\nexport type KDFInput = string | Uint8Array;\n\n/**\n * Helper for KDFs: consumes uint8array or string.\n * When string is passed, does utf8 decoding, using TextDecoder.\n */\nexport function kdfInputToBytes(data: KDFInput, errorTitle = ''): Uint8Array {\n  if (typeof data === 'string') return utf8ToBytes(data);\n  return abytes(data, undefined, errorTitle);\n}\n\n/** Copies several Uint8Arrays into one. */\nexport function concatBytes(...arrays: Uint8Array[]): Uint8Array {\n  let sum = 0;\n  for (let i = 0; i < arrays.length; i++) {\n    const a = arrays[i];\n    abytes(a);\n    sum += a.length;\n  }\n  const res = new Uint8Array(sum);\n  for (let i = 0, pad = 0; i < arrays.length; i++) {\n    const a = arrays[i];\n    res.set(a, pad);\n    pad += a.length;\n  }\n  return res;\n}\n\ntype EmptyObj = {};\n/** Merges default options and passed options. */\nexport function checkOpts<T1 extends EmptyObj, T2 extends EmptyObj>(\n  defaults: T1,\n  opts?: T2\n): T1 & T2 {\n  if (opts !== undefined && {}.toString.call(opts) !== '[object Object]')\n    throw new Error('options must be object or undefined');\n  const merged = Object.assign(defaults, opts);\n  return merged as T1 & T2;\n}\n\n/** Common interface for all hashes. */\nexport interface Hash<T> {\n  blockLen: number; // Bytes per block\n  outputLen: number; // Bytes in output\n  update(buf: Uint8Array): this;\n  digestInto(buf: Uint8Array): void;\n  digest(): Uint8Array;\n  destroy(): void;\n  _cloneInto(to?: T): T;\n  clone(): T;\n}\n\n/** PseudoRandom (number) Generator */\nexport interface PRG {\n  addEntropy(seed: Uint8Array): void;\n  randomBytes(length: number): Uint8Array;\n  clean(): void;\n}\n\n/**\n * XOF: streaming API to read digest in chunks.\n * Same as 'squeeze' in keccak/k12 and 'seek' in blake3, but more generic name.\n * When hash used in XOF mode it is up to user to call '.destroy' afterwards, since we cannot\n * destroy state, next call can require more bytes.\n */\nexport type HashXOF<T extends Hash<T>> = Hash<T> & {\n  xof(bytes: number): Uint8Array; // Read 'bytes' bytes from digest stream\n  xofInto(buf: Uint8Array): Uint8Array; // read buf.length bytes from digest stream into buf\n};\n\n/** Hash constructor */\nexport type HasherCons<T, Opts = undefined> = Opts extends undefined ? () => T : (opts?: Opts) => T;\n/** Optional hash params. */\nexport type HashInfo = {\n  oid?: Uint8Array; // DER encoded OID in bytes\n};\n/** Hash function */\nexport type CHash<T extends Hash<T> = Hash<any>, Opts = undefined> = {\n  outputLen: number;\n  blockLen: number;\n} & HashInfo &\n  (Opts extends undefined\n    ? {\n        (msg: Uint8Array): Uint8Array;\n        create(): T;\n      }\n    : {\n        (msg: Uint8Array, opts?: Opts): Uint8Array;\n        create(opts?: Opts): T;\n      });\n/** XOF with output */\nexport type CHashXOF<T extends HashXOF<T> = HashXOF<any>, Opts = undefined> = CHash<T, Opts>;\n\n/** Creates function with outputLen, blockLen, create properties from a class constructor. */\nexport function createHasher<T extends Hash<T>, Opts = undefined>(\n  hashCons: HasherCons<T, Opts>,\n  info: HashInfo = {}\n): CHash<T, Opts> {\n  const hashC: any = (msg: Uint8Array, opts?: Opts) => hashCons(opts).update(msg).digest();\n  const tmp = hashCons(undefined);\n  hashC.outputLen = tmp.outputLen;\n  hashC.blockLen = tmp.blockLen;\n  hashC.create = (opts?: Opts) => hashCons(opts);\n  Object.assign(hashC, info);\n  return Object.freeze(hashC);\n}\n\n/** Cryptographically secure PRNG. Uses internal OS-level `crypto.getRandomValues`. */\nexport function randomBytes(bytesLength = 32): Uint8Array {\n  const cr = typeof globalThis === 'object' ? (globalThis as any).crypto : null;\n  if (typeof cr?.getRandomValues !== 'function')\n    throw new Error('crypto.getRandomValues must be defined');\n  return cr.getRandomValues(new Uint8Array(bytesLength));\n}\n\n/** Creates OID opts for NIST hashes, with prefix 06 09 60 86 48 01 65 03 04 02. */\nexport const oidNist = (suffix: number): Required<HashInfo> => ({\n  oid: Uint8Array.from([0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, suffix]),\n});\n", "/**\n * Internal Merkle-Damgard hash utils.\n * @module\n */\nimport { abytes, aexists, aoutput, clean, createView, type Hash } from './utils.ts';\n\n/** Choice: a ? b : c */\nexport function Chi(a: number, b: number, c: number): number {\n  return (a & b) ^ (~a & c);\n}\n\n/** Majority function, true if any two inputs is true. */\nexport function Maj(a: number, b: number, c: number): number {\n  return (a & b) ^ (a & c) ^ (b & c);\n}\n\n/**\n * Merkle-Damgard hash construction base class.\n * Could be used to create MD5, RIPEMD, SHA1, SHA2.\n */\nexport abstract class HashMD<T extends HashMD<T>> implements Hash<T> {\n  protected abstract process(buf: DataView, offset: number): void;\n  protected abstract get(): number[];\n  protected abstract set(...args: number[]): void;\n  abstract destroy(): void;\n  protected abstract roundClean(): void;\n\n  readonly blockLen: number;\n  readonly outputLen: number;\n  readonly padOffset: number;\n  readonly isLE: boolean;\n\n  // For partial updates less than block size\n  protected buffer: Uint8Array;\n  protected view: DataView;\n  protected finished = false;\n  protected length = 0;\n  protected pos = 0;\n  protected destroyed = false;\n\n  constructor(blockLen: number, outputLen: number, padOffset: number, isLE: boolean) {\n    this.blockLen = blockLen;\n    this.outputLen = outputLen;\n    this.padOffset = padOffset;\n    this.isLE = isLE;\n    this.buffer = new Uint8Array(blockLen);\n    this.view = createView(this.buffer);\n  }\n  update(data: Uint8Array): this {\n    aexists(this);\n    abytes(data);\n    const { view, buffer, blockLen } = this;\n    const len = data.length;\n    for (let pos = 0; pos < len; ) {\n      const take = Math.min(blockLen - this.pos, len - pos);\n      // Fast path: we have at least one block in input, cast it to view and process\n      if (take === blockLen) {\n        const dataView = createView(data);\n        for (; blockLen <= len - pos; pos += blockLen) this.process(dataView, pos);\n        continue;\n      }\n      buffer.set(data.subarray(pos, pos + take), this.pos);\n      this.pos += take;\n      pos += take;\n      if (this.pos === blockLen) {\n        this.process(view, 0);\n        this.pos = 0;\n      }\n    }\n    this.length += data.length;\n    this.roundClean();\n    return this;\n  }\n  digestInto(out: Uint8Array): void {\n    aexists(this);\n    aoutput(out, this);\n    this.finished = true;\n    // Padding\n    // We can avoid allocation of buffer for padding completely if it\n    // was previously not allocated here. But it won't change performance.\n    const { buffer, view, blockLen, isLE } = this;\n    let { pos } = this;\n    // append the bit '1' to the message\n    buffer[pos++] = 0b10000000;\n    clean(this.buffer.subarray(pos));\n    // we have less than padOffset left in buffer, so we cannot put length in\n    // current block, need process it and pad again\n    if (this.padOffset > blockLen - pos) {\n      this.process(view, 0);\n      pos = 0;\n    }\n    // Pad until full block byte with zeros\n    for (let i = pos; i < blockLen; i++) buffer[i] = 0;\n    // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n    // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n    // So we just write lowest 64 bits of that value.\n    view.setBigUint64(blockLen - 8, BigInt(this.length * 8), isLE);\n    this.process(view, 0);\n    const oview = createView(out);\n    const len = this.outputLen;\n    // NOTE: we do division by 4 later, which must be fused in single op with modulo by JIT\n    if (len % 4) throw new Error('_sha2: outputLen must be aligned to 32bit');\n    const outLen = len / 4;\n    const state = this.get();\n    if (outLen > state.length) throw new Error('_sha2: outputLen bigger than state');\n    for (let i = 0; i < outLen; i++) oview.setUint32(4 * i, state[i], isLE);\n  }\n  digest(): Uint8Array {\n    const { buffer, outputLen } = this;\n    this.digestInto(buffer);\n    const res = buffer.slice(0, outputLen);\n    this.destroy();\n    return res;\n  }\n  _cloneInto(to?: T): T {\n    to ||= new (this.constructor as any)() as T;\n    to.set(...this.get());\n    const { blockLen, buffer, length, finished, destroyed, pos } = this;\n    to.destroyed = destroyed;\n    to.finished = finished;\n    to.length = length;\n    to.pos = pos;\n    if (length % blockLen) to.buffer.set(buffer);\n    return to as unknown as any;\n  }\n  clone(): T {\n    return this._cloneInto();\n  }\n}\n\n/**\n * Initial SHA-2 state: fractional parts of square roots of first 16 primes 2..53.\n * Check out `test/misc/sha2-gen-iv.js` for recomputation guide.\n */\n\n/** Initial SHA256 state. Bits 0..32 of frac part of sqrt of primes 2..19 */\nexport const SHA256_IV: Uint32Array = /* @__PURE__ */ Uint32Array.from([\n  0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19,\n]);\n\n/** Initial SHA224 state. Bits 32..64 of frac part of sqrt of primes 23..53 */\nexport const SHA224_IV: Uint32Array = /* @__PURE__ */ Uint32Array.from([\n  0xc1059ed8, 0x367cd507, 0x3070dd17, 0xf70e5939, 0xffc00b31, 0x68581511, 0x64f98fa7, 0xbefa4fa4,\n]);\n\n/** Initial SHA384 state. Bits 0..64 of frac part of sqrt of primes 23..53 */\nexport const SHA384_IV: Uint32Array = /* @__PURE__ */ Uint32Array.from([\n  0xcbbb9d5d, 0xc1059ed8, 0x629a292a, 0x367cd507, 0x9159015a, 0x3070dd17, 0x152fecd8, 0xf70e5939,\n  0x67332667, 0xffc00b31, 0x8eb44a87, 0x68581511, 0xdb0c2e0d, 0x64f98fa7, 0x47b5481d, 0xbefa4fa4,\n]);\n\n/** Initial SHA512 state. Bits 0..64 of frac part of sqrt of primes 2..19 */\nexport const SHA512_IV: Uint32Array = /* @__PURE__ */ Uint32Array.from([\n  0x6a09e667, 0xf3bcc908, 0xbb67ae85, 0x84caa73b, 0x3c6ef372, 0xfe94f82b, 0xa54ff53a, 0x5f1d36f1,\n  0x510e527f, 0xade682d1, 0x9b05688c, 0x2b3e6c1f, 0x1f83d9ab, 0xfb41bd6b, 0x5be0cd19, 0x137e2179,\n]);\n", "/**\n * Internal helpers for u64. BigUint64Array is too slow as per 2025, so we implement it using Uint32Array.\n * @todo re-check https://issues.chromium.org/issues/42212588\n * @module\n */\nconst U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);\nconst _32n = /* @__PURE__ */ BigInt(32);\n\nfunction fromBig(\n  n: bigint,\n  le = false\n): {\n  h: number;\n  l: number;\n} {\n  if (le) return { h: Number(n & U32_MASK64), l: Number((n >> _32n) & U32_MASK64) };\n  return { h: Number((n >> _32n) & U32_MASK64) | 0, l: Number(n & U32_MASK64) | 0 };\n}\n\nfunction split(lst: bigint[], le = false): Uint32Array[] {\n  const len = lst.length;\n  let Ah = new Uint32Array(len);\n  let Al = new Uint32Array(len);\n  for (let i = 0; i < len; i++) {\n    const { h, l } = fromBig(lst[i], le);\n    [Ah[i], Al[i]] = [h, l];\n  }\n  return [Ah, Al];\n}\n\nconst toBig = (h: number, l: number): bigint => (BigInt(h >>> 0) << _32n) | BigInt(l >>> 0);\n// for Shift in [0, 32)\nconst shrSH = (h: number, _l: number, s: number): number => h >>> s;\nconst shrSL = (h: number, l: number, s: number): number => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in [1, 32)\nconst rotrSH = (h: number, l: number, s: number): number => (h >>> s) | (l << (32 - s));\nconst rotrSL = (h: number, l: number, s: number): number => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotrBH = (h: number, l: number, s: number): number => (h << (64 - s)) | (l >>> (s - 32));\nconst rotrBL = (h: number, l: number, s: number): number => (h >>> (s - 32)) | (l << (64 - s));\n// Right rotate for shift===32 (just swaps l&h)\nconst rotr32H = (_h: number, l: number): number => l;\nconst rotr32L = (h: number, _l: number): number => h;\n// Left rotate for Shift in [1, 32)\nconst rotlSH = (h: number, l: number, s: number): number => (h << s) | (l >>> (32 - s));\nconst rotlSL = (h: number, l: number, s: number): number => (l << s) | (h >>> (32 - s));\n// Left rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotlBH = (h: number, l: number, s: number): number => (l << (s - 32)) | (h >>> (64 - s));\nconst rotlBL = (h: number, l: number, s: number): number => (h << (s - 32)) | (l >>> (64 - s));\n\n// JS uses 32-bit signed integers for bitwise operations which means we cannot\n// simple take carry out of low bit sum by shift, we need to use division.\nfunction add(\n  Ah: number,\n  Al: number,\n  Bh: number,\n  Bl: number\n): {\n  h: number;\n  l: number;\n} {\n  const l = (Al >>> 0) + (Bl >>> 0);\n  return { h: (Ah + Bh + ((l / 2 ** 32) | 0)) | 0, l: l | 0 };\n}\n// Addition with more than 2 elements\nconst add3L = (Al: number, Bl: number, Cl: number): number => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);\nconst add3H = (low: number, Ah: number, Bh: number, Ch: number): number =>\n  (Ah + Bh + Ch + ((low / 2 ** 32) | 0)) | 0;\nconst add4L = (Al: number, Bl: number, Cl: number, Dl: number): number =>\n  (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);\nconst add4H = (low: number, Ah: number, Bh: number, Ch: number, Dh: number): number =>\n  (Ah + Bh + Ch + Dh + ((low / 2 ** 32) | 0)) | 0;\nconst add5L = (Al: number, Bl: number, Cl: number, Dl: number, El: number): number =>\n  (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);\nconst add5H = (low: number, Ah: number, Bh: number, Ch: number, Dh: number, Eh: number): number =>\n  (Ah + Bh + Ch + Dh + Eh + ((low / 2 ** 32) | 0)) | 0;\n\n// prettier-ignore\nexport {\n  add, add3H, add3L, add4H, add4L, add5H, add5L, fromBig, rotlBH, rotlBL, rotlSH, rotlSL, rotr32H, rotr32L, rotrBH, rotrBL, rotrSH, rotrSL, shrSH, shrSL, split, toBig\n};\n// prettier-ignore\nconst u64: { fromBig: typeof fromBig; split: typeof split; toBig: (h: number, l: number) => bigint; shrSH: (h: number, _l: number, s: number) => number; shrSL: (h: number, l: number, s: number) => number; rotrSH: (h: number, l: number, s: number) => number; rotrSL: (h: number, l: number, s: number) => number; rotrBH: (h: number, l: number, s: number) => number; rotrBL: (h: number, l: number, s: number) => number; rotr32H: (_h: number, l: number) => number; rotr32L: (h: number, _l: number) => number; rotlSH: (h: number, l: number, s: number) => number; rotlSL: (h: number, l: number, s: number) => number; rotlBH: (h: number, l: number, s: number) => number; rotlBL: (h: number, l: number, s: number) => number; add: typeof add; add3L: (Al: number, Bl: number, Cl: number) => number; add3H: (low: number, Ah: number, Bh: number, Ch: number) => number; add4L: (Al: number, Bl: number, Cl: number, Dl: number) => number; add4H: (low: number, Ah: number, Bh: number, Ch: number, Dh: number) => number; add5H: (low: number, Ah: number, Bh: number, Ch: number, Dh: number, Eh: number) => number; add5L: (Al: number, Bl: number, Cl: number, Dl: number, El: number) => number; } = {\n  fromBig, split, toBig,\n  shrSH, shrSL,\n  rotrSH, rotrSL, rotrBH, rotrBL,\n  rotr32H, rotr32L,\n  rotlSH, rotlSL, rotlBH, rotlBL,\n  add, add3L, add3H, add4L, add4H, add5H, add5L,\n};\nexport default u64;\n", "/**\n * SHA2 hash function. A.k.a. sha256, sha384, sha512, sha512_224, sha512_256.\n * SHA256 is the fastest hash implementable in JS, even faster than Blake3.\n * Check out [RFC 4634](https://www.rfc-editor.org/rfc/rfc4634) and\n * [FIPS 180-4](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf).\n * @module\n */\nimport { Chi, HashMD, Maj, SHA224_IV, SHA256_IV, SHA384_IV, SHA512_IV } from './_md.ts';\nimport * as u64 from './_u64.ts';\nimport { type CHash, clean, createHasher, oidNist, rotr } from './utils.ts';\n\n/**\n * Round constants:\n * First 32 bits of fractional parts of the cube roots of the first 64 primes 2..311)\n */\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ Uint32Array.from([\n  0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n  0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n  0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n  0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n  0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n  0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n  0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n  0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n\n/** Reusable temporary buffer. \"W\" comes straight from spec. */\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\n\n/** Internal 32-byte base SHA2 hash class. */\nabstract class SHA2_32B<T extends SHA2_32B<T>> extends HashMD<T> {\n  // We cannot use array here since array allows indexing by variable\n  // which means optimizer/compiler cannot use registers.\n  protected abstract A: number;\n  protected abstract B: number;\n  protected abstract C: number;\n  protected abstract D: number;\n  protected abstract E: number;\n  protected abstract F: number;\n  protected abstract G: number;\n  protected abstract H: number;\n\n  constructor(outputLen: number) {\n    super(64, outputLen, 8, false);\n  }\n  protected get(): [number, number, number, number, number, number, number, number] {\n    const { A, B, C, D, E, F, G, H } = this;\n    return [A, B, C, D, E, F, G, H];\n  }\n  // prettier-ignore\n  protected set(\n    A: number, B: number, C: number, D: number, E: number, F: number, G: number, H: number\n  ): void {\n    this.A = A | 0;\n    this.B = B | 0;\n    this.C = C | 0;\n    this.D = D | 0;\n    this.E = E | 0;\n    this.F = F | 0;\n    this.G = G | 0;\n    this.H = H | 0;\n  }\n  protected process(view: DataView, offset: number): void {\n    // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n    for (let i = 0; i < 16; i++, offset += 4) SHA256_W[i] = view.getUint32(offset, false);\n    for (let i = 16; i < 64; i++) {\n      const W15 = SHA256_W[i - 15];\n      const W2 = SHA256_W[i - 2];\n      const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n      const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n      SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n    }\n    // Compression function main loop, 64 rounds\n    let { A, B, C, D, E, F, G, H } = this;\n    for (let i = 0; i < 64; i++) {\n      const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n      const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n      const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n      const T2 = (sigma0 + Maj(A, B, C)) | 0;\n      H = G;\n      G = F;\n      F = E;\n      E = (D + T1) | 0;\n      D = C;\n      C = B;\n      B = A;\n      A = (T1 + T2) | 0;\n    }\n    // Add the compressed chunk to the current hash value\n    A = (A + this.A) | 0;\n    B = (B + this.B) | 0;\n    C = (C + this.C) | 0;\n    D = (D + this.D) | 0;\n    E = (E + this.E) | 0;\n    F = (F + this.F) | 0;\n    G = (G + this.G) | 0;\n    H = (H + this.H) | 0;\n    this.set(A, B, C, D, E, F, G, H);\n  }\n  protected roundClean(): void {\n    clean(SHA256_W);\n  }\n  destroy(): void {\n    this.set(0, 0, 0, 0, 0, 0, 0, 0);\n    clean(this.buffer);\n  }\n}\n\n/** Internal SHA2-256 hash class. */\nexport class _SHA256 extends SHA2_32B<_SHA256> {\n  // We cannot use array here since array allows indexing by variable\n  // which means optimizer/compiler cannot use registers.\n  protected A: number = SHA256_IV[0] | 0;\n  protected B: number = SHA256_IV[1] | 0;\n  protected C: number = SHA256_IV[2] | 0;\n  protected D: number = SHA256_IV[3] | 0;\n  protected E: number = SHA256_IV[4] | 0;\n  protected F: number = SHA256_IV[5] | 0;\n  protected G: number = SHA256_IV[6] | 0;\n  protected H: number = SHA256_IV[7] | 0;\n  constructor() {\n    super(32);\n  }\n}\n\n/** Internal SHA2-224 hash class. */\nexport class _SHA224 extends SHA2_32B<_SHA224> {\n  protected A: number = SHA224_IV[0] | 0;\n  protected B: number = SHA224_IV[1] | 0;\n  protected C: number = SHA224_IV[2] | 0;\n  protected D: number = SHA224_IV[3] | 0;\n  protected E: number = SHA224_IV[4] | 0;\n  protected F: number = SHA224_IV[5] | 0;\n  protected G: number = SHA224_IV[6] | 0;\n  protected H: number = SHA224_IV[7] | 0;\n  constructor() {\n    super(28);\n  }\n}\n\n// SHA2-512 is slower than sha256 in js because u64 operations are slow.\n\n// Round contants\n// First 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409\n// prettier-ignore\nconst K512 = /* @__PURE__ */ (() => u64.split([\n  '0x428a2f98d728ae22', '0x7137449123ef65cd', '0xb5c0fbcfec4d3b2f', '0xe9b5dba58189dbbc',\n  '0x3956c25bf348b538', '0x59f111f1b605d019', '0x923f82a4af194f9b', '0xab1c5ed5da6d8118',\n  '0xd807aa98a3030242', '0x12835b0145706fbe', '0x243185be4ee4b28c', '0x550c7dc3d5ffb4e2',\n  '0x72be5d74f27b896f', '0x80deb1fe3b1696b1', '0x9bdc06a725c71235', '0xc19bf174cf692694',\n  '0xe49b69c19ef14ad2', '0xefbe4786384f25e3', '0x0fc19dc68b8cd5b5', '0x240ca1cc77ac9c65',\n  '0x2de92c6f592b0275', '0x4a7484aa6ea6e483', '0x5cb0a9dcbd41fbd4', '0x76f988da831153b5',\n  '0x983e5152ee66dfab', '0xa831c66d2db43210', '0xb00327c898fb213f', '0xbf597fc7beef0ee4',\n  '0xc6e00bf33da88fc2', '0xd5a79147930aa725', '0x06ca6351e003826f', '0x142929670a0e6e70',\n  '0x27b70a8546d22ffc', '0x2e1b21385c26c926', '0x4d2c6dfc5ac42aed', '0x53380d139d95b3df',\n  '0x650a73548baf63de', '0x766a0abb3c77b2a8', '0x81c2c92e47edaee6', '0x92722c851482353b',\n  '0xa2bfe8a14cf10364', '0xa81a664bbc423001', '0xc24b8b70d0f89791', '0xc76c51a30654be30',\n  '0xd192e819d6ef5218', '0xd69906245565a910', '0xf40e35855771202a', '0x106aa07032bbd1b8',\n  '0x19a4c116b8d2d0c8', '0x1e376c085141ab53', '0x2748774cdf8eeb99', '0x34b0bcb5e19b48a8',\n  '0x391c0cb3c5c95a63', '0x4ed8aa4ae3418acb', '0x5b9cca4f7763e373', '0x682e6ff3d6b2b8a3',\n  '0x748f82ee5defb2fc', '0x78a5636f43172f60', '0x84c87814a1f0ab72', '0x8cc702081a6439ec',\n  '0x90befffa23631e28', '0xa4506cebde82bde9', '0xbef9a3f7b2c67915', '0xc67178f2e372532b',\n  '0xca273eceea26619c', '0xd186b8c721c0c207', '0xeada7dd6cde0eb1e', '0xf57d4f7fee6ed178',\n  '0x06f067aa72176fba', '0x0a637dc5a2c898a6', '0x113f9804bef90dae', '0x1b710b35131c471b',\n  '0x28db77f523047d84', '0x32caab7b40c72493', '0x3c9ebe0a15c9bebc', '0x431d67c49c100d4c',\n  '0x4cc5d4becb3e42b6', '0x597f299cfc657e2a', '0x5fcb6fab3ad6faec', '0x6c44198c4a475817'\n].map(n => BigInt(n))))();\nconst SHA512_Kh = /* @__PURE__ */ (() => K512[0])();\nconst SHA512_Kl = /* @__PURE__ */ (() => K512[1])();\n\n// Reusable temporary buffers\nconst SHA512_W_H = /* @__PURE__ */ new Uint32Array(80);\nconst SHA512_W_L = /* @__PURE__ */ new Uint32Array(80);\n\n/** Internal 64-byte base SHA2 hash class. */\nabstract class SHA2_64B<T extends SHA2_64B<T>> extends HashMD<T> {\n  // We cannot use array here since array allows indexing by variable\n  // which means optimizer/compiler cannot use registers.\n  // h -- high 32 bits, l -- low 32 bits\n  protected abstract Ah: number;\n  protected abstract Al: number;\n  protected abstract Bh: number;\n  protected abstract Bl: number;\n  protected abstract Ch: number;\n  protected abstract Cl: number;\n  protected abstract Dh: number;\n  protected abstract Dl: number;\n  protected abstract Eh: number;\n  protected abstract El: number;\n  protected abstract Fh: number;\n  protected abstract Fl: number;\n  protected abstract Gh: number;\n  protected abstract Gl: number;\n  protected abstract Hh: number;\n  protected abstract Hl: number;\n\n  constructor(outputLen: number) {\n    super(128, outputLen, 16, false);\n  }\n  // prettier-ignore\n  protected get(): [\n    number, number, number, number, number, number, number, number,\n    number, number, number, number, number, number, number, number\n  ] {\n    const { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n    return [Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl];\n  }\n  // prettier-ignore\n  protected set(\n    Ah: number, Al: number, Bh: number, Bl: number, Ch: number, Cl: number, Dh: number, Dl: number,\n    Eh: number, El: number, Fh: number, Fl: number, Gh: number, Gl: number, Hh: number, Hl: number\n  ): void {\n    this.Ah = Ah | 0;\n    this.Al = Al | 0;\n    this.Bh = Bh | 0;\n    this.Bl = Bl | 0;\n    this.Ch = Ch | 0;\n    this.Cl = Cl | 0;\n    this.Dh = Dh | 0;\n    this.Dl = Dl | 0;\n    this.Eh = Eh | 0;\n    this.El = El | 0;\n    this.Fh = Fh | 0;\n    this.Fl = Fl | 0;\n    this.Gh = Gh | 0;\n    this.Gl = Gl | 0;\n    this.Hh = Hh | 0;\n    this.Hl = Hl | 0;\n  }\n  protected process(view: DataView, offset: number): void {\n    // Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array\n    for (let i = 0; i < 16; i++, offset += 4) {\n      SHA512_W_H[i] = view.getUint32(offset);\n      SHA512_W_L[i] = view.getUint32((offset += 4));\n    }\n    for (let i = 16; i < 80; i++) {\n      // s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)\n      const W15h = SHA512_W_H[i - 15] | 0;\n      const W15l = SHA512_W_L[i - 15] | 0;\n      const s0h = u64.rotrSH(W15h, W15l, 1) ^ u64.rotrSH(W15h, W15l, 8) ^ u64.shrSH(W15h, W15l, 7);\n      const s0l = u64.rotrSL(W15h, W15l, 1) ^ u64.rotrSL(W15h, W15l, 8) ^ u64.shrSL(W15h, W15l, 7);\n      // s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)\n      const W2h = SHA512_W_H[i - 2] | 0;\n      const W2l = SHA512_W_L[i - 2] | 0;\n      const s1h = u64.rotrSH(W2h, W2l, 19) ^ u64.rotrBH(W2h, W2l, 61) ^ u64.shrSH(W2h, W2l, 6);\n      const s1l = u64.rotrSL(W2h, W2l, 19) ^ u64.rotrBL(W2h, W2l, 61) ^ u64.shrSL(W2h, W2l, 6);\n      // SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];\n      const SUMl = u64.add4L(s0l, s1l, SHA512_W_L[i - 7], SHA512_W_L[i - 16]);\n      const SUMh = u64.add4H(SUMl, s0h, s1h, SHA512_W_H[i - 7], SHA512_W_H[i - 16]);\n      SHA512_W_H[i] = SUMh | 0;\n      SHA512_W_L[i] = SUMl | 0;\n    }\n    let { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n    // Compression function main loop, 80 rounds\n    for (let i = 0; i < 80; i++) {\n      // S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)\n      const sigma1h = u64.rotrSH(Eh, El, 14) ^ u64.rotrSH(Eh, El, 18) ^ u64.rotrBH(Eh, El, 41);\n      const sigma1l = u64.rotrSL(Eh, El, 14) ^ u64.rotrSL(Eh, El, 18) ^ u64.rotrBL(Eh, El, 41);\n      //const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n      const CHIh = (Eh & Fh) ^ (~Eh & Gh);\n      const CHIl = (El & Fl) ^ (~El & Gl);\n      // T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]\n      // prettier-ignore\n      const T1ll = u64.add5L(Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);\n      const T1h = u64.add5H(T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);\n      const T1l = T1ll | 0;\n      // S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)\n      const sigma0h = u64.rotrSH(Ah, Al, 28) ^ u64.rotrBH(Ah, Al, 34) ^ u64.rotrBH(Ah, Al, 39);\n      const sigma0l = u64.rotrSL(Ah, Al, 28) ^ u64.rotrBL(Ah, Al, 34) ^ u64.rotrBL(Ah, Al, 39);\n      const MAJh = (Ah & Bh) ^ (Ah & Ch) ^ (Bh & Ch);\n      const MAJl = (Al & Bl) ^ (Al & Cl) ^ (Bl & Cl);\n      Hh = Gh | 0;\n      Hl = Gl | 0;\n      Gh = Fh | 0;\n      Gl = Fl | 0;\n      Fh = Eh | 0;\n      Fl = El | 0;\n      ({ h: Eh, l: El } = u64.add(Dh | 0, Dl | 0, T1h | 0, T1l | 0));\n      Dh = Ch | 0;\n      Dl = Cl | 0;\n      Ch = Bh | 0;\n      Cl = Bl | 0;\n      Bh = Ah | 0;\n      Bl = Al | 0;\n      const All = u64.add3L(T1l, sigma0l, MAJl);\n      Ah = u64.add3H(All, T1h, sigma0h, MAJh);\n      Al = All | 0;\n    }\n    // Add the compressed chunk to the current hash value\n    ({ h: Ah, l: Al } = u64.add(this.Ah | 0, this.Al | 0, Ah | 0, Al | 0));\n    ({ h: Bh, l: Bl } = u64.add(this.Bh | 0, this.Bl | 0, Bh | 0, Bl | 0));\n    ({ h: Ch, l: Cl } = u64.add(this.Ch | 0, this.Cl | 0, Ch | 0, Cl | 0));\n    ({ h: Dh, l: Dl } = u64.add(this.Dh | 0, this.Dl | 0, Dh | 0, Dl | 0));\n    ({ h: Eh, l: El } = u64.add(this.Eh | 0, this.El | 0, Eh | 0, El | 0));\n    ({ h: Fh, l: Fl } = u64.add(this.Fh | 0, this.Fl | 0, Fh | 0, Fl | 0));\n    ({ h: Gh, l: Gl } = u64.add(this.Gh | 0, this.Gl | 0, Gh | 0, Gl | 0));\n    ({ h: Hh, l: Hl } = u64.add(this.Hh | 0, this.Hl | 0, Hh | 0, Hl | 0));\n    this.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);\n  }\n  protected roundClean(): void {\n    clean(SHA512_W_H, SHA512_W_L);\n  }\n  destroy(): void {\n    clean(this.buffer);\n    this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\n  }\n}\n\n/** Internal SHA2-512 hash class. */\nexport class _SHA512 extends SHA2_64B<_SHA512> {\n  protected Ah: number = SHA512_IV[0] | 0;\n  protected Al: number = SHA512_IV[1] | 0;\n  protected Bh: number = SHA512_IV[2] | 0;\n  protected Bl: number = SHA512_IV[3] | 0;\n  protected Ch: number = SHA512_IV[4] | 0;\n  protected Cl: number = SHA512_IV[5] | 0;\n  protected Dh: number = SHA512_IV[6] | 0;\n  protected Dl: number = SHA512_IV[7] | 0;\n  protected Eh: number = SHA512_IV[8] | 0;\n  protected El: number = SHA512_IV[9] | 0;\n  protected Fh: number = SHA512_IV[10] | 0;\n  protected Fl: number = SHA512_IV[11] | 0;\n  protected Gh: number = SHA512_IV[12] | 0;\n  protected Gl: number = SHA512_IV[13] | 0;\n  protected Hh: number = SHA512_IV[14] | 0;\n  protected Hl: number = SHA512_IV[15] | 0;\n\n  constructor() {\n    super(64);\n  }\n}\n\n/** Internal SHA2-384 hash class. */\nexport class _SHA384 extends SHA2_64B<_SHA384> {\n  protected Ah: number = SHA384_IV[0] | 0;\n  protected Al: number = SHA384_IV[1] | 0;\n  protected Bh: number = SHA384_IV[2] | 0;\n  protected Bl: number = SHA384_IV[3] | 0;\n  protected Ch: number = SHA384_IV[4] | 0;\n  protected Cl: number = SHA384_IV[5] | 0;\n  protected Dh: number = SHA384_IV[6] | 0;\n  protected Dl: number = SHA384_IV[7] | 0;\n  protected Eh: number = SHA384_IV[8] | 0;\n  protected El: number = SHA384_IV[9] | 0;\n  protected Fh: number = SHA384_IV[10] | 0;\n  protected Fl: number = SHA384_IV[11] | 0;\n  protected Gh: number = SHA384_IV[12] | 0;\n  protected Gl: number = SHA384_IV[13] | 0;\n  protected Hh: number = SHA384_IV[14] | 0;\n  protected Hl: number = SHA384_IV[15] | 0;\n\n  constructor() {\n    super(48);\n  }\n}\n\n/**\n * Truncated SHA512/256 and SHA512/224.\n * SHA512_IV is XORed with 0xa5a5a5a5a5a5a5a5, then used as \"intermediary\" IV of SHA512/t.\n * Then t hashes string to produce result IV.\n * See `test/misc/sha2-gen-iv.js`.\n */\n\n/** SHA512/224 IV */\nconst T224_IV = /* @__PURE__ */ Uint32Array.from([\n  0x8c3d37c8, 0x19544da2, 0x73e19966, 0x89dcd4d6, 0x1dfab7ae, 0x32ff9c82, 0x679dd514, 0x582f9fcf,\n  0x0f6d2b69, 0x7bd44da8, 0x77e36f73, 0x04c48942, 0x3f9d85a8, 0x6a1d36c8, 0x1112e6ad, 0x91d692a1,\n]);\n\n/** SHA512/256 IV */\nconst T256_IV = /* @__PURE__ */ Uint32Array.from([\n  0x22312194, 0xfc2bf72c, 0x9f555fa3, 0xc84c64c2, 0x2393b86b, 0x6f53b151, 0x96387719, 0x5940eabd,\n  0x96283ee2, 0xa88effe3, 0xbe5e1e25, 0x53863992, 0x2b0199fc, 0x2c85b8aa, 0x0eb72ddc, 0x81c52ca2,\n]);\n\n/** Internal SHA2-512/224 hash class. */\nexport class _SHA512_224 extends SHA2_64B<_SHA512_224> {\n  protected Ah: number = T224_IV[0] | 0;\n  protected Al: number = T224_IV[1] | 0;\n  protected Bh: number = T224_IV[2] | 0;\n  protected Bl: number = T224_IV[3] | 0;\n  protected Ch: number = T224_IV[4] | 0;\n  protected Cl: number = T224_IV[5] | 0;\n  protected Dh: number = T224_IV[6] | 0;\n  protected Dl: number = T224_IV[7] | 0;\n  protected Eh: number = T224_IV[8] | 0;\n  protected El: number = T224_IV[9] | 0;\n  protected Fh: number = T224_IV[10] | 0;\n  protected Fl: number = T224_IV[11] | 0;\n  protected Gh: number = T224_IV[12] | 0;\n  protected Gl: number = T224_IV[13] | 0;\n  protected Hh: number = T224_IV[14] | 0;\n  protected Hl: number = T224_IV[15] | 0;\n\n  constructor() {\n    super(28);\n  }\n}\n\n/** Internal SHA2-512/256 hash class. */\nexport class _SHA512_256 extends SHA2_64B<_SHA512_256> {\n  protected Ah: number = T256_IV[0] | 0;\n  protected Al: number = T256_IV[1] | 0;\n  protected Bh: number = T256_IV[2] | 0;\n  protected Bl: number = T256_IV[3] | 0;\n  protected Ch: number = T256_IV[4] | 0;\n  protected Cl: number = T256_IV[5] | 0;\n  protected Dh: number = T256_IV[6] | 0;\n  protected Dl: number = T256_IV[7] | 0;\n  protected Eh: number = T256_IV[8] | 0;\n  protected El: number = T256_IV[9] | 0;\n  protected Fh: number = T256_IV[10] | 0;\n  protected Fl: number = T256_IV[11] | 0;\n  protected Gh: number = T256_IV[12] | 0;\n  protected Gl: number = T256_IV[13] | 0;\n  protected Hh: number = T256_IV[14] | 0;\n  protected Hl: number = T256_IV[15] | 0;\n\n  constructor() {\n    super(32);\n  }\n}\n\n/**\n * SHA2-256 hash function from RFC 4634. In JS it's the fastest: even faster than Blake3. Some info:\n *\n * - Trying 2^128 hashes would get 50% chance of collision, using birthday attack.\n * - BTC network is doing 2^70 hashes/sec (2^95 hashes/year) as per 2025.\n * - Each sha256 hash is executing 2^18 bit operations.\n * - Good 2024 ASICs can do 200Th/sec with 3500 watts of power, corresponding to 2^36 hashes/joule.\n */\nexport const sha256: CHash<_SHA256> = /* @__PURE__ */ createHasher(\n  () => new _SHA256(),\n  /* @__PURE__ */ oidNist(0x01)\n);\n/** SHA2-224 hash function from RFC 4634 */\nexport const sha224: CHash<_SHA224> = /* @__PURE__ */ createHasher(\n  () => new _SHA224(),\n  /* @__PURE__ */ oidNist(0x04)\n);\n\n/** SHA2-512 hash function from RFC 4634. */\nexport const sha512: CHash<_SHA512> = /* @__PURE__ */ createHasher(\n  () => new _SHA512(),\n  /* @__PURE__ */ oidNist(0x03)\n);\n/** SHA2-384 hash function from RFC 4634. */\nexport const sha384: CHash<_SHA384> = /* @__PURE__ */ createHasher(\n  () => new _SHA384(),\n  /* @__PURE__ */ oidNist(0x02)\n);\n\n/**\n * SHA2-512/256 \"truncated\" hash function, with improved resistance to length extension attacks.\n * See the paper on [truncated SHA512](https://eprint.iacr.org/2010/548.pdf).\n */\nexport const sha512_256: CHash<_SHA512_256> = /* @__PURE__ */ createHasher(\n  () => new _SHA512_256(),\n  /* @__PURE__ */ oidNist(0x06)\n);\n/**\n * SHA2-512/224 \"truncated\" hash function, with improved resistance to length extension attacks.\n * See the paper on [truncated SHA512](https://eprint.iacr.org/2010/548.pdf).\n */\nexport const sha512_224: CHash<_SHA512_224> = /* @__PURE__ */ createHasher(\n  () => new _SHA512_224(),\n  /* @__PURE__ */ oidNist(0x05)\n);\n", "/**\n * Hex, bytes and number utilities.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport {\n  abytes as abytes_,\n  anumber,\n  bytesToHex as bytesToHex_,\n  concatBytes as concatBytes_,\n  hexToBytes as hexToBytes_,\n} from '@noble/hashes/utils.js';\nexport {\n  abytes,\n  anumber,\n  bytesToHex,\n  concatBytes,\n  hexToBytes,\n  isBytes,\n  randomBytes,\n} from '@noble/hashes/utils.js';\nconst _0n = /* @__PURE__ */ BigInt(0);\nconst _1n = /* @__PURE__ */ BigInt(1);\n\nexport type CHash = {\n  (message: Uint8Array): Uint8Array;\n  blockLen: number;\n  outputLen: number;\n  create(opts?: { dkLen?: number }): any; // For shake\n};\nexport type FHash = (message: Uint8Array) => Uint8Array;\nexport function abool(value: boolean, title: string = ''): boolean {\n  if (typeof value !== 'boolean') {\n    const prefix = title && `\"${title}\" `;\n    throw new Error(prefix + 'expected boolean, got type=' + typeof value);\n  }\n  return value;\n}\n\n// Used in weierstrass, der\nfunction abignumber(n: number | bigint) {\n  if (typeof n === 'bigint') {\n    if (!isPosBig(n)) throw new Error('positive bigint expected, got ' + n);\n  } else anumber(n);\n  return n;\n}\n\nexport function asafenumber(value: number, title: string = ''): void {\n  if (!Number.isSafeInteger(value)) {\n    const prefix = title && `\"${title}\" `;\n    throw new Error(prefix + 'expected safe integer, got type=' + typeof value);\n  }\n}\n\nexport function numberToHexUnpadded(num: number | bigint): string {\n  const hex = abignumber(num).toString(16);\n  return hex.length & 1 ? '0' + hex : hex;\n}\n\nexport function hexToNumber(hex: string): bigint {\n  if (typeof hex !== 'string') throw new Error('hex string expected, got ' + typeof hex);\n  return hex === '' ? _0n : BigInt('0x' + hex); // Big Endian\n}\n\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes: Uint8Array): bigint {\n  return hexToNumber(bytesToHex_(bytes));\n}\nexport function bytesToNumberLE(bytes: Uint8Array): bigint {\n  return hexToNumber(bytesToHex_(copyBytes(abytes_(bytes)).reverse()));\n}\n\nexport function numberToBytesBE(n: number | bigint, len: number): Uint8Array {\n  anumber(len);\n  n = abignumber(n);\n  const res = hexToBytes_(n.toString(16).padStart(len * 2, '0'));\n  if (res.length !== len) throw new Error('number too large');\n  return res;\n}\nexport function numberToBytesLE(n: number | bigint, len: number): Uint8Array {\n  return numberToBytesBE(n, len).reverse();\n}\n// Unpadded, rarely used\nexport function numberToVarBytesBE(n: number | bigint): Uint8Array {\n  return hexToBytes_(numberToHexUnpadded(abignumber(n)));\n}\n\n// Compares 2 u8a-s in kinda constant time\nexport function equalBytes(a: Uint8Array, b: Uint8Array): boolean {\n  if (a.length !== b.length) return false;\n  let diff = 0;\n  for (let i = 0; i < a.length; i++) diff |= a[i] ^ b[i];\n  return diff === 0;\n}\n\n/**\n * Copies Uint8Array. We can't use u8a.slice(), because u8a can be Buffer,\n * and Buffer#slice creates mutable copy. Never use Buffers!\n */\nexport function copyBytes(bytes: Uint8Array): Uint8Array {\n  return Uint8Array.from(bytes);\n}\n\n/**\n * Decodes 7-bit ASCII string to Uint8Array, throws on non-ascii symbols\n * Should be safe to use for things expected to be ASCII.\n * Returns exact same result as `TextEncoder` for ASCII or throws.\n */\nexport function asciiToBytes(ascii: string): Uint8Array {\n  return Uint8Array.from(ascii, (c, i) => {\n    const charCode = c.charCodeAt(0);\n    if (c.length !== 1 || charCode > 127) {\n      throw new Error(\n        `string contains non-ASCII character \"${ascii[i]}\" with code ${charCode} at position ${i}`\n      );\n    }\n    return charCode;\n  });\n}\n\n// Is positive bigint\nconst isPosBig = (n: bigint) => typeof n === 'bigint' && _0n <= n;\n\nexport function inRange(n: bigint, min: bigint, max: bigint): boolean {\n  return isPosBig(n) && isPosBig(min) && isPosBig(max) && min <= n && n < max;\n}\n\n/**\n * Asserts min <= n < max. NOTE: It's < max and not <= max.\n * @example\n * aInRange('x', x, 1n, 256n); // would assume x is in (1n..255n)\n */\nexport function aInRange(title: string, n: bigint, min: bigint, max: bigint): void {\n  // Why min <= n < max and not a (min < n < max) OR b (min <= n <= max)?\n  // consider P=256n, min=0n, max=P\n  // - a for min=0 would require -1:          `inRange('x', x, -1n, P)`\n  // - b would commonly require subtraction:  `inRange('x', x, 0n, P - 1n)`\n  // - our way is the cleanest:               `inRange('x', x, 0n, P)\n  if (!inRange(n, min, max))\n    throw new Error('expected valid ' + title + ': ' + min + ' <= n < ' + max + ', got ' + n);\n}\n\n// Bit operations\n\n/**\n * Calculates amount of bits in a bigint.\n * Same as `n.toString(2).length`\n * TODO: merge with nLength in modular\n */\nexport function bitLen(n: bigint): number {\n  let len;\n  for (len = 0; n > _0n; n >>= _1n, len += 1);\n  return len;\n}\n\n/**\n * Gets single bit at position.\n * NOTE: first bit position is 0 (same as arrays)\n * Same as `!!+Array.from(n.toString(2)).reverse()[pos]`\n */\nexport function bitGet(n: bigint, pos: number): bigint {\n  return (n >> BigInt(pos)) & _1n;\n}\n\n/**\n * Sets single bit at position.\n */\nexport function bitSet(n: bigint, pos: number, value: boolean): bigint {\n  return n | ((value ? _1n : _0n) << BigInt(pos));\n}\n\n/**\n * Calculate mask for N bits. Not using ** operator with bigints because of old engines.\n * Same as BigInt(`0b${Array(i).fill('1').join('')}`)\n */\nexport const bitMask = (n: number): bigint => (_1n << BigInt(n)) - _1n;\n\n// DRBG\n\ntype Pred<T> = (v: Uint8Array) => T | undefined;\n/**\n * Minimal HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n * @returns function that will call DRBG until 2nd arg returns something meaningful\n * @example\n *   const drbg = createHmacDRBG<Key>(32, 32, hmac);\n *   drbg(seed, bytesToKey); // bytesToKey must return Key or undefined\n */\nexport function createHmacDrbg<T>(\n  hashLen: number,\n  qByteLen: number,\n  hmacFn: (key: Uint8Array, message: Uint8Array) => Uint8Array\n): (seed: Uint8Array, predicate: Pred<T>) => T {\n  anumber(hashLen, 'hashLen');\n  anumber(qByteLen, 'qByteLen');\n  if (typeof hmacFn !== 'function') throw new Error('hmacFn must be a function');\n  const u8n = (len: number): Uint8Array => new Uint8Array(len); // creates Uint8Array\n  const NULL = Uint8Array.of();\n  const byte0 = Uint8Array.of(0x00);\n  const byte1 = Uint8Array.of(0x01);\n  const _maxDrbgIters = 1000;\n\n  // Step B, Step C: set hashLen to 8*ceil(hlen/8)\n  let v = u8n(hashLen); // Minimal non-full-spec HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n  let k = u8n(hashLen); // Steps B and C of RFC6979 3.2: set hashLen, in our case always same\n  let i = 0; // Iterations counter, will throw when over 1000\n  const reset = () => {\n    v.fill(1);\n    k.fill(0);\n    i = 0;\n  };\n  const h = (...msgs: Uint8Array[]) => hmacFn(k, concatBytes_(v, ...msgs)); // hmac(k)(v, ...values)\n  const reseed = (seed: Uint8Array = NULL) => {\n    // HMAC-DRBG reseed() function. Steps D-G\n    k = h(byte0, seed); // k = hmac(k || v || 0x00 || seed)\n    v = h(); // v = hmac(k || v)\n    if (seed.length === 0) return;\n    k = h(byte1, seed); // k = hmac(k || v || 0x01 || seed)\n    v = h(); // v = hmac(k || v)\n  };\n  const gen = () => {\n    // HMAC-DRBG generate() function\n    if (i++ >= _maxDrbgIters) throw new Error('drbg: tried max amount of iterations');\n    let len = 0;\n    const out: Uint8Array[] = [];\n    while (len < qByteLen) {\n      v = h();\n      const sl = v.slice();\n      out.push(sl);\n      len += v.length;\n    }\n    return concatBytes_(...out);\n  };\n  const genUntil = (seed: Uint8Array, pred: Pred<T>): T => {\n    reset();\n    reseed(seed); // Steps D-G\n    let res: T | undefined = undefined; // Step H: grind until k is in [1..n-1]\n    while (!(res = pred(gen()))) reseed();\n    reset();\n    return res;\n  };\n  return genUntil;\n}\n\nexport function validateObject(\n  object: Record<string, any>,\n  fields: Record<string, string> = {},\n  optFields: Record<string, string> = {}\n): void {\n  if (!object || typeof object !== 'object') throw new Error('expected valid options object');\n  type Item = keyof typeof object;\n  function checkField(fieldName: Item, expectedType: string, isOpt: boolean) {\n    const val = object[fieldName];\n    if (isOpt && val === undefined) return;\n    const current = typeof val;\n    if (current !== expectedType || val === null)\n      throw new Error(`param \"${fieldName}\" is invalid: expected ${expectedType}, got ${current}`);\n  }\n  const iter = (f: typeof fields, isOpt: boolean) =>\n    Object.entries(f).forEach(([k, v]) => checkField(k, v, isOpt));\n  iter(fields, false);\n  iter(optFields, true);\n}\n\n/**\n * throws not implemented error\n */\nexport const notImplemented = (): never => {\n  throw new Error('not implemented');\n};\n\n/**\n * Memoizes (caches) computation result.\n * Uses WeakMap: the value is going auto-cleaned by GC after last reference is removed.\n */\nexport function memoized<T extends object, R, O extends any[]>(\n  fn: (arg: T, ...args: O) => R\n): (arg: T, ...args: O) => R {\n  const map = new WeakMap<T, R>();\n  return (arg: T, ...args: O): R => {\n    const val = map.get(arg);\n    if (val !== undefined) return val;\n    const computed = fn(arg, ...args);\n    map.set(arg, computed);\n    return computed;\n  };\n}\n\nexport interface CryptoKeys {\n  lengths: { seed?: number; public?: number; secret?: number };\n  keygen: (seed?: Uint8Array) => { secretKey: Uint8Array; publicKey: Uint8Array };\n  getPublicKey: (secretKey: Uint8Array) => Uint8Array;\n}\n\n/** Generic interface for signatures. Has keygen, sign and verify. */\nexport interface Signer extends CryptoKeys {\n  // Interfaces are fun. We cannot just add new fields without copying old ones.\n  lengths: {\n    seed?: number;\n    public?: number;\n    secret?: number;\n    signRand?: number;\n    signature?: number;\n  };\n  sign: (msg: Uint8Array, secretKey: Uint8Array) => Uint8Array;\n  verify: (sig: Uint8Array, msg: Uint8Array, publicKey: Uint8Array) => boolean;\n}\n", "/**\n * Utils for modular division and fields.\n * Field over 11 is a finite (Galois) field is integer number operations `mod 11`.\n * There is no division: it is replaced by modular multiplicative inverse.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport {\n  abytes,\n  anumber,\n  bytesToNumberBE,\n  bytesToNumberLE,\n  numberToBytesBE,\n  numberToBytesLE,\n  validateObject,\n} from '../utils.ts';\n\n// Numbers aren't used in x25519 / x448 builds\n// prettier-ignore\nconst _0n = /* @__PURE__ */ BigInt(0), _1n = /* @__PURE__ */ BigInt(1), _2n = /* @__PURE__ */ BigInt(2);\n// prettier-ignore\nconst _3n = /* @__PURE__ */ BigInt(3), _4n = /* @__PURE__ */ BigInt(4), _5n = /* @__PURE__ */ BigInt(5);\n// prettier-ignore\nconst _7n = /* @__PURE__ */ BigInt(7), _8n = /* @__PURE__ */ BigInt(8), _9n = /* @__PURE__ */ BigInt(9);\nconst _16n = /* @__PURE__ */ BigInt(16);\n\n// Calculates a modulo b\nexport function mod(a: bigint, b: bigint): bigint {\n  const result = a % b;\n  return result >= _0n ? result : b + result;\n}\n/**\n * Efficiently raise num to power and do modular division.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n * @example\n * pow(2n, 6n, 11n) // 64n % 11n == 9n\n */\nexport function pow(num: bigint, power: bigint, modulo: bigint): bigint {\n  return FpPow(Field(modulo), num, power);\n}\n\n/** Does `x^(2^power)` mod p. `pow2(30, 4)` == `30^(2^4)` */\nexport function pow2(x: bigint, power: bigint, modulo: bigint): bigint {\n  let res = x;\n  while (power-- > _0n) {\n    res *= res;\n    res %= modulo;\n  }\n  return res;\n}\n\n/**\n * Inverses number over modulo.\n * Implemented using [Euclidean GCD](https://brilliant.org/wiki/extended-euclidean-algorithm/).\n */\nexport function invert(number: bigint, modulo: bigint): bigint {\n  if (number === _0n) throw new Error('invert: expected non-zero number');\n  if (modulo <= _0n) throw new Error('invert: expected positive modulus, got ' + modulo);\n  // Fermat's little theorem \"CT-like\" version inv(n) = n^(m-2) mod m is 30x slower.\n  let a = mod(number, modulo);\n  let b = modulo;\n  // prettier-ignore\n  let x = _0n, y = _1n, u = _1n, v = _0n;\n  while (a !== _0n) {\n    // JIT applies optimization if those two lines follow each other\n    const q = b / a;\n    const r = b % a;\n    const m = x - u * q;\n    const n = y - v * q;\n    // prettier-ignore\n    b = a, a = r, x = u, y = v, u = m, v = n;\n  }\n  const gcd = b;\n  if (gcd !== _1n) throw new Error('invert: does not exist');\n  return mod(x, modulo);\n}\n\nfunction assertIsSquare<T>(Fp: IField<T>, root: T, n: T): void {\n  if (!Fp.eql(Fp.sqr(root), n)) throw new Error('Cannot find square root');\n}\n\n// Not all roots are possible! Example which will throw:\n// const NUM =\n// n = 72057594037927816n;\n// Fp = Field(BigInt('0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab'));\nfunction sqrt3mod4<T>(Fp: IField<T>, n: T) {\n  const p1div4 = (Fp.ORDER + _1n) / _4n;\n  const root = Fp.pow(n, p1div4);\n  assertIsSquare(Fp, root, n);\n  return root;\n}\n\nfunction sqrt5mod8<T>(Fp: IField<T>, n: T) {\n  const p5div8 = (Fp.ORDER - _5n) / _8n;\n  const n2 = Fp.mul(n, _2n);\n  const v = Fp.pow(n2, p5div8);\n  const nv = Fp.mul(n, v);\n  const i = Fp.mul(Fp.mul(nv, _2n), v);\n  const root = Fp.mul(nv, Fp.sub(i, Fp.ONE));\n  assertIsSquare(Fp, root, n);\n  return root;\n}\n\n// Based on RFC9380, Kong algorithm\n// prettier-ignore\nfunction sqrt9mod16(P: bigint): <T>(Fp: IField<T>, n: T) => T {\n  const Fp_ = Field(P);\n  const tn = tonelliShanks(P);\n  const c1 = tn(Fp_, Fp_.neg(Fp_.ONE));//  1. c1 = sqrt(-1) in F, i.e., (c1^2) == -1 in F\n  const c2 = tn(Fp_, c1);              //  2. c2 = sqrt(c1) in F, i.e., (c2^2) == c1 in F\n  const c3 = tn(Fp_, Fp_.neg(c1));     //  3. c3 = sqrt(-c1) in F, i.e., (c3^2) == -c1 in F\n  const c4 = (P + _7n) / _16n;         //  4. c4 = (q + 7) / 16        # Integer arithmetic\n  return <T>(Fp: IField<T>, n: T) => {\n    let tv1 = Fp.pow(n, c4);           //  1. tv1 = x^c4\n    let tv2 = Fp.mul(tv1, c1);         //  2. tv2 = c1 * tv1\n    const tv3 = Fp.mul(tv1, c2);       //  3. tv3 = c2 * tv1\n    const tv4 = Fp.mul(tv1, c3);       //  4. tv4 = c3 * tv1\n    const e1 = Fp.eql(Fp.sqr(tv2), n); //  5.  e1 = (tv2^2) == x\n    const e2 = Fp.eql(Fp.sqr(tv3), n); //  6.  e2 = (tv3^2) == x\n    tv1 = Fp.cmov(tv1, tv2, e1);       //  7. tv1 = CMOV(tv1, tv2, e1)  # Select tv2 if (tv2^2) == x\n    tv2 = Fp.cmov(tv4, tv3, e2);       //  8. tv2 = CMOV(tv4, tv3, e2)  # Select tv3 if (tv3^2) == x\n    const e3 = Fp.eql(Fp.sqr(tv2), n); //  9.  e3 = (tv2^2) == x\n    const root = Fp.cmov(tv1, tv2, e3);// 10.  z = CMOV(tv1, tv2, e3)   # Select sqrt from tv1 & tv2\n    assertIsSquare(Fp, root, n);\n    return root;\n  };\n}\n\n/**\n * Tonelli-Shanks square root search algorithm.\n * 1. https://eprint.iacr.org/2012/685.pdf (page 12)\n * 2. Square Roots from 1; 24, 51, 10 to Dan Shanks\n * @param P field order\n * @returns function that takes field Fp (created from P) and number n\n */\nexport function tonelliShanks(P: bigint): <T>(Fp: IField<T>, n: T) => T {\n  // Initialization (precomputation).\n  // Caching initialization could boost perf by 7%.\n  if (P < _3n) throw new Error('sqrt is not defined for small field');\n  // Factor P - 1 = Q * 2^S, where Q is odd\n  let Q = P - _1n;\n  let S = 0;\n  while (Q % _2n === _0n) {\n    Q /= _2n;\n    S++;\n  }\n\n  // Find the first quadratic non-residue Z >= 2\n  let Z = _2n;\n  const _Fp = Field(P);\n  while (FpLegendre(_Fp, Z) === 1) {\n    // Basic primality test for P. After x iterations, chance of\n    // not finding quadratic non-residue is 2^x, so 2^1000.\n    if (Z++ > 1000) throw new Error('Cannot find square root: probably non-prime P');\n  }\n  // Fast-path; usually done before Z, but we do \"primality test\".\n  if (S === 1) return sqrt3mod4;\n\n  // Slow-path\n  // TODO: test on Fp2 and others\n  let cc = _Fp.pow(Z, Q); // c = z^Q\n  const Q1div2 = (Q + _1n) / _2n;\n  return function tonelliSlow<T>(Fp: IField<T>, n: T): T {\n    if (Fp.is0(n)) return n;\n    // Check if n is a quadratic residue using Legendre symbol\n    if (FpLegendre(Fp, n) !== 1) throw new Error('Cannot find square root');\n\n    // Initialize variables for the main loop\n    let M = S;\n    let c = Fp.mul(Fp.ONE, cc); // c = z^Q, move cc from field _Fp into field Fp\n    let t = Fp.pow(n, Q); // t = n^Q, first guess at the fudge factor\n    let R = Fp.pow(n, Q1div2); // R = n^((Q+1)/2), first guess at the square root\n\n    // Main loop\n    // while t != 1\n    while (!Fp.eql(t, Fp.ONE)) {\n      if (Fp.is0(t)) return Fp.ZERO; // if t=0 return R=0\n      let i = 1;\n\n      // Find the smallest i >= 1 such that t^(2^i) \u2261 1 (mod P)\n      let t_tmp = Fp.sqr(t); // t^(2^1)\n      while (!Fp.eql(t_tmp, Fp.ONE)) {\n        i++;\n        t_tmp = Fp.sqr(t_tmp); // t^(2^2)...\n        if (i === M) throw new Error('Cannot find square root');\n      }\n\n      // Calculate the exponent for b: 2^(M - i - 1)\n      const exponent = _1n << BigInt(M - i - 1); // bigint is important\n      const b = Fp.pow(c, exponent); // b = 2^(M - i - 1)\n\n      // Update variables\n      M = i;\n      c = Fp.sqr(b); // c = b^2\n      t = Fp.mul(t, c); // t = (t * b^2)\n      R = Fp.mul(R, b); // R = R*b\n    }\n    return R;\n  };\n}\n\n/**\n * Square root for a finite field. Will try optimized versions first:\n *\n * 1. P \u2261 3 (mod 4)\n * 2. P \u2261 5 (mod 8)\n * 3. P \u2261 9 (mod 16)\n * 4. Tonelli-Shanks algorithm\n *\n * Different algorithms can give different roots, it is up to user to decide which one they want.\n * For example there is FpSqrtOdd/FpSqrtEven to choice root based on oddness (used for hash-to-curve).\n */\nexport function FpSqrt(P: bigint): <T>(Fp: IField<T>, n: T) => T {\n  // P \u2261 3 (mod 4) => \u221An = n^((P+1)/4)\n  if (P % _4n === _3n) return sqrt3mod4;\n  // P \u2261 5 (mod 8) => Atkin algorithm, page 10 of https://eprint.iacr.org/2012/685.pdf\n  if (P % _8n === _5n) return sqrt5mod8;\n  // P \u2261 9 (mod 16) => Kong algorithm, page 11 of https://eprint.iacr.org/2012/685.pdf (algorithm 4)\n  if (P % _16n === _9n) return sqrt9mod16(P);\n  // Tonelli-Shanks algorithm\n  return tonelliShanks(P);\n}\n\n// Little-endian check for first LE bit (last BE bit);\nexport const isNegativeLE = (num: bigint, modulo: bigint): boolean =>\n  (mod(num, modulo) & _1n) === _1n;\n\n/** Field is not always over prime: for example, Fp2 has ORDER(q)=p^m. */\nexport interface IField<T> {\n  ORDER: bigint;\n  BYTES: number;\n  BITS: number;\n  isLE: boolean;\n  ZERO: T;\n  ONE: T;\n  // 1-arg\n  create: (num: T) => T;\n  isValid: (num: T) => boolean;\n  is0: (num: T) => boolean;\n  isValidNot0: (num: T) => boolean;\n  neg(num: T): T;\n  inv(num: T): T;\n  sqrt(num: T): T;\n  sqr(num: T): T;\n  // 2-args\n  eql(lhs: T, rhs: T): boolean;\n  add(lhs: T, rhs: T): T;\n  sub(lhs: T, rhs: T): T;\n  mul(lhs: T, rhs: T | bigint): T;\n  pow(lhs: T, power: bigint): T;\n  div(lhs: T, rhs: T | bigint): T;\n  // N for NonNormalized (for now)\n  addN(lhs: T, rhs: T): T;\n  subN(lhs: T, rhs: T): T;\n  mulN(lhs: T, rhs: T | bigint): T;\n  sqrN(num: T): T;\n\n  // Optional\n  // Should be same as sgn0 function in\n  // [RFC9380](https://www.rfc-editor.org/rfc/rfc9380#section-4.1).\n  // NOTE: sgn0 is 'negative in LE', which is same as odd. And negative in LE is kinda strange definition anyway.\n  isOdd?(num: T): boolean; // Odd instead of even since we have it for Fp2\n  // legendre?(num: T): T;\n  invertBatch: (lst: T[]) => T[];\n  toBytes(num: T): Uint8Array;\n  fromBytes(bytes: Uint8Array, skipValidation?: boolean): T;\n  // If c is False, CMOV returns a, otherwise it returns b.\n  cmov(a: T, b: T, c: boolean): T;\n}\n// prettier-ignore\nconst FIELD_FIELDS = [\n  'create', 'isValid', 'is0', 'neg', 'inv', 'sqrt', 'sqr',\n  'eql', 'add', 'sub', 'mul', 'pow', 'div',\n  'addN', 'subN', 'mulN', 'sqrN'\n] as const;\nexport function validateField<T>(field: IField<T>): IField<T> {\n  const initial = {\n    ORDER: 'bigint',\n    BYTES: 'number',\n    BITS: 'number',\n  } as Record<string, string>;\n  const opts = FIELD_FIELDS.reduce((map, val: string) => {\n    map[val] = 'function';\n    return map;\n  }, initial);\n  validateObject(field, opts);\n  // const max = 16384;\n  // if (field.BYTES < 1 || field.BYTES > max) throw new Error('invalid field');\n  // if (field.BITS < 1 || field.BITS > 8 * max) throw new Error('invalid field');\n  return field;\n}\n\n// Generic field functions\n\n/**\n * Same as `pow` but for Fp: non-constant-time.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n */\nexport function FpPow<T>(Fp: IField<T>, num: T, power: bigint): T {\n  if (power < _0n) throw new Error('invalid exponent, negatives unsupported');\n  if (power === _0n) return Fp.ONE;\n  if (power === _1n) return num;\n  let p = Fp.ONE;\n  let d = num;\n  while (power > _0n) {\n    if (power & _1n) p = Fp.mul(p, d);\n    d = Fp.sqr(d);\n    power >>= _1n;\n  }\n  return p;\n}\n\n/**\n * Efficiently invert an array of Field elements.\n * Exception-free. Will return `undefined` for 0 elements.\n * @param passZero map 0 to 0 (instead of undefined)\n */\nexport function FpInvertBatch<T>(Fp: IField<T>, nums: T[], passZero = false): T[] {\n  const inverted = new Array(nums.length).fill(passZero ? Fp.ZERO : undefined);\n  // Walk from first to last, multiply them by each other MOD p\n  const multipliedAcc = nums.reduce((acc, num, i) => {\n    if (Fp.is0(num)) return acc;\n    inverted[i] = acc;\n    return Fp.mul(acc, num);\n  }, Fp.ONE);\n  // Invert last element\n  const invertedAcc = Fp.inv(multipliedAcc);\n  // Walk from last to first, multiply them by inverted each other MOD p\n  nums.reduceRight((acc, num, i) => {\n    if (Fp.is0(num)) return acc;\n    inverted[i] = Fp.mul(acc, inverted[i]);\n    return Fp.mul(acc, num);\n  }, invertedAcc);\n  return inverted;\n}\n\n// TODO: remove\nexport function FpDiv<T>(Fp: IField<T>, lhs: T, rhs: T | bigint): T {\n  return Fp.mul(lhs, typeof rhs === 'bigint' ? invert(rhs, Fp.ORDER) : Fp.inv(rhs));\n}\n\n/**\n * Legendre symbol.\n * Legendre constant is used to calculate Legendre symbol (a | p)\n * which denotes the value of a^((p-1)/2) (mod p).\n *\n * * (a | p) \u2261 1    if a is a square (mod p), quadratic residue\n * * (a | p) \u2261 -1   if a is not a square (mod p), quadratic non residue\n * * (a | p) \u2261 0    if a \u2261 0 (mod p)\n */\nexport function FpLegendre<T>(Fp: IField<T>, n: T): -1 | 0 | 1 {\n  // We can use 3rd argument as optional cache of this value\n  // but seems unneeded for now. The operation is very fast.\n  const p1mod2 = (Fp.ORDER - _1n) / _2n;\n  const powered = Fp.pow(n, p1mod2);\n  const yes = Fp.eql(powered, Fp.ONE);\n  const zero = Fp.eql(powered, Fp.ZERO);\n  const no = Fp.eql(powered, Fp.neg(Fp.ONE));\n  if (!yes && !zero && !no) throw new Error('invalid Legendre symbol result');\n  return yes ? 1 : zero ? 0 : -1;\n}\n\n// This function returns True whenever the value x is a square in the field F.\nexport function FpIsSquare<T>(Fp: IField<T>, n: T): boolean {\n  const l = FpLegendre(Fp, n);\n  return l === 1;\n}\n\nexport type NLength = { nByteLength: number; nBitLength: number };\n// CURVE.n lengths\nexport function nLength(n: bigint, nBitLength?: number): NLength {\n  // Bit size, byte size of CURVE.n\n  if (nBitLength !== undefined) anumber(nBitLength);\n  const _nBitLength = nBitLength !== undefined ? nBitLength : n.toString(2).length;\n  const nByteLength = Math.ceil(_nBitLength / 8);\n  return { nBitLength: _nBitLength, nByteLength };\n}\n\ntype FpField = IField<bigint> & Required<Pick<IField<bigint>, 'isOdd'>>;\ntype SqrtFn = (n: bigint) => bigint;\ntype FieldOpts = Partial<{\n  isLE: boolean;\n  BITS: number;\n  sqrt: SqrtFn;\n  allowedLengths?: readonly number[]; // for P521 (adds padding for smaller sizes)\n  modFromBytes: boolean; // bls12-381 requires mod(n) instead of rejecting keys >= n\n}>;\nclass _Field implements IField<bigint> {\n  readonly ORDER: bigint;\n  readonly BITS: number;\n  readonly BYTES: number;\n  readonly isLE: boolean;\n  readonly ZERO = _0n;\n  readonly ONE = _1n;\n  readonly _lengths?: number[];\n  private _sqrt: ReturnType<typeof FpSqrt> | undefined; // cached sqrt\n  private readonly _mod?: boolean;\n  constructor(ORDER: bigint, opts: FieldOpts = {}) {\n    if (ORDER <= _0n) throw new Error('invalid field: expected ORDER > 0, got ' + ORDER);\n    let _nbitLength: number | undefined = undefined;\n    this.isLE = false;\n    if (opts != null && typeof opts === 'object') {\n      if (typeof opts.BITS === 'number') _nbitLength = opts.BITS;\n      if (typeof opts.sqrt === 'function') this.sqrt = opts.sqrt;\n      if (typeof opts.isLE === 'boolean') this.isLE = opts.isLE;\n      if (opts.allowedLengths) this._lengths = opts.allowedLengths?.slice();\n      if (typeof opts.modFromBytes === 'boolean') this._mod = opts.modFromBytes;\n    }\n    const { nBitLength, nByteLength } = nLength(ORDER, _nbitLength);\n    if (nByteLength > 2048) throw new Error('invalid field: expected ORDER of <= 2048 bytes');\n    this.ORDER = ORDER;\n    this.BITS = nBitLength;\n    this.BYTES = nByteLength;\n    this._sqrt = undefined;\n    Object.preventExtensions(this);\n  }\n\n  create(num: bigint) {\n    return mod(num, this.ORDER);\n  }\n  isValid(num: bigint) {\n    if (typeof num !== 'bigint')\n      throw new Error('invalid field element: expected bigint, got ' + typeof num);\n    return _0n <= num && num < this.ORDER; // 0 is valid element, but it's not invertible\n  }\n  is0(num: bigint) {\n    return num === _0n;\n  }\n  // is valid and invertible\n  isValidNot0(num: bigint) {\n    return !this.is0(num) && this.isValid(num);\n  }\n  isOdd(num: bigint) {\n    return (num & _1n) === _1n;\n  }\n  neg(num: bigint) {\n    return mod(-num, this.ORDER);\n  }\n  eql(lhs: bigint, rhs: bigint) {\n    return lhs === rhs;\n  }\n\n  sqr(num: bigint) {\n    return mod(num * num, this.ORDER);\n  }\n  add(lhs: bigint, rhs: bigint) {\n    return mod(lhs + rhs, this.ORDER);\n  }\n  sub(lhs: bigint, rhs: bigint) {\n    return mod(lhs - rhs, this.ORDER);\n  }\n  mul(lhs: bigint, rhs: bigint) {\n    return mod(lhs * rhs, this.ORDER);\n  }\n  pow(num: bigint, power: bigint): bigint {\n    return FpPow(this, num, power);\n  }\n  div(lhs: bigint, rhs: bigint) {\n    return mod(lhs * invert(rhs, this.ORDER), this.ORDER);\n  }\n\n  // Same as above, but doesn't normalize\n  sqrN(num: bigint) {\n    return num * num;\n  }\n  addN(lhs: bigint, rhs: bigint) {\n    return lhs + rhs;\n  }\n  subN(lhs: bigint, rhs: bigint) {\n    return lhs - rhs;\n  }\n  mulN(lhs: bigint, rhs: bigint) {\n    return lhs * rhs;\n  }\n\n  inv(num: bigint) {\n    return invert(num, this.ORDER);\n  }\n  sqrt(num: bigint): bigint {\n    // Caching _sqrt speeds up sqrt9mod16 by 5x and tonneli-shanks by 10%\n    if (!this._sqrt) this._sqrt = FpSqrt(this.ORDER);\n    return this._sqrt(this, num);\n  }\n  toBytes(num: bigint) {\n    return this.isLE ? numberToBytesLE(num, this.BYTES) : numberToBytesBE(num, this.BYTES);\n  }\n  fromBytes(bytes: Uint8Array, skipValidation = false) {\n    abytes(bytes);\n    const { _lengths: allowedLengths, BYTES, isLE, ORDER, _mod: modFromBytes } = this;\n    if (allowedLengths) {\n      if (!allowedLengths.includes(bytes.length) || bytes.length > BYTES) {\n        throw new Error(\n          'Field.fromBytes: expected ' + allowedLengths + ' bytes, got ' + bytes.length\n        );\n      }\n      const padded = new Uint8Array(BYTES);\n      // isLE add 0 to right, !isLE to the left.\n      padded.set(bytes, isLE ? 0 : padded.length - bytes.length);\n      bytes = padded;\n    }\n    if (bytes.length !== BYTES)\n      throw new Error('Field.fromBytes: expected ' + BYTES + ' bytes, got ' + bytes.length);\n    let scalar = isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n    if (modFromBytes) scalar = mod(scalar, ORDER);\n    if (!skipValidation)\n      if (!this.isValid(scalar))\n        throw new Error('invalid field element: outside of range 0..ORDER');\n    // NOTE: we don't validate scalar here, please use isValid. This done such way because some\n    // protocol may allow non-reduced scalar that reduced later or changed some other way.\n    return scalar;\n  }\n  // TODO: we don't need it here, move out to separate fn\n  invertBatch(lst: bigint[]): bigint[] {\n    return FpInvertBatch(this, lst);\n  }\n  // We can't move this out because Fp6, Fp12 implement it\n  // and it's unclear what to return in there.\n  cmov(a: bigint, b: bigint, condition: boolean) {\n    return condition ? b : a;\n  }\n}\n\n/**\n * Creates a finite field. Major performance optimizations:\n * * 1. Denormalized operations like mulN instead of mul.\n * * 2. Identical object shape: never add or remove keys.\n * * 3. `Object.freeze`.\n * Fragile: always run a benchmark on a change.\n * Security note: operations don't check 'isValid' for all elements for performance reasons,\n * it is caller responsibility to check this.\n * This is low-level code, please make sure you know what you're doing.\n *\n * Note about field properties:\n * * CHARACTERISTIC p = prime number, number of elements in main subgroup.\n * * ORDER q = similar to cofactor in curves, may be composite `q = p^m`.\n *\n * @param ORDER field order, probably prime, or could be composite\n * @param bitLen how many bits the field consumes\n * @param isLE (default: false) if encoding / decoding should be in little-endian\n * @param redef optional faster redefinitions of sqrt and other methods\n */\nexport function Field(ORDER: bigint, opts: FieldOpts = {}): Readonly<FpField> {\n  return new _Field(ORDER, opts);\n}\n\n// Generic random scalar, we can do same for other fields if via Fp2.mul(Fp2.ONE, Fp2.random)?\n// This allows unsafe methods like ignore bias or zero. These unsafe, but often used in different protocols (if deterministic RNG).\n// which mean we cannot force this via opts.\n// Not sure what to do with randomBytes, we can accept it inside opts if wanted.\n// Probably need to export getMinHashLength somewhere?\n// random(bytes?: Uint8Array, unsafeAllowZero = false, unsafeAllowBias = false) {\n//   const LEN = !unsafeAllowBias ? getMinHashLength(ORDER) : BYTES;\n//   if (bytes === undefined) bytes = randomBytes(LEN); // _opts.randomBytes?\n//   const num = isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n//   // `mod(x, 11)` can sometimes produce 0. `mod(x, 10) + 1` is the same, but no 0\n//   const reduced = unsafeAllowZero ? mod(num, ORDER) : mod(num, ORDER - _1n) + _1n;\n//   return reduced;\n// },\n\nexport function FpSqrtOdd<T>(Fp: IField<T>, elm: T): T {\n  if (!Fp.isOdd) throw new Error(\"Field doesn't have isOdd\");\n  const root = Fp.sqrt(elm);\n  return Fp.isOdd(root) ? root : Fp.neg(root);\n}\n\nexport function FpSqrtEven<T>(Fp: IField<T>, elm: T): T {\n  if (!Fp.isOdd) throw new Error(\"Field doesn't have isOdd\");\n  const root = Fp.sqrt(elm);\n  return Fp.isOdd(root) ? Fp.neg(root) : root;\n}\n\n/**\n * Returns total number of bytes consumed by the field element.\n * For example, 32 bytes for usual 256-bit weierstrass curve.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of field\n */\nexport function getFieldBytesLength(fieldOrder: bigint): number {\n  if (typeof fieldOrder !== 'bigint') throw new Error('field order must be bigint');\n  const bitLength = fieldOrder.toString(2).length;\n  return Math.ceil(bitLength / 8);\n}\n\n/**\n * Returns minimal amount of bytes that can be safely reduced\n * by field order.\n * Should be 2^-128 for 128-bit curve such as P256.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of target hash\n */\nexport function getMinHashLength(fieldOrder: bigint): number {\n  const length = getFieldBytesLength(fieldOrder);\n  return length + Math.ceil(length / 2);\n}\n\n/**\n * \"Constant-time\" private key generation utility.\n * Can take (n + n/2) or more bytes of uniform input e.g. from CSPRNG or KDF\n * and convert them into private scalar, with the modulo bias being negligible.\n * Needs at least 48 bytes of input for 32-byte private key.\n * https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/\n * FIPS 186-5, A.2 https://csrc.nist.gov/publications/detail/fips/186/5/final\n * RFC 9380, https://www.rfc-editor.org/rfc/rfc9380#section-5\n * @param hash hash output from SHA3 or a similar function\n * @param groupOrder size of subgroup - (e.g. secp256k1.Point.Fn.ORDER)\n * @param isLE interpret hash bytes as LE num\n * @returns valid private scalar\n */\nexport function mapHashToField(key: Uint8Array, fieldOrder: bigint, isLE = false): Uint8Array {\n  abytes(key);\n  const len = key.length;\n  const fieldLen = getFieldBytesLength(fieldOrder);\n  const minLen = getMinHashLength(fieldOrder);\n  // No small numbers: need to understand bias story. No huge numbers: easier to detect JS timings.\n  if (len < 16 || len < minLen || len > 1024)\n    throw new Error('expected ' + minLen + '-1024 bytes of input, got ' + len);\n  const num = isLE ? bytesToNumberLE(key) : bytesToNumberBE(key);\n  // `mod(x, 11)` can sometimes produce 0. `mod(x, 10) + 1` is the same, but no 0\n  const reduced = mod(num, fieldOrder - _1n) + _1n;\n  return isLE ? numberToBytesLE(reduced, fieldLen) : numberToBytesBE(reduced, fieldLen);\n}\n", "/**\n * Methods for elliptic curve multiplication by scalars.\n * Contains wNAF, pippenger.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { bitLen, bitMask, type Signer } from '../utils.ts';\nimport { Field, FpInvertBatch, validateField, type IField } from './modular.ts';\n\nconst _0n = /* @__PURE__ */ BigInt(0);\nconst _1n = /* @__PURE__ */ BigInt(1);\n\nexport type AffinePoint<T> = {\n  x: T;\n  y: T;\n} & { Z?: never };\n\n// We can't \"abstract out\" coordinates (X, Y, Z; and T in Edwards): argument names of constructor\n// are not accessible. See Typescript gh-56093, gh-41594.\n//\n// We have to use recursive types, so it will return actual point, not constained `CurvePoint`.\n// If, at any point, P is `any`, it will erase all types and replace it\n// with `any`, because of recursion, `any implements CurvePoint`,\n// but we lose all constrains on methods.\n\n/** Base interface for all elliptic curve Points. */\nexport interface CurvePoint<F, P extends CurvePoint<F, P>> {\n  /** Affine x coordinate. Different from projective / extended X coordinate. */\n  x: F;\n  /** Affine y coordinate. Different from projective / extended Y coordinate. */\n  y: F;\n  Z?: F;\n  double(): P;\n  negate(): P;\n  add(other: P): P;\n  subtract(other: P): P;\n  equals(other: P): boolean;\n  multiply(scalar: bigint): P;\n  assertValidity(): void;\n  clearCofactor(): P;\n  is0(): boolean;\n  isTorsionFree(): boolean;\n  isSmallOrder(): boolean;\n  multiplyUnsafe(scalar: bigint): P;\n  /**\n   * Massively speeds up `p.multiply(n)` by using precompute tables (caching). See {@link wNAF}.\n   * @param isLazy calculate cache now. Default (true) ensures it's deferred to first `multiply()`\n   */\n  precompute(windowSize?: number, isLazy?: boolean): P;\n  /** Converts point to 2D xy affine coordinates */\n  toAffine(invertedZ?: F): AffinePoint<F>;\n  toBytes(): Uint8Array;\n  toHex(): string;\n}\n\n/** Base interface for all elliptic curve Point constructors. */\nexport interface CurvePointCons<P extends CurvePoint<any, P>> {\n  [Symbol.hasInstance]: (item: unknown) => boolean;\n  BASE: P;\n  ZERO: P;\n  /** Field for basic curve math */\n  Fp: IField<P_F<P>>;\n  /** Scalar field, for scalars in multiply and others */\n  Fn: IField<bigint>;\n  /** Creates point from x, y. Does NOT validate if the point is valid. Use `.assertValidity()`. */\n  fromAffine(p: AffinePoint<P_F<P>>): P;\n  fromBytes(bytes: Uint8Array): P;\n  fromHex(hex: string): P;\n}\n\n// Type inference helpers: PC - PointConstructor, P - Point, Fp - Field element\n// Short names, because we use them a lot in result types:\n// * we can't do 'P = GetCurvePoint<PC>': this is default value and doesn't constrain anything\n// * we can't do 'type X = GetCurvePoint<PC>': it won't be accesible for arguments/return types\n// * `CurvePointCons<P extends CurvePoint<any, P>>` constraints from interface definition\n//   won't propagate, if `PC extends CurvePointCons<any>`: the P would be 'any', which is incorrect\n// * PC could be super specific with super specific P, which implements CurvePoint<any, P>.\n//   this means we need to do stuff like\n//   `function test<P extends CurvePoint<any, P>, PC extends CurvePointCons<P>>(`\n//   if we want type safety around P, otherwise PC_P<PC> will be any\n\n/** Returns Fp type from Point (P_F<P> == P.F) */\nexport type P_F<P extends CurvePoint<any, P>> = P extends CurvePoint<infer F, P> ? F : never;\n/** Returns Fp type from PointCons (PC_F<PC> == PC.P.F) */\nexport type PC_F<PC extends CurvePointCons<CurvePoint<any, any>>> = PC['Fp']['ZERO'];\n/** Returns Point type from PointCons (PC_P<PC> == PC.P) */\nexport type PC_P<PC extends CurvePointCons<CurvePoint<any, any>>> = PC['ZERO'];\n\n// Ugly hack to get proper type inference, because in typescript fails to infer resursively.\n// The hack allows to do up to 10 chained operations without applying type erasure.\n//\n// Types which won't work:\n// * `CurvePointCons<CurvePoint<any, any>>`, will return `any` after 1 operation\n// * `CurvePointCons<any>: WeierstrassPointCons<bigint> extends CurvePointCons<any> = false`\n// * `P extends CurvePoint, PC extends CurvePointCons<P>`\n//     * It can't infer P from PC alone\n//     * Too many relations between F, P & PC\n//     * It will infer P/F if `arg: CurvePointCons<F, P>`, but will fail if PC is generic\n//     * It will work correctly if there is an additional argument of type P\n//     * But generally, we don't want to parametrize `CurvePointCons` over `F`: it will complicate\n//       types, making them un-inferable\n// prettier-ignore\nexport type PC_ANY = CurvePointCons<\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any,\n  CurvePoint<any, any>\n  >>>>>>>>>\n>;\n\nexport interface CurveLengths {\n  secretKey?: number;\n  publicKey?: number;\n  publicKeyUncompressed?: number;\n  publicKeyHasPrefix?: boolean;\n  signature?: number;\n  seed?: number;\n}\n\nexport type Mapper<T> = (i: T[]) => T[];\n\nexport function negateCt<T extends { negate: () => T }>(condition: boolean, item: T): T {\n  const neg = item.negate();\n  return condition ? neg : item;\n}\n\n/**\n * Takes a bunch of Projective Points but executes only one\n * inversion on all of them. Inversion is very slow operation,\n * so this improves performance massively.\n * Optimization: converts a list of projective points to a list of identical points with Z=1.\n */\nexport function normalizeZ<P extends CurvePoint<any, P>, PC extends CurvePointCons<P>>(\n  c: PC,\n  points: P[]\n): P[] {\n  const invertedZs = FpInvertBatch(\n    c.Fp,\n    points.map((p) => p.Z!)\n  );\n  return points.map((p, i) => c.fromAffine(p.toAffine(invertedZs[i])));\n}\n\nfunction validateW(W: number, bits: number) {\n  if (!Number.isSafeInteger(W) || W <= 0 || W > bits)\n    throw new Error('invalid window size, expected [1..' + bits + '], got W=' + W);\n}\n\n/** Internal wNAF opts for specific W and scalarBits */\ntype WOpts = {\n  windows: number;\n  windowSize: number;\n  mask: bigint;\n  maxNumber: number;\n  shiftBy: bigint;\n};\n\nfunction calcWOpts(W: number, scalarBits: number): WOpts {\n  validateW(W, scalarBits);\n  const windows = Math.ceil(scalarBits / W) + 1; // W=8 33. Not 32, because we skip zero\n  const windowSize = 2 ** (W - 1); // W=8 128. Not 256, because we skip zero\n  const maxNumber = 2 ** W; // W=8 256\n  const mask = bitMask(W); // W=8 255 == mask 0b11111111\n  const shiftBy = BigInt(W); // W=8 8\n  return { windows, windowSize, mask, maxNumber, shiftBy };\n}\n\nfunction calcOffsets(n: bigint, window: number, wOpts: WOpts) {\n  const { windowSize, mask, maxNumber, shiftBy } = wOpts;\n  let wbits = Number(n & mask); // extract W bits.\n  let nextN = n >> shiftBy; // shift number by W bits.\n\n  // What actually happens here:\n  // const highestBit = Number(mask ^ (mask >> 1n));\n  // let wbits2 = wbits - 1; // skip zero\n  // if (wbits2 & highestBit) { wbits2 ^= Number(mask); // (~);\n\n  // split if bits > max: +224 => 256-32\n  if (wbits > windowSize) {\n    // we skip zero, which means instead of `>= size-1`, we do `> size`\n    wbits -= maxNumber; // -32, can be maxNumber - wbits, but then we need to set isNeg here.\n    nextN += _1n; // +256 (carry)\n  }\n  const offsetStart = window * windowSize;\n  const offset = offsetStart + Math.abs(wbits) - 1; // -1 because we skip zero\n  const isZero = wbits === 0; // is current window slice a 0?\n  const isNeg = wbits < 0; // is current window slice negative?\n  const isNegF = window % 2 !== 0; // fake random statement for noise\n  const offsetF = offsetStart; // fake offset for noise\n  return { nextN, offset, isZero, isNeg, isNegF, offsetF };\n}\n\nfunction validateMSMPoints(points: any[], c: any) {\n  if (!Array.isArray(points)) throw new Error('array expected');\n  points.forEach((p, i) => {\n    if (!(p instanceof c)) throw new Error('invalid point at index ' + i);\n  });\n}\nfunction validateMSMScalars(scalars: any[], field: any) {\n  if (!Array.isArray(scalars)) throw new Error('array of scalars expected');\n  scalars.forEach((s, i) => {\n    if (!field.isValid(s)) throw new Error('invalid scalar at index ' + i);\n  });\n}\n\n// Since points in different groups cannot be equal (different object constructor),\n// we can have single place to store precomputes.\n// Allows to make points frozen / immutable.\nconst pointPrecomputes = new WeakMap<any, any[]>();\nconst pointWindowSizes = new WeakMap<any, number>();\n\nfunction getW(P: any): number {\n  // To disable precomputes:\n  // return 1;\n  return pointWindowSizes.get(P) || 1;\n}\n\nfunction assert0(n: bigint): void {\n  if (n !== _0n) throw new Error('invalid wNAF');\n}\n\n/**\n * Elliptic curve multiplication of Point by scalar. Fragile.\n * Table generation takes **30MB of ram and 10ms on high-end CPU**,\n * but may take much longer on slow devices. Actual generation will happen on\n * first call of `multiply()`. By default, `BASE` point is precomputed.\n *\n * Scalars should always be less than curve order: this should be checked inside of a curve itself.\n * Creates precomputation tables for fast multiplication:\n * - private scalar is split by fixed size windows of W bits\n * - every window point is collected from window's table & added to accumulator\n * - since windows are different, same point inside tables won't be accessed more than once per calc\n * - each multiplication is 'Math.ceil(CURVE_ORDER / \uD835\uDC4A) + 1' point additions (fixed for any scalar)\n * - +1 window is neccessary for wNAF\n * - wNAF reduces table size: 2x less memory + 2x faster generation, but 10% slower multiplication\n *\n * @todo Research returning 2d JS array of windows, instead of a single window.\n * This would allow windows to be in different memory locations\n */\nexport class wNAF<PC extends PC_ANY> {\n  private readonly BASE: PC_P<PC>;\n  private readonly ZERO: PC_P<PC>;\n  private readonly Fn: PC['Fn'];\n  readonly bits: number;\n\n  // Parametrized with a given Point class (not individual point)\n  constructor(Point: PC, bits: number) {\n    this.BASE = Point.BASE;\n    this.ZERO = Point.ZERO;\n    this.Fn = Point.Fn;\n    this.bits = bits;\n  }\n\n  // non-const time multiplication ladder\n  _unsafeLadder(elm: PC_P<PC>, n: bigint, p: PC_P<PC> = this.ZERO): PC_P<PC> {\n    let d: PC_P<PC> = elm;\n    while (n > _0n) {\n      if (n & _1n) p = p.add(d);\n      d = d.double();\n      n >>= _1n;\n    }\n    return p;\n  }\n\n  /**\n   * Creates a wNAF precomputation window. Used for caching.\n   * Default window size is set by `utils.precompute()` and is equal to 8.\n   * Number of precomputed points depends on the curve size:\n   * 2^(\uD835\uDC4A\u22121) * (Math.ceil(\uD835\uDC5B / \uD835\uDC4A) + 1), where:\n   * - \uD835\uDC4A is the window size\n   * - \uD835\uDC5B is the bitlength of the curve order.\n   * For a 256-bit curve and window size 8, the number of precomputed points is 128 * 33 = 4224.\n   * @param point Point instance\n   * @param W window size\n   * @returns precomputed point tables flattened to a single array\n   */\n  private precomputeWindow(point: PC_P<PC>, W: number): PC_P<PC>[] {\n    const { windows, windowSize } = calcWOpts(W, this.bits);\n    const points: PC_P<PC>[] = [];\n    let p: PC_P<PC> = point;\n    let base = p;\n    for (let window = 0; window < windows; window++) {\n      base = p;\n      points.push(base);\n      // i=1, bc we skip 0\n      for (let i = 1; i < windowSize; i++) {\n        base = base.add(p);\n        points.push(base);\n      }\n      p = base.double();\n    }\n    return points;\n  }\n\n  /**\n   * Implements ec multiplication using precomputed tables and w-ary non-adjacent form.\n   * More compact implementation:\n   * https://github.com/paulmillr/noble-secp256k1/blob/47cb1669b6e506ad66b35fe7d76132ae97465da2/index.ts#L502-L541\n   * @returns real and fake (for const-time) points\n   */\n  private wNAF(W: number, precomputes: PC_P<PC>[], n: bigint): { p: PC_P<PC>; f: PC_P<PC> } {\n    // Scalar should be smaller than field order\n    if (!this.Fn.isValid(n)) throw new Error('invalid scalar');\n    // Accumulators\n    let p = this.ZERO;\n    let f = this.BASE;\n    // This code was first written with assumption that 'f' and 'p' will never be infinity point:\n    // since each addition is multiplied by 2 ** W, it cannot cancel each other. However,\n    // there is negate now: it is possible that negated element from low value\n    // would be the same as high element, which will create carry into next window.\n    // It's not obvious how this can fail, but still worth investigating later.\n    const wo = calcWOpts(W, this.bits);\n    for (let window = 0; window < wo.windows; window++) {\n      // (n === _0n) is handled and not early-exited. isEven and offsetF are used for noise\n      const { nextN, offset, isZero, isNeg, isNegF, offsetF } = calcOffsets(n, window, wo);\n      n = nextN;\n      if (isZero) {\n        // bits are 0: add garbage to fake point\n        // Important part for const-time getPublicKey: add random \"noise\" point to f.\n        f = f.add(negateCt(isNegF, precomputes[offsetF]));\n      } else {\n        // bits are 1: add to result point\n        p = p.add(negateCt(isNeg, precomputes[offset]));\n      }\n    }\n    assert0(n);\n    // Return both real and fake points: JIT won't eliminate f.\n    // At this point there is a way to F be infinity-point even if p is not,\n    // which makes it less const-time: around 1 bigint multiply.\n    return { p, f };\n  }\n\n  /**\n   * Implements ec unsafe (non const-time) multiplication using precomputed tables and w-ary non-adjacent form.\n   * @param acc accumulator point to add result of multiplication\n   * @returns point\n   */\n  private wNAFUnsafe(\n    W: number,\n    precomputes: PC_P<PC>[],\n    n: bigint,\n    acc: PC_P<PC> = this.ZERO\n  ): PC_P<PC> {\n    const wo = calcWOpts(W, this.bits);\n    for (let window = 0; window < wo.windows; window++) {\n      if (n === _0n) break; // Early-exit, skip 0 value\n      const { nextN, offset, isZero, isNeg } = calcOffsets(n, window, wo);\n      n = nextN;\n      if (isZero) {\n        // Window bits are 0: skip processing.\n        // Move to next window.\n        continue;\n      } else {\n        const item = precomputes[offset];\n        acc = acc.add(isNeg ? item.negate() : item); // Re-using acc allows to save adds in MSM\n      }\n    }\n    assert0(n);\n    return acc;\n  }\n\n  private getPrecomputes(W: number, point: PC_P<PC>, transform?: Mapper<PC_P<PC>>): PC_P<PC>[] {\n    // Calculate precomputes on a first run, reuse them after\n    let comp = pointPrecomputes.get(point);\n    if (!comp) {\n      comp = this.precomputeWindow(point, W) as PC_P<PC>[];\n      if (W !== 1) {\n        // Doing transform outside of if brings 15% perf hit\n        if (typeof transform === 'function') comp = transform(comp);\n        pointPrecomputes.set(point, comp);\n      }\n    }\n    return comp;\n  }\n\n  cached(\n    point: PC_P<PC>,\n    scalar: bigint,\n    transform?: Mapper<PC_P<PC>>\n  ): { p: PC_P<PC>; f: PC_P<PC> } {\n    const W = getW(point);\n    return this.wNAF(W, this.getPrecomputes(W, point, transform), scalar);\n  }\n\n  unsafe(point: PC_P<PC>, scalar: bigint, transform?: Mapper<PC_P<PC>>, prev?: PC_P<PC>): PC_P<PC> {\n    const W = getW(point);\n    if (W === 1) return this._unsafeLadder(point, scalar, prev); // For W=1 ladder is ~x2 faster\n    return this.wNAFUnsafe(W, this.getPrecomputes(W, point, transform), scalar, prev);\n  }\n\n  // We calculate precomputes for elliptic curve point multiplication\n  // using windowed method. This specifies window size and\n  // stores precomputed values. Usually only base point would be precomputed.\n  createCache(P: PC_P<PC>, W: number): void {\n    validateW(W, this.bits);\n    pointWindowSizes.set(P, W);\n    pointPrecomputes.delete(P);\n  }\n\n  hasCache(elm: PC_P<PC>): boolean {\n    return getW(elm) !== 1;\n  }\n}\n\n/**\n * Endomorphism-specific multiplication for Koblitz curves.\n * Cost: 128 dbl, 0-256 adds.\n */\nexport function mulEndoUnsafe<P extends CurvePoint<any, P>, PC extends CurvePointCons<P>>(\n  Point: PC,\n  point: P,\n  k1: bigint,\n  k2: bigint\n): { p1: P; p2: P } {\n  let acc = point;\n  let p1 = Point.ZERO;\n  let p2 = Point.ZERO;\n  while (k1 > _0n || k2 > _0n) {\n    if (k1 & _1n) p1 = p1.add(acc);\n    if (k2 & _1n) p2 = p2.add(acc);\n    acc = acc.double();\n    k1 >>= _1n;\n    k2 >>= _1n;\n  }\n  return { p1, p2 };\n}\n\n/**\n * Pippenger algorithm for multi-scalar multiplication (MSM, Pa + Qb + Rc + ...).\n * 30x faster vs naive addition on L=4096, 10x faster than precomputes.\n * For N=254bit, L=1, it does: 1024 ADD + 254 DBL. For L=5: 1536 ADD + 254 DBL.\n * Algorithmically constant-time (for same L), even when 1 point + scalar, or when scalar = 0.\n * @param c Curve Point constructor\n * @param fieldN field over CURVE.N - important that it's not over CURVE.P\n * @param points array of L curve points\n * @param scalars array of L scalars (aka secret keys / bigints)\n */\nexport function pippenger<P extends CurvePoint<any, P>, PC extends CurvePointCons<P>>(\n  c: PC,\n  points: P[],\n  scalars: bigint[]\n): P {\n  // If we split scalars by some window (let's say 8 bits), every chunk will only\n  // take 256 buckets even if there are 4096 scalars, also re-uses double.\n  // TODO:\n  // - https://eprint.iacr.org/2024/750.pdf\n  // - https://tches.iacr.org/index.php/TCHES/article/view/10287\n  // 0 is accepted in scalars\n  const fieldN = c.Fn;\n  validateMSMPoints(points, c);\n  validateMSMScalars(scalars, fieldN);\n  const plength = points.length;\n  const slength = scalars.length;\n  if (plength !== slength) throw new Error('arrays of points and scalars must have equal length');\n  // if (plength === 0) throw new Error('array must be of length >= 2');\n  const zero = c.ZERO;\n  const wbits = bitLen(BigInt(plength));\n  let windowSize = 1; // bits\n  if (wbits > 12) windowSize = wbits - 3;\n  else if (wbits > 4) windowSize = wbits - 2;\n  else if (wbits > 0) windowSize = 2;\n  const MASK = bitMask(windowSize);\n  const buckets = new Array(Number(MASK) + 1).fill(zero); // +1 for zero array\n  const lastBits = Math.floor((fieldN.BITS - 1) / windowSize) * windowSize;\n  let sum = zero;\n  for (let i = lastBits; i >= 0; i -= windowSize) {\n    buckets.fill(zero);\n    for (let j = 0; j < slength; j++) {\n      const scalar = scalars[j];\n      const wbits = Number((scalar >> BigInt(i)) & MASK);\n      buckets[wbits] = buckets[wbits].add(points[j]);\n    }\n    let resI = zero; // not using this will do small speed-up, but will lose ct\n    // Skip first bucket, because it is zero\n    for (let j = buckets.length - 1, sumI = zero; j > 0; j--) {\n      sumI = sumI.add(buckets[j]);\n      resI = resI.add(sumI);\n    }\n    sum = sum.add(resI);\n    if (i !== 0) for (let j = 0; j < windowSize; j++) sum = sum.double();\n  }\n  return sum as P;\n}\n/**\n * Precomputed multi-scalar multiplication (MSM, Pa + Qb + Rc + ...).\n * @param c Curve Point constructor\n * @param fieldN field over CURVE.N - important that it's not over CURVE.P\n * @param points array of L curve points\n * @returns function which multiplies points with scaars\n */\nexport function precomputeMSMUnsafe<P extends CurvePoint<any, P>, PC extends CurvePointCons<P>>(\n  c: PC,\n  points: P[],\n  windowSize: number\n): (scalars: bigint[]) => P {\n  /**\n   * Performance Analysis of Window-based Precomputation\n   *\n   * Base Case (256-bit scalar, 8-bit window):\n   * - Standard precomputation requires:\n   *   - 31 additions per scalar \u00D7 256 scalars = 7,936 ops\n   *   - Plus 255 summary additions = 8,191 total ops\n   *   Note: Summary additions can be optimized via accumulator\n   *\n   * Chunked Precomputation Analysis:\n   * - Using 32 chunks requires:\n   *   - 255 additions per chunk\n   *   - 256 doublings\n   *   - Total: (255 \u00D7 32) + 256 = 8,416 ops\n   *\n   * Memory Usage Comparison:\n   * Window Size | Standard Points | Chunked Points\n   * ------------|-----------------|---------------\n   *     4-bit   |     520         |      15\n   *     8-bit   |    4,224        |     255\n   *    10-bit   |   13,824        |   1,023\n   *    16-bit   |  557,056        |  65,535\n   *\n   * Key Advantages:\n   * 1. Enables larger window sizes due to reduced memory overhead\n   * 2. More efficient for smaller scalar counts:\n   *    - 16 chunks: (16 \u00D7 255) + 256 = 4,336 ops\n   *    - ~2x faster than standard 8,191 ops\n   *\n   * Limitations:\n   * - Not suitable for plain precomputes (requires 256 constant doublings)\n   * - Performance degrades with larger scalar counts:\n   *   - Optimal for ~256 scalars\n   *   - Less efficient for 4096+ scalars (Pippenger preferred)\n   */\n  const fieldN = c.Fn;\n  validateW(windowSize, fieldN.BITS);\n  validateMSMPoints(points, c);\n  const zero = c.ZERO;\n  const tableSize = 2 ** windowSize - 1; // table size (without zero)\n  const chunks = Math.ceil(fieldN.BITS / windowSize); // chunks of item\n  const MASK = bitMask(windowSize);\n  const tables = points.map((p: P) => {\n    const res = [];\n    for (let i = 0, acc = p; i < tableSize; i++) {\n      res.push(acc);\n      acc = acc.add(p);\n    }\n    return res;\n  });\n  return (scalars: bigint[]): P => {\n    validateMSMScalars(scalars, fieldN);\n    if (scalars.length > points.length)\n      throw new Error('array of scalars must be smaller than array of points');\n    let res = zero;\n    for (let i = 0; i < chunks; i++) {\n      // No need to double if accumulator is still zero.\n      if (res !== zero) for (let j = 0; j < windowSize; j++) res = res.double();\n      const shiftBy = BigInt(chunks * windowSize - (i + 1) * windowSize);\n      for (let j = 0; j < scalars.length; j++) {\n        const n = scalars[j];\n        const curr = Number((n >> shiftBy) & MASK);\n        if (!curr) continue; // skip zero scalars chunks\n        res = res.add(tables[j][curr - 1]);\n      }\n    }\n    return res;\n  };\n}\n\nexport type ValidCurveParams<T> = {\n  p: bigint;\n  n: bigint;\n  h: bigint;\n  a: T;\n  b?: T;\n  d?: T;\n  Gx: T;\n  Gy: T;\n};\n\nfunction createField<T>(order: bigint, field?: IField<T>, isLE?: boolean): IField<T> {\n  if (field) {\n    if (field.ORDER !== order) throw new Error('Field.ORDER must match order: Fp == p, Fn == n');\n    validateField(field);\n    return field;\n  } else {\n    return Field(order, { isLE }) as unknown as IField<T>;\n  }\n}\nexport type FpFn<T> = { Fp: IField<T>; Fn: IField<bigint> };\n\n/** Validates CURVE opts and creates fields */\nexport function createCurveFields<T>(\n  type: 'weierstrass' | 'edwards',\n  CURVE: ValidCurveParams<T>,\n  curveOpts: Partial<FpFn<T>> = {},\n  FpFnLE?: boolean\n): FpFn<T> & { CURVE: ValidCurveParams<T> } {\n  if (FpFnLE === undefined) FpFnLE = type === 'edwards';\n  if (!CURVE || typeof CURVE !== 'object') throw new Error(`expected valid ${type} CURVE object`);\n  for (const p of ['p', 'n', 'h'] as const) {\n    const val = CURVE[p];\n    if (!(typeof val === 'bigint' && val > _0n))\n      throw new Error(`CURVE.${p} must be positive bigint`);\n  }\n  const Fp = createField(CURVE.p, curveOpts.Fp, FpFnLE);\n  const Fn = createField(CURVE.n, curveOpts.Fn, FpFnLE);\n  const _b: 'b' | 'd' = type === 'weierstrass' ? 'b' : 'd';\n  const params = ['Gx', 'Gy', 'a', _b] as const;\n  for (const p of params) {\n    // @ts-ignore\n    if (!Fp.isValid(CURVE[p]))\n      throw new Error(`CURVE.${p} must be valid field element of CURVE.Fp`);\n  }\n  CURVE = Object.freeze(Object.assign({}, CURVE));\n  return { CURVE, Fp, Fn };\n}\n\ntype KeygenFn = (\n  seed?: Uint8Array,\n  isCompressed?: boolean\n) => { secretKey: Uint8Array; publicKey: Uint8Array };\nexport function createKeygen(\n  randomSecretKey: Function,\n  getPublicKey: Signer['getPublicKey']\n): KeygenFn {\n  return function keygen(seed?: Uint8Array) {\n    const secretKey = randomSecretKey(seed);\n    return { secretKey, publicKey: getPublicKey(secretKey) };\n  };\n}\n", "/**\n * Twisted Edwards curve. The formula is: ax\u00B2 + y\u00B2 = 1 + dx\u00B2y\u00B2.\n * For design rationale of types / exports, see weierstrass module documentation.\n * Untwisted Edwards curves exist, but they aren't used in real-world protocols.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport {\n  abool,\n  abytes,\n  aInRange,\n  bytesToHex,\n  bytesToNumberLE,\n  concatBytes,\n  copyBytes,\n  hexToBytes,\n  isBytes,\n  memoized,\n  notImplemented,\n  validateObject,\n  randomBytes as wcRandomBytes,\n  type FHash,\n  type Signer,\n} from '../utils.ts';\nimport {\n  createCurveFields,\n  createKeygen,\n  normalizeZ,\n  wNAF,\n  type AffinePoint,\n  type CurveLengths,\n  type CurvePoint,\n  type CurvePointCons,\n} from './curve.ts';\nimport { type IField } from './modular.ts';\n\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _8n = BigInt(8);\n\n/** Instance of Extended Point with coordinates in X, Y, Z, T. */\nexport interface EdwardsPoint extends CurvePoint<bigint, EdwardsPoint> {\n  /** extended X coordinate. Different from affine x. */\n  readonly X: bigint;\n  /** extended Y coordinate. Different from affine y. */\n  readonly Y: bigint;\n  /** extended Z coordinate */\n  readonly Z: bigint;\n  /** extended T coordinate */\n  readonly T: bigint;\n}\n/** Static methods of Extended Point with coordinates in X, Y, Z, T. */\nexport interface EdwardsPointCons extends CurvePointCons<EdwardsPoint> {\n  new (X: bigint, Y: bigint, Z: bigint, T: bigint): EdwardsPoint;\n  CURVE(): EdwardsOpts;\n  fromBytes(bytes: Uint8Array, zip215?: boolean): EdwardsPoint;\n  fromHex(hex: string, zip215?: boolean): EdwardsPoint;\n}\n\n/**\n * Twisted Edwards curve options.\n *\n * * a: formula param\n * * d: formula param\n * * p: prime characteristic (order) of finite field, in which arithmetics is done\n * * n: order of prime subgroup a.k.a total amount of valid curve points\n * * h: cofactor. h*n is group order; n is subgroup order\n * * Gx: x coordinate of generator point a.k.a. base point\n * * Gy: y coordinate of generator point\n */\nexport type EdwardsOpts = Readonly<{\n  p: bigint;\n  n: bigint;\n  h: bigint;\n  a: bigint;\n  d: bigint;\n  Gx: bigint;\n  Gy: bigint;\n}>;\n\n/**\n * Extra curve options for Twisted Edwards.\n *\n * * Fp: redefined Field over curve.p\n * * Fn: redefined Field over curve.n\n * * uvRatio: helper function for decompression, calculating \u221A(u/v)\n */\nexport type EdwardsExtraOpts = Partial<{\n  Fp: IField<bigint>;\n  Fn: IField<bigint>;\n  FpFnLE: boolean;\n  uvRatio: (u: bigint, v: bigint) => { isValid: boolean; value: bigint };\n}>;\n\n/**\n * EdDSA (Edwards Digital Signature algorithm) options.\n *\n * * hash: hash function used to hash secret keys and messages\n * * adjustScalarBytes: clears bits to get valid field element\n * * domain: Used for hashing\n * * mapToCurve: for hash-to-curve standard\n * * prehash: RFC 8032 pre-hashing of messages to sign() / verify()\n * * randomBytes: function generating random bytes, used for randomSecretKey\n */\nexport type EdDSAOpts = Partial<{\n  adjustScalarBytes: (bytes: Uint8Array) => Uint8Array;\n  domain: (data: Uint8Array, ctx: Uint8Array, phflag: boolean) => Uint8Array;\n  mapToCurve: (scalar: bigint[]) => AffinePoint<bigint>;\n  prehash: FHash;\n  randomBytes: (bytesLength?: number) => Uint8Array;\n}>;\n\n/**\n * EdDSA (Edwards Digital Signature algorithm) interface.\n *\n * Allows to create and verify signatures, create public and secret keys.\n */\nexport interface EdDSA {\n  keygen: (seed?: Uint8Array) => { secretKey: Uint8Array; publicKey: Uint8Array };\n  getPublicKey: (secretKey: Uint8Array) => Uint8Array;\n  sign: (\n    message: Uint8Array,\n    secretKey: Uint8Array,\n    options?: { context?: Uint8Array }\n  ) => Uint8Array;\n  verify: (\n    sig: Uint8Array,\n    message: Uint8Array,\n    publicKey: Uint8Array,\n    options?: { context?: Uint8Array; zip215: boolean }\n  ) => boolean;\n  Point: EdwardsPointCons;\n  utils: {\n    randomSecretKey: (seed?: Uint8Array) => Uint8Array;\n    isValidSecretKey: (secretKey: Uint8Array) => boolean;\n    isValidPublicKey: (publicKey: Uint8Array, zip215?: boolean) => boolean;\n\n    /**\n     * Converts ed public key to x public key.\n     *\n     * There is NO `fromMontgomery`:\n     * - There are 2 valid ed25519 points for every x25519, with flipped coordinate\n     * - Sometimes there are 0 valid ed25519 points, because x25519 *additionally*\n     *   accepts inputs on the quadratic twist, which can't be moved to ed25519\n     *\n     * @example\n     * ```js\n     * const someonesPub_ed = ed25519.getPublicKey(ed25519.utils.randomSecretKey());\n     * const someonesPub = ed25519.utils.toMontgomery(someonesPub);\n     * const aPriv = x25519.utils.randomSecretKey();\n     * const shared = x25519.getSharedSecret(aPriv, someonesPub)\n     * ```\n     */\n    toMontgomery: (publicKey: Uint8Array) => Uint8Array;\n    /**\n     * Converts ed secret key to x secret key.\n     * @example\n     * ```js\n     * const someonesPub = x25519.getPublicKey(x25519.utils.randomSecretKey());\n     * const aPriv_ed = ed25519.utils.randomSecretKey();\n     * const aPriv = ed25519.utils.toMontgomerySecret(aPriv_ed);\n     * const shared = x25519.getSharedSecret(aPriv, someonesPub)\n     * ```\n     */\n    toMontgomerySecret: (secretKey: Uint8Array) => Uint8Array;\n    getExtendedPublicKey: (key: Uint8Array) => {\n      head: Uint8Array;\n      prefix: Uint8Array;\n      scalar: bigint;\n      point: EdwardsPoint;\n      pointBytes: Uint8Array;\n    };\n  };\n  lengths: CurveLengths;\n}\n\nfunction isEdValidXY(Fp: IField<bigint>, CURVE: EdwardsOpts, x: bigint, y: bigint): boolean {\n  const x2 = Fp.sqr(x);\n  const y2 = Fp.sqr(y);\n  const left = Fp.add(Fp.mul(CURVE.a, x2), y2);\n  const right = Fp.add(Fp.ONE, Fp.mul(CURVE.d, Fp.mul(x2, y2)));\n  return Fp.eql(left, right);\n}\n\nexport function edwards(params: EdwardsOpts, extraOpts: EdwardsExtraOpts = {}): EdwardsPointCons {\n  const validated = createCurveFields('edwards', params, extraOpts, extraOpts.FpFnLE);\n  const { Fp, Fn } = validated;\n  let CURVE = validated.CURVE as EdwardsOpts;\n  const { h: cofactor } = CURVE;\n  validateObject(extraOpts, {}, { uvRatio: 'function' });\n\n  // Important:\n  // There are some places where Fp.BYTES is used instead of nByteLength.\n  // So far, everything has been tested with curves of Fp.BYTES == nByteLength.\n  // TODO: test and find curves which behave otherwise.\n  const MASK = _2n << (BigInt(Fn.BYTES * 8) - _1n);\n  const modP = (n: bigint) => Fp.create(n); // Function overrides\n\n  // sqrt(u/v)\n  const uvRatio =\n    extraOpts.uvRatio ||\n    ((u: bigint, v: bigint) => {\n      try {\n        return { isValid: true, value: Fp.sqrt(Fp.div(u, v)) };\n      } catch (e) {\n        return { isValid: false, value: _0n };\n      }\n    });\n\n  // Validate whether the passed curve params are valid.\n  // equation ax\u00B2 + y\u00B2 = 1 + dx\u00B2y\u00B2 should work for generator point.\n  if (!isEdValidXY(Fp, CURVE, CURVE.Gx, CURVE.Gy))\n    throw new Error('bad curve params: generator point');\n\n  /**\n   * Asserts coordinate is valid: 0 <= n < MASK.\n   * Coordinates >= Fp.ORDER are allowed for zip215.\n   */\n  function acoord(title: string, n: bigint, banZero = false) {\n    const min = banZero ? _1n : _0n;\n    aInRange('coordinate ' + title, n, min, MASK);\n    return n;\n  }\n\n  function aedpoint(other: unknown) {\n    if (!(other instanceof Point)) throw new Error('EdwardsPoint expected');\n  }\n  // Converts Extended point to default (x, y) coordinates.\n  // Can accept precomputed Z^-1 - for example, from invertBatch.\n  const toAffineMemo = memoized((p: Point, iz?: bigint): AffinePoint<bigint> => {\n    const { X, Y, Z } = p;\n    const is0 = p.is0();\n    if (iz == null) iz = is0 ? _8n : (Fp.inv(Z) as bigint); // 8 was chosen arbitrarily\n    const x = modP(X * iz);\n    const y = modP(Y * iz);\n    const zz = Fp.mul(Z, iz);\n    if (is0) return { x: _0n, y: _1n };\n    if (zz !== _1n) throw new Error('invZ was invalid');\n    return { x, y };\n  });\n  const assertValidMemo = memoized((p: Point) => {\n    const { a, d } = CURVE;\n    if (p.is0()) throw new Error('bad point: ZERO'); // TODO: optimize, with vars below?\n    // Equation in affine coordinates: ax\u00B2 + y\u00B2 = 1 + dx\u00B2y\u00B2\n    // Equation in projective coordinates (X/Z, Y/Z, Z):  (aX\u00B2 + Y\u00B2)Z\u00B2 = Z\u2074 + dX\u00B2Y\u00B2\n    const { X, Y, Z, T } = p;\n    const X2 = modP(X * X); // X\u00B2\n    const Y2 = modP(Y * Y); // Y\u00B2\n    const Z2 = modP(Z * Z); // Z\u00B2\n    const Z4 = modP(Z2 * Z2); // Z\u2074\n    const aX2 = modP(X2 * a); // aX\u00B2\n    const left = modP(Z2 * modP(aX2 + Y2)); // (aX\u00B2 + Y\u00B2)Z\u00B2\n    const right = modP(Z4 + modP(d * modP(X2 * Y2))); // Z\u2074 + dX\u00B2Y\u00B2\n    if (left !== right) throw new Error('bad point: equation left != right (1)');\n    // In Extended coordinates we also have T, which is x*y=T/Z: check X*Y == Z*T\n    const XY = modP(X * Y);\n    const ZT = modP(Z * T);\n    if (XY !== ZT) throw new Error('bad point: equation left != right (2)');\n    return true;\n  });\n\n  // Extended Point works in extended coordinates: (X, Y, Z, T) \u220B (x=X/Z, y=Y/Z, T=xy).\n  // https://en.wikipedia.org/wiki/Twisted_Edwards_curve#Extended_coordinates\n  class Point implements EdwardsPoint {\n    // base / generator point\n    static readonly BASE = new Point(CURVE.Gx, CURVE.Gy, _1n, modP(CURVE.Gx * CURVE.Gy));\n    // zero / infinity / identity point\n    static readonly ZERO = new Point(_0n, _1n, _1n, _0n); // 0, 1, 1, 0\n    // math field\n    static readonly Fp = Fp;\n    // scalar field\n    static readonly Fn = Fn;\n\n    readonly X: bigint;\n    readonly Y: bigint;\n    readonly Z: bigint;\n    readonly T: bigint;\n\n    constructor(X: bigint, Y: bigint, Z: bigint, T: bigint) {\n      this.X = acoord('x', X);\n      this.Y = acoord('y', Y);\n      this.Z = acoord('z', Z, true);\n      this.T = acoord('t', T);\n      Object.freeze(this);\n    }\n\n    static CURVE(): EdwardsOpts {\n      return CURVE;\n    }\n\n    static fromAffine(p: AffinePoint<bigint>): Point {\n      if (p instanceof Point) throw new Error('extended point not allowed');\n      const { x, y } = p || {};\n      acoord('x', x);\n      acoord('y', y);\n      return new Point(x, y, _1n, modP(x * y));\n    }\n\n    // Uses algo from RFC8032 5.1.3.\n    static fromBytes(bytes: Uint8Array, zip215 = false): Point {\n      const len = Fp.BYTES;\n      const { a, d } = CURVE;\n      bytes = copyBytes(abytes(bytes, len, 'point'));\n      abool(zip215, 'zip215');\n      const normed = copyBytes(bytes); // copy again, we'll manipulate it\n      const lastByte = bytes[len - 1]; // select last byte\n      normed[len - 1] = lastByte & ~0x80; // clear last bit\n      const y = bytesToNumberLE(normed);\n\n      // zip215=true is good for consensus-critical apps. =false follows RFC8032 / NIST186-5.\n      // RFC8032 prohibits >= p, but ZIP215 doesn't\n      // zip215=true:  0 <= y < MASK (2^256 for ed25519)\n      // zip215=false: 0 <= y < P (2^255-19 for ed25519)\n      const max = zip215 ? MASK : Fp.ORDER;\n      aInRange('point.y', y, _0n, max);\n\n      // Ed25519: x\u00B2 = (y\u00B2-1)/(dy\u00B2+1) mod p. Ed448: x\u00B2 = (y\u00B2-1)/(dy\u00B2-1) mod p. Generic case:\n      // ax\u00B2+y\u00B2=1+dx\u00B2y\u00B2 => y\u00B2-1=dx\u00B2y\u00B2-ax\u00B2 => y\u00B2-1=x\u00B2(dy\u00B2-a) => x\u00B2=(y\u00B2-1)/(dy\u00B2-a)\n      const y2 = modP(y * y); // denominator is always non-0 mod p.\n      const u = modP(y2 - _1n); // u = y\u00B2 - 1\n      const v = modP(d * y2 - a); // v = d y\u00B2 + 1.\n      let { isValid, value: x } = uvRatio(u, v); // \u221A(u/v)\n      if (!isValid) throw new Error('bad point: invalid y coordinate');\n      const isXOdd = (x & _1n) === _1n; // There are 2 square roots. Use x_0 bit to select proper\n      const isLastByteOdd = (lastByte & 0x80) !== 0; // x_0, last bit\n      if (!zip215 && x === _0n && isLastByteOdd)\n        // if x=0 and x_0 = 1, fail\n        throw new Error('bad point: x=0 and x_0=1');\n      if (isLastByteOdd !== isXOdd) x = modP(-x); // if x_0 != x mod 2, set x = p-x\n      return Point.fromAffine({ x, y });\n    }\n\n    static fromHex(hex: string, zip215 = false): Point {\n      return Point.fromBytes(hexToBytes(hex), zip215);\n    }\n\n    get x(): bigint {\n      return this.toAffine().x;\n    }\n    get y(): bigint {\n      return this.toAffine().y;\n    }\n\n    precompute(windowSize: number = 8, isLazy = true) {\n      wnaf.createCache(this, windowSize);\n      if (!isLazy) this.multiply(_2n); // random number\n      return this;\n    }\n\n    // Useful in fromAffine() - not for fromBytes(), which always created valid points.\n    assertValidity(): void {\n      assertValidMemo(this);\n    }\n\n    // Compare one point to another.\n    equals(other: Point): boolean {\n      aedpoint(other);\n      const { X: X1, Y: Y1, Z: Z1 } = this;\n      const { X: X2, Y: Y2, Z: Z2 } = other;\n      const X1Z2 = modP(X1 * Z2);\n      const X2Z1 = modP(X2 * Z1);\n      const Y1Z2 = modP(Y1 * Z2);\n      const Y2Z1 = modP(Y2 * Z1);\n      return X1Z2 === X2Z1 && Y1Z2 === Y2Z1;\n    }\n\n    is0(): boolean {\n      return this.equals(Point.ZERO);\n    }\n\n    negate(): Point {\n      // Flips point sign to a negative one (-x, y in affine coords)\n      return new Point(modP(-this.X), this.Y, this.Z, modP(-this.T));\n    }\n\n    // Fast algo for doubling Extended Point.\n    // https://hyperelliptic.org/EFD/g1p/auto-twisted-extended.html#doubling-dbl-2008-hwcd\n    // Cost: 4M + 4S + 1*a + 6add + 1*2.\n    double(): Point {\n      const { a } = CURVE;\n      const { X: X1, Y: Y1, Z: Z1 } = this;\n      const A = modP(X1 * X1); // A = X12\n      const B = modP(Y1 * Y1); // B = Y12\n      const C = modP(_2n * modP(Z1 * Z1)); // C = 2*Z12\n      const D = modP(a * A); // D = a*A\n      const x1y1 = X1 + Y1;\n      const E = modP(modP(x1y1 * x1y1) - A - B); // E = (X1+Y1)2-A-B\n      const G = D + B; // G = D+B\n      const F = G - C; // F = G-C\n      const H = D - B; // H = D-B\n      const X3 = modP(E * F); // X3 = E*F\n      const Y3 = modP(G * H); // Y3 = G*H\n      const T3 = modP(E * H); // T3 = E*H\n      const Z3 = modP(F * G); // Z3 = F*G\n      return new Point(X3, Y3, Z3, T3);\n    }\n\n    // Fast algo for adding 2 Extended Points.\n    // https://hyperelliptic.org/EFD/g1p/auto-twisted-extended.html#addition-add-2008-hwcd\n    // Cost: 9M + 1*a + 1*d + 7add.\n    add(other: Point) {\n      aedpoint(other);\n      const { a, d } = CURVE;\n      const { X: X1, Y: Y1, Z: Z1, T: T1 } = this;\n      const { X: X2, Y: Y2, Z: Z2, T: T2 } = other;\n      const A = modP(X1 * X2); // A = X1*X2\n      const B = modP(Y1 * Y2); // B = Y1*Y2\n      const C = modP(T1 * d * T2); // C = T1*d*T2\n      const D = modP(Z1 * Z2); // D = Z1*Z2\n      const E = modP((X1 + Y1) * (X2 + Y2) - A - B); // E = (X1+Y1)*(X2+Y2)-A-B\n      const F = D - C; // F = D-C\n      const G = D + C; // G = D+C\n      const H = modP(B - a * A); // H = B-a*A\n      const X3 = modP(E * F); // X3 = E*F\n      const Y3 = modP(G * H); // Y3 = G*H\n      const T3 = modP(E * H); // T3 = E*H\n      const Z3 = modP(F * G); // Z3 = F*G\n      return new Point(X3, Y3, Z3, T3);\n    }\n\n    subtract(other: Point): Point {\n      return this.add(other.negate());\n    }\n\n    // Constant-time multiplication.\n    multiply(scalar: bigint): Point {\n      // 1 <= scalar < L\n      if (!Fn.isValidNot0(scalar)) throw new Error('invalid scalar: expected 1 <= sc < curve.n');\n      const { p, f } = wnaf.cached(this, scalar, (p) => normalizeZ(Point, p));\n      return normalizeZ(Point, [p, f])[0];\n    }\n\n    // Non-constant-time multiplication. Uses double-and-add algorithm.\n    // It's faster, but should only be used when you don't care about\n    // an exposed private key e.g. sig verification.\n    // Does NOT allow scalars higher than CURVE.n.\n    // Accepts optional accumulator to merge with multiply (important for sparse scalars)\n    multiplyUnsafe(scalar: bigint, acc = Point.ZERO): Point {\n      // 0 <= scalar < L\n      if (!Fn.isValid(scalar)) throw new Error('invalid scalar: expected 0 <= sc < curve.n');\n      if (scalar === _0n) return Point.ZERO;\n      if (this.is0() || scalar === _1n) return this;\n      return wnaf.unsafe(this, scalar, (p) => normalizeZ(Point, p), acc);\n    }\n\n    // Checks if point is of small order.\n    // If you add something to small order point, you will have \"dirty\"\n    // point with torsion component.\n    // Multiplies point by cofactor and checks if the result is 0.\n    isSmallOrder(): boolean {\n      return this.multiplyUnsafe(cofactor).is0();\n    }\n\n    // Multiplies point by curve order and checks if the result is 0.\n    // Returns `false` is the point is dirty.\n    isTorsionFree(): boolean {\n      return wnaf.unsafe(this, CURVE.n).is0();\n    }\n\n    // Converts Extended point to default (x, y) coordinates.\n    // Can accept precomputed Z^-1 - for example, from invertBatch.\n    toAffine(invertedZ?: bigint): AffinePoint<bigint> {\n      return toAffineMemo(this, invertedZ);\n    }\n\n    clearCofactor(): Point {\n      if (cofactor === _1n) return this;\n      return this.multiplyUnsafe(cofactor);\n    }\n\n    toBytes(): Uint8Array {\n      const { x, y } = this.toAffine();\n      // Fp.toBytes() allows non-canonical encoding of y (>= p).\n      const bytes = Fp.toBytes(y);\n      // Each y has 2 valid points: (x, y), (x,-y).\n      // When compressing, it's enough to store y and use the last byte to encode sign of x\n      bytes[bytes.length - 1] |= x & _1n ? 0x80 : 0;\n      return bytes;\n    }\n    toHex(): string {\n      return bytesToHex(this.toBytes());\n    }\n\n    toString() {\n      return `<Point ${this.is0() ? 'ZERO' : this.toHex()}>`;\n    }\n  }\n  const wnaf = new wNAF(Point, Fn.BITS);\n  Point.BASE.precompute(8); // Enable precomputes. Slows down first publicKey computation by 20ms.\n  return Point;\n}\n\n/**\n * Base class for prime-order points like Ristretto255 and Decaf448.\n * These points eliminate cofactor issues by representing equivalence classes\n * of Edwards curve points.\n */\nexport abstract class PrimeEdwardsPoint<T extends PrimeEdwardsPoint<T>>\n  implements CurvePoint<bigint, T>\n{\n  static BASE: PrimeEdwardsPoint<any>;\n  static ZERO: PrimeEdwardsPoint<any>;\n  static Fp: IField<bigint>;\n  static Fn: IField<bigint>;\n\n  protected readonly ep: EdwardsPoint;\n\n  constructor(ep: EdwardsPoint) {\n    this.ep = ep;\n  }\n\n  // Abstract methods that must be implemented by subclasses\n  abstract toBytes(): Uint8Array;\n  abstract equals(other: T): boolean;\n\n  // Static methods that must be implemented by subclasses\n  static fromBytes(_bytes: Uint8Array): any {\n    notImplemented();\n  }\n\n  static fromHex(_hex: string): any {\n    notImplemented();\n  }\n\n  get x(): bigint {\n    return this.toAffine().x;\n  }\n  get y(): bigint {\n    return this.toAffine().y;\n  }\n\n  // Common implementations\n  clearCofactor(): T {\n    // no-op for prime-order groups\n    return this as any;\n  }\n\n  assertValidity(): void {\n    this.ep.assertValidity();\n  }\n\n  toAffine(invertedZ?: bigint): AffinePoint<bigint> {\n    return this.ep.toAffine(invertedZ);\n  }\n\n  toHex(): string {\n    return bytesToHex(this.toBytes());\n  }\n\n  toString(): string {\n    return this.toHex();\n  }\n\n  isTorsionFree(): boolean {\n    return true;\n  }\n\n  isSmallOrder(): boolean {\n    return false;\n  }\n\n  add(other: T): T {\n    this.assertSame(other);\n    return this.init(this.ep.add(other.ep));\n  }\n\n  subtract(other: T): T {\n    this.assertSame(other);\n    return this.init(this.ep.subtract(other.ep));\n  }\n\n  multiply(scalar: bigint): T {\n    return this.init(this.ep.multiply(scalar));\n  }\n\n  multiplyUnsafe(scalar: bigint): T {\n    return this.init(this.ep.multiplyUnsafe(scalar));\n  }\n\n  double(): T {\n    return this.init(this.ep.double());\n  }\n\n  negate(): T {\n    return this.init(this.ep.negate());\n  }\n\n  precompute(windowSize?: number, isLazy?: boolean): T {\n    return this.init(this.ep.precompute(windowSize, isLazy));\n  }\n\n  // Helper methods\n  abstract is0(): boolean;\n  protected abstract assertSame(other: T): void;\n  protected abstract init(ep: EdwardsPoint): T;\n}\n\n/**\n * Initializes EdDSA signatures over given Edwards curve.\n */\nexport function eddsa(Point: EdwardsPointCons, cHash: FHash, eddsaOpts: EdDSAOpts = {}): EdDSA {\n  if (typeof cHash !== 'function') throw new Error('\"hash\" function param is required');\n  validateObject(\n    eddsaOpts,\n    {},\n    {\n      adjustScalarBytes: 'function',\n      randomBytes: 'function',\n      domain: 'function',\n      prehash: 'function',\n      mapToCurve: 'function',\n    }\n  );\n\n  const { prehash } = eddsaOpts;\n  const { BASE, Fp, Fn } = Point;\n\n  const randomBytes = eddsaOpts.randomBytes || wcRandomBytes;\n  const adjustScalarBytes = eddsaOpts.adjustScalarBytes || ((bytes: Uint8Array) => bytes);\n  const domain =\n    eddsaOpts.domain ||\n    ((data: Uint8Array, ctx: Uint8Array, phflag: boolean) => {\n      abool(phflag, 'phflag');\n      if (ctx.length || phflag) throw new Error('Contexts/pre-hash are not supported');\n      return data;\n    }); // NOOP\n\n  // Little-endian SHA512 with modulo n\n  function modN_LE(hash: Uint8Array): bigint {\n    return Fn.create(bytesToNumberLE(hash)); // Not Fn.fromBytes: it has length limit\n  }\n\n  // Get the hashed private scalar per RFC8032 5.1.5\n  function getPrivateScalar(key: Uint8Array) {\n    const len = lengths.secretKey;\n    abytes(key, lengths.secretKey, 'secretKey');\n    // Hash private key with curve's hash function to produce uniformingly random input\n    // Check byte lengths: ensure(64, h(ensure(32, key)))\n    const hashed = abytes(cHash(key), 2 * len, 'hashedSecretKey');\n    const head = adjustScalarBytes(hashed.slice(0, len)); // clear first half bits, produce FE\n    const prefix = hashed.slice(len, 2 * len); // second half is called key prefix (5.1.6)\n    const scalar = modN_LE(head); // The actual private scalar\n    return { head, prefix, scalar };\n  }\n\n  /** Convenience method that creates public key from scalar. RFC8032 5.1.5 */\n  function getExtendedPublicKey(secretKey: Uint8Array) {\n    const { head, prefix, scalar } = getPrivateScalar(secretKey);\n    const point = BASE.multiply(scalar); // Point on Edwards curve aka public key\n    const pointBytes = point.toBytes();\n    return { head, prefix, scalar, point, pointBytes };\n  }\n\n  /** Calculates EdDSA pub key. RFC8032 5.1.5. */\n  function getPublicKey(secretKey: Uint8Array): Uint8Array {\n    return getExtendedPublicKey(secretKey).pointBytes;\n  }\n\n  // int('LE', SHA512(dom2(F, C) || msgs)) mod N\n  function hashDomainToScalar(context: Uint8Array = Uint8Array.of(), ...msgs: Uint8Array[]) {\n    const msg = concatBytes(...msgs);\n    return modN_LE(cHash(domain(msg, abytes(context, undefined, 'context'), !!prehash)));\n  }\n\n  /** Signs message with secret key. RFC8032 5.1.6 */\n  function sign(\n    msg: Uint8Array,\n    secretKey: Uint8Array,\n    options: { context?: Uint8Array } = {}\n  ): Uint8Array {\n    msg = abytes(msg, undefined, 'message');\n    if (prehash) msg = prehash(msg); // for ed25519ph etc.\n    const { prefix, scalar, pointBytes } = getExtendedPublicKey(secretKey);\n    const r = hashDomainToScalar(options.context, prefix, msg); // r = dom2(F, C) || prefix || PH(M)\n    const R = BASE.multiply(r).toBytes(); // R = rG\n    const k = hashDomainToScalar(options.context, R, pointBytes, msg); // R || A || PH(M)\n    const s = Fn.create(r + k * scalar); // S = (r + k * s) mod L\n    if (!Fn.isValid(s)) throw new Error('sign failed: invalid s'); // 0 <= s < L\n    const rs = concatBytes(R, Fn.toBytes(s));\n    return abytes(rs, lengths.signature, 'result');\n  }\n\n  // verification rule is either zip215 or rfc8032 / nist186-5. Consult fromHex:\n  const verifyOpts: { context?: Uint8Array; zip215?: boolean } = { zip215: true };\n\n  /**\n   * Verifies EdDSA signature against message and public key. RFC8032 5.1.7.\n   * An extended group equation is checked.\n   */\n  function verify(\n    sig: Uint8Array,\n    msg: Uint8Array,\n    publicKey: Uint8Array,\n    options = verifyOpts\n  ): boolean {\n    const { context, zip215 } = options;\n    const len = lengths.signature;\n    sig = abytes(sig, len, 'signature');\n    msg = abytes(msg, undefined, 'message');\n    publicKey = abytes(publicKey, lengths.publicKey, 'publicKey');\n    if (zip215 !== undefined) abool(zip215, 'zip215');\n    if (prehash) msg = prehash(msg); // for ed25519ph, etc\n\n    const mid = len / 2;\n    const r = sig.subarray(0, mid);\n    const s = bytesToNumberLE(sig.subarray(mid, len));\n    let A, R, SB;\n    try {\n      // zip215=true is good for consensus-critical apps. =false follows RFC8032 / NIST186-5.\n      // zip215=true:  0 <= y < MASK (2^256 for ed25519)\n      // zip215=false: 0 <= y < P (2^255-19 for ed25519)\n      A = Point.fromBytes(publicKey, zip215);\n      R = Point.fromBytes(r, zip215);\n      SB = BASE.multiplyUnsafe(s); // 0 <= s < l is done inside\n    } catch (error) {\n      return false;\n    }\n    if (!zip215 && A.isSmallOrder()) return false; // zip215 allows public keys of small order\n\n    const k = hashDomainToScalar(context, R.toBytes(), A.toBytes(), msg);\n    const RkA = R.add(A.multiplyUnsafe(k));\n    // Extended group equation\n    // [8][S]B = [8]R + [8][k]A'\n    return RkA.subtract(SB).clearCofactor().is0();\n  }\n\n  const _size = Fp.BYTES; // 32 for ed25519, 57 for ed448\n  const lengths = {\n    secretKey: _size,\n    publicKey: _size,\n    signature: 2 * _size,\n    seed: _size,\n  };\n  function randomSecretKey(seed = randomBytes(lengths.seed)): Uint8Array {\n    return abytes(seed, lengths.seed, 'seed');\n  }\n\n  function isValidSecretKey(key: Uint8Array): boolean {\n    return isBytes(key) && key.length === Fn.BYTES;\n  }\n\n  function isValidPublicKey(key: Uint8Array, zip215?: boolean): boolean {\n    try {\n      return !!Point.fromBytes(key, zip215);\n    } catch (error) {\n      return false;\n    }\n  }\n\n  const utils = {\n    getExtendedPublicKey,\n    randomSecretKey,\n    isValidSecretKey,\n    isValidPublicKey,\n    /**\n     * Converts ed public key to x public key. Uses formula:\n     * - ed25519:\n     *   - `(u, v) = ((1+y)/(1-y), sqrt(-486664)*u/x)`\n     *   - `(x, y) = (sqrt(-486664)*u/v, (u-1)/(u+1))`\n     * - ed448:\n     *   - `(u, v) = ((y-1)/(y+1), sqrt(156324)*u/x)`\n     *   - `(x, y) = (sqrt(156324)*u/v, (1+u)/(1-u))`\n     */\n    toMontgomery(publicKey: Uint8Array): Uint8Array {\n      const { y } = Point.fromBytes(publicKey);\n      const size = lengths.publicKey;\n      const is25519 = size === 32;\n      if (!is25519 && size !== 57) throw new Error('only defined for 25519 and 448');\n      const u = is25519 ? Fp.div(_1n + y, _1n - y) : Fp.div(y - _1n, y + _1n);\n      return Fp.toBytes(u);\n    },\n    toMontgomerySecret(secretKey: Uint8Array): Uint8Array {\n      const size = lengths.secretKey;\n      abytes(secretKey, size);\n      const hashed = cHash(secretKey.subarray(0, size));\n      return adjustScalarBytes(hashed).subarray(0, size);\n    },\n  };\n\n  return Object.freeze({\n    keygen: createKeygen(randomSecretKey, getPublicKey),\n    getPublicKey,\n    sign,\n    verify,\n    utils,\n    Point,\n    lengths,\n  }) satisfies Signer;\n}\n", "/**\n * hash-to-curve from RFC 9380.\n * Hashes arbitrary-length byte strings to a list of one or more elements of a finite field F.\n * https://www.rfc-editor.org/rfc/rfc9380\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport type { CHash } from '../utils.ts';\nimport {\n  abytes,\n  asafenumber,\n  asciiToBytes,\n  bytesToNumberBE,\n  concatBytes,\n  isBytes,\n  validateObject,\n} from '../utils.ts';\nimport type { AffinePoint, PC_ANY, PC_F, PC_P } from './curve.ts';\nimport { FpInvertBatch, mod, type IField } from './modular.ts';\n\nexport type AsciiOrBytes = string | Uint8Array;\n\n/**\n * * `DST` is a domain separation tag, defined in section 2.2.5\n * * `p` characteristic of F, where F is a finite field of characteristic p and order q = p^m\n * * `m` is extension degree (1 for prime fields)\n * * `k` is the target security target in bits (e.g. 128), from section 5.1\n * * `expand` is `xmd` (SHA2, SHA3, BLAKE) or `xof` (SHAKE, BLAKE-XOF)\n * * `hash` conforming to `utils.CHash` interface, with `outputLen` / `blockLen` props\n */\nexport type H2COpts = {\n  DST: AsciiOrBytes;\n  expand: 'xmd' | 'xof';\n  hash: CHash;\n  p: bigint;\n  m: number;\n  k: number;\n};\nexport type H2CHashOpts = {\n  expand: 'xmd' | 'xof';\n  hash: CHash;\n};\nexport type MapToCurve<T> = (scalar: bigint[]) => AffinePoint<T>;\n\n// Separated from initialization opts, so users won't accidentally change per-curve parameters\n// (changing DST is ok!)\nexport type H2CDSTOpts = { DST: AsciiOrBytes };\nexport type H2CHasherBase<PC extends PC_ANY> = {\n  hashToCurve(msg: Uint8Array, options?: H2CDSTOpts): PC_P<PC>;\n  hashToScalar(msg: Uint8Array, options?: H2CDSTOpts): bigint;\n  deriveToCurve?(msg: Uint8Array, options?: H2CDSTOpts): PC_P<PC>;\n  Point: PC;\n};\n/**\n * RFC 9380 methods, with cofactor clearing. See https://www.rfc-editor.org/rfc/rfc9380#section-3.\n *\n * * hashToCurve: `map(hash(input))`, encodes RANDOM bytes to curve (WITH hashing)\n * * encodeToCurve: `map(hash(input))`, encodes NON-UNIFORM bytes to curve (WITH hashing)\n * * mapToCurve: `map(scalars)`, encodes NON-UNIFORM scalars to curve (NO hashing)\n */\nexport type H2CHasher<PC extends PC_ANY> = H2CHasherBase<PC> & {\n  encodeToCurve(msg: Uint8Array, options?: H2CDSTOpts): PC_P<PC>;\n  mapToCurve: MapToCurve<PC_F<PC>>;\n  defaults: H2COpts & { encodeDST?: AsciiOrBytes };\n};\n\n// Octet Stream to Integer. \"spec\" implementation of os2ip is 2.5x slower vs bytesToNumberBE.\nconst os2ip = bytesToNumberBE;\n\n// Integer to Octet Stream (numberToBytesBE)\nfunction i2osp(value: number, length: number): Uint8Array {\n  asafenumber(value);\n  asafenumber(length);\n  if (value < 0 || value >= 1 << (8 * length)) throw new Error('invalid I2OSP input: ' + value);\n  const res = Array.from({ length }).fill(0) as number[];\n  for (let i = length - 1; i >= 0; i--) {\n    res[i] = value & 0xff;\n    value >>>= 8;\n  }\n  return new Uint8Array(res);\n}\n\nfunction strxor(a: Uint8Array, b: Uint8Array): Uint8Array {\n  const arr = new Uint8Array(a.length);\n  for (let i = 0; i < a.length; i++) {\n    arr[i] = a[i] ^ b[i];\n  }\n  return arr;\n}\n\n// User can always use utf8 if they want, by passing Uint8Array.\n// If string is passed, we treat it as ASCII: other formats are likely a mistake.\nfunction normDST(DST: AsciiOrBytes): Uint8Array {\n  if (!isBytes(DST) && typeof DST !== 'string')\n    throw new Error('DST must be Uint8Array or ascii string');\n  return typeof DST === 'string' ? asciiToBytes(DST) : DST;\n}\n\n/**\n * Produces a uniformly random byte string using a cryptographic hash function H that outputs b bits.\n * [RFC 9380 5.3.1](https://www.rfc-editor.org/rfc/rfc9380#section-5.3.1).\n */\nexport function expand_message_xmd(\n  msg: Uint8Array,\n  DST: AsciiOrBytes,\n  lenInBytes: number,\n  H: CHash\n): Uint8Array {\n  abytes(msg);\n  asafenumber(lenInBytes);\n  DST = normDST(DST);\n  // https://www.rfc-editor.org/rfc/rfc9380#section-5.3.3\n  if (DST.length > 255) DST = H(concatBytes(asciiToBytes('H2C-OVERSIZE-DST-'), DST));\n  const { outputLen: b_in_bytes, blockLen: r_in_bytes } = H;\n  const ell = Math.ceil(lenInBytes / b_in_bytes);\n  if (lenInBytes > 65535 || ell > 255) throw new Error('expand_message_xmd: invalid lenInBytes');\n  const DST_prime = concatBytes(DST, i2osp(DST.length, 1));\n  const Z_pad = i2osp(0, r_in_bytes);\n  const l_i_b_str = i2osp(lenInBytes, 2); // len_in_bytes_str\n  const b = new Array<Uint8Array>(ell);\n  const b_0 = H(concatBytes(Z_pad, msg, l_i_b_str, i2osp(0, 1), DST_prime));\n  b[0] = H(concatBytes(b_0, i2osp(1, 1), DST_prime));\n  for (let i = 1; i <= ell; i++) {\n    const args = [strxor(b_0, b[i - 1]), i2osp(i + 1, 1), DST_prime];\n    b[i] = H(concatBytes(...args));\n  }\n  const pseudo_random_bytes = concatBytes(...b);\n  return pseudo_random_bytes.slice(0, lenInBytes);\n}\n\n/**\n * Produces a uniformly random byte string using an extendable-output function (XOF) H.\n * 1. The collision resistance of H MUST be at least k bits.\n * 2. H MUST be an XOF that has been proved indifferentiable from\n *    a random oracle under a reasonable cryptographic assumption.\n * [RFC 9380 5.3.2](https://www.rfc-editor.org/rfc/rfc9380#section-5.3.2).\n */\nexport function expand_message_xof(\n  msg: Uint8Array,\n  DST: AsciiOrBytes,\n  lenInBytes: number,\n  k: number,\n  H: CHash\n): Uint8Array {\n  abytes(msg);\n  asafenumber(lenInBytes);\n  DST = normDST(DST);\n  // https://www.rfc-editor.org/rfc/rfc9380#section-5.3.3\n  // DST = H('H2C-OVERSIZE-DST-' || a_very_long_DST, Math.ceil((lenInBytes * k) / 8));\n  if (DST.length > 255) {\n    const dkLen = Math.ceil((2 * k) / 8);\n    DST = H.create({ dkLen }).update(asciiToBytes('H2C-OVERSIZE-DST-')).update(DST).digest();\n  }\n  if (lenInBytes > 65535 || DST.length > 255)\n    throw new Error('expand_message_xof: invalid lenInBytes');\n  return (\n    H.create({ dkLen: lenInBytes })\n      .update(msg)\n      .update(i2osp(lenInBytes, 2))\n      // 2. DST_prime = DST || I2OSP(len(DST), 1)\n      .update(DST)\n      .update(i2osp(DST.length, 1))\n      .digest()\n  );\n}\n\n/**\n * Hashes arbitrary-length byte strings to a list of one or more elements of a finite field F.\n * [RFC 9380 5.2](https://www.rfc-editor.org/rfc/rfc9380#section-5.2).\n * @param msg a byte string containing the message to hash\n * @param count the number of elements of F to output\n * @param options `{DST: string, p: bigint, m: number, k: number, expand: 'xmd' | 'xof', hash: H}`, see above\n * @returns [u_0, ..., u_(count - 1)], a list of field elements.\n */\nexport function hash_to_field(msg: Uint8Array, count: number, options: H2COpts): bigint[][] {\n  validateObject(options, {\n    p: 'bigint',\n    m: 'number',\n    k: 'number',\n    hash: 'function',\n  });\n  const { p, k, m, hash, expand, DST } = options;\n  asafenumber(hash.outputLen, 'valid hash');\n  abytes(msg);\n  asafenumber(count);\n  const log2p = p.toString(2).length;\n  const L = Math.ceil((log2p + k) / 8); // section 5.1 of ietf draft link above\n  const len_in_bytes = count * m * L;\n  let prb; // pseudo_random_bytes\n  if (expand === 'xmd') {\n    prb = expand_message_xmd(msg, DST, len_in_bytes, hash);\n  } else if (expand === 'xof') {\n    prb = expand_message_xof(msg, DST, len_in_bytes, k, hash);\n  } else if (expand === '_internal_pass') {\n    // for internal tests only\n    prb = msg;\n  } else {\n    throw new Error('expand must be \"xmd\" or \"xof\"');\n  }\n  const u = new Array(count);\n  for (let i = 0; i < count; i++) {\n    const e = new Array(m);\n    for (let j = 0; j < m; j++) {\n      const elm_offset = L * (j + i * m);\n      const tv = prb.subarray(elm_offset, elm_offset + L);\n      e[j] = mod(os2ip(tv), p);\n    }\n    u[i] = e;\n  }\n  return u;\n}\n\ntype XY<T> = (x: T, y: T) => { x: T; y: T };\ntype XYRatio<T> = [T[], T[], T[], T[]]; // xn/xd, yn/yd\nexport function isogenyMap<T, F extends IField<T>>(field: F, map: XYRatio<T>): XY<T> {\n  // Make same order as in spec\n  const coeff = map.map((i) => Array.from(i).reverse());\n  return (x: T, y: T) => {\n    const [xn, xd, yn, yd] = coeff.map((val) =>\n      val.reduce((acc, i) => field.add(field.mul(acc, x), i))\n    );\n    // 6.6.3\n    // Exceptional cases of iso_map are inputs that cause the denominator of\n    // either rational function to evaluate to zero; such cases MUST return\n    // the identity point on E.\n    const [xd_inv, yd_inv] = FpInvertBatch(field, [xd, yd], true);\n    x = field.mul(xn, xd_inv); // xNum / xDen\n    y = field.mul(y, field.mul(yn, yd_inv)); // y * (yNum / yDev)\n    return { x, y };\n  };\n}\n\nexport const _DST_scalar: Uint8Array = asciiToBytes('HashToScalar-');\n\n/** Creates hash-to-curve methods from EC Point and mapToCurve function. See {@link H2CHasher}. */\nexport function createHasher<PC extends PC_ANY>(\n  Point: PC,\n  mapToCurve: MapToCurve<PC_F<PC>>,\n  defaults: H2COpts & { encodeDST?: AsciiOrBytes }\n): H2CHasher<PC> {\n  if (typeof mapToCurve !== 'function') throw new Error('mapToCurve() must be defined');\n  function map(num: bigint[]): PC_P<PC> {\n    return Point.fromAffine(mapToCurve(num)) as PC_P<PC>;\n  }\n  function clear(initial: PC_P<PC>): PC_P<PC> {\n    const P = initial.clearCofactor();\n    if (P.equals(Point.ZERO)) return Point.ZERO as PC_P<PC>; // zero will throw in assert\n    P.assertValidity();\n    return P as PC_P<PC>;\n  }\n\n  return {\n    defaults: Object.freeze(defaults),\n    Point,\n\n    hashToCurve(msg: Uint8Array, options?: H2CDSTOpts): PC_P<PC> {\n      const opts = Object.assign({}, defaults, options);\n      const u = hash_to_field(msg, 2, opts);\n      const u0 = map(u[0]);\n      const u1 = map(u[1]);\n      return clear(u0.add(u1) as PC_P<PC>);\n    },\n    encodeToCurve(msg: Uint8Array, options?: H2CDSTOpts): PC_P<PC> {\n      const optsDst = defaults.encodeDST ? { DST: defaults.encodeDST } : {};\n      const opts = Object.assign({}, defaults, optsDst, options);\n      const u = hash_to_field(msg, 1, opts);\n      const u0 = map(u[0]);\n      return clear(u0);\n    },\n    /** See {@link H2CHasher} */\n    mapToCurve(scalars: bigint | bigint[]): PC_P<PC> {\n      // Curves with m=1 accept only single scalar\n      if (defaults.m === 1) {\n        if (typeof scalars !== 'bigint') throw new Error('expected bigint (m=1)');\n        return clear(map([scalars]));\n      }\n      if (!Array.isArray(scalars)) throw new Error('expected array of bigints');\n      for (const i of scalars)\n        if (typeof i !== 'bigint') throw new Error('expected array of bigints');\n      return clear(map(scalars));\n    },\n\n    // hash_to_scalar can produce 0: https://www.rfc-editor.org/errata/eid8393\n    // RFC 9380, draft-irtf-cfrg-bbs-signatures-08\n    hashToScalar(msg: Uint8Array, options?: H2CDSTOpts): bigint {\n      // @ts-ignore\n      const N = Point.Fn.ORDER;\n      const opts = Object.assign({}, defaults, { p: N, m: 1, DST: _DST_scalar }, options);\n      return hash_to_field(msg, 1, opts)[0][0];\n    },\n  };\n}\n", "/**\n * Montgomery curve methods. It's not really whole montgomery curve,\n * just bunch of very specific methods for X25519 / X448 from\n * [RFC 7748](https://www.rfc-editor.org/rfc/rfc7748)\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport {\n  abytes,\n  aInRange,\n  bytesToNumberLE,\n  copyBytes,\n  numberToBytesLE,\n  randomBytes,\n  validateObject,\n  type CryptoKeys,\n} from '../utils.ts';\nimport { createKeygen, type CurveLengths } from './curve.ts';\nimport { mod } from './modular.ts';\n\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\n\nexport type MontgomeryOpts = {\n  P: bigint; // finite field prime\n  type: 'x25519' | 'x448';\n  adjustScalarBytes: (bytes: Uint8Array) => Uint8Array;\n  powPminus2: (x: bigint) => bigint;\n  randomBytes?: (bytesLength?: number) => Uint8Array;\n};\n\nexport type MontgomeryECDH = {\n  scalarMult: (scalar: Uint8Array, u: Uint8Array) => Uint8Array;\n  scalarMultBase: (scalar: Uint8Array) => Uint8Array;\n  getSharedSecret: (secretKeyA: Uint8Array, publicKeyB: Uint8Array) => Uint8Array;\n  getPublicKey: (secretKey: Uint8Array) => Uint8Array;\n  utils: {\n    randomSecretKey: () => Uint8Array;\n  };\n  GuBytes: Uint8Array;\n  lengths: CurveLengths;\n  keygen: (seed?: Uint8Array) => { secretKey: Uint8Array; publicKey: Uint8Array };\n};\n\nfunction validateOpts(curve: MontgomeryOpts) {\n  validateObject(curve, {\n    adjustScalarBytes: 'function',\n    powPminus2: 'function',\n  });\n  return Object.freeze({ ...curve } as const);\n}\n\nexport function montgomery(curveDef: MontgomeryOpts): MontgomeryECDH {\n  const CURVE = validateOpts(curveDef);\n  const { P, type, adjustScalarBytes, powPminus2, randomBytes: rand } = CURVE;\n  const is25519 = type === 'x25519';\n  if (!is25519 && type !== 'x448') throw new Error('invalid type');\n  const randomBytes_ = rand || randomBytes;\n\n  const montgomeryBits = is25519 ? 255 : 448;\n  const fieldLen = is25519 ? 32 : 56;\n  const Gu = is25519 ? BigInt(9) : BigInt(5);\n  // RFC 7748 #5:\n  // The constant a24 is (486662 - 2) / 4 = 121665 for curve25519/X25519 and\n  // (156326 - 2) / 4 = 39081 for curve448/X448\n  // const a = is25519 ? 156326n : 486662n;\n  const a24 = is25519 ? BigInt(121665) : BigInt(39081);\n  // RFC: x25519 \"the resulting integer is of the form 2^254 plus\n  // eight times a value between 0 and 2^251 - 1 (inclusive)\"\n  // x448: \"2^447 plus four times a value between 0 and 2^445 - 1 (inclusive)\"\n  const minScalar = is25519 ? _2n ** BigInt(254) : _2n ** BigInt(447);\n  const maxAdded = is25519\n    ? BigInt(8) * _2n ** BigInt(251) - _1n\n    : BigInt(4) * _2n ** BigInt(445) - _1n;\n  const maxScalar = minScalar + maxAdded + _1n; // (inclusive)\n  const modP = (n: bigint) => mod(n, P);\n  const GuBytes = encodeU(Gu);\n  function encodeU(u: bigint): Uint8Array {\n    return numberToBytesLE(modP(u), fieldLen);\n  }\n  function decodeU(u: Uint8Array): bigint {\n    const _u = copyBytes(abytes(u, fieldLen, 'uCoordinate'));\n    // RFC: When receiving such an array, implementations of X25519\n    // (but not X448) MUST mask the most significant bit in the final byte.\n    if (is25519) _u[31] &= 127; // 0b0111_1111\n    // RFC: Implementations MUST accept non-canonical values and process them as\n    // if they had been reduced modulo the field prime.  The non-canonical\n    // values are 2^255 - 19 through 2^255 - 1 for X25519 and 2^448 - 2^224\n    // - 1 through 2^448 - 1 for X448.\n    return modP(bytesToNumberLE(_u));\n  }\n  function decodeScalar(scalar: Uint8Array): bigint {\n    return bytesToNumberLE(adjustScalarBytes(copyBytes(abytes(scalar, fieldLen, 'scalar'))));\n  }\n  function scalarMult(scalar: Uint8Array, u: Uint8Array): Uint8Array {\n    const pu = montgomeryLadder(decodeU(u), decodeScalar(scalar));\n    // Some public keys are useless, of low-order. Curve author doesn't think\n    // it needs to be validated, but we do it nonetheless.\n    // https://cr.yp.to/ecdh.html#validate\n    if (pu === _0n) throw new Error('invalid private or public key received');\n    return encodeU(pu);\n  }\n  // Computes public key from private. By doing scalar multiplication of base point.\n  function scalarMultBase(scalar: Uint8Array): Uint8Array {\n    return scalarMult(scalar, GuBytes);\n  }\n  const getPublicKey = scalarMultBase;\n  const getSharedSecret = scalarMult;\n\n  // cswap from RFC7748 \"example code\"\n  function cswap(swap: bigint, x_2: bigint, x_3: bigint): { x_2: bigint; x_3: bigint } {\n    // dummy = mask(swap) AND (x_2 XOR x_3)\n    // Where mask(swap) is the all-1 or all-0 word of the same length as x_2\n    // and x_3, computed, e.g., as mask(swap) = 0 - swap.\n    const dummy = modP(swap * (x_2 - x_3));\n    x_2 = modP(x_2 - dummy); // x_2 = x_2 XOR dummy\n    x_3 = modP(x_3 + dummy); // x_3 = x_3 XOR dummy\n    return { x_2, x_3 };\n  }\n\n  /**\n   * Montgomery x-only multiplication ladder.\n   * @param pointU u coordinate (x) on Montgomery Curve 25519\n   * @param scalar by which the point would be multiplied\n   * @returns new Point on Montgomery curve\n   */\n  function montgomeryLadder(u: bigint, scalar: bigint): bigint {\n    aInRange('u', u, _0n, P);\n    aInRange('scalar', scalar, minScalar, maxScalar);\n    const k = scalar;\n    const x_1 = u;\n    let x_2 = _1n;\n    let z_2 = _0n;\n    let x_3 = u;\n    let z_3 = _1n;\n    let swap = _0n;\n    for (let t = BigInt(montgomeryBits - 1); t >= _0n; t--) {\n      const k_t = (k >> t) & _1n;\n      swap ^= k_t;\n      ({ x_2, x_3 } = cswap(swap, x_2, x_3));\n      ({ x_2: z_2, x_3: z_3 } = cswap(swap, z_2, z_3));\n      swap = k_t;\n\n      const A = x_2 + z_2;\n      const AA = modP(A * A);\n      const B = x_2 - z_2;\n      const BB = modP(B * B);\n      const E = AA - BB;\n      const C = x_3 + z_3;\n      const D = x_3 - z_3;\n      const DA = modP(D * A);\n      const CB = modP(C * B);\n      const dacb = DA + CB;\n      const da_cb = DA - CB;\n      x_3 = modP(dacb * dacb);\n      z_3 = modP(x_1 * modP(da_cb * da_cb));\n      x_2 = modP(AA * BB);\n      z_2 = modP(E * (AA + modP(a24 * E)));\n    }\n    ({ x_2, x_3 } = cswap(swap, x_2, x_3));\n    ({ x_2: z_2, x_3: z_3 } = cswap(swap, z_2, z_3));\n    const z2 = powPminus2(z_2); // `Fp.pow(x, P - _2n)` is much slower equivalent\n    return modP(x_2 * z2); // Return x_2 * (z_2^(p - 2))\n  }\n  const lengths = {\n    secretKey: fieldLen,\n    publicKey: fieldLen,\n    seed: fieldLen,\n  };\n  const randomSecretKey = (seed = randomBytes_(fieldLen)) => {\n    abytes(seed, lengths.seed, 'seed');\n    return seed;\n  };\n  const utils = { randomSecretKey };\n\n  return Object.freeze({\n    keygen: createKeygen(randomSecretKey, getPublicKey),\n    getSharedSecret,\n    getPublicKey,\n    scalarMult,\n    scalarMultBase,\n    utils,\n    GuBytes: GuBytes.slice(),\n    lengths,\n  }) satisfies CryptoKeys;\n}\n", "/**\n * RFC 9497: Oblivious Pseudorandom Functions (OPRFs) Using Prime-Order Groups.\n * https://www.rfc-editor.org/rfc/rfc9497\n *\n\nOPRF allows to interactively create an `Output = PRF(Input, serverSecretKey)`:\n\n- Server cannot calculate Output by itself: it doesn't know Input\n- Client cannot calculate Output by itself: it doesn't know server secretKey\n- An attacker interception the communication can't restore Input/Output/serverSecretKey and can't\n  link Input to some value.\n\n## Issues\n\n- Low-entropy inputs (e.g. password '123') enable brute-forced dictionary attacks by the server\n  (solveable by domain separation in POPRF)\n- High-level protocol needs to be constructed on top, because OPRF is low-level\n\n## Use cases\n\n1. **Password-Authenticated Key Exchange (PAKE):** Enables secure password login (e.g., OPAQUE)\n   without revealing the password to the server.\n2. **Private Set Intersection (PSI):** Allows two parties to compute the intersection of their\n   private sets without revealing non-intersecting elements.\n3. **Anonymous Credential Systems:** Supports issuance of anonymous, unlinkable credentials\n   (e.g., Privacy Pass) using blind OPRF evaluation.\n4. **Private Information Retrieval (PIR):** Helps users query databases without revealing which\n   item they accessed.\n5. **Encrypted Search / Secure Indexing:** Enables keyword search over encrypted data while keeping\n   queries private.\n6. **Spam Prevention and Rate-Limiting:** Issues anonymous tokens to prevent abuse\n   (e.g., CAPTCHA bypass) without compromising user privacy.\n\n## Modes\n\n- OPRF: simple mode, client doesn't need to know server public key\n- VOPRF: verifable mode, allows client to verify that server used secret key corresponding to known public key\n- POPRF: partially oblivious mode, VOPRF + domain separation\n\nThere is also non-interactive mode (Evaluate) that supports creating Output in non-interactive mode with knowledge of secret key.\n\nFlow:\n- (once) Server generates secret and public keys, distributes public keys to clients\n  - deterministically: `deriveKeyPair` or just random: `generateKeyPair`\n- Client blinds input: `blind(secretInput)`\n- Server evaluates blinded input: `blindEvaluate` generated by client, sends result to client\n- Client creates output using result of evaluation via 'finalize'\n\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport {\n  abytes,\n  asciiToBytes,\n  bytesToNumberBE,\n  bytesToNumberLE,\n  concatBytes,\n  numberToBytesBE,\n  randomBytes,\n  validateObject,\n} from '../utils.ts';\nimport { pippenger, type CurvePoint, type CurvePointCons } from './curve.ts';\nimport { _DST_scalar, type H2CDSTOpts } from './hash-to-curve.ts';\nimport { getMinHashLength, mapHashToField } from './modular.ts';\n\n// OPRF is designed to be used across network, so we default to serialized values.\nexport type PointBytes = Uint8Array;\nexport type ScalarBytes = Uint8Array;\nexport type Bytes = Uint8Array;\nexport type RNG = typeof randomBytes;\n\nexport type OPRFOpts<P extends CurvePoint<any, P>> = {\n  name: string;\n  Point: CurvePointCons<P>; // we don't return Point, so we need generic interface only\n  // Fn: IField<bigint>;\n  hash(msg: Bytes): Bytes;\n  hashToScalar(msg: Uint8Array, options: H2CDSTOpts): bigint;\n  hashToGroup(msg: Uint8Array, options: H2CDSTOpts): P;\n};\n\nexport type OPRFKeys = { secretKey: ScalarBytes; publicKey: PointBytes };\nexport type OPRFBlind = { blind: Uint8Array; blinded: Uint8Array };\nexport type OPRFBlindEval = { evaluated: PointBytes; proof: Bytes };\nexport type OPRFBlindEvalBatch = { evaluated: PointBytes[]; proof: Bytes };\nexport type OPRFFinalizeItem = {\n  input: Bytes;\n  blind: ScalarBytes;\n  evaluated: PointBytes;\n  blinded: PointBytes;\n};\n\n/**\n * Represents a full OPRF ciphersuite implementation according to RFC 9497.\n * This object bundles the three protocol variants (OPRF, VOPRF, POPRF) for a specific\n * prime-order group and hash function combination.\n *\n * @see https://www.rfc-editor.org/rfc/rfc9497.html\n */\nexport type OPRF = {\n  /**\n   * The unique identifier for the ciphersuite, e.g., \"ristretto255-SHA512\".\n   * This name is used for domain separation to prevent cross-protocol attacks.\n   */\n  readonly name: string;\n\n  /**\n   * The base Oblivious Pseudorandom Function (OPRF) mode (mode 0x00).\n   * This is a two-party protocol between a client and a server to compute F(k, x)\n   * where 'k' is the server's key and 'x' is the client's input.\n   *\n   * The client learns the output F(k, x) but nothing about 'k'.\n   * The server learns nothing about 'x' or F(k, x).\n   * This mode is NOT verifiable; the client cannot prove the server used a specific key.\n   */\n  readonly oprf: {\n    /**\n     * (Server-side) Generates a new random private/public key pair for the server.\n     * @returns A new key pair.\n     */\n    generateKeyPair(): OPRFKeys;\n\n    /**\n     * (Server-side) Deterministically derives a private/public key pair from a seed.\n     * @param seed A 32-byte cryptographically secure random seed.\n     * @param keyInfo An optional byte string for domain separation.\n     * @returns The derived key pair.\n     */\n    deriveKeyPair(seed: Bytes, keyInfo: Bytes): OPRFKeys;\n\n    /**\n     * (Client-side) The first step of the protocol. The client blinds its private input.\n     * @param input The client's private input bytes.\n     * @param rng An optional cryptographically secure random number generator.\n     * @returns An object containing the `blind` scalar (which the client MUST keep secret)\n     * and the `blinded` element (which the client sends to the server).\n     */\n    blind(input: Bytes, rng?: RNG): OPRFBlind;\n\n    /**\n     * (Server-side) The second step. The server evaluates the client's blinded element\n     * using its secret key.\n     * @param secretKey The server's private key.\n     * @param blinded The blinded group element received from the client.\n     * @returns The evaluated group element, to be sent back to the client.\n     */\n    blindEvaluate(secretKey: ScalarBytes, blinded: PointBytes): PointBytes;\n\n    /**\n     * (Client-side) The final step. The client unblinds the server's response to\n     * compute the final OPRF output.\n     * @param input The original private input from the `blind` step.\n     * @param blind The secret scalar from the `blind` step.\n     * @param evaluated The evaluated group element received from the server.\n     * @returns The final OPRF output, `Hash(len(input)||input||len(unblinded)||unblinded||\"Finalize\")`.\n     */\n    finalize(input: Bytes, blind: ScalarBytes, evaluated: PointBytes): Bytes;\n  };\n\n  /**\n   * The Verifiable Oblivious Pseudorandom Function (VOPRF) mode (mode 0x01).\n   * This mode extends the base OPRF by providing a proof that the server used the\n   * secret key corresponding to its known public key.\n   */\n  readonly voprf: {\n    /** (Server-side) Generates a key pair for the VOPRF mode. */\n    generateKeyPair(): OPRFKeys;\n    /** (Server-side) Deterministically derives a key pair for the VOPRF mode. */\n    deriveKeyPair(seed: Bytes, keyInfo: Bytes): OPRFKeys;\n    /** (Client-side) Blinds the client's private input for the VOPRF protocol. */\n    blind(input: Bytes, rng?: RNG): OPRFBlind;\n\n    /**\n     * (Server-side) Evaluates the client's blinded element and generates a DLEQ proof\n     * of correctness.\n     * @param secretKey The server's private key.\n     * @param publicKey The server's public key, used in proof generation.\n     * @param blinded The blinded group element received from the client.\n     * @param rng An optional cryptographically secure random number generator for the proof.\n     * @returns The evaluated element and a proof of correct computation.\n     */\n    blindEvaluate(\n      secretKey: ScalarBytes,\n      publicKey: PointBytes,\n      blinded: PointBytes,\n      rng?: RNG\n    ): OPRFBlindEval;\n\n    /**\n     * (Server-side) An optimized batch version of `blindEvaluate`. It evaluates multiple\n     * blinded elements and produces a single, constant-size proof for the entire batch,\n     * amortizing the cost of proof generation.\n     * @param secretKey The server's private key.\n     * @param publicKey The server's public key.\n     * @param blinded An array of blinded group elements from one or more clients.\n     * @param rng An optional cryptographically secure random number generator for the proof.\n     * @returns An array of evaluated elements and a single proof for the batch.\n     */\n    blindEvaluateBatch(\n      secretKey: ScalarBytes,\n      publicKey: PointBytes,\n      blinded: PointBytes[],\n      rng?: RNG\n    ): OPRFBlindEvalBatch;\n\n    /**\n     * (Client-side) The final step. The client verifies the server's proof, and if valid,\n     * unblinds the result to compute the final VOPRF output.\n     * @param input The original private input.\n     * @param blind The secret scalar from the `blind` step.\n     * @param evaluated The evaluated element from the server.\n     * @param blinded The blinded element sent to the server (needed for proof verification).\n     * @param publicKey The server's public key against which the proof is verified.\n     * @param proof The DLEQ proof from the server.\n     * @returns The final VOPRF output.\n     * @throws If the proof verification fails.\n     */\n    finalize(\n      input: Bytes,\n      blind: ScalarBytes,\n      evaluated: PointBytes,\n      blinded: PointBytes,\n      publicKey: PointBytes,\n      proof: Bytes\n    ): Bytes;\n\n    /**\n     * (Client-side) The batch-aware version of `finalize`. It verifies a single batch proof\n     * against a list of corresponding inputs and outputs.\n     * @param items An array of objects, each containing the parameters for a single finalization.\n     * @param publicKey The server's public key.\n     * @param proof The single DLEQ proof for the entire batch.\n     * @returns An array of final VOPRF outputs, one for each item in the input.\n     * @throws If the proof verification fails.\n     */\n    finalizeBatch(items: OPRFFinalizeItem[], publicKey: PointBytes, proof: Bytes): Bytes[];\n  };\n\n  /**\n   * A factory for the Partially Oblivious Pseudorandom Function (POPRF) mode (mode 0x02).\n   * This mode extends VOPRF to include a public `info` parameter, known to both client and\n   * server, which is cryptographically bound to the final output.\n   * This is useful for domain separation at the application level.\n   * @param info A public byte string to be mixed into the computation.\n   * @returns An object with the POPRF protocol functions.\n   */\n  readonly poprf: (info: Bytes) => {\n    /** (Server-side) Generates a key pair for the POPRF mode. */\n    generateKeyPair(): OPRFKeys;\n    /** (Server-side) Deterministically derives a key pair for the POPRF mode. */\n    deriveKeyPair(seed: Bytes, keyInfo: Bytes): OPRFKeys;\n\n    /**\n     * (Client-side) Blinds the client's private input and computes the \"tweaked key\".\n     * The tweaked key is a public value derived from the server's public key and the public `info`.\n     * @param input The client's private input.\n     * @param publicKey The server's public key.\n     * @param rng An optional cryptographically secure random number generator.\n     * @returns The `blind`, `blinded` element, and the `tweakedKey` which the client uses for verification.\n     */\n    blind(input: Bytes, publicKey: PointBytes, rng?: RNG): OPRFBlind & { tweakedKey: PointBytes };\n\n    /**\n     * (Server-side) Evaluates the blinded element using a key derived from its secret key and the public `info`.\n     * It generates a DLEQ proof against the tweaked key.\n     * @param secretKey The server's private key.\n     * @param blinded The blinded element from the client.\n     * @param rng An optional RNG for the proof.\n     * @returns The evaluated element and a proof of correct computation.\n     */\n    blindEvaluate(secretKey: ScalarBytes, blinded: PointBytes, rng?: RNG): OPRFBlindEval;\n\n    /**\n     * (Server-side) A batch-aware version of `blindEvaluate` for the POPRF mode.\n     * @param secretKey The server's private key.\n     * @param blinded An array of blinded elements.\n     * @param rng An optional RNG for the proof.\n     * @returns An array of evaluated elements and a single proof for the batch.\n     */\n    blindEvaluateBatch(secretKey: ScalarBytes, blinded: PointBytes[], rng: RNG): OPRFBlindEvalBatch;\n\n    /**\n     * (Client-side) A batch-aware version of `finalize` for the POPRF mode.\n     * It verifies the proof against the tweaked key.\n     * @param items An array containing the parameters for each finalization.\n     * @param proof The single DLEQ proof for the batch.\n     * @param tweakedKey The tweaked key corresponding to the proof (all items must share the same `info` and `publicKey`).\n     * @returns An array of final POPRF outputs.\n     * @throws If proof verification fails.\n     */\n    finalizeBatch(items: OPRFFinalizeItem[], proof: Bytes, tweakedKey: PointBytes): Bytes[];\n\n    /**\n     * (Client-side) Finalizes the POPRF protocol. It verifies the server's proof against the\n     * `tweakedKey` computed in the `blind` step. The final output is bound to the public `info`.\n     * @param input The original private input.\n     * @param blind The secret scalar.\n     * @param evaluated The evaluated element from the server.\n     * @param blinded The blinded element sent to the server.\n     * @param proof The DLEQ proof from the server.\n     * @param tweakedKey The public tweaked key computed by the client during the `blind` step.\n     * @returns The final POPRF output.\n     * @throws If proof verification fails.\n     */\n    finalize(\n      input: Bytes,\n      blind: ScalarBytes,\n      evaluated: PointBytes,\n      blinded: PointBytes,\n      proof: Bytes,\n      tweakedKey: PointBytes\n    ): Bytes;\n\n    /**\n     * A non-interactive evaluation function for an entity that knows all inputs.\n     * Computes the final POPRF output directly. Useful for testing or specific applications\n     * where the server needs to compute the output for a known input.\n     * @param secretKey The server's private key.\n     * @param input The client's private input.\n     * @returns The final POPRF output.\n     */\n    evaluate(secretKey: ScalarBytes, input: Bytes): Bytes;\n  };\n};\n\n// welcome to generic hell\nexport function createORPF<P extends CurvePoint<any, P>>(opts: OPRFOpts<P>): OPRF {\n  validateObject(opts, {\n    name: 'string',\n    hash: 'function',\n    hashToScalar: 'function',\n    hashToGroup: 'function',\n  });\n  // TODO\n  // Point: 'point',\n  const { name, Point, hash } = opts;\n  const { Fn } = Point;\n\n  const hashToGroup = (msg: Uint8Array, ctx: Uint8Array) =>\n    opts.hashToGroup(msg, {\n      DST: concatBytes(asciiToBytes('HashToGroup-'), ctx),\n    }) as P;\n  const hashToScalarPrefixed = (msg: Uint8Array, ctx: Uint8Array) =>\n    opts.hashToScalar(msg, { DST: concatBytes(_DST_scalar, ctx) });\n  const randomScalar = (rng: RNG = randomBytes) => {\n    const t = mapHashToField(rng(getMinHashLength(Fn.ORDER)), Fn.ORDER, Fn.isLE);\n    // We cannot use Fn.fromBytes here, because field\n    // can have different number of bytes (like ed448)\n    return Fn.isLE ? bytesToNumberLE(t) : bytesToNumberBE(t);\n  };\n\n  const msm = (points: P[], scalars: bigint[]) => pippenger(Point, points, scalars);\n\n  const getCtx = (mode: number) =>\n    concatBytes(asciiToBytes('OPRFV1-'), new Uint8Array([mode]), asciiToBytes('-' + name));\n  const ctxOPRF = getCtx(0x00);\n  const ctxVOPRF = getCtx(0x01);\n  const ctxPOPRF = getCtx(0x02);\n\n  function encode(...args: (Uint8Array | number | string)[]) {\n    const res = [];\n    for (const a of args) {\n      if (typeof a === 'number') res.push(numberToBytesBE(a, 2));\n      else if (typeof a === 'string') res.push(asciiToBytes(a));\n      else {\n        abytes(a);\n        res.push(numberToBytesBE(a.length, 2), a);\n      }\n    }\n    // No wipe here, since will modify actual bytes\n    return concatBytes(...res);\n  }\n  const hashInput = (...bytes: Uint8Array[]) => hash(encode(...bytes, 'Finalize'));\n\n  function getTranscripts(B: P, C: P[], D: P[], ctx: Bytes) {\n    const Bm = B.toBytes();\n    const seed = hash(encode(Bm, concatBytes(asciiToBytes('Seed-'), ctx)));\n    const res: bigint[] = [];\n    for (let i = 0; i < C.length; i++) {\n      const Ci = C[i].toBytes();\n      const Di = D[i].toBytes();\n      const di = hashToScalarPrefixed(encode(seed, i, Ci, Di, 'Composite'), ctx);\n      res.push(di);\n    }\n    return res;\n  }\n\n  function computeComposites(B: P, C: P[], D: P[], ctx: Bytes) {\n    const T = getTranscripts(B, C, D, ctx);\n    const M = msm(C, T);\n    const Z = msm(D, T);\n    return { M, Z };\n  }\n\n  function computeCompositesFast(k: bigint, B: P, C: P[], D: P[], ctx: Bytes): { M: P; Z: P } {\n    const T = getTranscripts(B, C, D, ctx);\n    const M = msm(C, T);\n    const Z = M.multiply(k);\n    return { M, Z };\n  }\n\n  function challengeTranscript(B: P, M: P, Z: P, t2: P, t3: P, ctx: Bytes) {\n    const [Bm, a0, a1, a2, a3] = [B, M, Z, t2, t3].map((i) => i.toBytes());\n    return hashToScalarPrefixed(encode(Bm, a0, a1, a2, a3, 'Challenge'), ctx);\n  }\n\n  function generateProof(ctx: Bytes, k: bigint, B: P, C: P[], D: P[], rng: RNG) {\n    const { M, Z } = computeCompositesFast(k, B, C, D, ctx);\n    const r = randomScalar(rng);\n    const t2 = Point.BASE.multiply(r);\n    const t3 = M.multiply(r);\n    const c = challengeTranscript(B, M, Z, t2, t3, ctx);\n    const s = Fn.sub(r, Fn.mul(c, k)); // r - c*k\n    return concatBytes(...[c, s].map((i) => Fn.toBytes(i)));\n  }\n\n  function verifyProof(ctx: Bytes, B: P, C: P[], D: P[], proof: Bytes) {\n    abytes(proof, 2 * Fn.BYTES);\n    const { M, Z } = computeComposites(B, C, D, ctx);\n    const [c, s] = [proof.subarray(0, Fn.BYTES), proof.subarray(Fn.BYTES)].map((f) =>\n      Fn.fromBytes(f)\n    );\n    const t2 = Point.BASE.multiply(s).add(B.multiply(c)); // s*G + c*B\n    const t3 = M.multiply(s).add(Z.multiply(c)); // s*M + c*Z\n    const expectedC = challengeTranscript(B, M, Z, t2, t3, ctx);\n    if (!Fn.eql(c, expectedC)) throw new Error('proof verification failed');\n  }\n\n  function generateKeyPair() {\n    const skS = randomScalar();\n    const pkS = Point.BASE.multiply(skS);\n    return { secretKey: Fn.toBytes(skS), publicKey: pkS.toBytes() };\n  }\n\n  function deriveKeyPair(ctx: Bytes, seed: Bytes, info: Bytes) {\n    const dst = concatBytes(asciiToBytes('DeriveKeyPair'), ctx);\n    const msg = concatBytes(seed, encode(info), Uint8Array.of(0));\n    for (let counter = 0; counter <= 255; counter++) {\n      msg[msg.length - 1] = counter;\n      const skS = opts.hashToScalar(msg, { DST: dst });\n      if (Fn.is0(skS)) continue; // should not happen\n      return { secretKey: Fn.toBytes(skS), publicKey: Point.BASE.multiply(skS).toBytes() };\n    }\n    throw new Error('Cannot derive key');\n  }\n  function blind(ctx: Bytes, input: Uint8Array, rng: RNG = randomBytes) {\n    const blind = randomScalar(rng);\n    const inputPoint = hashToGroup(input, ctx);\n    if (inputPoint.equals(Point.ZERO)) throw new Error('Input point at infinity');\n    const blinded = inputPoint.multiply(blind);\n    return { blind: Fn.toBytes(blind), blinded: blinded.toBytes() };\n  }\n  function evaluate(ctx: Bytes, secretKey: ScalarBytes, input: Bytes) {\n    const skS = Fn.fromBytes(secretKey);\n    const inputPoint = hashToGroup(input, ctx);\n    if (inputPoint.equals(Point.ZERO)) throw new Error('Input point at infinity');\n    const unblinded = inputPoint.multiply(skS).toBytes();\n    return hashInput(input, unblinded);\n  }\n  const oprf = {\n    generateKeyPair,\n    deriveKeyPair: (seed: Bytes, keyInfo: Bytes) => deriveKeyPair(ctxOPRF, seed, keyInfo),\n    blind: (input: Bytes, rng: RNG = randomBytes) => blind(ctxOPRF, input, rng),\n    blindEvaluate(secretKey: ScalarBytes, blindedPoint: PointBytes) {\n      const skS = Fn.fromBytes(secretKey);\n      const elm = Point.fromBytes(blindedPoint);\n      return elm.multiply(skS).toBytes();\n    },\n    finalize(input: Bytes, blindBytes: ScalarBytes, evaluatedBytes: PointBytes) {\n      const blind = Fn.fromBytes(blindBytes);\n      const evalPoint = Point.fromBytes(evaluatedBytes);\n      const unblinded = evalPoint.multiply(Fn.inv(blind)).toBytes();\n      return hashInput(input, unblinded);\n    },\n    evaluate: (secretKey: ScalarBytes, input: Bytes) => evaluate(ctxOPRF, secretKey, input),\n  };\n\n  const voprf = {\n    generateKeyPair,\n    deriveKeyPair: (seed: Bytes, keyInfo: Bytes) => deriveKeyPair(ctxVOPRF, seed, keyInfo),\n    blind: (input: Bytes, rng: RNG = randomBytes) => blind(ctxVOPRF, input, rng),\n    blindEvaluateBatch(\n      secretKey: ScalarBytes,\n      publicKey: PointBytes,\n      blinded: PointBytes[],\n      rng: RNG = randomBytes\n    ) {\n      if (!Array.isArray(blinded)) throw new Error('expected array');\n      const skS = Fn.fromBytes(secretKey);\n      const pkS = Point.fromBytes(publicKey);\n      const blindedPoints = blinded.map(Point.fromBytes);\n      const evaluated = blindedPoints.map((i) => i.multiply(skS));\n      const proof = generateProof(ctxVOPRF, skS, pkS, blindedPoints, evaluated, rng);\n      return { evaluated: evaluated.map((i) => i.toBytes()), proof };\n    },\n    blindEvaluate(\n      secretKey: ScalarBytes,\n      publicKey: PointBytes,\n      blinded: PointBytes,\n      rng: RNG = randomBytes\n    ) {\n      const res = this.blindEvaluateBatch(secretKey, publicKey, [blinded], rng);\n      return { evaluated: res.evaluated[0], proof: res.proof };\n    },\n    finalizeBatch(items: OPRFFinalizeItem[], publicKey: PointBytes, proof: Bytes) {\n      if (!Array.isArray(items)) throw new Error('expected array');\n      const pkS = Point.fromBytes(publicKey);\n      const blindedPoints = items.map((i) => i.blinded).map(Point.fromBytes);\n      const evalPoints = items.map((i) => i.evaluated).map(Point.fromBytes);\n      verifyProof(ctxVOPRF, pkS, blindedPoints, evalPoints, proof);\n      return items.map((i) => oprf.finalize(i.input, i.blind, i.evaluated));\n    },\n    finalize(\n      input: Bytes,\n      blind: ScalarBytes,\n      evaluated: PointBytes,\n      blinded: PointBytes,\n      publicKey: PointBytes,\n      proof: Bytes\n    ) {\n      return this.finalizeBatch([{ input, blind, evaluated, blinded }], publicKey, proof)[0];\n    },\n    evaluate: (secretKey: ScalarBytes, input: Bytes) => evaluate(ctxVOPRF, secretKey, input),\n  };\n  // NOTE: info is domain separation\n  const poprf = (info: Bytes) => {\n    const m = hashToScalarPrefixed(encode('Info', info), ctxPOPRF);\n    const T = Point.BASE.multiply(m);\n    return {\n      generateKeyPair,\n      deriveKeyPair: (seed: Bytes, keyInfo: Bytes) => deriveKeyPair(ctxPOPRF, seed, keyInfo),\n      blind(input: Bytes, publicKey: PointBytes, rng: RNG = randomBytes) {\n        const pkS = Point.fromBytes(publicKey);\n        const tweakedKey = T.add(pkS);\n        if (tweakedKey.equals(Point.ZERO)) throw new Error('tweakedKey point at infinity');\n        const blind = randomScalar(rng);\n        const inputPoint = hashToGroup(input, ctxPOPRF);\n        if (inputPoint.equals(Point.ZERO)) throw new Error('Input point at infinity');\n        const blindedPoint = inputPoint.multiply(blind);\n        return {\n          blind: Fn.toBytes(blind),\n          blinded: blindedPoint.toBytes(),\n          tweakedKey: tweakedKey.toBytes(),\n        };\n      },\n      blindEvaluateBatch(secretKey: ScalarBytes, blinded: PointBytes[], rng: RNG = randomBytes) {\n        if (!Array.isArray(blinded)) throw new Error('expected array');\n        const skS = Fn.fromBytes(secretKey);\n        const t = Fn.add(skS, m);\n        // \"Hence, this error can be a signal for the server to replace its private key\". We throw inside,\n        // should be impossible.\n        const invT = Fn.inv(t);\n        const blindedPoints = blinded.map(Point.fromBytes);\n        const evalPoints = blindedPoints.map((i) => i.multiply(invT));\n        const tweakedKey = Point.BASE.multiply(t);\n        const proof = generateProof(ctxPOPRF, t, tweakedKey, evalPoints, blindedPoints, rng);\n        return { evaluated: evalPoints.map((i) => i.toBytes()), proof };\n      },\n      blindEvaluate(secretKey: ScalarBytes, blinded: PointBytes, rng: RNG = randomBytes) {\n        const res = this.blindEvaluateBatch(secretKey, [blinded], rng);\n        return { evaluated: res.evaluated[0], proof: res.proof };\n      },\n      finalizeBatch(items: OPRFFinalizeItem[], proof: Bytes, tweakedKey: PointBytes) {\n        if (!Array.isArray(items)) throw new Error('expected array');\n        const evalPoints = items.map((i) => i.evaluated).map(Point.fromBytes);\n        verifyProof(\n          ctxPOPRF,\n          Point.fromBytes(tweakedKey),\n          evalPoints,\n          items.map((i) => i.blinded).map(Point.fromBytes),\n          proof\n        );\n        return items.map((i, j) => {\n          const blind = Fn.fromBytes(i.blind);\n          const point = evalPoints[j].multiply(Fn.inv(blind)).toBytes();\n          return hashInput(i.input, info, point);\n        });\n      },\n      finalize(\n        input: Bytes,\n        blind: ScalarBytes,\n        evaluated: PointBytes,\n        blinded: PointBytes,\n        proof: Bytes,\n        tweakedKey: PointBytes\n      ) {\n        return this.finalizeBatch([{ input, blind, evaluated, blinded }], proof, tweakedKey)[0];\n      },\n      evaluate(secretKey: ScalarBytes, input: Bytes) {\n        const skS = Fn.fromBytes(secretKey);\n        const inputPoint = hashToGroup(input, ctxPOPRF);\n        if (inputPoint.equals(Point.ZERO)) throw new Error('Input point at infinity');\n        const t = Fn.add(skS, m);\n        const invT = Fn.inv(t);\n        const unblinded = inputPoint.multiply(invT).toBytes();\n        return hashInput(input, info, unblinded);\n      },\n    };\n  };\n  return Object.freeze({ name, oprf, voprf, poprf, __tests: { Fn } });\n}\n", "/**\n * ed25519 Twisted Edwards curve with following addons:\n * - X25519 ECDH\n * - Ristretto cofactor elimination\n * - Elligator hash-to-group / point indistinguishability\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { sha512 } from '@noble/hashes/sha2.js';\nimport { abytes, concatBytes, hexToBytes } from '@noble/hashes/utils.js';\nimport { type AffinePoint } from './abstract/curve.ts';\nimport {\n  eddsa,\n  edwards,\n  PrimeEdwardsPoint,\n  type EdDSA,\n  type EdDSAOpts,\n  type EdwardsOpts,\n  type EdwardsPoint,\n  type EdwardsPointCons,\n} from './abstract/edwards.ts';\nimport {\n  _DST_scalar,\n  createHasher,\n  expand_message_xmd,\n  type H2CDSTOpts,\n  type H2CHasher,\n  type H2CHasherBase,\n} from './abstract/hash-to-curve.ts';\nimport {\n  FpInvertBatch,\n  FpSqrtEven,\n  isNegativeLE,\n  mod,\n  pow2,\n  type IField,\n} from './abstract/modular.ts';\nimport { montgomery, type MontgomeryECDH } from './abstract/montgomery.ts';\nimport { createORPF, type OPRF } from './abstract/oprf.ts';\nimport { asciiToBytes, bytesToNumberLE, equalBytes } from './utils.ts';\n\n// prettier-ignore\nconst _0n = /* @__PURE__ */ BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = /* @__PURE__ */ BigInt(3);\n// prettier-ignore\nconst _5n = BigInt(5), _8n = BigInt(8);\n\n// P = 2n**255n - 19n\nconst ed25519_CURVE_p = BigInt(\n  '0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed'\n);\n// N = 2n**252n + 27742317777372353535851937790883648493n\n// a = Fp.create(BigInt(-1))\n// d = -121665/121666 a.k.a. Fp.neg(121665 * Fp.inv(121666))\nconst ed25519_CURVE: EdwardsOpts = /* @__PURE__ */ (() => ({\n  p: ed25519_CURVE_p,\n  n: BigInt('0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed'),\n  h: _8n,\n  a: BigInt('0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec'),\n  d: BigInt('0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3'),\n  Gx: BigInt('0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a'),\n  Gy: BigInt('0x6666666666666666666666666666666666666666666666666666666666666658'),\n}))();\n\nfunction ed25519_pow_2_252_3(x: bigint) {\n  // prettier-ignore\n  const _10n = BigInt(10), _20n = BigInt(20), _40n = BigInt(40), _80n = BigInt(80);\n  const P = ed25519_CURVE_p;\n  const x2 = (x * x) % P;\n  const b2 = (x2 * x) % P; // x^3, 11\n  const b4 = (pow2(b2, _2n, P) * b2) % P; // x^15, 1111\n  const b5 = (pow2(b4, _1n, P) * x) % P; // x^31\n  const b10 = (pow2(b5, _5n, P) * b5) % P;\n  const b20 = (pow2(b10, _10n, P) * b10) % P;\n  const b40 = (pow2(b20, _20n, P) * b20) % P;\n  const b80 = (pow2(b40, _40n, P) * b40) % P;\n  const b160 = (pow2(b80, _80n, P) * b80) % P;\n  const b240 = (pow2(b160, _80n, P) * b80) % P;\n  const b250 = (pow2(b240, _10n, P) * b10) % P;\n  const pow_p_5_8 = (pow2(b250, _2n, P) * x) % P;\n  // ^ To pow to (p+3)/8, multiply it by x.\n  return { pow_p_5_8, b2 };\n}\n\nfunction adjustScalarBytes(bytes: Uint8Array): Uint8Array {\n  // Section 5: For X25519, in order to decode 32 random bytes as an integer scalar,\n  // set the three least significant bits of the first byte\n  bytes[0] &= 248; // 0b1111_1000\n  // and the most significant bit of the last to zero,\n  bytes[31] &= 127; // 0b0111_1111\n  // set the second most significant bit of the last byte to 1\n  bytes[31] |= 64; // 0b0100_0000\n  return bytes;\n}\n\n// \u221A(-1) aka \u221A(a) aka 2^((p-1)/4)\n// Fp.sqrt(Fp.neg(1))\nconst ED25519_SQRT_M1 = /* @__PURE__ */ BigInt(\n  '19681161376707505956807079304988542015446066515923890162744021073123829784752'\n);\n// sqrt(u/v)\nfunction uvRatio(u: bigint, v: bigint): { isValid: boolean; value: bigint } {\n  const P = ed25519_CURVE_p;\n  const v3 = mod(v * v * v, P); // v\u00B3\n  const v7 = mod(v3 * v3 * v, P); // v\u2077\n  // (p+3)/8 and (p-5)/8\n  const pow = ed25519_pow_2_252_3(u * v7).pow_p_5_8;\n  let x = mod(u * v3 * pow, P); // (uv\u00B3)(uv\u2077)^(p-5)/8\n  const vx2 = mod(v * x * x, P); // vx\u00B2\n  const root1 = x; // First root candidate\n  const root2 = mod(x * ED25519_SQRT_M1, P); // Second root candidate\n  const useRoot1 = vx2 === u; // If vx\u00B2 = u (mod p), x is a square root\n  const useRoot2 = vx2 === mod(-u, P); // If vx\u00B2 = -u, set x <-- x * 2^((p-1)/4)\n  const noRoot = vx2 === mod(-u * ED25519_SQRT_M1, P); // There is no valid root, vx\u00B2 = -u\u221A(-1)\n  if (useRoot1) x = root1;\n  if (useRoot2 || noRoot) x = root2; // We return root2 anyway, for const-time\n  if (isNegativeLE(x, P)) x = mod(-x, P);\n  return { isValid: useRoot1 || useRoot2, value: x };\n}\n\nconst ed25519_Point = /* @__PURE__ */ edwards(ed25519_CURVE, { uvRatio });\nconst Fp = /* @__PURE__ */ (() => ed25519_Point.Fp)();\nconst Fn = /* @__PURE__ */ (() => ed25519_Point.Fn)();\n\nfunction ed25519_domain(data: Uint8Array, ctx: Uint8Array, phflag: boolean) {\n  if (ctx.length > 255) throw new Error('Context is too big');\n  return concatBytes(\n    asciiToBytes('SigEd25519 no Ed25519 collisions'),\n    new Uint8Array([phflag ? 1 : 0, ctx.length]),\n    ctx,\n    data\n  );\n}\n\nfunction ed(opts: EdDSAOpts) {\n  return eddsa(ed25519_Point, sha512, Object.assign({ adjustScalarBytes }, opts));\n}\n\n/**\n * ed25519 curve with EdDSA signatures.\n * @example\n * ```js\n * import { ed25519 } from '@noble/curves/ed25519.js';\n * const { secretKey, publicKey } = ed25519.keygen();\n * // const publicKey = ed25519.getPublicKey(secretKey);\n * const msg = new TextEncoder().encode('hello noble');\n * const sig = ed25519.sign(msg, secretKey);\n * const isValid = ed25519.verify(sig, msg, pub); // ZIP215\n * // RFC8032 / FIPS 186-5\n * const isValid2 = ed25519.verify(sig, msg, pub, { zip215: false });\n * ```\n */\nexport const ed25519: EdDSA = /* @__PURE__ */ ed({});\n/** Context version of ed25519 (ctx for domain separation). See {@link ed25519} */\nexport const ed25519ctx: EdDSA = /* @__PURE__ */ ed({ domain: ed25519_domain });\n/** Prehashed version of ed25519. See {@link ed25519} */\nexport const ed25519ph: EdDSA = /* @__PURE__ */ ed({ domain: ed25519_domain, prehash: sha512 });\n\n/**\n * ECDH using curve25519 aka x25519.\n * @example\n * ```js\n * import { x25519 } from '@noble/curves/ed25519.js';\n * const alice = x25519.keygen();\n * const bob = x25519.keygen();\n * const shared = x25519.getSharedSecret(alice.secretKey, bob.publicKey);\n * ```\n */\nexport const x25519: MontgomeryECDH = /* @__PURE__ */ (() => {\n  const P = ed25519_CURVE_p;\n  return montgomery({\n    P,\n    type: 'x25519',\n    powPminus2: (x: bigint): bigint => {\n      // x^(p-2) aka x^(2^255-21)\n      const { pow_p_5_8, b2 } = ed25519_pow_2_252_3(x);\n      return mod(pow2(pow_p_5_8, _3n, P) * b2, P);\n    },\n    adjustScalarBytes,\n  });\n})();\n\n// Hash To Curve Elligator2 Map (NOTE: different from ristretto255 elligator)\n// NOTE: very important part is usage of FpSqrtEven for ELL2_C1_EDWARDS, since\n// SageMath returns different root first and everything falls apart\nconst ELL2_C1 = /* @__PURE__ */ (() => (ed25519_CURVE_p + _3n) / _8n)(); // 1. c1 = (q + 3) / 8       # Integer arithmetic\nconst ELL2_C2 = /* @__PURE__ */ (() => Fp.pow(_2n, ELL2_C1))(); // 2. c2 = 2^c1\nconst ELL2_C3 = /* @__PURE__ */ (() => Fp.sqrt(Fp.neg(Fp.ONE)))(); // 3. c3 = sqrt(-1)\n\n/**\n * RFC 9380 method `map_to_curve_elligator2_curve25519`. Experimental name: may be renamed later.\n * @private\n */\n// prettier-ignore\nexport function _map_to_curve_elligator2_curve25519(u: bigint): {\n  xMn: bigint, xMd: bigint, yMn: bigint, yMd: bigint\n} {\n  const ELL2_C4 = (ed25519_CURVE_p - _5n) / _8n; // 4. c4 = (q - 5) / 8       # Integer arithmetic\n  const ELL2_J = BigInt(486662);\n\n  let tv1 = Fp.sqr(u);          //  1.  tv1 = u^2\n  tv1 = Fp.mul(tv1, _2n);       //  2.  tv1 = 2 * tv1\n  let xd = Fp.add(tv1, Fp.ONE); //  3.   xd = tv1 + 1         # Nonzero: -1 is square (mod p), tv1 is not\n  let x1n = Fp.neg(ELL2_J);     //  4.  x1n = -J              # x1 = x1n / xd = -J / (1 + 2 * u^2)\n  let tv2 = Fp.sqr(xd);         //  5.  tv2 = xd^2\n  let gxd = Fp.mul(tv2, xd);    //  6.  gxd = tv2 * xd        # gxd = xd^3\n  let gx1 = Fp.mul(tv1, ELL2_J);//  7.  gx1 = J * tv1         # x1n + J * xd\n  gx1 = Fp.mul(gx1, x1n);       //  8.  gx1 = gx1 * x1n       # x1n^2 + J * x1n * xd\n  gx1 = Fp.add(gx1, tv2);       //  9.  gx1 = gx1 + tv2       # x1n^2 + J * x1n * xd + xd^2\n  gx1 = Fp.mul(gx1, x1n);       //  10. gx1 = gx1 * x1n       # x1n^3 + J * x1n^2 * xd + x1n * xd^2\n  let tv3 = Fp.sqr(gxd);        //  11. tv3 = gxd^2\n  tv2 = Fp.sqr(tv3);            //  12. tv2 = tv3^2           # gxd^4\n  tv3 = Fp.mul(tv3, gxd);       //  13. tv3 = tv3 * gxd       # gxd^3\n  tv3 = Fp.mul(tv3, gx1);       //  14. tv3 = tv3 * gx1       # gx1 * gxd^3\n  tv2 = Fp.mul(tv2, tv3);       //  15. tv2 = tv2 * tv3       # gx1 * gxd^7\n  let y11 = Fp.pow(tv2, ELL2_C4); //  16. y11 = tv2^c4        # (gx1 * gxd^7)^((p - 5) / 8)\n  y11 = Fp.mul(y11, tv3);       //  17. y11 = y11 * tv3       # gx1*gxd^3*(gx1*gxd^7)^((p-5)/8)\n  let y12 = Fp.mul(y11, ELL2_C3); //  18. y12 = y11 * c3\n  tv2 = Fp.sqr(y11);            //  19. tv2 = y11^2\n  tv2 = Fp.mul(tv2, gxd);       //  20. tv2 = tv2 * gxd\n  let e1 = Fp.eql(tv2, gx1);    //  21.  e1 = tv2 == gx1\n  let y1 = Fp.cmov(y12, y11, e1); //  22.  y1 = CMOV(y12, y11, e1)  # If g(x1) is square, this is its sqrt\n  let x2n = Fp.mul(x1n, tv1);   //  23. x2n = x1n * tv1       # x2 = x2n / xd = 2 * u^2 * x1n / xd\n  let y21 = Fp.mul(y11, u);     //  24. y21 = y11 * u\n  y21 = Fp.mul(y21, ELL2_C2);   //  25. y21 = y21 * c2\n  let y22 = Fp.mul(y21, ELL2_C3); //  26. y22 = y21 * c3\n  let gx2 = Fp.mul(gx1, tv1);   //  27. gx2 = gx1 * tv1       # g(x2) = gx2 / gxd = 2 * u^2 * g(x1)\n  tv2 = Fp.sqr(y21);            //  28. tv2 = y21^2\n  tv2 = Fp.mul(tv2, gxd);       //  29. tv2 = tv2 * gxd\n  let e2 = Fp.eql(tv2, gx2);    //  30.  e2 = tv2 == gx2\n  let y2 = Fp.cmov(y22, y21, e2); //  31.  y2 = CMOV(y22, y21, e2)  # If g(x2) is square, this is its sqrt\n  tv2 = Fp.sqr(y1);             //  32. tv2 = y1^2\n  tv2 = Fp.mul(tv2, gxd);       //  33. tv2 = tv2 * gxd\n  let e3 = Fp.eql(tv2, gx1);    //  34.  e3 = tv2 == gx1\n  let xn = Fp.cmov(x2n, x1n, e3); //  35.  xn = CMOV(x2n, x1n, e3)  # If e3, x = x1, else x = x2\n  let y = Fp.cmov(y2, y1, e3);  //  36.   y = CMOV(y2, y1, e3)    # If e3, y = y1, else y = y2\n  let e4 = Fp.isOdd!(y);         //  37.  e4 = sgn0(y) == 1        # Fix sign of y\n  y = Fp.cmov(y, Fp.neg(y), e3 !== e4); //  38.   y = CMOV(y, -y, e3 XOR e4)\n  return { xMn: xn, xMd: xd, yMn: y, yMd: _1n }; //  39. return (xn, xd, y, 1)\n}\n\nconst ELL2_C1_EDWARDS = /* @__PURE__ */ (() => FpSqrtEven(Fp, Fp.neg(BigInt(486664))))(); // sgn0(c1) MUST equal 0\nfunction map_to_curve_elligator2_edwards25519(u: bigint) {\n  const { xMn, xMd, yMn, yMd } = _map_to_curve_elligator2_curve25519(u); //  1.  (xMn, xMd, yMn, yMd) =\n  // map_to_curve_elligator2_curve25519(u)\n  let xn = Fp.mul(xMn, yMd); //  2.  xn = xMn * yMd\n  xn = Fp.mul(xn, ELL2_C1_EDWARDS); //  3.  xn = xn * c1\n  let xd = Fp.mul(xMd, yMn); //  4.  xd = xMd * yMn    # xn / xd = c1 * xM / yM\n  let yn = Fp.sub(xMn, xMd); //  5.  yn = xMn - xMd\n  let yd = Fp.add(xMn, xMd); //  6.  yd = xMn + xMd    # (n / d - 1) / (n / d + 1) = (n - d) / (n + d)\n  let tv1 = Fp.mul(xd, yd); //  7. tv1 = xd * yd\n  let e = Fp.eql(tv1, Fp.ZERO); //  8.   e = tv1 == 0\n  xn = Fp.cmov(xn, Fp.ZERO, e); //  9.  xn = CMOV(xn, 0, e)\n  xd = Fp.cmov(xd, Fp.ONE, e); //  10. xd = CMOV(xd, 1, e)\n  yn = Fp.cmov(yn, Fp.ONE, e); //  11. yn = CMOV(yn, 1, e)\n  yd = Fp.cmov(yd, Fp.ONE, e); //  12. yd = CMOV(yd, 1, e)\n  const [xd_inv, yd_inv] = FpInvertBatch(Fp, [xd, yd], true); // batch division\n  return { x: Fp.mul(xn, xd_inv), y: Fp.mul(yn, yd_inv) }; //  13. return (xn, xd, yn, yd)\n}\n\n/** Hashing to ed25519 points / field. RFC 9380 methods. */\nexport const ed25519_hasher: H2CHasher<EdwardsPointCons> = /* @__PURE__ */ (() =>\n  createHasher(\n    ed25519_Point,\n    (scalars: bigint[]) => map_to_curve_elligator2_edwards25519(scalars[0]),\n    {\n      DST: 'edwards25519_XMD:SHA-512_ELL2_RO_',\n      encodeDST: 'edwards25519_XMD:SHA-512_ELL2_NU_',\n      p: ed25519_CURVE_p,\n      m: 1,\n      k: 128,\n      expand: 'xmd',\n      hash: sha512,\n    }\n  ))();\n\n// \u221A(-1) aka \u221A(a) aka 2^((p-1)/4)\nconst SQRT_M1 = ED25519_SQRT_M1;\n// \u221A(ad - 1)\nconst SQRT_AD_MINUS_ONE = /* @__PURE__ */ BigInt(\n  '25063068953384623474111414158702152701244531502492656460079210482610430750235'\n);\n// 1 / \u221A(a-d)\nconst INVSQRT_A_MINUS_D = /* @__PURE__ */ BigInt(\n  '54469307008909316920995813868745141605393597292927456921205312896311721017578'\n);\n// 1-d\u00B2\nconst ONE_MINUS_D_SQ = /* @__PURE__ */ BigInt(\n  '1159843021668779879193775521855586647937357759715417654439879720876111806838'\n);\n// (d-1)\u00B2\nconst D_MINUS_ONE_SQ = /* @__PURE__ */ BigInt(\n  '40440834346308536858101042469323190826248399146238708352240133220865137265952'\n);\n// Calculates 1/\u221A(number)\nconst invertSqrt = (number: bigint) => uvRatio(_1n, number);\n\nconst MAX_255B = /* @__PURE__ */ BigInt(\n  '0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'\n);\nconst bytes255ToNumberLE = (bytes: Uint8Array) => Fp.create(bytesToNumberLE(bytes) & MAX_255B);\n\n/**\n * Computes Elligator map for Ristretto255.\n * Described in [RFC9380](https://www.rfc-editor.org/rfc/rfc9380#appendix-B) and on\n * the [website](https://ristretto.group/formulas/elligator.html).\n */\nfunction calcElligatorRistrettoMap(r0: bigint): EdwardsPoint {\n  const { d } = ed25519_CURVE;\n  const P = ed25519_CURVE_p;\n  const mod = (n: bigint) => Fp.create(n);\n  const r = mod(SQRT_M1 * r0 * r0); // 1\n  const Ns = mod((r + _1n) * ONE_MINUS_D_SQ); // 2\n  let c = BigInt(-1); // 3\n  const D = mod((c - d * r) * mod(r + d)); // 4\n  let { isValid: Ns_D_is_sq, value: s } = uvRatio(Ns, D); // 5\n  let s_ = mod(s * r0); // 6\n  if (!isNegativeLE(s_, P)) s_ = mod(-s_);\n  if (!Ns_D_is_sq) s = s_; // 7\n  if (!Ns_D_is_sq) c = r; // 8\n  const Nt = mod(c * (r - _1n) * D_MINUS_ONE_SQ - D); // 9\n  const s2 = s * s;\n  const W0 = mod((s + s) * D); // 10\n  const W1 = mod(Nt * SQRT_AD_MINUS_ONE); // 11\n  const W2 = mod(_1n - s2); // 12\n  const W3 = mod(_1n + s2); // 13\n  return new ed25519_Point(mod(W0 * W3), mod(W2 * W1), mod(W1 * W3), mod(W0 * W2));\n}\n\n/**\n * Wrapper over Edwards Point for ristretto255.\n *\n * Each ed25519/EdwardsPoint has 8 different equivalent points. This can be\n * a source of bugs for protocols like ring signatures. Ristretto was created to solve this.\n * Ristretto point operates in X:Y:Z:T extended coordinates like EdwardsPoint,\n * but it should work in its own namespace: do not combine those two.\n * See [RFC9496](https://www.rfc-editor.org/rfc/rfc9496).\n */\nclass _RistrettoPoint extends PrimeEdwardsPoint<_RistrettoPoint> {\n  // Do NOT change syntax: the following gymnastics is done,\n  // because typescript strips comments, which makes bundlers disable tree-shaking.\n  // prettier-ignore\n  static BASE: _RistrettoPoint =\n    /* @__PURE__ */ (() => new _RistrettoPoint(ed25519_Point.BASE))();\n  // prettier-ignore\n  static ZERO: _RistrettoPoint =\n    /* @__PURE__ */ (() => new _RistrettoPoint(ed25519_Point.ZERO))();\n  // prettier-ignore\n  static Fp: IField<bigint> =\n    /* @__PURE__ */ (() => Fp)();\n  // prettier-ignore\n  static Fn: IField<bigint> =\n    /* @__PURE__ */ (() => Fn)();\n\n  constructor(ep: EdwardsPoint) {\n    super(ep);\n  }\n\n  static fromAffine(ap: AffinePoint<bigint>): _RistrettoPoint {\n    return new _RistrettoPoint(ed25519_Point.fromAffine(ap));\n  }\n\n  protected assertSame(other: _RistrettoPoint): void {\n    if (!(other instanceof _RistrettoPoint)) throw new Error('RistrettoPoint expected');\n  }\n\n  protected init(ep: EdwardsPoint): _RistrettoPoint {\n    return new _RistrettoPoint(ep);\n  }\n\n  static fromBytes(bytes: Uint8Array): _RistrettoPoint {\n    abytes(bytes, 32);\n    const { a, d } = ed25519_CURVE;\n    const P = ed25519_CURVE_p;\n    const mod = (n: bigint) => Fp.create(n);\n    const s = bytes255ToNumberLE(bytes);\n    // 1. Check that s_bytes is the canonical encoding of a field element, or else abort.\n    // 3. Check that s is non-negative, or else abort\n    if (!equalBytes(Fp.toBytes(s), bytes) || isNegativeLE(s, P))\n      throw new Error('invalid ristretto255 encoding 1');\n    const s2 = mod(s * s);\n    const u1 = mod(_1n + a * s2); // 4 (a is -1)\n    const u2 = mod(_1n - a * s2); // 5\n    const u1_2 = mod(u1 * u1);\n    const u2_2 = mod(u2 * u2);\n    const v = mod(a * d * u1_2 - u2_2); // 6\n    const { isValid, value: I } = invertSqrt(mod(v * u2_2)); // 7\n    const Dx = mod(I * u2); // 8\n    const Dy = mod(I * Dx * v); // 9\n    let x = mod((s + s) * Dx); // 10\n    if (isNegativeLE(x, P)) x = mod(-x); // 10\n    const y = mod(u1 * Dy); // 11\n    const t = mod(x * y); // 12\n    if (!isValid || isNegativeLE(t, P) || y === _0n)\n      throw new Error('invalid ristretto255 encoding 2');\n    return new _RistrettoPoint(new ed25519_Point(x, y, _1n, t));\n  }\n\n  /**\n   * Converts ristretto-encoded string to ristretto point.\n   * Described in [RFC9496](https://www.rfc-editor.org/rfc/rfc9496#name-decode).\n   * @param hex Ristretto-encoded 32 bytes. Not every 32-byte string is valid ristretto encoding\n   */\n  static fromHex(hex: string): _RistrettoPoint {\n    return _RistrettoPoint.fromBytes(hexToBytes(hex));\n  }\n\n  /**\n   * Encodes ristretto point to Uint8Array.\n   * Described in [RFC9496](https://www.rfc-editor.org/rfc/rfc9496#name-encode).\n   */\n  toBytes(): Uint8Array {\n    let { X, Y, Z, T } = this.ep;\n    const P = ed25519_CURVE_p;\n    const mod = (n: bigint) => Fp.create(n);\n    const u1 = mod(mod(Z + Y) * mod(Z - Y)); // 1\n    const u2 = mod(X * Y); // 2\n    // Square root always exists\n    const u2sq = mod(u2 * u2);\n    const { value: invsqrt } = invertSqrt(mod(u1 * u2sq)); // 3\n    const D1 = mod(invsqrt * u1); // 4\n    const D2 = mod(invsqrt * u2); // 5\n    const zInv = mod(D1 * D2 * T); // 6\n    let D: bigint; // 7\n    if (isNegativeLE(T * zInv, P)) {\n      let _x = mod(Y * SQRT_M1);\n      let _y = mod(X * SQRT_M1);\n      X = _x;\n      Y = _y;\n      D = mod(D1 * INVSQRT_A_MINUS_D);\n    } else {\n      D = D2; // 8\n    }\n    if (isNegativeLE(X * zInv, P)) Y = mod(-Y); // 9\n    let s = mod((Z - Y) * D); // 10 (check footer's note, no sqrt(-a))\n    if (isNegativeLE(s, P)) s = mod(-s);\n    return Fp.toBytes(s); // 11\n  }\n\n  /**\n   * Compares two Ristretto points.\n   * Described in [RFC9496](https://www.rfc-editor.org/rfc/rfc9496#name-equals).\n   */\n  equals(other: _RistrettoPoint): boolean {\n    this.assertSame(other);\n    const { X: X1, Y: Y1 } = this.ep;\n    const { X: X2, Y: Y2 } = other.ep;\n    const mod = (n: bigint) => Fp.create(n);\n    // (x1 * y2 == y1 * x2) | (y1 * y2 == x1 * x2)\n    const one = mod(X1 * Y2) === mod(Y1 * X2);\n    const two = mod(Y1 * Y2) === mod(X1 * X2);\n    return one || two;\n  }\n\n  is0(): boolean {\n    return this.equals(_RistrettoPoint.ZERO);\n  }\n}\n\nexport const ristretto255: {\n  Point: typeof _RistrettoPoint;\n} = { Point: _RistrettoPoint };\n\n/** Hashing to ristretto255 points / field. RFC 9380 methods. */\nexport const ristretto255_hasher: H2CHasherBase<typeof _RistrettoPoint> = {\n  Point: _RistrettoPoint,\n  /**\n  * Spec: https://www.rfc-editor.org/rfc/rfc9380.html#name-hashing-to-ristretto255. Caveats:\n  * * There are no test vectors\n  * * encodeToCurve / mapToCurve is undefined\n  * * mapToCurve would be `calcElligatorRistrettoMap(scalars[0])`, not ristretto255_map!\n  * * hashToScalar is undefined too, so we just use OPRF implementation\n  * * We cannot re-use 'createHasher', because ristretto255_map is different algorithm/RFC\n    (os2ip -> bytes255ToNumberLE)\n  * * mapToCurve == calcElligatorRistrettoMap, hashToCurve == ristretto255_map\n  * * hashToScalar is undefined in RFC9380 for ristretto, we are using version from OPRF here, using bytes255ToNumblerLE will create different result if we use bytes255ToNumberLE as os2ip\n  * * current version is closest to spec.\n  */\n  hashToCurve(msg: Uint8Array, options?: H2CDSTOpts): _RistrettoPoint {\n    // == 'hash_to_ristretto255'\n    const DST = options?.DST || 'ristretto255_XMD:SHA-512_R255MAP_RO_';\n    const xmd = expand_message_xmd(msg, DST, 64, sha512);\n    // NOTE: RFC 9380 incorrectly calls this function 'ristretto255_map', in RFC 9496 map was function inside (per point)\n    // That also lead to confustion that ristretto255_map is mapToCurve (it is not! it is old hashToCurve)\n    return ristretto255_hasher.deriveToCurve!(xmd);\n  },\n  hashToScalar(msg: Uint8Array, options: H2CDSTOpts = { DST: _DST_scalar }) {\n    const xmd = expand_message_xmd(msg, options.DST, 64, sha512);\n    return Fn.create(bytesToNumberLE(xmd));\n  },\n  /**\n   * HashToCurve-like construction based on RFC 9496 (Element Derivation).\n   * Converts 64 uniform random bytes into a curve point.\n   *\n   * WARNING: This represents an older hash-to-curve construction, preceding the finalization of RFC 9380.\n   * It was later reused as a component in the newer `hash_to_ristretto255` function defined in RFC 9380.\n   */\n  deriveToCurve(bytes: Uint8Array): _RistrettoPoint {\n    // https://www.rfc-editor.org/rfc/rfc9496.html#name-element-derivation\n    abytes(bytes, 64);\n    const r1 = bytes255ToNumberLE(bytes.subarray(0, 32));\n    const R1 = calcElligatorRistrettoMap(r1);\n    const r2 = bytes255ToNumberLE(bytes.subarray(32, 64));\n    const R2 = calcElligatorRistrettoMap(r2);\n    return new _RistrettoPoint(R1.add(R2));\n  },\n};\n\n/** ristretto255 OPRF, defined in RFC 9497. */\nexport const ristretto255_oprf: OPRF = /* @__PURE__ */ (() =>\n  createORPF({\n    name: 'ristretto255-SHA512',\n    Point: _RistrettoPoint,\n    hash: sha512,\n    hashToGroup: ristretto255_hasher.hashToCurve,\n    hashToScalar: ristretto255_hasher.hashToScalar,\n  }))();\n\n/**\n * Weird / bogus points, useful for debugging.\n * All 8 ed25519 points of 8-torsion subgroup can be generated from the point\n * T = `26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05`.\n * \u27E8T\u27E9 = { O, T, 2T, 3T, 4T, 5T, 6T, 7T }\n */\nexport const ED25519_TORSION_SUBGROUP: string[] = [\n  '0100000000000000000000000000000000000000000000000000000000000000',\n  'c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a',\n  '0000000000000000000000000000000000000000000000000000000000000080',\n  '26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05',\n  'ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f',\n  '26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85',\n  '0000000000000000000000000000000000000000000000000000000000000000',\n  'c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa',\n];\n", "/**\n * SHA3 (keccak) hash function, based on a new \"Sponge function\" design.\n * Different from older hashes, the internal state is bigger than output size.\n *\n * Check out [FIPS-202](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf),\n * [Website](https://keccak.team/keccak.html),\n * [the differences between SHA-3 and Keccak](https://crypto.stackexchange.com/questions/15727/what-are-the-key-differences-between-the-draft-sha-3-standard-and-the-keccak-sub).\n *\n * Check out `sha3-addons` module for cSHAKE, k12, and others.\n * @module\n */\nimport { rotlBH, rotlBL, rotlSH, rotlSL, split } from './_u64.ts';\n// prettier-ignore\nimport {\n  abytes, aexists, anumber, aoutput,\n  clean, createHasher,\n  oidNist,\n  swap32IfBE,\n  u32,\n  type CHash, type CHashXOF,\n  type Hash,\n  type HashInfo,\n  type HashXOF\n} from './utils.ts';\n\n// No __PURE__ annotations in sha3 header:\n// EVERYTHING is in fact used on every export.\n// Various per round constants calculations\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst _7n = BigInt(7);\nconst _256n = BigInt(256);\nconst _0x71n = BigInt(0x71);\nconst SHA3_PI: number[] = [];\nconst SHA3_ROTL: number[] = [];\nconst _SHA3_IOTA: bigint[] = []; // no pure annotation: var is always used\nfor (let round = 0, R = _1n, x = 1, y = 0; round < 24; round++) {\n  // Pi\n  [x, y] = [y, (2 * x + 3 * y) % 5];\n  SHA3_PI.push(2 * (5 * y + x));\n  // Rotational\n  SHA3_ROTL.push((((round + 1) * (round + 2)) / 2) % 64);\n  // Iota\n  let t = _0n;\n  for (let j = 0; j < 7; j++) {\n    R = ((R << _1n) ^ ((R >> _7n) * _0x71n)) % _256n;\n    if (R & _2n) t ^= _1n << ((_1n << BigInt(j)) - _1n);\n  }\n  _SHA3_IOTA.push(t);\n}\nconst IOTAS = split(_SHA3_IOTA, true);\nconst SHA3_IOTA_H = IOTAS[0];\nconst SHA3_IOTA_L = IOTAS[1];\n\n// Left rotation (without 0, 32, 64)\nconst rotlH = (h: number, l: number, s: number) => (s > 32 ? rotlBH(h, l, s) : rotlSH(h, l, s));\nconst rotlL = (h: number, l: number, s: number) => (s > 32 ? rotlBL(h, l, s) : rotlSL(h, l, s));\n\n/** `keccakf1600` internal function, additionally allows to adjust round count. */\nexport function keccakP(s: Uint32Array, rounds: number = 24): void {\n  const B = new Uint32Array(5 * 2);\n  // NOTE: all indices are x2 since we store state as u32 instead of u64 (bigints to slow in js)\n  for (let round = 24 - rounds; round < 24; round++) {\n    // Theta \u03B8\n    for (let x = 0; x < 10; x++) B[x] = s[x] ^ s[x + 10] ^ s[x + 20] ^ s[x + 30] ^ s[x + 40];\n    for (let x = 0; x < 10; x += 2) {\n      const idx1 = (x + 8) % 10;\n      const idx0 = (x + 2) % 10;\n      const B0 = B[idx0];\n      const B1 = B[idx0 + 1];\n      const Th = rotlH(B0, B1, 1) ^ B[idx1];\n      const Tl = rotlL(B0, B1, 1) ^ B[idx1 + 1];\n      for (let y = 0; y < 50; y += 10) {\n        s[x + y] ^= Th;\n        s[x + y + 1] ^= Tl;\n      }\n    }\n    // Rho (\u03C1) and Pi (\u03C0)\n    let curH = s[2];\n    let curL = s[3];\n    for (let t = 0; t < 24; t++) {\n      const shift = SHA3_ROTL[t];\n      const Th = rotlH(curH, curL, shift);\n      const Tl = rotlL(curH, curL, shift);\n      const PI = SHA3_PI[t];\n      curH = s[PI];\n      curL = s[PI + 1];\n      s[PI] = Th;\n      s[PI + 1] = Tl;\n    }\n    // Chi (\u03C7)\n    for (let y = 0; y < 50; y += 10) {\n      for (let x = 0; x < 10; x++) B[x] = s[y + x];\n      for (let x = 0; x < 10; x++) s[y + x] ^= ~B[(x + 2) % 10] & B[(x + 4) % 10];\n    }\n    // Iota (\u03B9)\n    s[0] ^= SHA3_IOTA_H[round];\n    s[1] ^= SHA3_IOTA_L[round];\n  }\n  clean(B);\n}\n\n/** Keccak sponge function. */\nexport class Keccak implements Hash<Keccak>, HashXOF<Keccak> {\n  protected state: Uint8Array;\n  protected pos = 0;\n  protected posOut = 0;\n  protected finished = false;\n  protected state32: Uint32Array;\n  protected destroyed = false;\n\n  public blockLen: number;\n  public suffix: number;\n  public outputLen: number;\n  protected enableXOF = false;\n  protected rounds: number;\n\n  // NOTE: we accept arguments in bytes instead of bits here.\n  constructor(\n    blockLen: number,\n    suffix: number,\n    outputLen: number,\n    enableXOF = false,\n    rounds: number = 24\n  ) {\n    this.blockLen = blockLen;\n    this.suffix = suffix;\n    this.outputLen = outputLen;\n    this.enableXOF = enableXOF;\n    this.rounds = rounds;\n    // Can be passed from user as dkLen\n    anumber(outputLen, 'outputLen');\n    // 1600 = 5x5 matrix of 64bit.  1600 bits === 200 bytes\n    // 0 < blockLen < 200\n    if (!(0 < blockLen && blockLen < 200))\n      throw new Error('only keccak-f1600 function is supported');\n    this.state = new Uint8Array(200);\n    this.state32 = u32(this.state);\n  }\n  clone(): Keccak {\n    return this._cloneInto();\n  }\n  protected keccak(): void {\n    swap32IfBE(this.state32);\n    keccakP(this.state32, this.rounds);\n    swap32IfBE(this.state32);\n    this.posOut = 0;\n    this.pos = 0;\n  }\n  update(data: Uint8Array): this {\n    aexists(this);\n    abytes(data);\n    const { blockLen, state } = this;\n    const len = data.length;\n    for (let pos = 0; pos < len; ) {\n      const take = Math.min(blockLen - this.pos, len - pos);\n      for (let i = 0; i < take; i++) state[this.pos++] ^= data[pos++];\n      if (this.pos === blockLen) this.keccak();\n    }\n    return this;\n  }\n  protected finish(): void {\n    if (this.finished) return;\n    this.finished = true;\n    const { state, suffix, pos, blockLen } = this;\n    // Do the padding\n    state[pos] ^= suffix;\n    if ((suffix & 0x80) !== 0 && pos === blockLen - 1) this.keccak();\n    state[blockLen - 1] ^= 0x80;\n    this.keccak();\n  }\n  protected writeInto(out: Uint8Array): Uint8Array {\n    aexists(this, false);\n    abytes(out);\n    this.finish();\n    const bufferOut = this.state;\n    const { blockLen } = this;\n    for (let pos = 0, len = out.length; pos < len; ) {\n      if (this.posOut >= blockLen) this.keccak();\n      const take = Math.min(blockLen - this.posOut, len - pos);\n      out.set(bufferOut.subarray(this.posOut, this.posOut + take), pos);\n      this.posOut += take;\n      pos += take;\n    }\n    return out;\n  }\n  xofInto(out: Uint8Array): Uint8Array {\n    // Sha3/Keccak usage with XOF is probably mistake, only SHAKE instances can do XOF\n    if (!this.enableXOF) throw new Error('XOF is not possible for this instance');\n    return this.writeInto(out);\n  }\n  xof(bytes: number): Uint8Array {\n    anumber(bytes);\n    return this.xofInto(new Uint8Array(bytes));\n  }\n  digestInto(out: Uint8Array): Uint8Array {\n    aoutput(out, this);\n    if (this.finished) throw new Error('digest() was already called');\n    this.writeInto(out);\n    this.destroy();\n    return out;\n  }\n  digest(): Uint8Array {\n    return this.digestInto(new Uint8Array(this.outputLen));\n  }\n  destroy(): void {\n    this.destroyed = true;\n    clean(this.state);\n  }\n  _cloneInto(to?: Keccak): Keccak {\n    const { blockLen, suffix, outputLen, rounds, enableXOF } = this;\n    to ||= new Keccak(blockLen, suffix, outputLen, enableXOF, rounds);\n    to.state32.set(this.state32);\n    to.pos = this.pos;\n    to.posOut = this.posOut;\n    to.finished = this.finished;\n    to.rounds = rounds;\n    // Suffix can change in cSHAKE\n    to.suffix = suffix;\n    to.outputLen = outputLen;\n    to.enableXOF = enableXOF;\n    to.destroyed = this.destroyed;\n    return to;\n  }\n}\n\nconst genKeccak = (suffix: number, blockLen: number, outputLen: number, info: HashInfo = {}) =>\n  createHasher(() => new Keccak(blockLen, suffix, outputLen), info);\n\n/** SHA3-224 hash function. */\nexport const sha3_224: CHash = /* @__PURE__ */ genKeccak(\n  0x06,\n  144,\n  28,\n  /* @__PURE__ */ oidNist(0x07)\n);\n/** SHA3-256 hash function. Different from keccak-256. */\nexport const sha3_256: CHash = /* @__PURE__ */ genKeccak(\n  0x06,\n  136,\n  32,\n  /* @__PURE__ */ oidNist(0x08)\n);\n/** SHA3-384 hash function. */\nexport const sha3_384: CHash = /* @__PURE__ */ genKeccak(\n  0x06,\n  104,\n  48,\n  /* @__PURE__ */ oidNist(0x09)\n);\n/** SHA3-512 hash function. */\nexport const sha3_512: CHash = /* @__PURE__ */ genKeccak(\n  0x06,\n  72,\n  64,\n  /* @__PURE__ */ oidNist(0x0a)\n);\n\n/** keccak-224 hash function. */\nexport const keccak_224: CHash = /* @__PURE__ */ genKeccak(0x01, 144, 28);\n/** keccak-256 hash function. Different from SHA3-256. */\nexport const keccak_256: CHash = /* @__PURE__ */ genKeccak(0x01, 136, 32);\n/** keccak-384 hash function. */\nexport const keccak_384: CHash = /* @__PURE__ */ genKeccak(0x01, 104, 48);\n/** keccak-512 hash function. */\nexport const keccak_512: CHash = /* @__PURE__ */ genKeccak(0x01, 72, 64);\n\n/** Options for SHAKE XOF. */\nexport type ShakeOpts = { dkLen?: number };\n\nconst genShake = (suffix: number, blockLen: number, outputLen: number, info: HashInfo = {}) =>\n  createHasher<Keccak, ShakeOpts>(\n    (opts: ShakeOpts = {}) =>\n      new Keccak(blockLen, suffix, opts.dkLen === undefined ? outputLen : opts.dkLen, true),\n    info\n  );\n\n/** SHAKE128 XOF with 128-bit security. */\nexport const shake128: CHashXOF<Keccak, ShakeOpts> =\n  /* @__PURE__ */\n  genShake(0x1f, 168, 16, /* @__PURE__ */ oidNist(0x0b));\n/** SHAKE256 XOF with 256-bit security. */\nexport const shake256: CHashXOF<Keccak, ShakeOpts> =\n  /* @__PURE__ */\n  genShake(0x1f, 136, 32, /* @__PURE__ */ oidNist(0x0c));\n\n/** SHAKE128 XOF with 256-bit output (NIST version). */\nexport const shake128_32: CHashXOF<Keccak, ShakeOpts> =\n  /* @__PURE__ */\n  genShake(0x1f, 168, 32, /* @__PURE__ */ oidNist(0x0b));\n/** SHAKE256 XOF with 512-bit output (NIST version). */\nexport const shake256_64: CHashXOF<Keccak, ShakeOpts> =\n  /* @__PURE__ */\n  genShake(0x1f, 136, 64, /* @__PURE__ */ oidNist(0x0c));\n", "/**\n * Edwards448 (not Ed448-Goldilocks) curve with following addons:\n * - X448 ECDH\n * - Decaf cofactor elimination\n * - Elligator hash-to-group / point indistinguishability\n * Conforms to RFC 8032 https://www.rfc-editor.org/rfc/rfc8032.html#section-5.2\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { shake256 } from '@noble/hashes/sha3.js';\nimport { concatBytes, hexToBytes, createHasher as wrapConstructor } from '@noble/hashes/utils.js';\nimport type { AffinePoint } from './abstract/curve.ts';\nimport {\n  eddsa,\n  edwards,\n  PrimeEdwardsPoint,\n  type EdDSA,\n  type EdDSAOpts,\n  type EdwardsOpts,\n  type EdwardsPoint,\n  type EdwardsPointCons,\n} from './abstract/edwards.ts';\nimport {\n  _DST_scalar,\n  createHasher,\n  expand_message_xof,\n  type H2CDSTOpts,\n  type H2CHasher,\n  type H2CHasherBase,\n} from './abstract/hash-to-curve.ts';\nimport { Field, FpInvertBatch, isNegativeLE, mod, pow2, type IField } from './abstract/modular.ts';\nimport { montgomery, type MontgomeryECDH } from './abstract/montgomery.ts';\nimport { createORPF, type OPRF } from './abstract/oprf.ts';\nimport { abytes, asciiToBytes, bytesToNumberLE, equalBytes } from './utils.ts';\n\n// edwards448 curve\n// a = 1n\n// d = Fp.neg(39081n)\n// Finite field 2n**448n - 2n**224n - 1n\n// Subgroup order\n// 2n**446n - 13818066809895115352007386748515426880336692474882178609894547503885n\nconst ed448_CURVE_p = BigInt(\n  '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff'\n);\nconst ed448_CURVE: EdwardsOpts = /* @__PURE__ */ (() => ({\n  p: ed448_CURVE_p,\n  n: BigInt(\n    '0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3'\n  ),\n  h: BigInt(4),\n  a: BigInt(1),\n  d: BigInt(\n    '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756'\n  ),\n  Gx: BigInt(\n    '0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e'\n  ),\n  Gy: BigInt(\n    '0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14'\n  ),\n}))();\n\n// E448 NIST curve is identical to edwards448, except for:\n// d = 39082/39081\n// Gx = 3/2\nconst E448_CURVE: EdwardsOpts = /* @__PURE__ */ (() =>\n  Object.assign({}, ed448_CURVE, {\n    d: BigInt(\n      '0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9'\n    ),\n    Gx: BigInt(\n      '0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc'\n    ),\n    Gy: BigInt(\n      '0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001'\n    ),\n  }))();\n\nconst shake256_114 = /* @__PURE__ */ wrapConstructor(() => shake256.create({ dkLen: 114 }));\nconst shake256_64 = /* @__PURE__ */ wrapConstructor(() => shake256.create({ dkLen: 64 }));\n\n// prettier-ignore\nconst _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3), _4n = /* @__PURE__ */ BigInt(4), _11n = BigInt(11);\n// prettier-ignore\nconst _22n = BigInt(22), _44n = BigInt(44), _88n = BigInt(88), _223n = BigInt(223);\n\n// powPminus3div4 calculates z = x^k mod p, where k = (p-3)/4.\n// Used for efficient square root calculation.\n// ((P-3)/4).toString(2) would produce bits [223x 1, 0, 222x 1]\nfunction ed448_pow_Pminus3div4(x: bigint): bigint {\n  const P = ed448_CURVE_p;\n  const b2 = (x * x * x) % P;\n  const b3 = (b2 * b2 * x) % P;\n  const b6 = (pow2(b3, _3n, P) * b3) % P;\n  const b9 = (pow2(b6, _3n, P) * b3) % P;\n  const b11 = (pow2(b9, _2n, P) * b2) % P;\n  const b22 = (pow2(b11, _11n, P) * b11) % P;\n  const b44 = (pow2(b22, _22n, P) * b22) % P;\n  const b88 = (pow2(b44, _44n, P) * b44) % P;\n  const b176 = (pow2(b88, _88n, P) * b88) % P;\n  const b220 = (pow2(b176, _44n, P) * b44) % P;\n  const b222 = (pow2(b220, _2n, P) * b2) % P;\n  const b223 = (pow2(b222, _1n, P) * x) % P;\n  return (pow2(b223, _223n, P) * b222) % P;\n}\n\nfunction adjustScalarBytes(bytes: Uint8Array): Uint8Array {\n  // Section 5: Likewise, for X448, set the two least significant bits of the first byte to 0,\n  bytes[0] &= 252; // 0b11111100\n  // and the most significant bit of the last byte to 1.\n  bytes[55] |= 128; // 0b10000000\n  // NOTE: is NOOP for 56 bytes scalars (X25519/X448)\n  bytes[56] = 0; // Byte outside of group (456 buts vs 448 bits)\n  return bytes;\n}\n\n// Constant-time ratio of u to v. Allows to combine inversion and square root u/\u221Av.\n// Uses algo from RFC8032 5.1.3.\nfunction uvRatio(u: bigint, v: bigint): { isValid: boolean; value: bigint } {\n  const P = ed448_CURVE_p;\n  // https://www.rfc-editor.org/rfc/rfc8032#section-5.2.3\n  // To compute the square root of (u/v), the first step is to compute the\n  //   candidate root x = (u/v)^((p+1)/4).  This can be done using the\n  // following trick, to use a single modular powering for both the\n  // inversion of v and the square root:\n  // x = (u/v)^((p+1)/4)   = u\u00B3v(u\u2075v\u00B3)^((p-3)/4)   (mod p)\n  const u2v = mod(u * u * v, P); // u\u00B2v\n  const u3v = mod(u2v * u, P); // u\u00B3v\n  const u5v3 = mod(u3v * u2v * v, P); // u\u2075v\u00B3\n  const root = ed448_pow_Pminus3div4(u5v3);\n  const x = mod(u3v * root, P);\n  // Verify that root is exists\n  const x2 = mod(x * x, P); // x\u00B2\n  // If vx\u00B2 = u, the recovered x-coordinate is x.  Otherwise, no\n  // square root exists, and the decoding fails.\n  return { isValid: mod(x2 * v, P) === u, value: x };\n}\n\n// Finite field 2n**448n - 2n**224n - 1n\n// The value fits in 448 bits, but we use 456-bit (57-byte) elements because of bitflags.\n// - ed25519 fits in 255 bits, allowing using last 1 byte for specifying bit flag of point negation.\n// - ed448 fits in 448 bits. We can't use last 1 byte: we can only use a bit 224 in the middle.\nconst Fp = /* @__PURE__ */ (() => Field(ed448_CURVE_p, { BITS: 456, isLE: true }))();\nconst Fn = /* @__PURE__ */ (() => Field(ed448_CURVE.n, { BITS: 456, isLE: true }))();\n// decaf448 uses 448-bit (56-byte) keys\nconst Fp448 = /* @__PURE__ */ (() => Field(ed448_CURVE_p, { BITS: 448, isLE: true }))();\nconst Fn448 = /* @__PURE__ */ (() => Field(ed448_CURVE.n, { BITS: 448, isLE: true }))();\n\n// SHAKE256(dom4(phflag,context)||x, 114)\nfunction dom4(data: Uint8Array, ctx: Uint8Array, phflag: boolean) {\n  if (ctx.length > 255) throw new Error('context must be smaller than 255, got: ' + ctx.length);\n  return concatBytes(\n    asciiToBytes('SigEd448'),\n    new Uint8Array([phflag ? 1 : 0, ctx.length]),\n    ctx,\n    data\n  );\n}\nconst ed448_Point = /* @__PURE__ */ edwards(ed448_CURVE, { Fp, Fn, uvRatio });\n\nfunction ed4(opts: EdDSAOpts) {\n  return eddsa(ed448_Point, shake256_114, Object.assign({ adjustScalarBytes, domain: dom4 }, opts));\n}\n\n/**\n * ed448 EdDSA curve and methods.\n * @example\n * ```js\n * import { ed448 } from '@noble/curves/ed448.js';\n * const { secretKey, publicKey } = ed448.keygen();\n * // const publicKey = ed448.getPublicKey(secretKey);\n * const msg = new TextEncoder().encode('hello noble');\n * const sig = ed448.sign(msg, secretKey);\n * const isValid = ed448.verify(sig, msg, publicKey);\n * ```\n */\nexport const ed448: EdDSA = /* @__PURE__ */ ed4({});\n\n// There is no ed448ctx, since ed448 supports ctx by default\n/** Prehashed version of ed448. See {@link ed448} */\nexport const ed448ph: EdDSA = /* @__PURE__ */ ed4({ prehash: shake256_64 });\n/**\n * E448 (NIST) != edwards448 used in ed448.\n * E448 is birationally equivalent to edwards448.\n */\nexport const E448: EdwardsPointCons = /* @__PURE__ */ edwards(E448_CURVE);\n\n/**\n * ECDH using curve448 aka x448.\n *\n * @example\n * ```js\n * import { x448 } from '@noble/curves/ed448.js';\n * const alice = x448.keygen();\n * const bob = x448.keygen();\n * const shared = x448.getSharedSecret(alice.secretKey, bob.publicKey);\n * ```\n */\nexport const x448: MontgomeryECDH = /* @__PURE__ */ (() => {\n  const P = ed448_CURVE_p;\n  return montgomery({\n    P,\n    type: 'x448',\n    powPminus2: (x: bigint): bigint => {\n      const Pminus3div4 = ed448_pow_Pminus3div4(x);\n      const Pminus3 = pow2(Pminus3div4, _2n, P);\n      return mod(Pminus3 * x, P); // Pminus3 * x = Pminus2\n    },\n    adjustScalarBytes,\n  });\n})();\n\n// Hash To Curve Elligator2 Map\nconst ELL2_C1 = /* @__PURE__ */ (() => (ed448_CURVE_p - BigInt(3)) / BigInt(4))(); // 1. c1 = (q - 3) / 4         # Integer arithmetic\nconst ELL2_J = /* @__PURE__ */ BigInt(156326);\n\nfunction map_to_curve_elligator2_curve448(u: bigint) {\n  let tv1 = Fp.sqr(u); // 1.  tv1 = u^2\n  let e1 = Fp.eql(tv1, Fp.ONE); // 2.   e1 = tv1 == 1\n  tv1 = Fp.cmov(tv1, Fp.ZERO, e1); // 3.  tv1 = CMOV(tv1, 0, e1)  # If Z * u^2 == -1, set tv1 = 0\n  let xd = Fp.sub(Fp.ONE, tv1); // 4.   xd = 1 - tv1\n  let x1n = Fp.neg(ELL2_J); // 5.  x1n = -J\n  let tv2 = Fp.sqr(xd); // 6.  tv2 = xd^2\n  let gxd = Fp.mul(tv2, xd); // 7.  gxd = tv2 * xd          # gxd = xd^3\n  let gx1 = Fp.mul(tv1, Fp.neg(ELL2_J)); // 8.  gx1 = -J * tv1          # x1n + J * xd\n  gx1 = Fp.mul(gx1, x1n); // 9.  gx1 = gx1 * x1n         # x1n^2 + J * x1n * xd\n  gx1 = Fp.add(gx1, tv2); // 10. gx1 = gx1 + tv2         # x1n^2 + J * x1n * xd + xd^2\n  gx1 = Fp.mul(gx1, x1n); // 11. gx1 = gx1 * x1n         # x1n^3 + J * x1n^2 * xd + x1n * xd^2\n  let tv3 = Fp.sqr(gxd); // 12. tv3 = gxd^2\n  tv2 = Fp.mul(gx1, gxd); // 13. tv2 = gx1 * gxd         # gx1 * gxd\n  tv3 = Fp.mul(tv3, tv2); // 14. tv3 = tv3 * tv2         # gx1 * gxd^3\n  let y1 = Fp.pow(tv3, ELL2_C1); // 15.  y1 = tv3^c1            # (gx1 * gxd^3)^((p - 3) / 4)\n  y1 = Fp.mul(y1, tv2); // 16.  y1 = y1 * tv2          # gx1 * gxd * (gx1 * gxd^3)^((p - 3) / 4)\n  let x2n = Fp.mul(x1n, Fp.neg(tv1)); // 17. x2n = -tv1 * x1n        # x2 = x2n / xd = -1 * u^2 * x1n / xd\n  let y2 = Fp.mul(y1, u); // 18.  y2 = y1 * u\n  y2 = Fp.cmov(y2, Fp.ZERO, e1); // 19.  y2 = CMOV(y2, 0, e1)\n  tv2 = Fp.sqr(y1); // 20. tv2 = y1^2\n  tv2 = Fp.mul(tv2, gxd); // 21. tv2 = tv2 * gxd\n  let e2 = Fp.eql(tv2, gx1); // 22.  e2 = tv2 == gx1\n  let xn = Fp.cmov(x2n, x1n, e2); // 23.  xn = CMOV(x2n, x1n, e2)  # If e2, x = x1, else x = x2\n  let y = Fp.cmov(y2, y1, e2); // 24.   y = CMOV(y2, y1, e2)    # If e2, y = y1, else y = y2\n  let e3 = Fp.isOdd(y); // 25.  e3 = sgn0(y) == 1        # Fix sign of y\n  y = Fp.cmov(y, Fp.neg(y), e2 !== e3); // 26.   y = CMOV(y, -y, e2 XOR e3)\n  return { xn, xd, yn: y, yd: Fp.ONE }; // 27. return (xn, xd, y, 1)\n}\n\nfunction map_to_curve_elligator2_edwards448(u: bigint) {\n  let { xn, xd, yn, yd } = map_to_curve_elligator2_curve448(u); // 1. (xn, xd, yn, yd) = map_to_curve_elligator2_curve448(u)\n  let xn2 = Fp.sqr(xn); // 2.  xn2 = xn^2\n  let xd2 = Fp.sqr(xd); // 3.  xd2 = xd^2\n  let xd4 = Fp.sqr(xd2); // 4.  xd4 = xd2^2\n  let yn2 = Fp.sqr(yn); // 5.  yn2 = yn^2\n  let yd2 = Fp.sqr(yd); // 6.  yd2 = yd^2\n  let xEn = Fp.sub(xn2, xd2); // 7.  xEn = xn2 - xd2\n  let tv2 = Fp.sub(xEn, xd2); // 8.  tv2 = xEn - xd2\n  xEn = Fp.mul(xEn, xd2); // 9.  xEn = xEn * xd2\n  xEn = Fp.mul(xEn, yd); // 10. xEn = xEn * yd\n  xEn = Fp.mul(xEn, yn); // 11. xEn = xEn * yn\n  xEn = Fp.mul(xEn, _4n); // 12. xEn = xEn * 4\n  tv2 = Fp.mul(tv2, xn2); // 13. tv2 = tv2 * xn2\n  tv2 = Fp.mul(tv2, yd2); // 14. tv2 = tv2 * yd2\n  let tv3 = Fp.mul(yn2, _4n); // 15. tv3 = 4 * yn2\n  let tv1 = Fp.add(tv3, yd2); // 16. tv1 = tv3 + yd2\n  tv1 = Fp.mul(tv1, xd4); // 17. tv1 = tv1 * xd4\n  let xEd = Fp.add(tv1, tv2); // 18. xEd = tv1 + tv2\n  tv2 = Fp.mul(tv2, xn); // 19. tv2 = tv2 * xn\n  let tv4 = Fp.mul(xn, xd4); // 20. tv4 = xn * xd4\n  let yEn = Fp.sub(tv3, yd2); // 21. yEn = tv3 - yd2\n  yEn = Fp.mul(yEn, tv4); // 22. yEn = yEn * tv4\n  yEn = Fp.sub(yEn, tv2); // 23. yEn = yEn - tv2\n  tv1 = Fp.add(xn2, xd2); // 24. tv1 = xn2 + xd2\n  tv1 = Fp.mul(tv1, xd2); // 25. tv1 = tv1 * xd2\n  tv1 = Fp.mul(tv1, xd); // 26. tv1 = tv1 * xd\n  tv1 = Fp.mul(tv1, yn2); // 27. tv1 = tv1 * yn2\n  tv1 = Fp.mul(tv1, BigInt(-2)); // 28. tv1 = -2 * tv1\n  let yEd = Fp.add(tv2, tv1); // 29. yEd = tv2 + tv1\n  tv4 = Fp.mul(tv4, yd2); // 30. tv4 = tv4 * yd2\n  yEd = Fp.add(yEd, tv4); // 31. yEd = yEd + tv4\n  tv1 = Fp.mul(xEd, yEd); // 32. tv1 = xEd * yEd\n  let e = Fp.eql(tv1, Fp.ZERO); // 33.   e = tv1 == 0\n  xEn = Fp.cmov(xEn, Fp.ZERO, e); // 34. xEn = CMOV(xEn, 0, e)\n  xEd = Fp.cmov(xEd, Fp.ONE, e); // 35. xEd = CMOV(xEd, 1, e)\n  yEn = Fp.cmov(yEn, Fp.ONE, e); // 36. yEn = CMOV(yEn, 1, e)\n  yEd = Fp.cmov(yEd, Fp.ONE, e); // 37. yEd = CMOV(yEd, 1, e)\n\n  const inv = FpInvertBatch(Fp, [xEd, yEd], true); // batch division\n  return { x: Fp.mul(xEn, inv[0]), y: Fp.mul(yEn, inv[1]) }; // 38. return (xEn, xEd, yEn, yEd)\n}\n\n/** Hashing / encoding to ed448 points / field. RFC 9380 methods. */\nexport const ed448_hasher: H2CHasher<EdwardsPointCons> = /* @__PURE__ */ (() =>\n  createHasher(ed448_Point, (scalars: bigint[]) => map_to_curve_elligator2_edwards448(scalars[0]), {\n    DST: 'edwards448_XOF:SHAKE256_ELL2_RO_',\n    encodeDST: 'edwards448_XOF:SHAKE256_ELL2_NU_',\n    p: ed448_CURVE_p,\n    m: 1,\n    k: 224,\n    expand: 'xof',\n    hash: shake256,\n  }))();\n\n// 1-d\nconst ONE_MINUS_D = /* @__PURE__ */ BigInt('39082');\n// 1-2d\nconst ONE_MINUS_TWO_D = /* @__PURE__ */ BigInt('78163');\n// \u221A(-d)\nconst SQRT_MINUS_D = /* @__PURE__ */ BigInt(\n  '98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214'\n);\n// 1 / \u221A(-d)\nconst INVSQRT_MINUS_D = /* @__PURE__ */ BigInt(\n  '315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716'\n);\n// Calculates 1/\u221A(number)\nconst invertSqrt = (number: bigint) => uvRatio(_1n, number);\n\n/**\n * Elligator map for hash-to-curve of decaf448.\n * Described in [RFC9380](https://www.rfc-editor.org/rfc/rfc9380#appendix-C)\n * and [RFC9496](https://www.rfc-editor.org/rfc/rfc9496#name-element-derivation-2).\n */\nfunction calcElligatorDecafMap(r0: bigint): EdwardsPoint {\n  const { d, p: P } = ed448_CURVE;\n  const mod = (n: bigint) => Fp448.create(n);\n\n  const r = mod(-(r0 * r0)); // 1\n  const u0 = mod(d * (r - _1n)); // 2\n  const u1 = mod((u0 + _1n) * (u0 - r)); // 3\n\n  const { isValid: was_square, value: v } = uvRatio(ONE_MINUS_TWO_D, mod((r + _1n) * u1)); // 4\n\n  let v_prime = v; // 5\n  if (!was_square) v_prime = mod(r0 * v);\n\n  let sgn = _1n; // 6\n  if (!was_square) sgn = mod(-_1n);\n\n  const s = mod(v_prime * (r + _1n)); // 7\n  let s_abs = s;\n  if (isNegativeLE(s, P)) s_abs = mod(-s);\n\n  const s2 = s * s;\n  const W0 = mod(s_abs * _2n); // 8\n  const W1 = mod(s2 + _1n); // 9\n  const W2 = mod(s2 - _1n); // 10\n  const W3 = mod(v_prime * s * (r - _1n) * ONE_MINUS_TWO_D + sgn); // 11\n  return new ed448_Point(mod(W0 * W3), mod(W2 * W1), mod(W1 * W3), mod(W0 * W2));\n}\n\n/**\n * Each ed448/EdwardsPoint has 4 different equivalent points. This can be\n * a source of bugs for protocols like ring signatures. Decaf was created to solve this.\n * Decaf point operates in X:Y:Z:T extended coordinates like EdwardsPoint,\n * but it should work in its own namespace: do not combine those two.\n * See [RFC9496](https://www.rfc-editor.org/rfc/rfc9496).\n */\nclass _DecafPoint extends PrimeEdwardsPoint<_DecafPoint> {\n  // The following gymnastics is done because typescript strips comments otherwise\n  // prettier-ignore\n  static BASE: _DecafPoint =\n    /* @__PURE__ */ (() => new _DecafPoint(ed448_Point.BASE).multiplyUnsafe(_2n))();\n  // prettier-ignore\n  static ZERO: _DecafPoint =\n    /* @__PURE__ */ (() => new _DecafPoint(ed448_Point.ZERO))();\n  // prettier-ignore\n  static Fp: IField<bigint> =\n    /* @__PURE__ */ (() => Fp448)();\n  // prettier-ignore\n  static Fn: IField<bigint> =\n    /* @__PURE__ */ (() => Fn448)();\n\n  constructor(ep: EdwardsPoint) {\n    super(ep);\n  }\n\n  static fromAffine(ap: AffinePoint<bigint>): _DecafPoint {\n    return new _DecafPoint(ed448_Point.fromAffine(ap));\n  }\n\n  protected assertSame(other: _DecafPoint): void {\n    if (!(other instanceof _DecafPoint)) throw new Error('DecafPoint expected');\n  }\n\n  protected init(ep: EdwardsPoint): _DecafPoint {\n    return new _DecafPoint(ep);\n  }\n\n  static fromBytes(bytes: Uint8Array): _DecafPoint {\n    abytes(bytes, 56);\n    const { d, p: P } = ed448_CURVE;\n    const mod = (n: bigint) => Fp448.create(n);\n    const s = Fp448.fromBytes(bytes);\n\n    // 1. Check that s_bytes is the canonical encoding of a field element, or else abort.\n    // 2. Check that s is non-negative, or else abort\n    if (!equalBytes(Fn448.toBytes(s), bytes) || isNegativeLE(s, P))\n      throw new Error('invalid decaf448 encoding 1');\n\n    const s2 = mod(s * s); // 1\n    const u1 = mod(_1n + s2); // 2\n    const u1sq = mod(u1 * u1);\n    const u2 = mod(u1sq - _4n * d * s2); // 3\n\n    const { isValid, value: invsqrt } = invertSqrt(mod(u2 * u1sq)); // 4\n\n    let u3 = mod((s + s) * invsqrt * u1 * SQRT_MINUS_D); // 5\n    if (isNegativeLE(u3, P)) u3 = mod(-u3);\n\n    const x = mod(u3 * invsqrt * u2 * INVSQRT_MINUS_D); // 6\n    const y = mod((_1n - s2) * invsqrt * u1); // 7\n    const t = mod(x * y); // 8\n\n    if (!isValid) throw new Error('invalid decaf448 encoding 2');\n    return new _DecafPoint(new ed448_Point(x, y, _1n, t));\n  }\n\n  /**\n   * Converts decaf-encoded string to decaf point.\n   * Described in [RFC9496](https://www.rfc-editor.org/rfc/rfc9496#name-decode-2).\n   * @param hex Decaf-encoded 56 bytes. Not every 56-byte string is valid decaf encoding\n   */\n  static fromHex(hex: string): _DecafPoint {\n    return _DecafPoint.fromBytes(hexToBytes(hex));\n  }\n\n  /**\n   * Encodes decaf point to Uint8Array.\n   * Described in [RFC9496](https://www.rfc-editor.org/rfc/rfc9496#name-encode-2).\n   */\n  toBytes(): Uint8Array {\n    const { X, Z, T } = this.ep;\n    const P = ed448_CURVE.p;\n    const mod = (n: bigint) => Fp448.create(n);\n    const u1 = mod(mod(X + T) * mod(X - T)); // 1\n    const x2 = mod(X * X);\n    const { value: invsqrt } = invertSqrt(mod(u1 * ONE_MINUS_D * x2)); // 2\n    let ratio = mod(invsqrt * u1 * SQRT_MINUS_D); // 3\n    if (isNegativeLE(ratio, P)) ratio = mod(-ratio);\n    const u2 = mod(INVSQRT_MINUS_D * ratio * Z - T); // 4\n    let s = mod(ONE_MINUS_D * invsqrt * X * u2); // 5\n    if (isNegativeLE(s, P)) s = mod(-s);\n    return Fn448.toBytes(s);\n  }\n\n  /**\n   * Compare one point to another.\n   * Described in [RFC9496](https://www.rfc-editor.org/rfc/rfc9496#name-equals-2).\n   */\n  equals(other: _DecafPoint): boolean {\n    this.assertSame(other);\n    const { X: X1, Y: Y1 } = this.ep;\n    const { X: X2, Y: Y2 } = other.ep;\n    // (x1 * y2 == y1 * x2)\n    return Fp448.create(X1 * Y2) === Fp448.create(Y1 * X2);\n  }\n\n  is0(): boolean {\n    return this.equals(_DecafPoint.ZERO);\n  }\n}\n\nexport const decaf448: {\n  Point: typeof _DecafPoint;\n} = { Point: _DecafPoint };\n\n/** Hashing to decaf448 points / field. RFC 9380 methods. */\nexport const decaf448_hasher: H2CHasherBase<typeof _DecafPoint> = {\n  Point: _DecafPoint,\n  hashToCurve(msg: Uint8Array, options?: H2CDSTOpts): _DecafPoint {\n    const DST = options?.DST || 'decaf448_XOF:SHAKE256_D448MAP_RO_';\n    return decaf448_hasher.deriveToCurve!(expand_message_xof(msg, DST, 112, 224, shake256));\n  },\n  /**\n   * Warning: has big modulo bias of 2^-64.\n   * RFC is invalid. RFC says \"use 64-byte xof\", while for 2^-112 bias\n   * it must use 84-byte xof (56+56/2), not 64.\n   */\n  hashToScalar(msg: Uint8Array, options: H2CDSTOpts = { DST: _DST_scalar }): bigint {\n    // Can't use `Fn448.fromBytes()`. 64-byte input => 56-byte field element\n    const xof = expand_message_xof(msg, options.DST, 64, 256, shake256);\n    return Fn448.create(bytesToNumberLE(xof));\n  },\n  /**\n   * HashToCurve-like construction based on RFC 9496 (Element Derivation).\n   * Converts 112 uniform random bytes into a curve point.\n   *\n   * WARNING: This represents an older hash-to-curve construction, preceding the finalization of RFC 9380.\n   * It was later reused as a component in the newer `hash_to_ristretto255` function defined in RFC 9380.\n   */\n  deriveToCurve(bytes: Uint8Array): _DecafPoint {\n    abytes(bytes, 112);\n    const skipValidation = true;\n    // Note: Similar to the field element decoding described in\n    // [RFC7748], and unlike the field element decoding described in\n    // Section 5.3.1, non-canonical values are accepted.\n    const r1 = Fp448.create(Fp448.fromBytes(bytes.subarray(0, 56), skipValidation));\n    const R1 = calcElligatorDecafMap(r1);\n    const r2 = Fp448.create(Fp448.fromBytes(bytes.subarray(56, 112), skipValidation));\n    const R2 = calcElligatorDecafMap(r2);\n    return new _DecafPoint(R1.add(R2));\n  },\n};\n\n/** decaf448 OPRF, defined in RFC 9497. */\nexport const decaf448_oprf: OPRF = /* @__PURE__ */ (() =>\n  createORPF({\n    name: 'decaf448-SHAKE256',\n    Point: _DecafPoint,\n    hash: (msg: Uint8Array) => shake256(msg, { dkLen: 64 }),\n    hashToGroup: decaf448_hasher.hashToCurve,\n    hashToScalar: decaf448_hasher.hashToScalar,\n  }))();\n\n/**\n * Weird / bogus points, useful for debugging.\n * Unlike ed25519, there is no ed448 generator point which can produce full T subgroup.\n * Instead, there is a Klein four-group, which spans over 2 independent 2-torsion points:\n * (0, 1), (0, -1), (-1, 0), (1, 0).\n */\nexport const ED448_TORSION_SUBGROUP: string[] = [\n  '010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',\n  'fefffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffff00',\n  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',\n  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080',\n];\n", "/**\n * HMAC: RFC2104 message authentication code.\n * @module\n */\nimport { abytes, aexists, ahash, clean, type CHash, type Hash } from './utils.ts';\n\n/** Internal class for HMAC. */\nexport class _HMAC<T extends Hash<T>> implements Hash<_HMAC<T>> {\n  oHash: T;\n  iHash: T;\n  blockLen: number;\n  outputLen: number;\n  private finished = false;\n  private destroyed = false;\n\n  constructor(hash: CHash, key: Uint8Array) {\n    ahash(hash);\n    abytes(key, undefined, 'key');\n    this.iHash = hash.create() as T;\n    if (typeof this.iHash.update !== 'function')\n      throw new Error('Expected instance of class which extends utils.Hash');\n    this.blockLen = this.iHash.blockLen;\n    this.outputLen = this.iHash.outputLen;\n    const blockLen = this.blockLen;\n    const pad = new Uint8Array(blockLen);\n    // blockLen can be bigger than outputLen\n    pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n    for (let i = 0; i < pad.length; i++) pad[i] ^= 0x36;\n    this.iHash.update(pad);\n    // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n    this.oHash = hash.create() as T;\n    // Undo internal XOR && apply outer XOR\n    for (let i = 0; i < pad.length; i++) pad[i] ^= 0x36 ^ 0x5c;\n    this.oHash.update(pad);\n    clean(pad);\n  }\n  update(buf: Uint8Array): this {\n    aexists(this);\n    this.iHash.update(buf);\n    return this;\n  }\n  digestInto(out: Uint8Array): void {\n    aexists(this);\n    abytes(out, this.outputLen, 'output');\n    this.finished = true;\n    this.iHash.digestInto(out);\n    this.oHash.update(out);\n    this.oHash.digestInto(out);\n    this.destroy();\n  }\n  digest(): Uint8Array {\n    const out = new Uint8Array(this.oHash.outputLen);\n    this.digestInto(out);\n    return out;\n  }\n  _cloneInto(to?: _HMAC<T>): _HMAC<T> {\n    // Create new instance without calling constructor since key already in state and we don't know it.\n    to ||= Object.create(Object.getPrototypeOf(this), {});\n    const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n    to = to as this;\n    to.finished = finished;\n    to.destroyed = destroyed;\n    to.blockLen = blockLen;\n    to.outputLen = outputLen;\n    to.oHash = oHash._cloneInto(to.oHash);\n    to.iHash = iHash._cloneInto(to.iHash);\n    return to;\n  }\n  clone(): _HMAC<T> {\n    return this._cloneInto();\n  }\n  destroy(): void {\n    this.destroyed = true;\n    this.oHash.destroy();\n    this.iHash.destroy();\n  }\n}\n\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n * @example\n * import { hmac } from '@noble/hashes/hmac';\n * import { sha256 } from '@noble/hashes/sha2';\n * const mac1 = hmac(sha256, 'key', 'message');\n */\nexport const hmac: {\n  (hash: CHash, key: Uint8Array, message: Uint8Array): Uint8Array;\n  create(hash: CHash, key: Uint8Array): _HMAC<any>;\n} = (hash: CHash, key: Uint8Array, message: Uint8Array): Uint8Array =>\n  new _HMAC<any>(hash, key).update(message).digest();\nhmac.create = (hash: CHash, key: Uint8Array) => new _HMAC<any>(hash, key);\n", "/**\n * Short Weierstrass curve methods. The formula is: y\u00B2 = x\u00B3 + ax + b.\n *\n * ### Design rationale for types\n *\n * * Interaction between classes from different curves should fail:\n *   `k256.Point.BASE.add(p256.Point.BASE)`\n * * For this purpose we want to use `instanceof` operator, which is fast and works during runtime\n * * Different calls of `curve()` would return different classes -\n *   `curve(params) !== curve(params)`: if somebody decided to monkey-patch their curve,\n *   it won't affect others\n *\n * TypeScript can't infer types for classes created inside a function. Classes is one instance\n * of nominative types in TypeScript and interfaces only check for shape, so it's hard to create\n * unique type for every function call.\n *\n * We can use generic types via some param, like curve opts, but that would:\n *     1. Enable interaction between `curve(params)` and `curve(params)` (curves of same params)\n *     which is hard to debug.\n *     2. Params can be generic and we can't enforce them to be constant value:\n *     if somebody creates curve from non-constant params,\n *     it would be allowed to interact with other curves with non-constant params\n *\n * @todo https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#unique-symbol\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { hmac as nobleHmac } from '@noble/hashes/hmac.js';\nimport { ahash } from '@noble/hashes/utils.js';\nimport {\n  abool,\n  abytes,\n  aInRange,\n  bitLen,\n  bitMask,\n  bytesToHex,\n  bytesToNumberBE,\n  concatBytes,\n  createHmacDrbg,\n  hexToBytes,\n  isBytes,\n  memoized,\n  numberToHexUnpadded,\n  validateObject,\n  randomBytes as wcRandomBytes,\n  type CHash,\n  type Signer,\n} from '../utils.ts';\nimport {\n  createCurveFields,\n  createKeygen,\n  mulEndoUnsafe,\n  negateCt,\n  normalizeZ,\n  wNAF,\n  type AffinePoint,\n  type CurveLengths,\n  type CurvePoint,\n  type CurvePointCons,\n} from './curve.ts';\nimport {\n  FpInvertBatch,\n  getMinHashLength,\n  mapHashToField,\n  validateField,\n  type IField,\n} from './modular.ts';\n\nexport type { AffinePoint };\n\ntype EndoBasis = [[bigint, bigint], [bigint, bigint]];\n/**\n * When Weierstrass curve has `a=0`, it becomes Koblitz curve.\n * Koblitz curves allow using **efficiently-computable GLV endomorphism \u03C8**.\n * Endomorphism uses 2x less RAM, speeds up precomputation by 2x and ECDH / key recovery by 20%.\n * For precomputed wNAF it trades off 1/2 init time & 1/3 ram for 20% perf hit.\n *\n * Endomorphism consists of beta, lambda and splitScalar:\n *\n * 1. GLV endomorphism \u03C8 transforms a point: `P = (x, y) \u21A6 \u03C8(P) = (\u03B2\u00B7x mod p, y)`\n * 2. GLV scalar decomposition transforms a scalar: `k \u2261 k\u2081 + k\u2082\u00B7\u03BB (mod n)`\n * 3. Then these are combined: `k\u00B7P = k\u2081\u00B7P + k\u2082\u00B7\u03C8(P)`\n * 4. Two 128-bit point-by-scalar multiplications + one point addition is faster than\n *    one 256-bit multiplication.\n *\n * where\n * * beta: \u03B2 \u2208 F\u209A with \u03B2\u00B3 = 1, \u03B2 \u2260 1\n * * lambda: \u03BB \u2208 F\u2099 with \u03BB\u00B3 = 1, \u03BB \u2260 1\n * * splitScalar decomposes k \u21A6 k\u2081, k\u2082, by using reduced basis vectors.\n *   Gauss lattice reduction calculates them from initial basis vectors `(n, 0), (-\u03BB, 0)`\n *\n * Check out `test/misc/endomorphism.js` and\n * [gist](https://gist.github.com/paulmillr/eb670806793e84df628a7c434a873066).\n */\nexport type EndomorphismOpts = {\n  beta: bigint;\n  basises?: EndoBasis;\n  splitScalar?: (k: bigint) => { k1neg: boolean; k1: bigint; k2neg: boolean; k2: bigint };\n};\n// We construct basis in such way that den is always positive and equals n, but num sign depends on basis (not on secret value)\nconst divNearest = (num: bigint, den: bigint) => (num + (num >= 0 ? den : -den) / _2n) / den;\n\nexport type ScalarEndoParts = { k1neg: boolean; k1: bigint; k2neg: boolean; k2: bigint };\n\n/**\n * Splits scalar for GLV endomorphism.\n */\nexport function _splitEndoScalar(k: bigint, basis: EndoBasis, n: bigint): ScalarEndoParts {\n  // Split scalar into two such that part is ~half bits: `abs(part) < sqrt(N)`\n  // Since part can be negative, we need to do this on point.\n  // TODO: verifyScalar function which consumes lambda\n  const [[a1, b1], [a2, b2]] = basis;\n  const c1 = divNearest(b2 * k, n);\n  const c2 = divNearest(-b1 * k, n);\n  // |k1|/|k2| is < sqrt(N), but can be negative.\n  // If we do `k1 mod N`, we'll get big scalar (`> sqrt(N)`): so, we do cheaper negation instead.\n  let k1 = k - c1 * a1 - c2 * a2;\n  let k2 = -c1 * b1 - c2 * b2;\n  const k1neg = k1 < _0n;\n  const k2neg = k2 < _0n;\n  if (k1neg) k1 = -k1;\n  if (k2neg) k2 = -k2;\n  // Double check that resulting scalar less than half bits of N: otherwise wNAF will fail.\n  // This should only happen on wrong basises. Also, math inside is too complex and I don't trust it.\n  const MAX_NUM = bitMask(Math.ceil(bitLen(n) / 2)) + _1n; // Half bits of N\n  if (k1 < _0n || k1 >= MAX_NUM || k2 < _0n || k2 >= MAX_NUM) {\n    throw new Error('splitScalar (endomorphism): failed, k=' + k);\n  }\n  return { k1neg, k1, k2neg, k2 };\n}\n\n/**\n * Option to enable hedged signatures with improved security.\n *\n * * Randomly generated k is bad, because broken CSPRNG would leak private keys.\n * * Deterministic k (RFC6979) is better; but is suspectible to fault attacks.\n *\n * We allow using technique described in RFC6979 3.6: additional k', a.k.a. adding randomness\n * to deterministic sig. If CSPRNG is broken & randomness is weak, it would STILL be as secure\n * as ordinary sig without ExtraEntropy.\n *\n * * `true` means \"fetch data, from CSPRNG, incorporate it into k generation\"\n * * `false` means \"disable extra entropy, use purely deterministic k\"\n * * `Uint8Array` passed means \"incorporate following data into k generation\"\n *\n * https://paulmillr.com/posts/deterministic-signatures/\n */\nexport type ECDSAExtraEntropy = boolean | Uint8Array;\n/**\n * - `compact` is the default format\n * - `recovered` is the same as compact, but with an extra byte indicating recovery byte\n * - `der` is ASN.1 DER encoding\n */\nexport type ECDSASignatureFormat = 'compact' | 'recovered' | 'der';\n/**\n * - `prehash`: (default: true) indicates whether to do sha256(message).\n *   When a custom hash is used, it must be set to `false`.\n */\nexport type ECDSARecoverOpts = {\n  prehash?: boolean;\n};\n/**\n * - `prehash`: (default: true) indicates whether to do sha256(message).\n *   When a custom hash is used, it must be set to `false`.\n * - `lowS`: (default: true) prohibits signatures which have (sig.s >= CURVE.n/2n).\n *   Compatible with BTC/ETH. Setting `lowS: false` allows to create malleable signatures,\n *   which is default openssl behavior.\n *   Non-malleable signatures can still be successfully verified in openssl.\n * - `format`: (default: 'compact') 'compact' or 'recovered' with recovery byte\n */\nexport type ECDSAVerifyOpts = {\n  prehash?: boolean;\n  lowS?: boolean;\n  format?: ECDSASignatureFormat;\n};\n/**\n * - `prehash`: (default: true) indicates whether to do sha256(message).\n *   When a custom hash is used, it must be set to `false`.\n * - `lowS`: (default: true) prohibits signatures which have (sig.s >= CURVE.n/2n).\n *   Compatible with BTC/ETH. Setting `lowS: false` allows to create malleable signatures,\n *   which is default openssl behavior.\n *   Non-malleable signatures can still be successfully verified in openssl.\n * - `format`: (default: 'compact') 'compact' or 'recovered' with recovery byte\n * - `extraEntropy`: (default: false) creates sigs with increased security, see {@link ECDSAExtraEntropy}\n */\nexport type ECDSASignOpts = {\n  prehash?: boolean;\n  lowS?: boolean;\n  format?: ECDSASignatureFormat;\n  extraEntropy?: ECDSAExtraEntropy;\n};\n\nfunction validateSigFormat(format: string): ECDSASignatureFormat {\n  if (!['compact', 'recovered', 'der'].includes(format))\n    throw new Error('Signature format must be \"compact\", \"recovered\", or \"der\"');\n  return format as ECDSASignatureFormat;\n}\n\nfunction validateSigOpts<T extends ECDSASignOpts, D extends Required<ECDSASignOpts>>(\n  opts: T,\n  def: D\n): Required<ECDSASignOpts> {\n  const optsn: ECDSASignOpts = {};\n  for (let optName of Object.keys(def)) {\n    // @ts-ignore\n    optsn[optName] = opts[optName] === undefined ? def[optName] : opts[optName];\n  }\n  abool(optsn.lowS!, 'lowS');\n  abool(optsn.prehash!, 'prehash');\n  if (optsn.format !== undefined) validateSigFormat(optsn.format);\n  return optsn as Required<ECDSASignOpts>;\n}\n\n/** Instance methods for 3D XYZ projective points. */\nexport interface WeierstrassPoint<T> extends CurvePoint<T, WeierstrassPoint<T>> {\n  /** projective X coordinate. Different from affine x. */\n  readonly X: T;\n  /** projective Y coordinate. Different from affine y. */\n  readonly Y: T;\n  /** projective z coordinate */\n  readonly Z: T;\n  /** affine x coordinate. Different from projective X. */\n  get x(): T;\n  /** affine y coordinate. Different from projective Y. */\n  get y(): T;\n  /** Encodes point using IEEE P1363 (DER) encoding. First byte is 2/3/4. Default = isCompressed. */\n  toBytes(isCompressed?: boolean): Uint8Array;\n  toHex(isCompressed?: boolean): string;\n}\n\n/** Static methods for 3D XYZ projective points. */\nexport interface WeierstrassPointCons<T> extends CurvePointCons<WeierstrassPoint<T>> {\n  /** Does NOT validate if the point is valid. Use `.assertValidity()`. */\n  new (X: T, Y: T, Z: T): WeierstrassPoint<T>;\n  CURVE(): WeierstrassOpts<T>;\n}\n\n/**\n * Weierstrass curve options.\n *\n * * p: prime characteristic (order) of finite field, in which arithmetics is done\n * * n: order of prime subgroup a.k.a total amount of valid curve points\n * * h: cofactor, usually 1. h*n is group order; n is subgroup order\n * * a: formula param, must be in field of p\n * * b: formula param, must be in field of p\n * * Gx: x coordinate of generator point a.k.a. base point\n * * Gy: y coordinate of generator point\n */\nexport type WeierstrassOpts<T> = Readonly<{\n  p: bigint;\n  n: bigint;\n  h: bigint;\n  a: T;\n  b: T;\n  Gx: T;\n  Gy: T;\n}>;\n\n// When a cofactor != 1, there can be an effective methods to:\n// 1. Determine whether a point is torsion-free\n// 2. Clear torsion component\nexport type WeierstrassExtraOpts<T> = Partial<{\n  Fp: IField<T>;\n  Fn: IField<bigint>;\n  allowInfinityPoint: boolean;\n  endo: EndomorphismOpts;\n  isTorsionFree: (c: WeierstrassPointCons<T>, point: WeierstrassPoint<T>) => boolean;\n  clearCofactor: (c: WeierstrassPointCons<T>, point: WeierstrassPoint<T>) => WeierstrassPoint<T>;\n  fromBytes: (bytes: Uint8Array) => AffinePoint<T>;\n  toBytes: (\n    c: WeierstrassPointCons<T>,\n    point: WeierstrassPoint<T>,\n    isCompressed: boolean\n  ) => Uint8Array;\n}>;\n\n/**\n * Options for ECDSA signatures over a Weierstrass curve.\n *\n * * lowS: (default: true) whether produced / verified signatures occupy low half of ecdsaOpts.p. Prevents malleability.\n * * hmac: (default: noble-hashes hmac) function, would be used to init hmac-drbg for k generation.\n * * randomBytes: (default: webcrypto os-level CSPRNG) custom method for fetching secure randomness.\n * * bits2int, bits2int_modN: used in sigs, sometimes overridden by curves\n */\nexport type ECDSAOpts = Partial<{\n  lowS: boolean;\n  hmac: (key: Uint8Array, message: Uint8Array) => Uint8Array;\n  randomBytes: (bytesLength?: number) => Uint8Array;\n  bits2int: (bytes: Uint8Array) => bigint;\n  bits2int_modN: (bytes: Uint8Array) => bigint;\n}>;\n\n/**\n * Elliptic Curve Diffie-Hellman interface.\n * Provides keygen, secret-to-public conversion, calculating shared secrets.\n */\nexport interface ECDH {\n  keygen: (seed?: Uint8Array) => { secretKey: Uint8Array; publicKey: Uint8Array };\n  getPublicKey: (secretKey: Uint8Array, isCompressed?: boolean) => Uint8Array;\n  getSharedSecret: (\n    secretKeyA: Uint8Array,\n    publicKeyB: Uint8Array,\n    isCompressed?: boolean\n  ) => Uint8Array;\n  Point: WeierstrassPointCons<bigint>;\n  utils: {\n    isValidSecretKey: (secretKey: Uint8Array) => boolean;\n    isValidPublicKey: (publicKey: Uint8Array, isCompressed?: boolean) => boolean;\n    randomSecretKey: (seed?: Uint8Array) => Uint8Array;\n  };\n  lengths: CurveLengths;\n}\n\n/**\n * ECDSA interface.\n * Only supported for prime fields, not Fp2 (extension fields).\n */\nexport interface ECDSA extends ECDH {\n  sign: (message: Uint8Array, secretKey: Uint8Array, opts?: ECDSASignOpts) => Uint8Array;\n  verify: (\n    signature: Uint8Array,\n    message: Uint8Array,\n    publicKey: Uint8Array,\n    opts?: ECDSAVerifyOpts\n  ) => boolean;\n  recoverPublicKey(signature: Uint8Array, message: Uint8Array, opts?: ECDSARecoverOpts): Uint8Array;\n  Signature: ECDSASignatureCons;\n}\nexport class DERErr extends Error {\n  constructor(m = '') {\n    super(m);\n  }\n}\nexport type IDER = {\n  // asn.1 DER encoding utils\n  Err: typeof DERErr;\n  // Basic building block is TLV (Tag-Length-Value)\n  _tlv: {\n    encode: (tag: number, data: string) => string;\n    // v - value, l - left bytes (unparsed)\n    decode(tag: number, data: Uint8Array): { v: Uint8Array; l: Uint8Array };\n  };\n  // https://crypto.stackexchange.com/a/57734 Leftmost bit of first byte is 'negative' flag,\n  // since we always use positive integers here. It must always be empty:\n  // - add zero byte if exists\n  // - if next byte doesn't have a flag, leading zero is not allowed (minimal encoding)\n  _int: {\n    encode(num: bigint): string;\n    decode(data: Uint8Array): bigint;\n  };\n  toSig(hex: string | Uint8Array): { r: bigint; s: bigint };\n  hexFromSig(sig: { r: bigint; s: bigint }): string;\n};\n/**\n * ASN.1 DER encoding utilities. ASN is very complex & fragile. Format:\n *\n *     [0x30 (SEQUENCE), bytelength, 0x02 (INTEGER), intLength, R, 0x02 (INTEGER), intLength, S]\n *\n * Docs: https://letsencrypt.org/docs/a-warm-welcome-to-asn1-and-der/, https://luca.ntop.org/Teaching/Appunti/asn1.html\n */\nexport const DER: IDER = {\n  // asn.1 DER encoding utils\n  Err: DERErr,\n  // Basic building block is TLV (Tag-Length-Value)\n  _tlv: {\n    encode: (tag: number, data: string): string => {\n      const { Err: E } = DER;\n      if (tag < 0 || tag > 256) throw new E('tlv.encode: wrong tag');\n      if (data.length & 1) throw new E('tlv.encode: unpadded data');\n      const dataLen = data.length / 2;\n      const len = numberToHexUnpadded(dataLen);\n      if ((len.length / 2) & 0b1000_0000) throw new E('tlv.encode: long form length too big');\n      // length of length with long form flag\n      const lenLen = dataLen > 127 ? numberToHexUnpadded((len.length / 2) | 0b1000_0000) : '';\n      const t = numberToHexUnpadded(tag);\n      return t + lenLen + len + data;\n    },\n    // v - value, l - left bytes (unparsed)\n    decode(tag: number, data: Uint8Array): { v: Uint8Array; l: Uint8Array } {\n      const { Err: E } = DER;\n      let pos = 0;\n      if (tag < 0 || tag > 256) throw new E('tlv.encode: wrong tag');\n      if (data.length < 2 || data[pos++] !== tag) throw new E('tlv.decode: wrong tlv');\n      const first = data[pos++];\n      const isLong = !!(first & 0b1000_0000); // First bit of first length byte is flag for short/long form\n      let length = 0;\n      if (!isLong) length = first;\n      else {\n        // Long form: [longFlag(1bit), lengthLength(7bit), length (BE)]\n        const lenLen = first & 0b0111_1111;\n        if (!lenLen) throw new E('tlv.decode(long): indefinite length not supported');\n        if (lenLen > 4) throw new E('tlv.decode(long): byte length is too big'); // this will overflow u32 in js\n        const lengthBytes = data.subarray(pos, pos + lenLen);\n        if (lengthBytes.length !== lenLen) throw new E('tlv.decode: length bytes not complete');\n        if (lengthBytes[0] === 0) throw new E('tlv.decode(long): zero leftmost byte');\n        for (const b of lengthBytes) length = (length << 8) | b;\n        pos += lenLen;\n        if (length < 128) throw new E('tlv.decode(long): not minimal encoding');\n      }\n      const v = data.subarray(pos, pos + length);\n      if (v.length !== length) throw new E('tlv.decode: wrong value length');\n      return { v, l: data.subarray(pos + length) };\n    },\n  },\n  // https://crypto.stackexchange.com/a/57734 Leftmost bit of first byte is 'negative' flag,\n  // since we always use positive integers here. It must always be empty:\n  // - add zero byte if exists\n  // - if next byte doesn't have a flag, leading zero is not allowed (minimal encoding)\n  _int: {\n    encode(num: bigint): string {\n      const { Err: E } = DER;\n      if (num < _0n) throw new E('integer: negative integers are not allowed');\n      let hex = numberToHexUnpadded(num);\n      // Pad with zero byte if negative flag is present\n      if (Number.parseInt(hex[0], 16) & 0b1000) hex = '00' + hex;\n      if (hex.length & 1) throw new E('unexpected DER parsing assertion: unpadded hex');\n      return hex;\n    },\n    decode(data: Uint8Array): bigint {\n      const { Err: E } = DER;\n      if (data[0] & 0b1000_0000) throw new E('invalid signature integer: negative');\n      if (data[0] === 0x00 && !(data[1] & 0b1000_0000))\n        throw new E('invalid signature integer: unnecessary leading zero');\n      return bytesToNumberBE(data);\n    },\n  },\n  toSig(bytes: Uint8Array): { r: bigint; s: bigint } {\n    // parse DER signature\n    const { Err: E, _int: int, _tlv: tlv } = DER;\n    const data = abytes(bytes, undefined, 'signature');\n    const { v: seqBytes, l: seqLeftBytes } = tlv.decode(0x30, data);\n    if (seqLeftBytes.length) throw new E('invalid signature: left bytes after parsing');\n    const { v: rBytes, l: rLeftBytes } = tlv.decode(0x02, seqBytes);\n    const { v: sBytes, l: sLeftBytes } = tlv.decode(0x02, rLeftBytes);\n    if (sLeftBytes.length) throw new E('invalid signature: left bytes after parsing');\n    return { r: int.decode(rBytes), s: int.decode(sBytes) };\n  },\n  hexFromSig(sig: { r: bigint; s: bigint }): string {\n    const { _tlv: tlv, _int: int } = DER;\n    const rs = tlv.encode(0x02, int.encode(sig.r));\n    const ss = tlv.encode(0x02, int.encode(sig.s));\n    const seq = rs + ss;\n    return tlv.encode(0x30, seq);\n  },\n};\n\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3), _4n = BigInt(4);\n\n/**\n * Creates weierstrass Point constructor, based on specified curve options.\n *\n * See {@link WeierstrassOpts}.\n *\n * @example\n```js\nconst opts = {\n  p: 0xfffffffffffffffffffffffffffffffeffffac73n,\n  n: 0x100000000000000000001b8fa16dfab9aca16b6b3n,\n  h: 1n,\n  a: 0n,\n  b: 7n,\n  Gx: 0x3b4c382ce37aa192a4019e763036f4f5dd4d7ebbn,\n  Gy: 0x938cf935318fdced6bc28286531733c3f03c4feen,\n};\nconst secp160k1_Point = weierstrass(opts);\n```\n */\nexport function weierstrass<T>(\n  params: WeierstrassOpts<T>,\n  extraOpts: WeierstrassExtraOpts<T> = {}\n): WeierstrassPointCons<T> {\n  const validated = createCurveFields('weierstrass', params, extraOpts);\n  const { Fp, Fn } = validated;\n  let CURVE = validated.CURVE as WeierstrassOpts<T>;\n  const { h: cofactor, n: CURVE_ORDER } = CURVE;\n  validateObject(\n    extraOpts,\n    {},\n    {\n      allowInfinityPoint: 'boolean',\n      clearCofactor: 'function',\n      isTorsionFree: 'function',\n      fromBytes: 'function',\n      toBytes: 'function',\n      endo: 'object',\n    }\n  );\n\n  const { endo } = extraOpts;\n  if (endo) {\n    // validateObject(endo, { beta: 'bigint', splitScalar: 'function' });\n    if (!Fp.is0(CURVE.a) || typeof endo.beta !== 'bigint' || !Array.isArray(endo.basises)) {\n      throw new Error('invalid endo: expected \"beta\": bigint and \"basises\": array');\n    }\n  }\n\n  const lengths = getWLengths(Fp, Fn);\n\n  function assertCompressionIsSupported() {\n    if (!Fp.isOdd) throw new Error('compression is not supported: Field does not have .isOdd()');\n  }\n\n  // Implements IEEE P1363 point encoding\n  function pointToBytes(\n    _c: WeierstrassPointCons<T>,\n    point: WeierstrassPoint<T>,\n    isCompressed: boolean\n  ): Uint8Array {\n    const { x, y } = point.toAffine();\n    const bx = Fp.toBytes(x);\n    abool(isCompressed, 'isCompressed');\n    if (isCompressed) {\n      assertCompressionIsSupported();\n      const hasEvenY = !Fp.isOdd!(y);\n      return concatBytes(pprefix(hasEvenY), bx);\n    } else {\n      return concatBytes(Uint8Array.of(0x04), bx, Fp.toBytes(y));\n    }\n  }\n  function pointFromBytes(bytes: Uint8Array) {\n    abytes(bytes, undefined, 'Point');\n    const { publicKey: comp, publicKeyUncompressed: uncomp } = lengths; // e.g. for 32-byte: 33, 65\n    const length = bytes.length;\n    const head = bytes[0];\n    const tail = bytes.subarray(1);\n    // No actual validation is done here: use .assertValidity()\n    if (length === comp && (head === 0x02 || head === 0x03)) {\n      const x = Fp.fromBytes(tail);\n      if (!Fp.isValid(x)) throw new Error('bad point: is not on curve, wrong x');\n      const y2 = weierstrassEquation(x); // y\u00B2 = x\u00B3 + ax + b\n      let y: T;\n      try {\n        y = Fp.sqrt(y2); // y = y\u00B2 ^ (p+1)/4\n      } catch (sqrtError) {\n        const err = sqrtError instanceof Error ? ': ' + sqrtError.message : '';\n        throw new Error('bad point: is not on curve, sqrt error' + err);\n      }\n      assertCompressionIsSupported();\n      const evenY = Fp.isOdd!(y);\n      const evenH = (head & 1) === 1; // ECDSA-specific\n      if (evenH !== evenY) y = Fp.neg(y);\n      return { x, y };\n    } else if (length === uncomp && head === 0x04) {\n      // TODO: more checks\n      const L = Fp.BYTES;\n      const x = Fp.fromBytes(tail.subarray(0, L));\n      const y = Fp.fromBytes(tail.subarray(L, L * 2));\n      if (!isValidXY(x, y)) throw new Error('bad point: is not on curve');\n      return { x, y };\n    } else {\n      throw new Error(\n        `bad point: got length ${length}, expected compressed=${comp} or uncompressed=${uncomp}`\n      );\n    }\n  }\n\n  const encodePoint = extraOpts.toBytes || pointToBytes;\n  const decodePoint = extraOpts.fromBytes || pointFromBytes;\n  function weierstrassEquation(x: T): T {\n    const x2 = Fp.sqr(x); // x * x\n    const x3 = Fp.mul(x2, x); // x\u00B2 * x\n    return Fp.add(Fp.add(x3, Fp.mul(x, CURVE.a)), CURVE.b); // x\u00B3 + a * x + b\n  }\n\n  // TODO: move top-level\n  /** Checks whether equation holds for given x, y: y\u00B2 == x\u00B3 + ax + b */\n  function isValidXY(x: T, y: T): boolean {\n    const left = Fp.sqr(y); // y\u00B2\n    const right = weierstrassEquation(x); // x\u00B3 + ax + b\n    return Fp.eql(left, right);\n  }\n\n  // Validate whether the passed curve params are valid.\n  // Test 1: equation y\u00B2 = x\u00B3 + ax + b should work for generator point.\n  if (!isValidXY(CURVE.Gx, CURVE.Gy)) throw new Error('bad curve params: generator point');\n\n  // Test 2: discriminant \u0394 part should be non-zero: 4a\u00B3 + 27b\u00B2 != 0.\n  // Guarantees curve is genus-1, smooth (non-singular).\n  const _4a3 = Fp.mul(Fp.pow(CURVE.a, _3n), _4n);\n  const _27b2 = Fp.mul(Fp.sqr(CURVE.b), BigInt(27));\n  if (Fp.is0(Fp.add(_4a3, _27b2))) throw new Error('bad curve params: a or b');\n\n  /** Asserts coordinate is valid: 0 <= n < Fp.ORDER. */\n  function acoord(title: string, n: T, banZero = false) {\n    if (!Fp.isValid(n) || (banZero && Fp.is0(n))) throw new Error(`bad point coordinate ${title}`);\n    return n;\n  }\n\n  function aprjpoint(other: unknown) {\n    if (!(other instanceof Point)) throw new Error('Weierstrass Point expected');\n  }\n\n  function splitEndoScalarN(k: bigint) {\n    if (!endo || !endo.basises) throw new Error('no endo');\n    return _splitEndoScalar(k, endo.basises, Fn.ORDER);\n  }\n\n  // Memoized toAffine / validity check. They are heavy. Points are immutable.\n\n  // Converts Projective point to affine (x, y) coordinates.\n  // Can accept precomputed Z^-1 - for example, from invertBatch.\n  // (X, Y, Z) \u220B (x=X/Z, y=Y/Z)\n  const toAffineMemo = memoized((p: Point, iz?: T): AffinePoint<T> => {\n    const { X, Y, Z } = p;\n    // Fast-path for normalized points\n    if (Fp.eql(Z, Fp.ONE)) return { x: X, y: Y };\n    const is0 = p.is0();\n    // If invZ was 0, we return zero point. However we still want to execute\n    // all operations, so we replace invZ with a random number, 1.\n    if (iz == null) iz = is0 ? Fp.ONE : Fp.inv(Z);\n    const x = Fp.mul(X, iz);\n    const y = Fp.mul(Y, iz);\n    const zz = Fp.mul(Z, iz);\n    if (is0) return { x: Fp.ZERO, y: Fp.ZERO };\n    if (!Fp.eql(zz, Fp.ONE)) throw new Error('invZ was invalid');\n    return { x, y };\n  });\n  // NOTE: on exception this will crash 'cached' and no value will be set.\n  // Otherwise true will be return\n  const assertValidMemo = memoized((p: Point) => {\n    if (p.is0()) {\n      // (0, 1, 0) aka ZERO is invalid in most contexts.\n      // In BLS, ZERO can be serialized, so we allow it.\n      // (0, 0, 0) is invalid representation of ZERO.\n      if (extraOpts.allowInfinityPoint && !Fp.is0(p.Y)) return;\n      throw new Error('bad point: ZERO');\n    }\n    // Some 3rd-party test vectors require different wording between here & `fromCompressedHex`\n    const { x, y } = p.toAffine();\n    if (!Fp.isValid(x) || !Fp.isValid(y)) throw new Error('bad point: x or y not field elements');\n    if (!isValidXY(x, y)) throw new Error('bad point: equation left != right');\n    if (!p.isTorsionFree()) throw new Error('bad point: not in prime-order subgroup');\n    return true;\n  });\n\n  function finishEndo(\n    endoBeta: EndomorphismOpts['beta'],\n    k1p: Point,\n    k2p: Point,\n    k1neg: boolean,\n    k2neg: boolean\n  ) {\n    k2p = new Point(Fp.mul(k2p.X, endoBeta), k2p.Y, k2p.Z);\n    k1p = negateCt(k1neg, k1p);\n    k2p = negateCt(k2neg, k2p);\n    return k1p.add(k2p);\n  }\n\n  /**\n   * Projective Point works in 3d / projective (homogeneous) coordinates:(X, Y, Z) \u220B (x=X/Z, y=Y/Z).\n   * Default Point works in 2d / affine coordinates: (x, y).\n   * We're doing calculations in projective, because its operations don't require costly inversion.\n   */\n  class Point implements WeierstrassPoint<T> {\n    // base / generator point\n    static readonly BASE = new Point(CURVE.Gx, CURVE.Gy, Fp.ONE);\n    // zero / infinity / identity point\n    static readonly ZERO = new Point(Fp.ZERO, Fp.ONE, Fp.ZERO); // 0, 1, 0\n    // math field\n    static readonly Fp = Fp;\n    // scalar field\n    static readonly Fn = Fn;\n\n    readonly X: T;\n    readonly Y: T;\n    readonly Z: T;\n\n    /** Does NOT validate if the point is valid. Use `.assertValidity()`. */\n    constructor(X: T, Y: T, Z: T) {\n      this.X = acoord('x', X);\n      this.Y = acoord('y', Y, true);\n      this.Z = acoord('z', Z);\n      Object.freeze(this);\n    }\n\n    static CURVE(): WeierstrassOpts<T> {\n      return CURVE;\n    }\n\n    /** Does NOT validate if the point is valid. Use `.assertValidity()`. */\n    static fromAffine(p: AffinePoint<T>): Point {\n      const { x, y } = p || {};\n      if (!p || !Fp.isValid(x) || !Fp.isValid(y)) throw new Error('invalid affine point');\n      if (p instanceof Point) throw new Error('projective point not allowed');\n      // (0, 0) would've produced (0, 0, 1) - instead, we need (0, 1, 0)\n      if (Fp.is0(x) && Fp.is0(y)) return Point.ZERO;\n      return new Point(x, y, Fp.ONE);\n    }\n\n    static fromBytes(bytes: Uint8Array): Point {\n      const P = Point.fromAffine(decodePoint(abytes(bytes, undefined, 'point')));\n      P.assertValidity();\n      return P;\n    }\n\n    static fromHex(hex: string): Point {\n      return Point.fromBytes(hexToBytes(hex));\n    }\n\n    get x(): T {\n      return this.toAffine().x;\n    }\n    get y(): T {\n      return this.toAffine().y;\n    }\n\n    /**\n     *\n     * @param windowSize\n     * @param isLazy true will defer table computation until the first multiplication\n     * @returns\n     */\n    precompute(windowSize: number = 8, isLazy = true): Point {\n      wnaf.createCache(this, windowSize);\n      if (!isLazy) this.multiply(_3n); // random number\n      return this;\n    }\n\n    // TODO: return `this`\n    /** A point on curve is valid if it conforms to equation. */\n    assertValidity(): void {\n      assertValidMemo(this);\n    }\n\n    hasEvenY(): boolean {\n      const { y } = this.toAffine();\n      if (!Fp.isOdd) throw new Error(\"Field doesn't support isOdd\");\n      return !Fp.isOdd(y);\n    }\n\n    /** Compare one point to another. */\n    equals(other: Point): boolean {\n      aprjpoint(other);\n      const { X: X1, Y: Y1, Z: Z1 } = this;\n      const { X: X2, Y: Y2, Z: Z2 } = other;\n      const U1 = Fp.eql(Fp.mul(X1, Z2), Fp.mul(X2, Z1));\n      const U2 = Fp.eql(Fp.mul(Y1, Z2), Fp.mul(Y2, Z1));\n      return U1 && U2;\n    }\n\n    /** Flips point to one corresponding to (x, -y) in Affine coordinates. */\n    negate(): Point {\n      return new Point(this.X, Fp.neg(this.Y), this.Z);\n    }\n\n    // Renes-Costello-Batina exception-free doubling formula.\n    // There is 30% faster Jacobian formula, but it is not complete.\n    // https://eprint.iacr.org/2015/1060, algorithm 3\n    // Cost: 8M + 3S + 3*a + 2*b3 + 15add.\n    double() {\n      const { a, b } = CURVE;\n      const b3 = Fp.mul(b, _3n);\n      const { X: X1, Y: Y1, Z: Z1 } = this;\n      let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n      let t0 = Fp.mul(X1, X1); // step 1\n      let t1 = Fp.mul(Y1, Y1);\n      let t2 = Fp.mul(Z1, Z1);\n      let t3 = Fp.mul(X1, Y1);\n      t3 = Fp.add(t3, t3); // step 5\n      Z3 = Fp.mul(X1, Z1);\n      Z3 = Fp.add(Z3, Z3);\n      X3 = Fp.mul(a, Z3);\n      Y3 = Fp.mul(b3, t2);\n      Y3 = Fp.add(X3, Y3); // step 10\n      X3 = Fp.sub(t1, Y3);\n      Y3 = Fp.add(t1, Y3);\n      Y3 = Fp.mul(X3, Y3);\n      X3 = Fp.mul(t3, X3);\n      Z3 = Fp.mul(b3, Z3); // step 15\n      t2 = Fp.mul(a, t2);\n      t3 = Fp.sub(t0, t2);\n      t3 = Fp.mul(a, t3);\n      t3 = Fp.add(t3, Z3);\n      Z3 = Fp.add(t0, t0); // step 20\n      t0 = Fp.add(Z3, t0);\n      t0 = Fp.add(t0, t2);\n      t0 = Fp.mul(t0, t3);\n      Y3 = Fp.add(Y3, t0);\n      t2 = Fp.mul(Y1, Z1); // step 25\n      t2 = Fp.add(t2, t2);\n      t0 = Fp.mul(t2, t3);\n      X3 = Fp.sub(X3, t0);\n      Z3 = Fp.mul(t2, t1);\n      Z3 = Fp.add(Z3, Z3); // step 30\n      Z3 = Fp.add(Z3, Z3);\n      return new Point(X3, Y3, Z3);\n    }\n\n    // Renes-Costello-Batina exception-free addition formula.\n    // There is 30% faster Jacobian formula, but it is not complete.\n    // https://eprint.iacr.org/2015/1060, algorithm 1\n    // Cost: 12M + 0S + 3*a + 3*b3 + 23add.\n    add(other: Point): Point {\n      aprjpoint(other);\n      const { X: X1, Y: Y1, Z: Z1 } = this;\n      const { X: X2, Y: Y2, Z: Z2 } = other;\n      let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n      const a = CURVE.a;\n      const b3 = Fp.mul(CURVE.b, _3n);\n      let t0 = Fp.mul(X1, X2); // step 1\n      let t1 = Fp.mul(Y1, Y2);\n      let t2 = Fp.mul(Z1, Z2);\n      let t3 = Fp.add(X1, Y1);\n      let t4 = Fp.add(X2, Y2); // step 5\n      t3 = Fp.mul(t3, t4);\n      t4 = Fp.add(t0, t1);\n      t3 = Fp.sub(t3, t4);\n      t4 = Fp.add(X1, Z1);\n      let t5 = Fp.add(X2, Z2); // step 10\n      t4 = Fp.mul(t4, t5);\n      t5 = Fp.add(t0, t2);\n      t4 = Fp.sub(t4, t5);\n      t5 = Fp.add(Y1, Z1);\n      X3 = Fp.add(Y2, Z2); // step 15\n      t5 = Fp.mul(t5, X3);\n      X3 = Fp.add(t1, t2);\n      t5 = Fp.sub(t5, X3);\n      Z3 = Fp.mul(a, t4);\n      X3 = Fp.mul(b3, t2); // step 20\n      Z3 = Fp.add(X3, Z3);\n      X3 = Fp.sub(t1, Z3);\n      Z3 = Fp.add(t1, Z3);\n      Y3 = Fp.mul(X3, Z3);\n      t1 = Fp.add(t0, t0); // step 25\n      t1 = Fp.add(t1, t0);\n      t2 = Fp.mul(a, t2);\n      t4 = Fp.mul(b3, t4);\n      t1 = Fp.add(t1, t2);\n      t2 = Fp.sub(t0, t2); // step 30\n      t2 = Fp.mul(a, t2);\n      t4 = Fp.add(t4, t2);\n      t0 = Fp.mul(t1, t4);\n      Y3 = Fp.add(Y3, t0);\n      t0 = Fp.mul(t5, t4); // step 35\n      X3 = Fp.mul(t3, X3);\n      X3 = Fp.sub(X3, t0);\n      t0 = Fp.mul(t3, t1);\n      Z3 = Fp.mul(t5, Z3);\n      Z3 = Fp.add(Z3, t0); // step 40\n      return new Point(X3, Y3, Z3);\n    }\n\n    subtract(other: Point) {\n      return this.add(other.negate());\n    }\n\n    is0(): boolean {\n      return this.equals(Point.ZERO);\n    }\n\n    /**\n     * Constant time multiplication.\n     * Uses wNAF method. Windowed method may be 10% faster,\n     * but takes 2x longer to generate and consumes 2x memory.\n     * Uses precomputes when available.\n     * Uses endomorphism for Koblitz curves.\n     * @param scalar by which the point would be multiplied\n     * @returns New point\n     */\n    multiply(scalar: bigint): Point {\n      const { endo } = extraOpts;\n      if (!Fn.isValidNot0(scalar)) throw new Error('invalid scalar: out of range'); // 0 is invalid\n      let point: Point, fake: Point; // Fake point is used to const-time mult\n      const mul = (n: bigint) => wnaf.cached(this, n, (p) => normalizeZ(Point, p));\n      /** See docs for {@link EndomorphismOpts} */\n      if (endo) {\n        const { k1neg, k1, k2neg, k2 } = splitEndoScalarN(scalar);\n        const { p: k1p, f: k1f } = mul(k1);\n        const { p: k2p, f: k2f } = mul(k2);\n        fake = k1f.add(k2f);\n        point = finishEndo(endo.beta, k1p, k2p, k1neg, k2neg);\n      } else {\n        const { p, f } = mul(scalar);\n        point = p;\n        fake = f;\n      }\n      // Normalize `z` for both points, but return only real one\n      return normalizeZ(Point, [point, fake])[0];\n    }\n\n    /**\n     * Non-constant-time multiplication. Uses double-and-add algorithm.\n     * It's faster, but should only be used when you don't care about\n     * an exposed secret key e.g. sig verification, which works over *public* keys.\n     */\n    multiplyUnsafe(sc: bigint): Point {\n      const { endo } = extraOpts;\n      const p = this as Point;\n      if (!Fn.isValid(sc)) throw new Error('invalid scalar: out of range'); // 0 is valid\n      if (sc === _0n || p.is0()) return Point.ZERO; // 0\n      if (sc === _1n) return p; // 1\n      if (wnaf.hasCache(this)) return this.multiply(sc); // precomputes\n      // We don't have method for double scalar multiplication (aP + bQ):\n      // Even with using Strauss-Shamir trick, it's 35% slower than na\u00EFve mul+add.\n      if (endo) {\n        const { k1neg, k1, k2neg, k2 } = splitEndoScalarN(sc);\n        const { p1, p2 } = mulEndoUnsafe(Point, p, k1, k2); // 30% faster vs wnaf.unsafe\n        return finishEndo(endo.beta, p1, p2, k1neg, k2neg);\n      } else {\n        return wnaf.unsafe(p, sc);\n      }\n    }\n\n    /**\n     * Converts Projective point to affine (x, y) coordinates.\n     * @param invertedZ Z^-1 (inverted zero) - optional, precomputation is useful for invertBatch\n     */\n    toAffine(invertedZ?: T): AffinePoint<T> {\n      return toAffineMemo(this, invertedZ);\n    }\n\n    /**\n     * Checks whether Point is free of torsion elements (is in prime subgroup).\n     * Always torsion-free for cofactor=1 curves.\n     */\n    isTorsionFree(): boolean {\n      const { isTorsionFree } = extraOpts;\n      if (cofactor === _1n) return true;\n      if (isTorsionFree) return isTorsionFree(Point, this);\n      return wnaf.unsafe(this, CURVE_ORDER).is0();\n    }\n\n    clearCofactor(): Point {\n      const { clearCofactor } = extraOpts;\n      if (cofactor === _1n) return this; // Fast-path\n      if (clearCofactor) return clearCofactor(Point, this) as Point;\n      return this.multiplyUnsafe(cofactor);\n    }\n\n    isSmallOrder(): boolean {\n      // can we use this.clearCofactor()?\n      return this.multiplyUnsafe(cofactor).is0();\n    }\n\n    toBytes(isCompressed = true): Uint8Array {\n      abool(isCompressed, 'isCompressed');\n      this.assertValidity();\n      return encodePoint(Point, this, isCompressed);\n    }\n\n    toHex(isCompressed = true): string {\n      return bytesToHex(this.toBytes(isCompressed));\n    }\n\n    toString() {\n      return `<Point ${this.is0() ? 'ZERO' : this.toHex()}>`;\n    }\n  }\n  const bits = Fn.BITS;\n  const wnaf = new wNAF(Point, extraOpts.endo ? Math.ceil(bits / 2) : bits);\n  Point.BASE.precompute(8); // Enable precomputes. Slows down first publicKey computation by 20ms.\n  return Point;\n}\n\n/** Methods of ECDSA signature instance. */\nexport interface ECDSASignature {\n  readonly r: bigint;\n  readonly s: bigint;\n  readonly recovery?: number;\n  addRecoveryBit(recovery: number): ECDSASignature & { readonly recovery: number };\n  hasHighS(): boolean;\n  recoverPublicKey(messageHash: Uint8Array): WeierstrassPoint<bigint>;\n  toBytes(format?: string): Uint8Array;\n  toHex(format?: string): string;\n}\n/** Methods of ECDSA signature constructor. */\nexport type ECDSASignatureCons = {\n  new (r: bigint, s: bigint, recovery?: number): ECDSASignature;\n  fromBytes(bytes: Uint8Array, format?: ECDSASignatureFormat): ECDSASignature;\n  fromHex(hex: string, format?: ECDSASignatureFormat): ECDSASignature;\n};\n\n// Points start with byte 0x02 when y is even; otherwise 0x03\nfunction pprefix(hasEvenY: boolean): Uint8Array {\n  return Uint8Array.of(hasEvenY ? 0x02 : 0x03);\n}\n\n/**\n * Implementation of the Shallue and van de Woestijne method for any weierstrass curve.\n * TODO: check if there is a way to merge this with uvRatio in Edwards; move to modular.\n * b = True and y = sqrt(u / v) if (u / v) is square in F, and\n * b = False and y = sqrt(Z * (u / v)) otherwise.\n * @param Fp\n * @param Z\n * @returns\n */\nexport function SWUFpSqrtRatio<T>(\n  Fp: IField<T>,\n  Z: T\n): (u: T, v: T) => { isValid: boolean; value: T } {\n  // Generic implementation\n  const q = Fp.ORDER;\n  let l = _0n;\n  for (let o = q - _1n; o % _2n === _0n; o /= _2n) l += _1n;\n  const c1 = l; // 1. c1, the largest integer such that 2^c1 divides q - 1.\n  // We need 2n ** c1 and 2n ** (c1-1). We can't use **; but we can use <<.\n  // 2n ** c1 == 2n << (c1-1)\n  const _2n_pow_c1_1 = _2n << (c1 - _1n - _1n);\n  const _2n_pow_c1 = _2n_pow_c1_1 * _2n;\n  const c2 = (q - _1n) / _2n_pow_c1; // 2. c2 = (q - 1) / (2^c1)  # Integer arithmetic\n  const c3 = (c2 - _1n) / _2n; // 3. c3 = (c2 - 1) / 2            # Integer arithmetic\n  const c4 = _2n_pow_c1 - _1n; // 4. c4 = 2^c1 - 1                # Integer arithmetic\n  const c5 = _2n_pow_c1_1; // 5. c5 = 2^(c1 - 1)                  # Integer arithmetic\n  const c6 = Fp.pow(Z, c2); // 6. c6 = Z^c2\n  const c7 = Fp.pow(Z, (c2 + _1n) / _2n); // 7. c7 = Z^((c2 + 1) / 2)\n  let sqrtRatio = (u: T, v: T): { isValid: boolean; value: T } => {\n    let tv1 = c6; // 1. tv1 = c6\n    let tv2 = Fp.pow(v, c4); // 2. tv2 = v^c4\n    let tv3 = Fp.sqr(tv2); // 3. tv3 = tv2^2\n    tv3 = Fp.mul(tv3, v); // 4. tv3 = tv3 * v\n    let tv5 = Fp.mul(u, tv3); // 5. tv5 = u * tv3\n    tv5 = Fp.pow(tv5, c3); // 6. tv5 = tv5^c3\n    tv5 = Fp.mul(tv5, tv2); // 7. tv5 = tv5 * tv2\n    tv2 = Fp.mul(tv5, v); // 8. tv2 = tv5 * v\n    tv3 = Fp.mul(tv5, u); // 9. tv3 = tv5 * u\n    let tv4 = Fp.mul(tv3, tv2); // 10. tv4 = tv3 * tv2\n    tv5 = Fp.pow(tv4, c5); // 11. tv5 = tv4^c5\n    let isQR = Fp.eql(tv5, Fp.ONE); // 12. isQR = tv5 == 1\n    tv2 = Fp.mul(tv3, c7); // 13. tv2 = tv3 * c7\n    tv5 = Fp.mul(tv4, tv1); // 14. tv5 = tv4 * tv1\n    tv3 = Fp.cmov(tv2, tv3, isQR); // 15. tv3 = CMOV(tv2, tv3, isQR)\n    tv4 = Fp.cmov(tv5, tv4, isQR); // 16. tv4 = CMOV(tv5, tv4, isQR)\n    // 17. for i in (c1, c1 - 1, ..., 2):\n    for (let i = c1; i > _1n; i--) {\n      let tv5 = i - _2n; // 18.    tv5 = i - 2\n      tv5 = _2n << (tv5 - _1n); // 19.    tv5 = 2^tv5\n      let tvv5 = Fp.pow(tv4, tv5); // 20.    tv5 = tv4^tv5\n      const e1 = Fp.eql(tvv5, Fp.ONE); // 21.    e1 = tv5 == 1\n      tv2 = Fp.mul(tv3, tv1); // 22.    tv2 = tv3 * tv1\n      tv1 = Fp.mul(tv1, tv1); // 23.    tv1 = tv1 * tv1\n      tvv5 = Fp.mul(tv4, tv1); // 24.    tv5 = tv4 * tv1\n      tv3 = Fp.cmov(tv2, tv3, e1); // 25.    tv3 = CMOV(tv2, tv3, e1)\n      tv4 = Fp.cmov(tvv5, tv4, e1); // 26.    tv4 = CMOV(tv5, tv4, e1)\n    }\n    return { isValid: isQR, value: tv3 };\n  };\n  if (Fp.ORDER % _4n === _3n) {\n    // sqrt_ratio_3mod4(u, v)\n    const c1 = (Fp.ORDER - _3n) / _4n; // 1. c1 = (q - 3) / 4     # Integer arithmetic\n    const c2 = Fp.sqrt(Fp.neg(Z)); // 2. c2 = sqrt(-Z)\n    sqrtRatio = (u: T, v: T) => {\n      let tv1 = Fp.sqr(v); // 1. tv1 = v^2\n      const tv2 = Fp.mul(u, v); // 2. tv2 = u * v\n      tv1 = Fp.mul(tv1, tv2); // 3. tv1 = tv1 * tv2\n      let y1 = Fp.pow(tv1, c1); // 4. y1 = tv1^c1\n      y1 = Fp.mul(y1, tv2); // 5. y1 = y1 * tv2\n      const y2 = Fp.mul(y1, c2); // 6. y2 = y1 * c2\n      const tv3 = Fp.mul(Fp.sqr(y1), v); // 7. tv3 = y1^2; 8. tv3 = tv3 * v\n      const isQR = Fp.eql(tv3, u); // 9. isQR = tv3 == u\n      let y = Fp.cmov(y2, y1, isQR); // 10. y = CMOV(y2, y1, isQR)\n      return { isValid: isQR, value: y }; // 11. return (isQR, y) isQR ? y : y*c2\n    };\n  }\n  // No curves uses that\n  // if (Fp.ORDER % _8n === _5n) // sqrt_ratio_5mod8\n  return sqrtRatio;\n}\n/**\n * Simplified Shallue-van de Woestijne-Ulas Method\n * https://www.rfc-editor.org/rfc/rfc9380#section-6.6.2\n */\nexport function mapToCurveSimpleSWU<T>(\n  Fp: IField<T>,\n  opts: {\n    A: T;\n    B: T;\n    Z: T;\n  }\n): (u: T) => { x: T; y: T } {\n  validateField(Fp);\n  const { A, B, Z } = opts;\n  if (!Fp.isValid(A) || !Fp.isValid(B) || !Fp.isValid(Z))\n    throw new Error('mapToCurveSimpleSWU: invalid opts');\n  const sqrtRatio = SWUFpSqrtRatio(Fp, Z);\n  if (!Fp.isOdd) throw new Error('Field does not have .isOdd()');\n  // Input: u, an element of F.\n  // Output: (x, y), a point on E.\n  return (u: T): { x: T; y: T } => {\n    // prettier-ignore\n    let tv1, tv2, tv3, tv4, tv5, tv6, x, y;\n    tv1 = Fp.sqr(u); // 1.  tv1 = u^2\n    tv1 = Fp.mul(tv1, Z); // 2.  tv1 = Z * tv1\n    tv2 = Fp.sqr(tv1); // 3.  tv2 = tv1^2\n    tv2 = Fp.add(tv2, tv1); // 4.  tv2 = tv2 + tv1\n    tv3 = Fp.add(tv2, Fp.ONE); // 5.  tv3 = tv2 + 1\n    tv3 = Fp.mul(tv3, B); // 6.  tv3 = B * tv3\n    tv4 = Fp.cmov(Z, Fp.neg(tv2), !Fp.eql(tv2, Fp.ZERO)); // 7.  tv4 = CMOV(Z, -tv2, tv2 != 0)\n    tv4 = Fp.mul(tv4, A); // 8.  tv4 = A * tv4\n    tv2 = Fp.sqr(tv3); // 9.  tv2 = tv3^2\n    tv6 = Fp.sqr(tv4); // 10. tv6 = tv4^2\n    tv5 = Fp.mul(tv6, A); // 11. tv5 = A * tv6\n    tv2 = Fp.add(tv2, tv5); // 12. tv2 = tv2 + tv5\n    tv2 = Fp.mul(tv2, tv3); // 13. tv2 = tv2 * tv3\n    tv6 = Fp.mul(tv6, tv4); // 14. tv6 = tv6 * tv4\n    tv5 = Fp.mul(tv6, B); // 15. tv5 = B * tv6\n    tv2 = Fp.add(tv2, tv5); // 16. tv2 = tv2 + tv5\n    x = Fp.mul(tv1, tv3); // 17.   x = tv1 * tv3\n    const { isValid, value } = sqrtRatio(tv2, tv6); // 18. (is_gx1_square, y1) = sqrt_ratio(tv2, tv6)\n    y = Fp.mul(tv1, u); // 19.   y = tv1 * u  -> Z * u^3 * y1\n    y = Fp.mul(y, value); // 20.   y = y * y1\n    x = Fp.cmov(x, tv3, isValid); // 21.   x = CMOV(x, tv3, is_gx1_square)\n    y = Fp.cmov(y, value, isValid); // 22.   y = CMOV(y, y1, is_gx1_square)\n    const e1 = Fp.isOdd!(u) === Fp.isOdd!(y); // 23.  e1 = sgn0(u) == sgn0(y)\n    y = Fp.cmov(Fp.neg(y), y, e1); // 24.   y = CMOV(-y, y, e1)\n    const tv4_inv = FpInvertBatch(Fp, [tv4], true)[0];\n    x = Fp.mul(x, tv4_inv); // 25.   x = x / tv4\n    return { x, y };\n  };\n}\n\nfunction getWLengths<T>(Fp: IField<T>, Fn: IField<bigint>) {\n  return {\n    secretKey: Fn.BYTES,\n    publicKey: 1 + Fp.BYTES,\n    publicKeyUncompressed: 1 + 2 * Fp.BYTES,\n    publicKeyHasPrefix: true,\n    signature: 2 * Fn.BYTES,\n  };\n}\n\n/**\n * Sometimes users only need getPublicKey, getSharedSecret, and secret key handling.\n * This helper ensures no signature functionality is present. Less code, smaller bundle size.\n */\nexport function ecdh(\n  Point: WeierstrassPointCons<bigint>,\n  ecdhOpts: { randomBytes?: (bytesLength?: number) => Uint8Array } = {}\n): ECDH {\n  const { Fn } = Point;\n  const randomBytes_ = ecdhOpts.randomBytes || wcRandomBytes;\n  const lengths = Object.assign(getWLengths(Point.Fp, Fn), { seed: getMinHashLength(Fn.ORDER) });\n\n  function isValidSecretKey(secretKey: Uint8Array) {\n    try {\n      const num = Fn.fromBytes(secretKey);\n      return Fn.isValidNot0(num);\n    } catch (error) {\n      return false;\n    }\n  }\n\n  function isValidPublicKey(publicKey: Uint8Array, isCompressed?: boolean): boolean {\n    const { publicKey: comp, publicKeyUncompressed } = lengths;\n    try {\n      const l = publicKey.length;\n      if (isCompressed === true && l !== comp) return false;\n      if (isCompressed === false && l !== publicKeyUncompressed) return false;\n      return !!Point.fromBytes(publicKey);\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Produces cryptographically secure secret key from random of size\n   * (groupLen + ceil(groupLen / 2)) with modulo bias being negligible.\n   */\n  function randomSecretKey(seed = randomBytes_(lengths.seed)): Uint8Array {\n    return mapHashToField(abytes(seed, lengths.seed, 'seed'), Fn.ORDER);\n  }\n\n  /**\n   * Computes public key for a secret key. Checks for validity of the secret key.\n   * @param isCompressed whether to return compact (default), or full key\n   * @returns Public key, full when isCompressed=false; short when isCompressed=true\n   */\n  function getPublicKey(secretKey: Uint8Array, isCompressed = true): Uint8Array {\n    return Point.BASE.multiply(Fn.fromBytes(secretKey)).toBytes(isCompressed);\n  }\n\n  /**\n   * Quick and dirty check for item being public key. Does not validate hex, or being on-curve.\n   */\n  function isProbPub(item: Uint8Array): boolean | undefined {\n    const { secretKey, publicKey, publicKeyUncompressed } = lengths;\n    if (!isBytes(item)) return undefined;\n    if (('_lengths' in Fn && Fn._lengths) || secretKey === publicKey) return undefined;\n    const l = abytes(item, undefined, 'key').length;\n    return l === publicKey || l === publicKeyUncompressed;\n  }\n\n  /**\n   * ECDH (Elliptic Curve Diffie Hellman).\n   * Computes shared public key from secret key A and public key B.\n   * Checks: 1) secret key validity 2) shared key is on-curve.\n   * Does NOT hash the result.\n   * @param isCompressed whether to return compact (default), or full key\n   * @returns shared public key\n   */\n  function getSharedSecret(\n    secretKeyA: Uint8Array,\n    publicKeyB: Uint8Array,\n    isCompressed = true\n  ): Uint8Array {\n    if (isProbPub(secretKeyA) === true) throw new Error('first arg must be private key');\n    if (isProbPub(publicKeyB) === false) throw new Error('second arg must be public key');\n    const s = Fn.fromBytes(secretKeyA);\n    const b = Point.fromBytes(publicKeyB); // checks for being on-curve\n    return b.multiply(s).toBytes(isCompressed);\n  }\n\n  const utils = {\n    isValidSecretKey,\n    isValidPublicKey,\n    randomSecretKey,\n  };\n  const keygen = createKeygen(randomSecretKey, getPublicKey);\n\n  return Object.freeze({ getPublicKey, getSharedSecret, keygen, Point, utils, lengths });\n}\n\n/**\n * Creates ECDSA signing interface for given elliptic curve `Point` and `hash` function.\n *\n * @param Point created using {@link weierstrass} function\n * @param hash used for 1) message prehash-ing 2) k generation in `sign`, using hmac_drbg(hash)\n * @param ecdsaOpts rarely needed, see {@link ECDSAOpts}\n *\n * @example\n * ```js\n * const p256_Point = weierstrass(...);\n * const p256_sha256 = ecdsa(p256_Point, sha256);\n * const p256_sha224 = ecdsa(p256_Point, sha224);\n * const p256_sha224_r = ecdsa(p256_Point, sha224, { randomBytes: (length) => { ... } });\n * ```\n */\nexport function ecdsa(\n  Point: WeierstrassPointCons<bigint>,\n  hash: CHash,\n  ecdsaOpts: ECDSAOpts = {}\n): ECDSA {\n  ahash(hash);\n  validateObject(\n    ecdsaOpts,\n    {},\n    {\n      hmac: 'function',\n      lowS: 'boolean',\n      randomBytes: 'function',\n      bits2int: 'function',\n      bits2int_modN: 'function',\n    }\n  );\n  ecdsaOpts = Object.assign({}, ecdsaOpts);\n  const randomBytes = ecdsaOpts.randomBytes || wcRandomBytes;\n  const hmac = ecdsaOpts.hmac || ((key, msg) => nobleHmac(hash, key, msg));\n\n  const { Fp, Fn } = Point;\n  const { ORDER: CURVE_ORDER, BITS: fnBits } = Fn;\n  const { keygen, getPublicKey, getSharedSecret, utils, lengths } = ecdh(Point, ecdsaOpts);\n  const defaultSigOpts: Required<ECDSASignOpts> = {\n    prehash: true,\n    lowS: typeof ecdsaOpts.lowS === 'boolean' ? ecdsaOpts.lowS : true,\n    format: 'compact' as ECDSASignatureFormat,\n    extraEntropy: false,\n  };\n  const hasLargeCofactor = CURVE_ORDER * _2n < Fp.ORDER; // Won't CURVE().h > 2n be more effective?\n\n  function isBiggerThanHalfOrder(number: bigint) {\n    const HALF = CURVE_ORDER >> _1n;\n    return number > HALF;\n  }\n  function validateRS(title: string, num: bigint): bigint {\n    if (!Fn.isValidNot0(num))\n      throw new Error(`invalid signature ${title}: out of range 1..Point.Fn.ORDER`);\n    return num;\n  }\n  function assertSmallCofactor(): void {\n    // ECDSA recovery is hard for cofactor > 1 curves.\n    // In sign, `r = q.x mod n`, and here we recover q.x from r.\n    // While recovering q.x >= n, we need to add r+n for cofactor=1 curves.\n    // However, for cofactor>1, r+n may not get q.x:\n    // r+n*i would need to be done instead where i is unknown.\n    // To easily get i, we either need to:\n    // a. increase amount of valid recid values (4, 5...); OR\n    // b. prohibit non-prime-order signatures (recid > 1).\n    if (hasLargeCofactor)\n      throw new Error('\"recovered\" sig type is not supported for cofactor >2 curves');\n  }\n  function validateSigLength(bytes: Uint8Array, format: ECDSASignatureFormat) {\n    validateSigFormat(format);\n    const size = lengths.signature!;\n    const sizer = format === 'compact' ? size : format === 'recovered' ? size + 1 : undefined;\n    return abytes(bytes, sizer);\n  }\n\n  /**\n   * ECDSA signature with its (r, s) properties. Supports compact, recovered & DER representations.\n   */\n  class Signature implements ECDSASignature {\n    readonly r: bigint;\n    readonly s: bigint;\n    readonly recovery?: number;\n\n    constructor(r: bigint, s: bigint, recovery?: number) {\n      this.r = validateRS('r', r); // r in [1..N-1];\n      this.s = validateRS('s', s); // s in [1..N-1];\n      if (recovery != null) {\n        assertSmallCofactor();\n        if (![0, 1, 2, 3].includes(recovery)) throw new Error('invalid recovery id');\n        this.recovery = recovery;\n      }\n      Object.freeze(this);\n    }\n\n    static fromBytes(\n      bytes: Uint8Array,\n      format: ECDSASignatureFormat = defaultSigOpts.format\n    ): Signature {\n      validateSigLength(bytes, format);\n      let recid: number | undefined;\n      if (format === 'der') {\n        const { r, s } = DER.toSig(abytes(bytes));\n        return new Signature(r, s);\n      }\n      if (format === 'recovered') {\n        recid = bytes[0];\n        format = 'compact';\n        bytes = bytes.subarray(1);\n      }\n      const L = lengths.signature! / 2;\n      const r = bytes.subarray(0, L);\n      const s = bytes.subarray(L, L * 2);\n      return new Signature(Fn.fromBytes(r), Fn.fromBytes(s), recid);\n    }\n\n    static fromHex(hex: string, format?: ECDSASignatureFormat) {\n      return this.fromBytes(hexToBytes(hex), format);\n    }\n\n    private assertRecovery(): number {\n      const { recovery } = this;\n      if (recovery == null) throw new Error('invalid recovery id: must be present');\n      return recovery;\n    }\n\n    addRecoveryBit(recovery: number): RecoveredSignature {\n      return new Signature(this.r, this.s, recovery) as RecoveredSignature;\n    }\n\n    recoverPublicKey(messageHash: Uint8Array): WeierstrassPoint<bigint> {\n      const { r, s } = this;\n      const recovery = this.assertRecovery();\n      const radj = recovery === 2 || recovery === 3 ? r + CURVE_ORDER : r;\n      if (!Fp.isValid(radj)) throw new Error('invalid recovery id: sig.r+curve.n != R.x');\n      const x = Fp.toBytes(radj);\n      const R = Point.fromBytes(concatBytes(pprefix((recovery & 1) === 0), x));\n      const ir = Fn.inv(radj); // r^-1\n      const h = bits2int_modN(abytes(messageHash, undefined, 'msgHash')); // Truncate hash\n      const u1 = Fn.create(-h * ir); // -hr^-1\n      const u2 = Fn.create(s * ir); // sr^-1\n      // (sr^-1)R-(hr^-1)G = -(hr^-1)G + (sr^-1). unsafe is fine: there is no private data.\n      const Q = Point.BASE.multiplyUnsafe(u1).add(R.multiplyUnsafe(u2));\n      if (Q.is0()) throw new Error('invalid recovery: point at infinify');\n      Q.assertValidity();\n      return Q;\n    }\n\n    // Signatures should be low-s, to prevent malleability.\n    hasHighS(): boolean {\n      return isBiggerThanHalfOrder(this.s);\n    }\n\n    toBytes(format: ECDSASignatureFormat = defaultSigOpts.format) {\n      validateSigFormat(format);\n      if (format === 'der') return hexToBytes(DER.hexFromSig(this));\n      const { r, s } = this;\n      const rb = Fn.toBytes(r);\n      const sb = Fn.toBytes(s);\n      if (format === 'recovered') {\n        assertSmallCofactor();\n        return concatBytes(Uint8Array.of(this.assertRecovery()), rb, sb);\n      }\n      return concatBytes(rb, sb);\n    }\n\n    toHex(format?: ECDSASignatureFormat) {\n      return bytesToHex(this.toBytes(format));\n    }\n  }\n  type RecoveredSignature = Signature & { recovery: number };\n\n  // RFC6979: ensure ECDSA msg is X bytes and < N. RFC suggests optional truncating via bits2octets.\n  // FIPS 186-4 4.6 suggests the leftmost min(nBitLen, outLen) bits, which matches bits2int.\n  // bits2int can produce res>N, we can do mod(res, N) since the bitLen is the same.\n  // int2octets can't be used; pads small msgs with 0: unacceptatble for trunc as per RFC vectors\n  const bits2int =\n    ecdsaOpts.bits2int ||\n    function bits2int_def(bytes: Uint8Array): bigint {\n      // Our custom check \"just in case\", for protection against DoS\n      if (bytes.length > 8192) throw new Error('input is too large');\n      // For curves with nBitLength % 8 !== 0: bits2octets(bits2octets(m)) !== bits2octets(m)\n      // for some cases, since bytes.length * 8 is not actual bitLength.\n      const num = bytesToNumberBE(bytes); // check for == u8 done here\n      const delta = bytes.length * 8 - fnBits; // truncate to nBitLength leftmost bits\n      return delta > 0 ? num >> BigInt(delta) : num;\n    };\n  const bits2int_modN =\n    ecdsaOpts.bits2int_modN ||\n    function bits2int_modN_def(bytes: Uint8Array): bigint {\n      return Fn.create(bits2int(bytes)); // can't use bytesToNumberBE here\n    };\n  // Pads output with zero as per spec\n  const ORDER_MASK = bitMask(fnBits);\n  /** Converts to bytes. Checks if num in `[0..ORDER_MASK-1]` e.g.: `[0..2^256-1]`. */\n  function int2octets(num: bigint): Uint8Array {\n    // IMPORTANT: the check ensures working for case `Fn.BYTES != Fn.BITS * 8`\n    aInRange('num < 2^' + fnBits, num, _0n, ORDER_MASK);\n    return Fn.toBytes(num);\n  }\n\n  function validateMsgAndHash(message: Uint8Array, prehash: boolean) {\n    abytes(message, undefined, 'message');\n    return prehash ? abytes(hash(message), undefined, 'prehashed message') : message;\n  }\n\n  /**\n   * Steps A, D of RFC6979 3.2.\n   * Creates RFC6979 seed; converts msg/privKey to numbers.\n   * Used only in sign, not in verify.\n   *\n   * Warning: we cannot assume here that message has same amount of bytes as curve order,\n   * this will be invalid at least for P521. Also it can be bigger for P224 + SHA256.\n   */\n  function prepSig(message: Uint8Array, secretKey: Uint8Array, opts: ECDSASignOpts) {\n    const { lowS, prehash, extraEntropy } = validateSigOpts(opts, defaultSigOpts);\n    message = validateMsgAndHash(message, prehash); // RFC6979 3.2 A: h1 = H(m)\n    // We can't later call bits2octets, since nested bits2int is broken for curves\n    // with fnBits % 8 !== 0. Because of that, we unwrap it here as int2octets call.\n    // const bits2octets = (bits) => int2octets(bits2int_modN(bits))\n    const h1int = bits2int_modN(message);\n    const d = Fn.fromBytes(secretKey); // validate secret key, convert to bigint\n    if (!Fn.isValidNot0(d)) throw new Error('invalid private key');\n    const seedArgs = [int2octets(d), int2octets(h1int)];\n    // extraEntropy. RFC6979 3.6: additional k' (optional).\n    if (extraEntropy != null && extraEntropy !== false) {\n      // K = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1) || k')\n      // gen random bytes OR pass as-is\n      const e = extraEntropy === true ? randomBytes(lengths.secretKey) : extraEntropy;\n      seedArgs.push(abytes(e, undefined, 'extraEntropy')); // check for being bytes\n    }\n    const seed = concatBytes(...seedArgs); // Step D of RFC6979 3.2\n    const m = h1int; // no need to call bits2int second time here, it is inside truncateHash!\n    // Converts signature params into point w r/s, checks result for validity.\n    // To transform k => Signature:\n    // q = k\u22C5G\n    // r = q.x mod n\n    // s = k^-1(m + rd) mod n\n    // Can use scalar blinding b^-1(bm + bdr) where b \u2208 [1,q\u22121] according to\n    // https://tches.iacr.org/index.php/TCHES/article/view/7337/6509. We've decided against it:\n    // a) dependency on CSPRNG b) 15% slowdown c) doesn't really help since bigints are not CT\n    function k2sig(kBytes: Uint8Array): Signature | undefined {\n      // RFC 6979 Section 3.2, step 3: k = bits2int(T)\n      // Important: all mod() calls here must be done over N\n      const k = bits2int(kBytes); // Cannot use fields methods, since it is group element\n      if (!Fn.isValidNot0(k)) return; // Valid scalars (including k) must be in 1..N-1\n      const ik = Fn.inv(k); // k^-1 mod n\n      const q = Point.BASE.multiply(k).toAffine(); // q = k\u22C5G\n      const r = Fn.create(q.x); // r = q.x mod n\n      if (r === _0n) return;\n      const s = Fn.create(ik * Fn.create(m + r * d)); // s = k^-1(m + rd) mod n\n      if (s === _0n) return;\n      let recovery = (q.x === r ? 0 : 2) | Number(q.y & _1n); // recovery bit (2 or 3 when q.x>n)\n      let normS = s;\n      if (lowS && isBiggerThanHalfOrder(s)) {\n        normS = Fn.neg(s); // if lowS was passed, ensure s is always in the bottom half of N\n        recovery ^= 1;\n      }\n      return new Signature(r, normS, hasLargeCofactor ? undefined : recovery);\n    }\n    return { seed, k2sig };\n  }\n\n  /**\n   * Signs message hash with a secret key.\n   *\n   * ```\n   * sign(m, d) where\n   *   k = rfc6979_hmac_drbg(m, d)\n   *   (x, y) = G \u00D7 k\n   *   r = x mod n\n   *   s = (m + dr) / k mod n\n   * ```\n   */\n  function sign(message: Uint8Array, secretKey: Uint8Array, opts: ECDSASignOpts = {}): Uint8Array {\n    const { seed, k2sig } = prepSig(message, secretKey, opts); // Steps A, D of RFC6979 3.2.\n    const drbg = createHmacDrbg<Signature>(hash.outputLen, Fn.BYTES, hmac);\n    const sig = drbg(seed, k2sig); // Steps B, C, D, E, F, G\n    return sig.toBytes(opts.format);\n  }\n\n  /**\n   * Verifies a signature against message and public key.\n   * Rejects lowS signatures by default: see {@link ECDSAVerifyOpts}.\n   * Implements section 4.1.4 from https://www.secg.org/sec1-v2.pdf:\n   *\n   * ```\n   * verify(r, s, h, P) where\n   *   u1 = hs^-1 mod n\n   *   u2 = rs^-1 mod n\n   *   R = u1\u22C5G + u2\u22C5P\n   *   mod(R.x, n) == r\n   * ```\n   */\n  function verify(\n    signature: Uint8Array,\n    message: Uint8Array,\n    publicKey: Uint8Array,\n    opts: ECDSAVerifyOpts = {}\n  ): boolean {\n    const { lowS, prehash, format } = validateSigOpts(opts, defaultSigOpts);\n    publicKey = abytes(publicKey, undefined, 'publicKey');\n    message = validateMsgAndHash(message, prehash);\n    if (!isBytes(signature as any)) {\n      const end = signature instanceof Signature ? ', use sig.toBytes()' : '';\n      throw new Error('verify expects Uint8Array signature' + end);\n    }\n    validateSigLength(signature, format); // execute this twice because we want loud error\n    try {\n      const sig = Signature.fromBytes(signature, format);\n      const P = Point.fromBytes(publicKey);\n      if (lowS && sig.hasHighS()) return false;\n      const { r, s } = sig;\n      const h = bits2int_modN(message); // mod n, not mod p\n      const is = Fn.inv(s); // s^-1 mod n\n      const u1 = Fn.create(h * is); // u1 = hs^-1 mod n\n      const u2 = Fn.create(r * is); // u2 = rs^-1 mod n\n      const R = Point.BASE.multiplyUnsafe(u1).add(P.multiplyUnsafe(u2)); // u1\u22C5G + u2\u22C5P\n      if (R.is0()) return false;\n      const v = Fn.create(R.x); // v = r.x mod n\n      return v === r;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function recoverPublicKey(\n    signature: Uint8Array,\n    message: Uint8Array,\n    opts: ECDSARecoverOpts = {}\n  ): Uint8Array {\n    const { prehash } = validateSigOpts(opts, defaultSigOpts);\n    message = validateMsgAndHash(message, prehash);\n    return Signature.fromBytes(signature, 'recovered').recoverPublicKey(message).toBytes();\n  }\n\n  return Object.freeze({\n    keygen,\n    getPublicKey,\n    getSharedSecret,\n    utils,\n    lengths,\n    Point,\n    sign,\n    verify,\n    recoverPublicKey,\n    Signature,\n    hash,\n  }) satisfies Signer;\n}\n", "/**\n * Internal module for NIST P256, P384, P521 curves.\n * Do not use for now.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { sha256, sha384, sha512 } from '@noble/hashes/sha2.js';\nimport { createHasher, type H2CHasher } from './abstract/hash-to-curve.ts';\nimport { Field } from './abstract/modular.ts';\nimport { createORPF, type OPRF } from './abstract/oprf.ts';\nimport {\n  ecdsa,\n  mapToCurveSimpleSWU,\n  weierstrass,\n  type ECDSA,\n  type WeierstrassOpts,\n  type WeierstrassPointCons,\n} from './abstract/weierstrass.ts';\n\n// p = 2n**224n * (2n**32n-1n) + 2n**192n + 2n**96n - 1n\n// a = Fp256.create(BigInt('-3'));\nconst p256_CURVE: WeierstrassOpts<bigint> = /* @__PURE__ */ (() => ({\n  p: BigInt('0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff'),\n  n: BigInt('0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551'),\n  h: BigInt(1),\n  a: BigInt('0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc'),\n  b: BigInt('0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b'),\n  Gx: BigInt('0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296'),\n  Gy: BigInt('0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5'),\n}))();\n\n// p = 2n**384n - 2n**128n - 2n**96n + 2n**32n - 1n\nconst p384_CURVE: WeierstrassOpts<bigint> = /* @__PURE__ */ (() => ({\n  p: BigInt(\n    '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff'\n  ),\n  n: BigInt(\n    '0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973'\n  ),\n  h: BigInt(1),\n  a: BigInt(\n    '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc'\n  ),\n  b: BigInt(\n    '0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef'\n  ),\n  Gx: BigInt(\n    '0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7'\n  ),\n  Gy: BigInt(\n    '0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f'\n  ),\n}))();\n\n// p = 2n**521n - 1n\nconst p521_CURVE: WeierstrassOpts<bigint> = /* @__PURE__ */ (() => ({\n  p: BigInt(\n    '0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'\n  ),\n  n: BigInt(\n    '0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409'\n  ),\n  h: BigInt(1),\n  a: BigInt(\n    '0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc'\n  ),\n  b: BigInt(\n    '0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00'\n  ),\n  Gx: BigInt(\n    '0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66'\n  ),\n  Gy: BigInt(\n    '0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650'\n  ),\n}))();\n\ntype SwuOpts = {\n  A: bigint;\n  B: bigint;\n  Z: bigint;\n};\n\nfunction createSWU(Point: WeierstrassPointCons<bigint>, opts: SwuOpts) {\n  const map = mapToCurveSimpleSWU(Point.Fp, opts);\n  return (scalars: bigint[]) => map(scalars[0]);\n}\n\n// NIST P256\nconst p256_Point = /* @__PURE__ */ weierstrass(p256_CURVE);\n/**\n * NIST P256 (aka secp256r1, prime256v1) curve, ECDSA and ECDH methods.\n * Hashes inputs with sha256 by default.\n *\n * @example\n * ```js\n * import { p256 } from '@noble/curves/nist.js';\n * const { secretKey, publicKey } = p256.keygen();\n * // const publicKey = p256.getPublicKey(secretKey);\n * const msg = new TextEncoder().encode('hello noble');\n * const sig = p256.sign(msg, secretKey);\n * const isValid = p256.verify(sig, msg, publicKey);\n * // const sigKeccak = p256.sign(keccak256(msg), secretKey, { prehash: false });\n * ```\n */\nexport const p256: ECDSA = /* @__PURE__ */ ecdsa(p256_Point, sha256);\n/** Hashing / encoding to p256 points / field. RFC 9380 methods. */\nexport const p256_hasher: H2CHasher<WeierstrassPointCons<bigint>> = /* @__PURE__ */ (() => {\n  return createHasher(\n    p256_Point,\n    createSWU(p256_Point, {\n      A: p256_CURVE.a,\n      B: p256_CURVE.b,\n      Z: p256_Point.Fp.create(BigInt('-10')),\n    }),\n    {\n      DST: 'P256_XMD:SHA-256_SSWU_RO_',\n      encodeDST: 'P256_XMD:SHA-256_SSWU_NU_',\n      p: p256_CURVE.p,\n      m: 1,\n      k: 128,\n      expand: 'xmd',\n      hash: sha256,\n    }\n  );\n})();\n/** p256 OPRF, defined in RFC 9497. */\nexport const p256_oprf: OPRF = /* @__PURE__ */ (() =>\n  createORPF({\n    name: 'P256-SHA256',\n    Point: p256_Point,\n    hash: sha256,\n    hashToGroup: p256_hasher.hashToCurve,\n    hashToScalar: p256_hasher.hashToScalar,\n  }))();\n\n// NIST P384\nconst p384_Point = /* @__PURE__ */ weierstrass(p384_CURVE);\n/** NIST P384 (aka secp384r1) curve, ECDSA and ECDH methods. Hashes inputs with sha384 by default. */\nexport const p384: ECDSA = /* @__PURE__ */ ecdsa(p384_Point, sha384);\n/** Hashing / encoding to p384 points / field. RFC 9380 methods. */\nexport const p384_hasher: H2CHasher<WeierstrassPointCons<bigint>> = /* @__PURE__ */ (() => {\n  return createHasher(\n    p384_Point,\n    createSWU(p384_Point, {\n      A: p384_CURVE.a,\n      B: p384_CURVE.b,\n      Z: p384_Point.Fp.create(BigInt('-12')),\n    }),\n    {\n      DST: 'P384_XMD:SHA-384_SSWU_RO_',\n      encodeDST: 'P384_XMD:SHA-384_SSWU_NU_',\n      p: p384_CURVE.p,\n      m: 1,\n      k: 192,\n      expand: 'xmd',\n      hash: sha384,\n    }\n  );\n})();\n/** p384 OPRF, defined in RFC 9497. */\nexport const p384_oprf: OPRF = /* @__PURE__ */ (() =>\n  createORPF({\n    name: 'P384-SHA384',\n    Point: p384_Point,\n    hash: sha384,\n    hashToGroup: p384_hasher.hashToCurve,\n    hashToScalar: p384_hasher.hashToScalar,\n  }))();\n\n// NIST P521\nconst Fn521 = /* @__PURE__ */ (() => Field(p521_CURVE.n, { allowedLengths: [65, 66] }))();\nconst p521_Point = /* @__PURE__ */ weierstrass(p521_CURVE, { Fn: Fn521 });\n/** NIST P521 (aka secp521r1) curve, ECDSA and ECDH methods. Hashes inputs with sha512 by default. */\nexport const p521: ECDSA = /* @__PURE__ */ ecdsa(p521_Point, sha512);\n/** Hashing / encoding to p521 points / field. RFC 9380 methods. */\nexport const p521_hasher: H2CHasher<WeierstrassPointCons<bigint>> = /* @__PURE__ */ (() => {\n  return createHasher(\n    p521_Point,\n    createSWU(p521_Point, {\n      A: p521_CURVE.a,\n      B: p521_CURVE.b,\n      Z: p521_Point.Fp.create(BigInt('-4')),\n    }),\n    {\n      DST: 'P521_XMD:SHA-512_SSWU_RO_',\n      encodeDST: 'P521_XMD:SHA-512_SSWU_NU_',\n      p: p521_CURVE.p,\n      m: 1,\n      k: 256,\n      expand: 'xmd',\n      hash: sha512,\n    }\n  );\n})();\n/** p521 OPRF, defined in RFC 9497. */\nexport const p521_oprf: OPRF = /* @__PURE__ */ (() =>\n  createORPF({\n    name: 'P521-SHA512',\n    Point: p521_Point,\n    hash: sha512,\n    hashToGroup: p521_hasher.hashToCurve,\n    hashToScalar: p521_hasher.hashToScalar, // produces L=98 just like in RFC\n  }))();\n", "import m from \"mithril\"\n\nimport { ServiceFactory } from \"./service/factory\"\nimport { ViewContainer } from \"./viewContainer\"\n\nclass Application {\n\n\tconstructor(root:HTMLElement) {\n\t\tthis.start(root)\n\t}\n\n\tprivate async start(root:HTMLElement) {\n\n\t\tvar factory = new ServiceFactory()\n\t\tawait factory.start()\n\n\t\tvar viewContainer = new ViewContainer(factory)\n\t\tm.mount(root, viewContainer)\n\t}\n}\n\n// Start the Application\nvar app: Application\nvar root = document.getElementById(\"mls\")\n\nif (root != undefined) {\n\tconst app = new Application(root)\n} else {\n\tconsole.log(\"Can't mount Mithril app. Please verify that <div id=mls> exists.\")\n}", "// ActivityPubService manages all interactions with the ActivityPub server\nexport class ActivityPubService {\n\n\t// All class #properties are PRIVATE\n\t#actorID: string = \"\" \n\n\tasync start(actorID: string) {\n\t\tthis.#actorID = actorID\n\t}\n\n\tasync createObject<T>(object: T): Promise<[T, string]> {\n\n\t\tconst [result, err] = await this.sendActivity({\n\t\t\t\"@context\": \"\",\n\t\t\t\"id\": \"\",\n\t\t\t\"type\": \"Create\",\n\t\t\t\"actor\": this.#actorID,\n\t\t\t\"object\": object,\n\t\t})\n\n\t\treturn [<T>result, err]\n\t}\n\n\tasync deleteObject(objectId: string): Promise<string> {\n\n\t\tconst [_result, err] = await this.sendActivity({\n\t\t\t\"@context\": \"\",\n\t\t\t\"id\": \"\",\n\t\t\t\"type\": \"Delete\",\n\t\t\t\"actor\": this.#actorID,\n\t\t\t\"object\": objectId,\n\t\t})\n\n\t\treturn err\n\t}\n\n\tasync sendActivity<T>(activity: Object): Promise<[T, string]> {\n\n\t\ttry {\n\n\t\t\t// Send the Activity to the server\n\t\t\tconst result = await fetch(\"http://localhost/@me/outbox\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: JSON.stringify(activity),\n\t\t\t\tcredentials: \"include\",\n\t\t\t})\n\n\t\t\tconst resultObject = await result.json()\n\n\t\t\treturn [resultObject, \"\"]\n\n\t\t} catch (err) {\n\t\t\treturn [<T>{}, String(err)]\n\t\t}\n\t}\n}", "const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst transactionDoneMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    // This mapping exists in reverseTransformCache but doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(this.request);\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nconst advanceMethodProps = ['continue', 'continuePrimaryKey', 'advance'];\nconst methodMap = {};\nconst advanceResults = new WeakMap();\nconst ittrProxiedCursorToOriginalProxy = new WeakMap();\nconst cursorIteratorTraps = {\n    get(target, prop) {\n        if (!advanceMethodProps.includes(prop))\n            return target[prop];\n        let cachedFunc = methodMap[prop];\n        if (!cachedFunc) {\n            cachedFunc = methodMap[prop] = function (...args) {\n                advanceResults.set(this, ittrProxiedCursorToOriginalProxy.get(this)[prop](...args));\n            };\n        }\n        return cachedFunc;\n    },\n};\nasync function* iterate(...args) {\n    // tslint:disable-next-line:no-this-assignment\n    let cursor = this;\n    if (!(cursor instanceof IDBCursor)) {\n        cursor = await cursor.openCursor(...args);\n    }\n    if (!cursor)\n        return;\n    cursor = cursor;\n    const proxiedCursor = new Proxy(cursor, cursorIteratorTraps);\n    ittrProxiedCursorToOriginalProxy.set(proxiedCursor, cursor);\n    // Map this double-proxy back to the original, so other cursor methods work.\n    reverseTransformCache.set(proxiedCursor, unwrap(cursor));\n    while (cursor) {\n        yield proxiedCursor;\n        // If one of the advancing methods was not called, call continue().\n        cursor = await (advanceResults.get(proxiedCursor) || cursor.continue());\n        advanceResults.delete(proxiedCursor);\n    }\n}\nfunction isIteratorProp(target, prop) {\n    return ((prop === Symbol.asyncIterator &&\n        instanceOfAny(target, [IDBIndex, IDBObjectStore, IDBCursor])) ||\n        (prop === 'iterate' && instanceOfAny(target, [IDBIndex, IDBObjectStore])));\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get(target, prop, receiver) {\n        if (isIteratorProp(target, prop))\n            return iterate;\n        return oldTraps.get(target, prop, receiver);\n    },\n    has(target, prop) {\n        return isIteratorProp(target, prop) || oldTraps.has(target, prop);\n    },\n}));\n\nexport { deleteDB, openDB, unwrap, wrap };\n", "\n// APKeyPackage is the ActivityPub representation of a KeyPackage\n\nimport type { KeyPackage, PrivateKeyPackage } from \"ts-mls\"\n\n// https://swicg.github.io/activitypub-e2ee/mls#KeyPackage\nexport type APKeyPackage = {\n\t// type: [\"Object\", \"KeyPackage\"]\n\ttype: \"KeyPackage\"\n\tid: string\n\tattributedTo: string\n\tto: \"as:Public\"\n\tsummary: string\n\tmediaType: \"message/mls\"\n\tencoding: \"base64\"\n\tcontent: string\n\tgenerator: string\n}\n\n// NewAPKeyPackage creates a fully initialized APKeyPackage object\nexport function NewAPKeyPackage(actorID:string, publicPackage:KeyPackage): APKeyPackage {\n\treturn {\n\t\tid:\"\", // This will be appened by the server\n\t\t// type: [\"Object\", \"KeyPackage\"],\n\t\ttype: \"KeyPackage\",\n\t\tto: \"as:Public\",\n\t\tattributedTo: actorID,\n\t\tmediaType: \"message/mls\",\n\t\tencoding: \"base64\",\n\t\tsummary: \"\",\n\t\tgenerator: \"Emissary MLS\",\n\t\tcontent: btoa(publicPackage.signature.toString()),\n\t}\n}\n\n// Record stored in the local IndexedDB database\nexport type IDBKeyPackage = {\n\tid: string // The URL of this KeyPackage\n\tpublicPackage: KeyPackage\n\tprivatePackage: PrivateKeyPackage\n}", null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, "/**\n * The base error class of hpke-js.\n * @group Errors\n */\nexport class HpkeError extends Error {\n    constructor(e) {\n        let message;\n        if (e instanceof Error) {\n            message = e.message;\n        }\n        else if (typeof e === \"string\") {\n            message = e;\n        }\n        else {\n            message = \"\";\n        }\n        super(message);\n        this.name = this.constructor.name;\n    }\n}\n/**\n * Invalid parameter.\n * @group Errors\n */\nexport class InvalidParamError extends HpkeError {\n}\n/**\n * KEM input or output validation failure.\n * @group Errors\n */\nexport class ValidationError extends HpkeError {\n}\n/**\n * Public or private key serialization failure.\n * @group Errors\n */\nexport class SerializeError extends HpkeError {\n}\n/**\n * Public or private key deserialization failure.\n * @group Errors\n */\nexport class DeserializeError extends HpkeError {\n}\n/**\n * encap() failure.\n * @group Errors\n */\nexport class EncapError extends HpkeError {\n}\n/**\n * decap() failure.\n * @group Errors\n */\nexport class DecapError extends HpkeError {\n}\n/**\n * Secret export failure.\n * @group Errors\n */\nexport class ExportError extends HpkeError {\n}\n/**\n * seal() failure.\n * @group Errors\n */\nexport class SealError extends HpkeError {\n}\n/**\n * open() failure.\n * @group Errors\n */\nexport class OpenError extends HpkeError {\n}\n/**\n * Sequence number overflow on the encryption context.\n * @group Errors\n */\nexport class MessageLimitReachedError extends HpkeError {\n}\n/**\n * Key pair derivation failure.\n * @group Errors\n */\nexport class DeriveKeyPairError extends HpkeError {\n}\n/**\n * Not supported failure.\n * @group Errors\n */\nexport class NotSupportedError extends HpkeError {\n}\n", "const dntGlobals = {};\nexport const dntGlobalThis = createMergeProxy(globalThis, dntGlobals);\nfunction createMergeProxy(baseObj, extObj) {\n    return new Proxy(baseObj, {\n        get(_target, prop, _receiver) {\n            if (prop in extObj) {\n                return extObj[prop];\n            }\n            else {\n                return baseObj[prop];\n            }\n        },\n        set(_target, prop, value) {\n            if (prop in extObj) {\n                delete extObj[prop];\n            }\n            baseObj[prop] = value;\n            return true;\n        },\n        deleteProperty(_target, prop) {\n            let success = false;\n            if (prop in extObj) {\n                delete extObj[prop];\n                success = true;\n            }\n            if (prop in baseObj) {\n                delete baseObj[prop];\n                success = true;\n            }\n            return success;\n        },\n        ownKeys(_target) {\n            const baseKeys = Reflect.ownKeys(baseObj);\n            const extKeys = Reflect.ownKeys(extObj);\n            const extKeysSet = new Set(extKeys);\n            return [...baseKeys.filter((k) => !extKeysSet.has(k)), ...extKeys];\n        },\n        defineProperty(_target, prop, desc) {\n            if (prop in extObj) {\n                delete extObj[prop];\n            }\n            Reflect.defineProperty(baseObj, prop, desc);\n            return true;\n        },\n        getOwnPropertyDescriptor(_target, prop) {\n            if (prop in extObj) {\n                return Reflect.getOwnPropertyDescriptor(extObj, prop);\n            }\n            else {\n                return Reflect.getOwnPropertyDescriptor(baseObj, prop);\n            }\n        },\n        has(_target, prop) {\n            return prop in extObj || prop in baseObj;\n        },\n    });\n}\n", "import * as dntShim from \"../_dnt.shims.js\";\nimport { NotSupportedError } from \"./errors.js\";\nasync function loadSubtleCrypto() {\n    if (dntShim.dntGlobalThis !== undefined && globalThis.crypto !== undefined) {\n        // Browsers, Node.js >= v19, Cloudflare Workers, Bun, etc.\n        return globalThis.crypto.subtle;\n    }\n    // Node.js <= v18\n    try {\n        // @ts-ignore: to ignore \"crypto\"\n        const { webcrypto } = await import(\"crypto\"); // node:crypto\n        return webcrypto.subtle;\n    }\n    catch (e) {\n        throw new NotSupportedError(e);\n    }\n}\nexport class NativeAlgorithm {\n    constructor() {\n        Object.defineProperty(this, \"_api\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: undefined\n        });\n    }\n    async _setup() {\n        if (this._api !== undefined) {\n            return;\n        }\n        this._api = await loadSubtleCrypto();\n    }\n}\n", "/**\n * The supported HPKE modes.\n */\nexport const Mode = {\n    Base: 0x00,\n    Psk: 0x01,\n    Auth: 0x02,\n    AuthPsk: 0x03,\n};\n/**\n * The supported Key Encapsulation Mechanism (KEM) identifiers.\n */\nexport const KemId = {\n    NotAssigned: 0x0000,\n    DhkemP256HkdfSha256: 0x0010,\n    DhkemP384HkdfSha384: 0x0011,\n    DhkemP521HkdfSha512: 0x0012,\n    DhkemSecp256k1HkdfSha256: 0x0013,\n    DhkemX25519HkdfSha256: 0x0020,\n    DhkemX448HkdfSha512: 0x0021,\n    HybridkemX25519Kyber768: 0x0030,\n    MlKem512: 0x0040,\n    MlKem768: 0x0041,\n    MlKem1024: 0x0042,\n    XWing: 0x647a,\n};\n/**\n * The supported Key Derivation Function (KDF) identifiers.\n */\nexport const KdfId = {\n    HkdfSha256: 0x0001,\n    HkdfSha384: 0x0002,\n    HkdfSha512: 0x0003,\n};\n/**\n * The supported Authenticated Encryption with Associated Data (AEAD) identifiers.\n */\nexport const AeadId = {\n    Aes128Gcm: 0x0001,\n    Aes256Gcm: 0x0002,\n    Chacha20Poly1305: 0x0003,\n    ExportOnly: 0xFFFF,\n};\n", "// The input length limit (psk, psk_id, info, exporter_context, ikm).\nexport const INPUT_LENGTH_LIMIT = 8192;\nexport const INFO_LENGTH_LIMIT = 65536;\n// The minimum length of a PSK.\nexport const MINIMUM_PSK_LENGTH = 32;\n// b\"\"\nexport const EMPTY = new Uint8Array(0);\n", "// b\"KEM\"\nexport const SUITE_ID_HEADER_KEM = new Uint8Array([\n    75,\n    69,\n    77,\n    0,\n    0,\n]);\n", "import * as dntShim from \"../../_dnt.shims.js\";\nimport { KemId } from \"../identifiers.js\";\nexport const isDenoV1 = () => \n// deno-lint-ignore no-explicit-any\ndntShim.dntGlobalThis.process === undefined;\n/**\n * Checks whether the runtime is Deno or not (Node.js).\n * @returns boolean - true if the runtime is Deno, false Node.js.\n */\nexport function isDeno() {\n    // deno-lint-ignore no-explicit-any\n    if (dntShim.dntGlobalThis.process === undefined) {\n        return true;\n    }\n    // deno-lint-ignore no-explicit-any\n    return dntShim.dntGlobalThis.process?.versions?.deno !== undefined;\n}\n/**\n * Checks whetehr the type of input is CryptoKeyPair or not.\n */\nexport const isCryptoKeyPair = (x) => typeof x === \"object\" &&\n    x !== null &&\n    typeof x.privateKey === \"object\" &&\n    typeof x.publicKey === \"object\";\n/**\n * Converts integer to octet string. I2OSP implementation.\n */\nexport function i2Osp(n, w) {\n    if (w <= 0) {\n        throw new Error(\"i2Osp: too small size\");\n    }\n    if (n >= 256 ** w) {\n        throw new Error(\"i2Osp: too large integer\");\n    }\n    const ret = new Uint8Array(w);\n    for (let i = 0; i < w && n; i++) {\n        ret[w - (i + 1)] = n % 256;\n        n = n >> 8;\n    }\n    return ret;\n}\n/**\n * Concatenates two Uint8Arrays.\n * @param a Uint8Array\n * @param b Uint8Array\n * @returns Concatenated Uint8Array\n */\nexport function concat(a, b) {\n    const ret = new Uint8Array(a.length + b.length);\n    ret.set(a, 0);\n    ret.set(b, a.length);\n    return ret;\n}\n/**\n * Decodes Base64Url-encoded data.\n * @param v Base64Url-encoded string\n * @returns Uint8Array\n */\nexport function base64UrlToBytes(v) {\n    const base64 = v.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    const byteString = atob(base64);\n    const ret = new Uint8Array(byteString.length);\n    for (let i = 0; i < byteString.length; i++) {\n        ret[i] = byteString.charCodeAt(i);\n    }\n    return ret;\n}\n/**\n * Encodes Uint8Array to Base64Url.\n * @param v Uint8Array\n * @returns Base64Url-encoded string\n */\nexport function bytesToBase64Url(v) {\n    return btoa(String.fromCharCode(...v))\n        .replace(/\\+/g, \"-\")\n        .replace(/\\//g, \"_\")\n        .replace(/=*$/g, \"\");\n}\n/**\n * Decodes hex string to Uint8Array.\n * @param v Hex string\n * @returns Uint8Array\n * @throws Error if the input is not a hex string.\n */\nexport function hexToBytes(v) {\n    if (v.length === 0) {\n        return new Uint8Array([]);\n    }\n    const res = v.match(/[\\da-f]{2}/gi);\n    if (res == null) {\n        throw new Error(\"Not hex string.\");\n    }\n    return new Uint8Array(res.map(function (h) {\n        return parseInt(h, 16);\n    }));\n}\n/**\n * Encodes Uint8Array to hex string.\n * @param v Uint8Array\n * @returns Hex string\n */\nexport function bytesToHex(v) {\n    return [...v].map((x) => x.toString(16).padStart(2, \"0\")).join(\"\");\n}\n/**\n * Converts KemId to KeyAlgorithm.\n * @param kem KemId\n * @returns KeyAlgorithm\n */\nexport function kemToKeyGenAlgorithm(kem) {\n    switch (kem) {\n        case KemId.DhkemP256HkdfSha256:\n            return {\n                name: \"ECDH\",\n                namedCurve: \"P-256\",\n            };\n        case KemId.DhkemP384HkdfSha384:\n            return {\n                name: \"ECDH\",\n                namedCurve: \"P-384\",\n            };\n        case KemId.DhkemP521HkdfSha512:\n            return {\n                name: \"ECDH\",\n                namedCurve: \"P-521\",\n            };\n        default:\n            // case KemId.DhkemX25519HkdfSha256\n            return {\n                name: \"X25519\",\n            };\n    }\n}\nexport async function loadSubtleCrypto() {\n    if (dntShim.dntGlobalThis !== undefined && globalThis.crypto !== undefined) {\n        // Browsers, Node.js >= v19, Cloudflare Workers, Bun, etc.\n        return globalThis.crypto.subtle;\n    }\n    // Node.js <= v18\n    try {\n        // @ts-ignore: to ignore \"crypto\"\n        const { webcrypto } = await import(\"crypto\"); // node:crypto\n        return webcrypto.subtle;\n    }\n    catch (_e) {\n        throw new Error(\"Failed to load SubtleCrypto\");\n    }\n}\nexport async function loadCrypto() {\n    if (dntShim.dntGlobalThis !== undefined && globalThis.crypto !== undefined) {\n        // Browsers, Node.js >= v19, Cloudflare Workers, Bun, etc.\n        return globalThis.crypto;\n    }\n    // Node.js <= v18\n    try {\n        // @ts-ignore: to ignore \"crypto\"\n        const { webcrypto } = await import(\"crypto\"); // node:crypto\n        return webcrypto;\n    }\n    catch (_e) {\n        throw new Error(\"Web Cryptograph API not supported\");\n    }\n}\n/**\n * XOR for Uint8Array.\n */\nexport function xor(a, b) {\n    if (a.byteLength !== b.byteLength) {\n        throw new Error(\"xor: different length inputs\");\n    }\n    const buf = new Uint8Array(a.byteLength);\n    for (let i = 0; i < a.byteLength; i++) {\n        buf[i] = a[i] ^ b[i];\n    }\n    return buf;\n}\n", "import { EMPTY, INPUT_LENGTH_LIMIT } from \"../consts.js\";\nimport { DecapError, EncapError, InvalidParamError } from \"../errors.js\";\nimport { SUITE_ID_HEADER_KEM } from \"../interfaces/kemInterface.js\";\nimport { concat, i2Osp, isCryptoKeyPair } from \"../utils/misc.js\";\n// b\"eae_prk\"\nconst LABEL_EAE_PRK = new Uint8Array([101, 97, 101, 95, 112, 114, 107]);\n// b\"shared_secret\"\n// deno-fmt-ignore\nconst LABEL_SHARED_SECRET = new Uint8Array([\n    115, 104, 97, 114, 101, 100, 95, 115, 101, 99,\n    114, 101, 116,\n]);\nfunction concat3(a, b, c) {\n    const ret = new Uint8Array(a.length + b.length + c.length);\n    ret.set(a, 0);\n    ret.set(b, a.length);\n    ret.set(c, a.length + b.length);\n    return ret;\n}\nexport class Dhkem {\n    constructor(id, prim, kdf) {\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"secretSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"encSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"publicKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"privateKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"_prim\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_kdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.id = id;\n        this._prim = prim;\n        this._kdf = kdf;\n        const suiteId = new Uint8Array(SUITE_ID_HEADER_KEM);\n        suiteId.set(i2Osp(this.id, 2), 3);\n        this._kdf.init(suiteId);\n    }\n    async serializePublicKey(key) {\n        return await this._prim.serializePublicKey(key);\n    }\n    async deserializePublicKey(key) {\n        return await this._prim.deserializePublicKey(key);\n    }\n    async serializePrivateKey(key) {\n        return await this._prim.serializePrivateKey(key);\n    }\n    async deserializePrivateKey(key) {\n        return await this._prim.deserializePrivateKey(key);\n    }\n    async importKey(format, key, isPublic = true) {\n        return await this._prim.importKey(format, key, isPublic);\n    }\n    async generateKeyPair() {\n        return await this._prim.generateKeyPair();\n    }\n    async deriveKeyPair(ikm) {\n        if (ikm.byteLength > INPUT_LENGTH_LIMIT) {\n            throw new InvalidParamError(\"Too long ikm\");\n        }\n        return await this._prim.deriveKeyPair(ikm);\n    }\n    async encap(params) {\n        let ke;\n        if (params.ekm === undefined) {\n            ke = await this.generateKeyPair();\n        }\n        else if (isCryptoKeyPair(params.ekm)) {\n            // params.ekm is only used for testing.\n            ke = params.ekm;\n        }\n        else {\n            // params.ekm is only used for testing.\n            ke = await this.deriveKeyPair(params.ekm);\n        }\n        const enc = await this._prim.serializePublicKey(ke.publicKey);\n        const pkrm = await this._prim.serializePublicKey(params.recipientPublicKey);\n        try {\n            let dh;\n            if (params.senderKey === undefined) {\n                dh = new Uint8Array(await this._prim.dh(ke.privateKey, params.recipientPublicKey));\n            }\n            else {\n                const sks = isCryptoKeyPair(params.senderKey)\n                    ? params.senderKey.privateKey\n                    : params.senderKey;\n                const dh1 = new Uint8Array(await this._prim.dh(ke.privateKey, params.recipientPublicKey));\n                const dh2 = new Uint8Array(await this._prim.dh(sks, params.recipientPublicKey));\n                dh = concat(dh1, dh2);\n            }\n            let kemContext;\n            if (params.senderKey === undefined) {\n                kemContext = concat(new Uint8Array(enc), new Uint8Array(pkrm));\n            }\n            else {\n                const pks = isCryptoKeyPair(params.senderKey)\n                    ? params.senderKey.publicKey\n                    : await this._prim.derivePublicKey(params.senderKey);\n                const pksm = await this._prim.serializePublicKey(pks);\n                kemContext = concat3(new Uint8Array(enc), new Uint8Array(pkrm), new Uint8Array(pksm));\n            }\n            const sharedSecret = await this._generateSharedSecret(dh, kemContext);\n            return {\n                enc: enc,\n                sharedSecret: sharedSecret,\n            };\n        }\n        catch (e) {\n            throw new EncapError(e);\n        }\n    }\n    async decap(params) {\n        const pke = await this._prim.deserializePublicKey(params.enc);\n        const skr = isCryptoKeyPair(params.recipientKey)\n            ? params.recipientKey.privateKey\n            : params.recipientKey;\n        const pkr = isCryptoKeyPair(params.recipientKey)\n            ? params.recipientKey.publicKey\n            : await this._prim.derivePublicKey(params.recipientKey);\n        const pkrm = await this._prim.serializePublicKey(pkr);\n        try {\n            let dh;\n            if (params.senderPublicKey === undefined) {\n                dh = new Uint8Array(await this._prim.dh(skr, pke));\n            }\n            else {\n                const dh1 = new Uint8Array(await this._prim.dh(skr, pke));\n                const dh2 = new Uint8Array(await this._prim.dh(skr, params.senderPublicKey));\n                dh = concat(dh1, dh2);\n            }\n            let kemContext;\n            if (params.senderPublicKey === undefined) {\n                kemContext = concat(new Uint8Array(params.enc), new Uint8Array(pkrm));\n            }\n            else {\n                const pksm = await this._prim.serializePublicKey(params.senderPublicKey);\n                kemContext = new Uint8Array(params.enc.byteLength + pkrm.byteLength + pksm.byteLength);\n                kemContext.set(new Uint8Array(params.enc), 0);\n                kemContext.set(new Uint8Array(pkrm), params.enc.byteLength);\n                kemContext.set(new Uint8Array(pksm), params.enc.byteLength + pkrm.byteLength);\n            }\n            return await this._generateSharedSecret(dh, kemContext);\n        }\n        catch (e) {\n            throw new DecapError(e);\n        }\n    }\n    async _generateSharedSecret(dh, kemContext) {\n        const labeledIkm = this._kdf.buildLabeledIkm(LABEL_EAE_PRK, dh);\n        const labeledInfo = this._kdf.buildLabeledInfo(LABEL_SHARED_SECRET, kemContext, this.secretSize);\n        return await this._kdf.extractAndExpand(EMPTY.buffer, labeledIkm.buffer, labeledInfo.buffer, this.secretSize);\n    }\n}\n", "// The key usages for KEM.\nexport const KEM_USAGES = [\"deriveBits\"];\n// b\"dkp_prk\"\nexport const LABEL_DKP_PRK = new Uint8Array([\n    100,\n    107,\n    112,\n    95,\n    112,\n    114,\n    107,\n]);\n// b\"sk\"\nexport const LABEL_SK = new Uint8Array([115, 107]);\n", "/**\n * The minimum inplementation of bignum to derive an EC key pair.\n */\nexport class Bignum {\n    constructor(size) {\n        Object.defineProperty(this, \"_num\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._num = new Uint8Array(size);\n    }\n    val() {\n        return this._num;\n    }\n    reset() {\n        this._num.fill(0);\n    }\n    set(src) {\n        if (src.length !== this._num.length) {\n            throw new Error(\"Bignum.set: invalid argument\");\n        }\n        this._num.set(src);\n    }\n    isZero() {\n        for (let i = 0; i < this._num.length; i++) {\n            if (this._num[i] !== 0) {\n                return false;\n            }\n        }\n        return true;\n    }\n    lessThan(v) {\n        if (v.length !== this._num.length) {\n            throw new Error(\"Bignum.lessThan: invalid argument\");\n        }\n        for (let i = 0; i < this._num.length; i++) {\n            if (this._num[i] < v[i]) {\n                return true;\n            }\n            if (this._num[i] > v[i]) {\n                return false;\n            }\n        }\n        return false;\n    }\n}\n", "import { NativeAlgorithm } from \"../../algorithm.js\";\nimport { EMPTY } from \"../../consts.js\";\nimport { DeriveKeyPairError, DeserializeError, NotSupportedError, SerializeError, } from \"../../errors.js\";\nimport { KemId } from \"../../identifiers.js\";\nimport { KEM_USAGES, LABEL_DKP_PRK } from \"../../interfaces/dhkemPrimitives.js\";\nimport { Bignum } from \"../../utils/bignum.js\";\nimport { base64UrlToBytes, i2Osp } from \"../../utils/misc.js\";\n// b\"candidate\"\n// deno-fmt-ignore\nconst LABEL_CANDIDATE = new Uint8Array([\n    99, 97, 110, 100, 105, 100, 97, 116, 101,\n]);\n// the order of the curve being used.\n// deno-fmt-ignore\nconst ORDER_P_256 = new Uint8Array([\n    0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xbc, 0xe6, 0xfa, 0xad, 0xa7, 0x17, 0x9e, 0x84,\n    0xf3, 0xb9, 0xca, 0xc2, 0xfc, 0x63, 0x25, 0x51,\n]);\n// deno-fmt-ignore\nconst ORDER_P_384 = new Uint8Array([\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xc7, 0x63, 0x4d, 0x81, 0xf4, 0x37, 0x2d, 0xdf,\n    0x58, 0x1a, 0x0d, 0xb2, 0x48, 0xb0, 0xa7, 0x7a,\n    0xec, 0xec, 0x19, 0x6a, 0xcc, 0xc5, 0x29, 0x73,\n]);\n// deno-fmt-ignore\nconst ORDER_P_521 = new Uint8Array([\n    0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,\n    0xff, 0xfa, 0x51, 0x86, 0x87, 0x83, 0xbf, 0x2f,\n    0x96, 0x6b, 0x7f, 0xcc, 0x01, 0x48, 0xf7, 0x09,\n    0xa5, 0xd0, 0x3b, 0xb5, 0xc9, 0xb8, 0x89, 0x9c,\n    0x47, 0xae, 0xbb, 0x6f, 0xb7, 0x1e, 0x91, 0x38,\n    0x64, 0x09,\n]);\n// deno-fmt-ignore\nconst PKCS8_ALG_ID_P_256 = new Uint8Array([\n    48, 65, 2, 1, 0, 48, 19, 6, 7, 42,\n    134, 72, 206, 61, 2, 1, 6, 8, 42, 134,\n    72, 206, 61, 3, 1, 7, 4, 39, 48, 37,\n    2, 1, 1, 4, 32,\n]);\n// deno-fmt-ignore\nconst PKCS8_ALG_ID_P_384 = new Uint8Array([\n    48, 78, 2, 1, 0, 48, 16, 6, 7, 42,\n    134, 72, 206, 61, 2, 1, 6, 5, 43, 129,\n    4, 0, 34, 4, 55, 48, 53, 2, 1, 1,\n    4, 48,\n]);\n// deno-fmt-ignore\nconst PKCS8_ALG_ID_P_521 = new Uint8Array([\n    48, 96, 2, 1, 0, 48, 16, 6, 7, 42,\n    134, 72, 206, 61, 2, 1, 6, 5, 43, 129,\n    4, 0, 35, 4, 73, 48, 71, 2, 1, 1,\n    4, 66,\n]);\nexport class Ec extends NativeAlgorithm {\n    constructor(kem, hkdf) {\n        super();\n        Object.defineProperty(this, \"_hkdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_alg\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nPk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nSk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nDh\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // EC specific arguments for deriving key pair.\n        Object.defineProperty(this, \"_order\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_bitmask\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_pkcs8AlgId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._hkdf = hkdf;\n        switch (kem) {\n            case KemId.DhkemP256HkdfSha256:\n                this._alg = { name: \"ECDH\", namedCurve: \"P-256\" };\n                this._nPk = 65;\n                this._nSk = 32;\n                this._nDh = 32;\n                this._order = ORDER_P_256;\n                this._bitmask = 0xFF;\n                this._pkcs8AlgId = PKCS8_ALG_ID_P_256;\n                break;\n            case KemId.DhkemP384HkdfSha384:\n                this._alg = { name: \"ECDH\", namedCurve: \"P-384\" };\n                this._nPk = 97;\n                this._nSk = 48;\n                this._nDh = 48;\n                this._order = ORDER_P_384;\n                this._bitmask = 0xFF;\n                this._pkcs8AlgId = PKCS8_ALG_ID_P_384;\n                break;\n            default:\n                // case KemId.DhkemP521HkdfSha512:\n                this._alg = { name: \"ECDH\", namedCurve: \"P-521\" };\n                this._nPk = 133;\n                this._nSk = 66;\n                this._nDh = 66;\n                this._order = ORDER_P_521;\n                this._bitmask = 0x01;\n                this._pkcs8AlgId = PKCS8_ALG_ID_P_521;\n                break;\n        }\n    }\n    async serializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._api.exportKey(\"raw\", key);\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, true);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async serializePrivateKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            if (!(\"d\" in jwk)) {\n                throw new Error(\"Not private key\");\n            }\n            return base64UrlToBytes(jwk[\"d\"]).buffer;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePrivateKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, false);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async importKey(format, key, isPublic) {\n        await this._setup();\n        try {\n            if (format === \"raw\") {\n                return await this._importRawKey(key, isPublic);\n            }\n            // jwk\n            if (key instanceof ArrayBuffer) {\n                throw new Error(\"Invalid jwk key format\");\n            }\n            return await this._importJWK(key, isPublic);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async generateKeyPair() {\n        await this._setup();\n        try {\n            return await this._api.generateKey(this._alg, true, KEM_USAGES);\n        }\n        catch (e) {\n            throw new NotSupportedError(e);\n        }\n    }\n    async deriveKeyPair(ikm) {\n        await this._setup();\n        try {\n            const dkpPrk = await this._hkdf.labeledExtract(EMPTY.buffer, LABEL_DKP_PRK, new Uint8Array(ikm));\n            const bn = new Bignum(this._nSk);\n            for (let counter = 0; bn.isZero() || !bn.lessThan(this._order); counter++) {\n                if (counter > 255) {\n                    throw new Error(\"Faild to derive a key pair\");\n                }\n                const bytes = new Uint8Array(await this._hkdf.labeledExpand(dkpPrk, LABEL_CANDIDATE, i2Osp(counter, 1), this._nSk));\n                bytes[0] = bytes[0] & this._bitmask;\n                bn.set(bytes);\n            }\n            const sk = await this._deserializePkcs8Key(bn.val());\n            bn.reset();\n            return {\n                privateKey: sk,\n                publicKey: await this.derivePublicKey(sk),\n            };\n        }\n        catch (e) {\n            throw new DeriveKeyPairError(e);\n        }\n    }\n    async derivePublicKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            delete jwk[\"d\"];\n            delete jwk[\"key_ops\"];\n            return await this._api.importKey(\"jwk\", jwk, this._alg, true, []);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async dh(sk, pk) {\n        try {\n            await this._setup();\n            const bits = await this._api.deriveBits({\n                name: \"ECDH\",\n                public: pk,\n            }, sk, this._nDh * 8);\n            return bits;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async _importRawKey(key, isPublic) {\n        if (isPublic && key.byteLength !== this._nPk) {\n            throw new Error(\"Invalid public key for the ciphersuite\");\n        }\n        if (!isPublic && key.byteLength !== this._nSk) {\n            throw new Error(\"Invalid private key for the ciphersuite\");\n        }\n        if (isPublic) {\n            return await this._api.importKey(\"raw\", key, this._alg, true, []);\n        }\n        return await this._deserializePkcs8Key(new Uint8Array(key));\n    }\n    async _importJWK(key, isPublic) {\n        if (typeof key.crv === \"undefined\" || key.crv !== this._alg.namedCurve) {\n            throw new Error(`Invalid crv: ${key.crv}`);\n        }\n        if (isPublic) {\n            if (typeof key.d !== \"undefined\") {\n                throw new Error(\"Invalid key: `d` should not be set\");\n            }\n            return await this._api.importKey(\"jwk\", key, this._alg, true, []);\n        }\n        if (typeof key.d === \"undefined\") {\n            throw new Error(\"Invalid key: `d` not found\");\n        }\n        return await this._api.importKey(\"jwk\", key, this._alg, true, KEM_USAGES);\n    }\n    async _deserializePkcs8Key(k) {\n        const pkcs8Key = new Uint8Array(this._pkcs8AlgId.length + k.length);\n        pkcs8Key.set(this._pkcs8AlgId, 0);\n        pkcs8Key.set(k, this._pkcs8AlgId.length);\n        return await this._api.importKey(\"pkcs8\", pkcs8Key, this._alg, true, KEM_USAGES);\n    }\n}\n", "import { EMPTY } from \"../consts.js\";\nimport { InvalidParamError } from \"../errors.js\";\nimport { KdfId } from \"../identifiers.js\";\nimport { NativeAlgorithm } from \"../algorithm.js\";\n// b\"HPKE-v1\"\nconst HPKE_VERSION = new Uint8Array([72, 80, 75, 69, 45, 118, 49]);\nexport class HkdfNative extends NativeAlgorithm {\n    constructor() {\n        super();\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KdfId.HkdfSha256\n        });\n        Object.defineProperty(this, \"hashSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"_suiteId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: EMPTY\n        });\n        Object.defineProperty(this, \"algHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {\n                name: \"HMAC\",\n                hash: \"SHA-256\",\n                length: 256,\n            }\n        });\n    }\n    init(suiteId) {\n        this._suiteId = suiteId;\n    }\n    buildLabeledIkm(label, ikm) {\n        this._checkInit();\n        const ret = new Uint8Array(7 + this._suiteId.byteLength + label.byteLength + ikm.byteLength);\n        ret.set(HPKE_VERSION, 0);\n        ret.set(this._suiteId, 7);\n        ret.set(label, 7 + this._suiteId.byteLength);\n        ret.set(ikm, 7 + this._suiteId.byteLength + label.byteLength);\n        return ret;\n    }\n    buildLabeledInfo(label, info, len) {\n        this._checkInit();\n        const ret = new Uint8Array(9 + this._suiteId.byteLength + label.byteLength + info.byteLength);\n        ret.set(new Uint8Array([0, len]), 0);\n        ret.set(HPKE_VERSION, 2);\n        ret.set(this._suiteId, 9);\n        ret.set(label, 9 + this._suiteId.byteLength);\n        ret.set(info, 9 + this._suiteId.byteLength + label.byteLength);\n        return ret;\n    }\n    async extract(salt, ikm) {\n        await this._setup();\n        if (salt.byteLength === 0) {\n            salt = new ArrayBuffer(this.hashSize);\n        }\n        if (salt.byteLength !== this.hashSize) {\n            throw new InvalidParamError(\"The salt length must be the same as the hashSize\");\n        }\n        const key = await this._api.importKey(\"raw\", salt, this.algHash, false, [\n            \"sign\",\n        ]);\n        return await this._api.sign(\"HMAC\", key, ikm);\n    }\n    async expand(prk, info, len) {\n        await this._setup();\n        const key = await this._api.importKey(\"raw\", prk, this.algHash, false, [\n            \"sign\",\n        ]);\n        const okm = new ArrayBuffer(len);\n        const p = new Uint8Array(okm);\n        let prev = EMPTY;\n        const mid = new Uint8Array(info);\n        const tail = new Uint8Array(1);\n        if (len > 255 * this.hashSize) {\n            throw new Error(\"Entropy limit reached\");\n        }\n        const tmp = new Uint8Array(this.hashSize + mid.length + 1);\n        for (let i = 1, cur = 0; cur < p.length; i++) {\n            tail[0] = i;\n            tmp.set(prev, 0);\n            tmp.set(mid, prev.length);\n            tmp.set(tail, prev.length + mid.length);\n            prev = new Uint8Array(await this._api.sign(\"HMAC\", key, tmp.slice(0, prev.length + mid.length + 1)));\n            if (p.length - cur >= prev.length) {\n                p.set(prev, cur);\n                cur += prev.length;\n            }\n            else {\n                p.set(prev.slice(0, p.length - cur), cur);\n                cur += p.length - cur;\n            }\n        }\n        return okm;\n    }\n    async extractAndExpand(salt, ikm, info, len) {\n        await this._setup();\n        const baseKey = await this._api.importKey(\"raw\", ikm, \"HKDF\", false, [\"deriveBits\"]);\n        return await this._api.deriveBits({\n            name: \"HKDF\",\n            hash: this.algHash.hash,\n            salt: salt,\n            info: info,\n        }, baseKey, len * 8);\n    }\n    async labeledExtract(salt, label, ikm) {\n        return await this.extract(salt, this.buildLabeledIkm(label, ikm).buffer);\n    }\n    async labeledExpand(prk, label, info, len) {\n        return await this.expand(prk, this.buildLabeledInfo(label, info, len).buffer, len);\n    }\n    _checkInit() {\n        if (this._suiteId === EMPTY) {\n            throw new Error(\"Not initialized. Call init()\");\n        }\n    }\n}\nexport class HkdfSha256Native extends HkdfNative {\n    constructor() {\n        super(...arguments);\n        /** KdfId.HkdfSha256 (0x0001) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KdfId.HkdfSha256\n        });\n        /** 32 */\n        Object.defineProperty(this, \"hashSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n        /** The parameters for Web Cryptography API */\n        Object.defineProperty(this, \"algHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {\n                name: \"HMAC\",\n                hash: \"SHA-256\",\n                length: 256,\n            }\n        });\n    }\n}\nexport class HkdfSha384Native extends HkdfNative {\n    constructor() {\n        super(...arguments);\n        /** KdfId.HkdfSha384 (0x0002) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KdfId.HkdfSha384\n        });\n        /** 48 */\n        Object.defineProperty(this, \"hashSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 48\n        });\n        /** The parameters for Web Cryptography API */\n        Object.defineProperty(this, \"algHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {\n                name: \"HMAC\",\n                hash: \"SHA-384\",\n                length: 384,\n            }\n        });\n    }\n}\nexport class HkdfSha512Native extends HkdfNative {\n    constructor() {\n        super(...arguments);\n        /** KdfId.HkdfSha512 (0x0003) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KdfId.HkdfSha512\n        });\n        /** 64 */\n        Object.defineProperty(this, \"hashSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 64\n        });\n        /** The parameters for Web Cryptography API */\n        Object.defineProperty(this, \"algHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {\n                name: \"HMAC\",\n                hash: \"SHA-512\",\n                length: 512,\n            }\n        });\n    }\n}\n", "// The key usages for AEAD.\nexport const AEAD_USAGES = [\"encrypt\", \"decrypt\"];\n", "// deno-lint-ignore-file no-explicit-any\n/**\n * This file is based on noble-curves (https://github.com/paulmillr/noble-curves).\n *\n * noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com)\n *\n * The original file is located at:\n * https://github.com/paulmillr/noble-curves/blob/b9d49d2b41d550571a0c5be443ecb62109fa3373/src/utils.ts\n */\n/**\n * Hex, bytes and number utilities.\n * @module\n */\nimport { loadCrypto } from \"./misc.js\";\nconst _0n = /* @__PURE__ */ BigInt(0);\n/** Checks if something is Uint8Array. Be careful: nodejs Buffer will return true. */\nexport function isBytes(a) {\n    return a instanceof Uint8Array ||\n        (ArrayBuffer.isView(a) && a.constructor.name === \"Uint8Array\");\n}\n/** Asserts something is Uint8Array. */\nexport function abytes(value, length, title = \"\") {\n    const bytes = isBytes(value);\n    const len = value?.length;\n    const needsLen = length !== undefined;\n    if (!bytes || (needsLen && len !== length)) {\n        const prefix = title && `\"${title}\" `;\n        const ofLen = needsLen ? ` of length ${length}` : \"\";\n        const got = bytes ? `length=${len}` : `type=${typeof value}`;\n        throw new Error(prefix + \"expected Uint8Array\" + ofLen + \", got \" + got);\n    }\n    return value;\n}\n/** Asserts something is hash */\nexport function ahash(h) {\n    if (typeof h !== \"function\" || typeof h.create !== \"function\") {\n        throw new Error(\"Hash must wrapped by utils.createHasher\");\n    }\n    anumber(h.outputLen);\n    anumber(h.blockLen);\n}\n/** Asserts a hash instance has not been destroyed / finished */\nexport function aexists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error(\"Hash instance has been destroyed\");\n    if (checkFinished && instance.finished) {\n        throw new Error(\"Hash#digest() has already been called\");\n    }\n}\n/** Asserts output is properly-sized byte array */\nexport function aoutput(out, instance) {\n    abytes(out, undefined, \"digestInto() output\");\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error('\"digestInto() output\" expected to be of length >=' + min);\n    }\n}\n/** Asserts something is positive integer. */\nexport function anumber(n) {\n    if (!Number.isSafeInteger(n) || n < 0) {\n        throw new Error(\"positive integer expected, got \" + n);\n    }\n}\n// Used in weierstrass, der\nfunction abignumer(n) {\n    if (typeof n === \"bigint\") {\n        if (!isPosBig(n))\n            throw new Error(\"positive bigint expected, got \" + n);\n    }\n    else\n        anumber(n);\n    return n;\n}\n/** Zeroize a byte array. Warning: JS provides no guarantees. */\nexport function clean(...arrays) {\n    for (let i = 0; i < arrays.length; i++) {\n        arrays[i].fill(0);\n    }\n}\n/** Create DataView of an array for easy byte-level manipulation. */\nexport function createView(arr) {\n    return new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n/** The rotate right (circular right shift) operation for uint32 */\nexport function rotr(word, shift) {\n    return (word << (32 - shift)) | (word >>> shift);\n}\n// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex\nconst hasHexBuiltin = /* @__PURE__ */ (() => \n// @ts-ignore: to use toHex\ntypeof Uint8Array.from([]).toHex === \"function\" &&\n    // @ts-ignore: to use fromHex\n    typeof Uint8Array.fromHex === \"function\")();\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, \"0\"));\n/**\n * Convert byte array to hex string. Uses built-in function, when available.\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    abytes(bytes);\n    // @ts-ignore: to use toHex\n    if (hasHexBuiltin)\n        return bytes.toHex();\n    // pre-caching improves the speed 6x\n    let hex = \"\";\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 };\nfunction asciiToBase16(ch) {\n    if (ch >= asciis._0 && ch <= asciis._9)\n        return ch - asciis._0; // '2' => 50-48\n    if (ch >= asciis.A && ch <= asciis.F)\n        return ch - (asciis.A - 10); // 'B' => 66-(65-10)\n    if (ch >= asciis.a && ch <= asciis.f)\n        return ch - (asciis.a - 10); // 'b' => 98-(97-10)\n    return;\n}\n/**\n * Convert hex string to byte array. Uses built-in function, when available.\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== \"string\") {\n        throw new Error(\"hex string expected, got \" + typeof hex);\n    }\n    // @ts-ignore: to use fromHex\n    if (hasHexBuiltin)\n        return Uint8Array.fromHex(hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2) {\n        throw new Error(\"hex string expected, got unpadded hex of length \" + hl);\n    }\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' +\n                hi);\n        }\n        array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163\n    }\n    return array;\n}\n/**\n * Converts string to bytes using UTF8 encoding.\n * @example utf8ToBytes('abc') // Uint8Array.from([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== \"string\")\n        throw new Error(\"string expected\");\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Converts bytes to string using UTF8 encoding.\n * @example bytesToUtf8(Uint8Array.from([97, 98, 99])) // 'abc'\n */\nexport function bytesToUtf8(bytes) {\n    return new TextDecoder().decode(bytes);\n}\nexport function numberToHexUnpadded(num) {\n    const hex = abignumer(num).toString(16);\n    return hex.length & 1 ? \"0\" + hex : hex;\n}\nexport function hexToNumber(hex) {\n    if (typeof hex !== \"string\") {\n        throw new Error(\"hex string expected, got \" + typeof hex);\n    }\n    return hex === \"\" ? _0n : BigInt(\"0x\" + hex); // Big Endian\n}\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes) {\n    return hexToNumber(bytesToHex(bytes));\n}\nexport function bytesToNumberLE(bytes) {\n    return hexToNumber(bytesToHex(copyBytes(abytes(bytes)).reverse()));\n}\nexport function numberToBytesBE(n, len) {\n    anumber(len);\n    n = abignumer(n);\n    const res = hexToBytes(n.toString(16).padStart(len * 2, \"0\"));\n    if (res.length !== len)\n        throw new Error(\"number too large\");\n    return res;\n}\nexport function numberToBytesLE(n, len) {\n    return numberToBytesBE(n, len).reverse();\n}\n/**\n * Copies Uint8Array. We can't use u8a.slice(), because u8a can be Buffer,\n * and Buffer#slice creates mutable copy. Never use Buffers!\n */\nexport function copyBytes(bytes) {\n    return Uint8Array.from(bytes);\n}\n/** Copies several Uint8Arrays into one. */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        abytes(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n/**\n * Decodes 7-bit ASCII string to Uint8Array, throws on non-ascii symbols\n * Should be safe to use for things expected to be ASCII.\n * Returns exact same result as utf8ToBytes for ASCII or throws.\n */\nexport function asciiToBytes(ascii) {\n    return Uint8Array.from(ascii, (c, i) => {\n        const charCode = c.charCodeAt(0);\n        if (c.length !== 1 || charCode > 127) {\n            throw new Error(`string contains non-ASCII character \"${ascii[i]}\" with code ${charCode} at position ${i}`);\n        }\n        return charCode;\n    });\n}\n// Is positive bigint\nconst isPosBig = (n) => typeof n === \"bigint\" && _0n <= n;\nexport function inRange(n, min, max) {\n    return isPosBig(n) && isPosBig(min) && isPosBig(max) && min <= n && n < max;\n}\n/**\n * Asserts min <= n < max. NOTE: It's < max and not <= max.\n * @example\n * aInRange('x', x, 1n, 256n); // would assume x is in (1n..255n)\n */\nexport function aInRange(title, n, min, max) {\n    // Why min <= n < max and not a (min < n < max) OR b (min <= n <= max)?\n    // consider P=256n, min=0n, max=P\n    // - a for min=0 would require -1:          `inRange('x', x, -1n, P)`\n    // - b would commonly require subtraction:  `inRange('x', x, 0n, P - 1n)`\n    // - our way is the cleanest:               `inRange('x', x, 0n, P)\n    if (!inRange(n, min, max)) {\n        throw new Error(\"expected valid \" + title + \": \" + min + \" <= n < \" + max + \", got \" + n);\n    }\n}\nexport function validateObject(object, fields = {}, optFields = {}) {\n    if (!object || typeof object !== \"object\") {\n        throw new Error(\"expected valid options object\");\n    }\n    function checkField(fieldName, expectedType, isOpt) {\n        const val = object[fieldName];\n        if (isOpt && val === undefined)\n            return;\n        const current = typeof val;\n        if (current !== expectedType || val === null) {\n            throw new Error(`param \"${fieldName}\" is invalid: expected ${expectedType}, got ${current}`);\n        }\n    }\n    const iter = (f, isOpt) => Object.entries(f).forEach(([k, v]) => checkField(k, v, isOpt));\n    iter(fields, false);\n    iter(optFields, true);\n}\nexport function createHasher(hashCons, info = {}) {\n    const hashC = (msg, opts) => hashCons(opts).update(msg).digest();\n    const tmp = hashCons(undefined);\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    Object.assign(hashC, info);\n    return Object.freeze(hashC);\n}\n// /** Cryptographically secure PRNG. Uses internal OS-level `crypto.getRandomValues`. */\n// export function randomBytes(bytesLength = 32): Uint8Array {\n//   const cr = typeof globalThis != null && (globalThis as any).crypto;\n//   if (!cr || typeof cr.getRandomValues !== \"function\") {\n//     throw new Error(\"crypto.getRandomValues must be defined\");\n//   }\n//   return cr.getRandomValues(new Uint8Array(bytesLength));\n// }\n/** Cryptographically secure PRNG. Uses internal OS-level `crypto.getRandomValues`. */\nexport async function randomBytesAsync(bytesLength = 32) {\n    const api = await loadCrypto();\n    const rnd = new Uint8Array(bytesLength);\n    api.getRandomValues(rnd);\n    return rnd;\n}\n// 06 09 60 86 48 01 65 03 04 02\nexport const oidNist = (suffix) => ({\n    oid: Uint8Array.from([\n        0x06,\n        0x09,\n        0x60,\n        0x86,\n        0x48,\n        0x01,\n        0x65,\n        0x03,\n        0x04,\n        0x02,\n        suffix,\n    ]),\n});\n", "// deno-lint-ignore-file no-explicit-any\n/**\n * This file is based on noble-hashes (https://github.com/paulmillr/noble-hashes).\n *\n * noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com)\n *\n * The original file is located at:\n * https://github.com/paulmillr/noble-hashes/blob/2e0c00e1aa134082ba1380bf3afb8b1641f60fed/src/hmac.ts\n */\n/**\n * HMAC: RFC2104 message authentication code.\n * @module\n */\nimport { abytes, aexists, ahash, clean, } from \"../utils/noble.js\";\nexport class _HMAC {\n    constructor(hash, key) {\n        Object.defineProperty(this, \"oHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"iHash\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"blockLen\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"outputLen\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"finished\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"destroyed\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        ahash(hash);\n        abytes(key, undefined, \"key\");\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== \"function\") {\n            throw new Error(\"Expected instance of class which extends utils.Hash\");\n        }\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        clean(pad);\n    }\n    update(buf) {\n        aexists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        aexists(this);\n        abytes(out, this.outputLen, \"output\");\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to ||= Object.create(Object.getPrototypeOf(this), {});\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    clone() {\n        return this._cloneInto();\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n * @example\n * import { hmac } from '@noble/hashes/hmac';\n * import { sha256 } from '@noble/hashes/sha2';\n * const mac1 = hmac(sha256, 'key', 'message');\n */\nexport const hmac = (hash, key, message) => new _HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new _HMAC(hash, key);\n", "/**\n * This file is based on noble-curves (https://github.com/paulmillr/noble-curves).\n *\n * noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com)\n *\n * The original file is located at:\n * https://github.com/paulmillr/noble-curves/blob/b9d49d2b41d550571a0c5be443ecb62109fa3373/src/abstract/montgomery.ts\n */\n/**\n * Montgomery curve methods. It's not really whole montgomery curve,\n * just bunch of very specific methods for X25519 / X448 from\n * [RFC 7748](https://www.rfc-editor.org/rfc/rfc7748)\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { abytes, aInRange, bytesToNumberLE, copyBytes, numberToBytesLE, randomBytesAsync, validateObject, } from \"../utils/noble.js\";\nimport { createKeygen } from \"./curve.js\";\nimport { mod } from \"./modular.js\";\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nfunction validateOpts(curve) {\n    validateObject(curve, {\n        adjustScalarBytes: \"function\",\n        powPminus2: \"function\",\n    });\n    return Object.freeze({ ...curve });\n}\nexport function montgomery(curveDef) {\n    const CURVE = validateOpts(curveDef);\n    const { P, type, adjustScalarBytes, powPminus2, randomBytes: rand } = CURVE;\n    const is25519 = type === \"x25519\";\n    if (!is25519 && type !== \"x448\")\n        throw new Error(\"invalid type\");\n    const randomBytes_ = rand || randomBytesAsync;\n    const montgomeryBits = is25519 ? 255 : 448;\n    const fieldLen = is25519 ? 32 : 56;\n    const Gu = is25519 ? BigInt(9) : BigInt(5);\n    // RFC 7748 #5:\n    // The constant a24 is (486662 - 2) / 4 = 121665 for curve25519/X25519 and\n    // (156326 - 2) / 4 = 39081 for curve448/X448\n    // const a = is25519 ? 156326n : 486662n;\n    const a24 = is25519 ? BigInt(121665) : BigInt(39081);\n    // RFC: x25519 \"the resulting integer is of the form 2^254 plus\n    // eight times a value between 0 and 2^251 - 1 (inclusive)\"\n    // x448: \"2^447 plus four times a value between 0 and 2^445 - 1 (inclusive)\"\n    const minScalar = is25519 ? _2n ** BigInt(254) : _2n ** BigInt(447);\n    const maxAdded = is25519\n        ? BigInt(8) * _2n ** BigInt(251) - _1n\n        : BigInt(4) * _2n ** BigInt(445) - _1n;\n    const maxScalar = minScalar + maxAdded + _1n; // (inclusive)\n    const modP = (n) => mod(n, P);\n    const GuBytes = encodeU(Gu);\n    function encodeU(u) {\n        return numberToBytesLE(modP(u), fieldLen);\n    }\n    function decodeU(u) {\n        const _u = copyBytes(abytes(u, fieldLen, \"uCoordinate\"));\n        // RFC: When receiving such an array, implementations of X25519\n        // (but not X448) MUST mask the most significant bit in the final byte.\n        if (is25519)\n            _u[31] &= 127; // 0b0111_1111\n        // RFC: Implementations MUST accept non-canonical values and process them as\n        // if they had been reduced modulo the field prime.  The non-canonical\n        // values are 2^255 - 19 through 2^255 - 1 for X25519 and 2^448 - 2^224\n        // - 1 through 2^448 - 1 for X448.\n        return modP(bytesToNumberLE(_u));\n    }\n    function decodeScalar(scalar) {\n        return bytesToNumberLE(adjustScalarBytes(copyBytes(abytes(scalar, fieldLen, \"scalar\"))));\n    }\n    function scalarMult(scalar, u) {\n        const pu = montgomeryLadder(decodeU(u), decodeScalar(scalar));\n        // Some public keys are useless, of low-order. Curve author doesn't think\n        // it needs to be validated, but we do it nonetheless.\n        // https://cr.yp.to/ecdh.html#validate\n        if (pu === _0n)\n            throw new Error(\"invalid private or public key received\");\n        return encodeU(pu);\n    }\n    // Computes public key from private. By doing scalar multiplication of base point.\n    function scalarMultBase(scalar) {\n        return scalarMult(scalar, GuBytes);\n    }\n    const getPublicKey = scalarMultBase;\n    const getSharedSecret = scalarMult;\n    // cswap from RFC7748 \"example code\"\n    function cswap(swap, x_2, x_3) {\n        // dummy = mask(swap) AND (x_2 XOR x_3)\n        // Where mask(swap) is the all-1 or all-0 word of the same length as x_2\n        // and x_3, computed, e.g., as mask(swap) = 0 - swap.\n        const dummy = modP(swap * (x_2 - x_3));\n        x_2 = modP(x_2 - dummy); // x_2 = x_2 XOR dummy\n        x_3 = modP(x_3 + dummy); // x_3 = x_3 XOR dummy\n        return { x_2, x_3 };\n    }\n    /**\n     * Montgomery x-only multiplication ladder.\n     * @param pointU u coordinate (x) on Montgomery Curve 25519\n     * @param scalar by which the point would be multiplied\n     * @returns new Point on Montgomery curve\n     */\n    function montgomeryLadder(u, scalar) {\n        aInRange(\"u\", u, _0n, P);\n        aInRange(\"scalar\", scalar, minScalar, maxScalar);\n        const k = scalar;\n        const x_1 = u;\n        let x_2 = _1n;\n        let z_2 = _0n;\n        let x_3 = u;\n        let z_3 = _1n;\n        let swap = _0n;\n        for (let t = BigInt(montgomeryBits - 1); t >= _0n; t--) {\n            const k_t = (k >> t) & _1n;\n            swap ^= k_t;\n            ({ x_2, x_3 } = cswap(swap, x_2, x_3));\n            ({ x_2: z_2, x_3: z_3 } = cswap(swap, z_2, z_3));\n            swap = k_t;\n            const A = x_2 + z_2;\n            const AA = modP(A * A);\n            const B = x_2 - z_2;\n            const BB = modP(B * B);\n            const E = AA - BB;\n            const C = x_3 + z_3;\n            const D = x_3 - z_3;\n            const DA = modP(D * A);\n            const CB = modP(C * B);\n            const dacb = DA + CB;\n            const da_cb = DA - CB;\n            x_3 = modP(dacb * dacb);\n            z_3 = modP(x_1 * modP(da_cb * da_cb));\n            x_2 = modP(AA * BB);\n            z_2 = modP(E * (AA + modP(a24 * E)));\n        }\n        ({ x_2, x_3 } = cswap(swap, x_2, x_3));\n        ({ x_2: z_2, x_3: z_3 } = cswap(swap, z_2, z_3));\n        const z2 = powPminus2(z_2); // `Fp.pow(x, P - _2n)` is much slower equivalent\n        return modP(x_2 * z2); // Return x_2 * (z_2^(p - 2))\n    }\n    const lengths = {\n        secretKey: fieldLen,\n        publicKey: fieldLen,\n        seed: fieldLen,\n    };\n    const randomSecretKey = async (seed) => {\n        if (seed === undefined) {\n            seed = await randomBytes_(fieldLen);\n        }\n        abytes(seed, lengths.seed, \"seed\");\n        return seed;\n    };\n    const utils = { randomSecretKey };\n    return Object.freeze({\n        keygen: createKeygen(randomSecretKey, getPublicKey),\n        getSharedSecret,\n        getPublicKey,\n        scalarMult,\n        scalarMultBase,\n        utils,\n        GuBytes: GuBytes.slice(),\n        lengths,\n    });\n}\n", "import { AEAD_USAGES, AeadId, NativeAlgorithm } from \"@hpke/common\";\nexport class AesGcmContext extends NativeAlgorithm {\n    constructor(key) {\n        super();\n        Object.defineProperty(this, \"_rawKey\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_key\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: undefined\n        });\n        this._rawKey = key;\n    }\n    async seal(iv, data, aad) {\n        await this._setupKey();\n        const alg = {\n            name: \"AES-GCM\",\n            iv: iv,\n            additionalData: aad,\n        };\n        const ct = await this._api.encrypt(alg, this._key, data);\n        return ct;\n    }\n    async open(iv, data, aad) {\n        await this._setupKey();\n        const alg = {\n            name: \"AES-GCM\",\n            iv: iv,\n            additionalData: aad,\n        };\n        const pt = await this._api.decrypt(alg, this._key, data);\n        return pt;\n    }\n    async _setupKey() {\n        if (this._key !== undefined) {\n            return;\n        }\n        await this._setup();\n        const key = await this._importKey(this._rawKey);\n        (new Uint8Array(this._rawKey)).fill(0);\n        this._key = key;\n        return;\n    }\n    async _importKey(key) {\n        return await this._api.importKey(\"raw\", key, { name: \"AES-GCM\" }, true, AEAD_USAGES);\n    }\n}\n/**\n * The AES-128-GCM for HPKE AEAD implementing {@link AeadInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `aead` parameter of {@link CipherSuiteParams} instead of `AeadId.Aes128Gcm`.\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class Aes128Gcm {\n    constructor() {\n        /** AeadId.Aes128Gcm (0x0001) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: AeadId.Aes128Gcm\n        });\n        /** 16 */\n        Object.defineProperty(this, \"keySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 16\n        });\n        /** 12 */\n        Object.defineProperty(this, \"nonceSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 12\n        });\n        /** 16 */\n        Object.defineProperty(this, \"tagSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 16\n        });\n    }\n    createEncryptionContext(key) {\n        return new AesGcmContext(key);\n    }\n}\n/**\n * The AES-256-GCM for HPKE AEAD implementing {@link AeadInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `aead` parameter of {@link CipherSuiteParams} instead of `AeadId.Aes256Gcm`\n * as follows:\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes256Gcm,\n *   CipherSuite,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes256Gcm(),\n * });\n * ```\n */\nexport class Aes256Gcm extends Aes128Gcm {\n    constructor() {\n        super(...arguments);\n        /** AeadId.Aes256Gcm (0x0002) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: AeadId.Aes256Gcm\n        });\n        /** 32 */\n        Object.defineProperty(this, \"keySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n        /** 12 */\n        Object.defineProperty(this, \"nonceSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 12\n        });\n        /** 16 */\n        Object.defineProperty(this, \"tagSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 16\n        });\n    }\n}\n", "import { NotSupportedError } from \"@hpke/common\";\nexport function emitNotSupported() {\n    return new Promise((_resolve, reject) => {\n        reject(new NotSupportedError(\"Not supported\"));\n    });\n}\n", "import { ExportError, INPUT_LENGTH_LIMIT, InvalidParamError, } from \"@hpke/common\";\nimport { emitNotSupported } from \"./utils/emitNotSupported.js\";\n// b\"sec\"\nconst LABEL_SEC = new Uint8Array([115, 101, 99]);\nexport class ExporterContextImpl {\n    constructor(api, kdf, exporterSecret) {\n        Object.defineProperty(this, \"_api\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"exporterSecret\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_kdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._api = api;\n        this._kdf = kdf;\n        this.exporterSecret = exporterSecret;\n    }\n    async seal(_data, _aad) {\n        return await emitNotSupported();\n    }\n    async open(_data, _aad) {\n        return await emitNotSupported();\n    }\n    async export(exporterContext, len) {\n        if (exporterContext.byteLength > INPUT_LENGTH_LIMIT) {\n            throw new InvalidParamError(\"Too long exporter context\");\n        }\n        try {\n            return await this._kdf.labeledExpand(this.exporterSecret, LABEL_SEC, new Uint8Array(exporterContext), len);\n        }\n        catch (e) {\n            throw new ExportError(e);\n        }\n    }\n}\nexport class RecipientExporterContextImpl extends ExporterContextImpl {\n}\nexport class SenderExporterContextImpl extends ExporterContextImpl {\n    constructor(api, kdf, exporterSecret, enc) {\n        super(api, kdf, exporterSecret);\n        Object.defineProperty(this, \"enc\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.enc = enc;\n        return;\n    }\n}\n", "import { i2Osp, MessageLimitReachedError, xor } from \"@hpke/common\";\nimport { ExporterContextImpl } from \"./exporterContext.js\";\nexport class EncryptionContextImpl extends ExporterContextImpl {\n    constructor(api, kdf, params) {\n        super(api, kdf, params.exporterSecret);\n        // AEAD id.\n        Object.defineProperty(this, \"_aead\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // The length in bytes of a key for the algorithm.\n        Object.defineProperty(this, \"_nK\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // The length in bytes of a nonce for the algorithm.\n        Object.defineProperty(this, \"_nN\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // The length in bytes of an authentication tag for the algorithm.\n        Object.defineProperty(this, \"_nT\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // The end-to-end encryption key information.\n        Object.defineProperty(this, \"_ctx\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        if (params.key === undefined || params.baseNonce === undefined ||\n            params.seq === undefined) {\n            throw new Error(\"Required parameters are missing\");\n        }\n        this._aead = params.aead;\n        this._nK = this._aead.keySize;\n        this._nN = this._aead.nonceSize;\n        this._nT = this._aead.tagSize;\n        const key = this._aead.createEncryptionContext(params.key);\n        this._ctx = {\n            key: key,\n            baseNonce: params.baseNonce,\n            seq: params.seq,\n        };\n    }\n    computeNonce(k) {\n        const seqBytes = i2Osp(k.seq, k.baseNonce.byteLength);\n        return xor(k.baseNonce, seqBytes).buffer;\n    }\n    incrementSeq(k) {\n        // if (this.seq >= (1 << (8 * this.baseNonce.byteLength)) - 1) {\n        if (k.seq > Number.MAX_SAFE_INTEGER) {\n            throw new MessageLimitReachedError(\"Message limit reached\");\n        }\n        k.seq += 1;\n        return;\n    }\n}\n", "var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar _Mutex_locked;\nexport class Mutex {\n    constructor() {\n        _Mutex_locked.set(this, Promise.resolve());\n    }\n    async lock() {\n        let releaseLock;\n        const nextLock = new Promise((resolve) => {\n            releaseLock = resolve;\n        });\n        const previousLock = __classPrivateFieldGet(this, _Mutex_locked, \"f\");\n        __classPrivateFieldSet(this, _Mutex_locked, nextLock, \"f\");\n        await previousLock;\n        return releaseLock;\n    }\n}\n_Mutex_locked = new WeakMap();\n", "var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar _RecipientContextImpl_mutex;\nimport { EMPTY, OpenError } from \"@hpke/common\";\nimport { EncryptionContextImpl } from \"./encryptionContext.js\";\nimport { Mutex } from \"./mutex.js\";\nexport class RecipientContextImpl extends EncryptionContextImpl {\n    constructor() {\n        super(...arguments);\n        _RecipientContextImpl_mutex.set(this, void 0);\n    }\n    async open(data, aad = EMPTY.buffer) {\n        __classPrivateFieldSet(this, _RecipientContextImpl_mutex, __classPrivateFieldGet(this, _RecipientContextImpl_mutex, \"f\") ?? new Mutex(), \"f\");\n        const release = await __classPrivateFieldGet(this, _RecipientContextImpl_mutex, \"f\").lock();\n        let pt;\n        try {\n            pt = await this._ctx.key.open(this.computeNonce(this._ctx), data, aad);\n        }\n        catch (e) {\n            throw new OpenError(e);\n        }\n        finally {\n            release();\n        }\n        this.incrementSeq(this._ctx);\n        return pt;\n    }\n}\n_RecipientContextImpl_mutex = new WeakMap();\n", "var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar _SenderContextImpl_mutex;\nimport { EMPTY, SealError } from \"@hpke/common\";\nimport { EncryptionContextImpl } from \"./encryptionContext.js\";\nimport { Mutex } from \"./mutex.js\";\nexport class SenderContextImpl extends EncryptionContextImpl {\n    constructor(api, kdf, params, enc) {\n        super(api, kdf, params);\n        Object.defineProperty(this, \"enc\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        _SenderContextImpl_mutex.set(this, void 0);\n        this.enc = enc;\n    }\n    async seal(data, aad = EMPTY.buffer) {\n        __classPrivateFieldSet(this, _SenderContextImpl_mutex, __classPrivateFieldGet(this, _SenderContextImpl_mutex, \"f\") ?? new Mutex(), \"f\");\n        const release = await __classPrivateFieldGet(this, _SenderContextImpl_mutex, \"f\").lock();\n        let ct;\n        try {\n            ct = await this._ctx.key.seal(this.computeNonce(this._ctx), data, aad);\n        }\n        catch (e) {\n            throw new SealError(e);\n        }\n        finally {\n            release();\n        }\n        this.incrementSeq(this._ctx);\n        return ct;\n    }\n}\n_SenderContextImpl_mutex = new WeakMap();\n", "import { AeadId, EMPTY, i2Osp, INFO_LENGTH_LIMIT, INPUT_LENGTH_LIMIT, InvalidParamError, MINIMUM_PSK_LENGTH, Mode, NativeAlgorithm, } from \"@hpke/common\";\nimport { RecipientExporterContextImpl, SenderExporterContextImpl, } from \"./exporterContext.js\";\nimport { RecipientContextImpl } from \"./recipientContext.js\";\nimport { SenderContextImpl } from \"./senderContext.js\";\n// b\"base_nonce\"\n// deno-fmt-ignore\nconst LABEL_BASE_NONCE = new Uint8Array([\n    98, 97, 115, 101, 95, 110, 111, 110, 99, 101,\n]);\n// b\"exp\"\nconst LABEL_EXP = new Uint8Array([101, 120, 112]);\n// b\"info_hash\"\n// deno-fmt-ignore\nconst LABEL_INFO_HASH = new Uint8Array([\n    105, 110, 102, 111, 95, 104, 97, 115, 104,\n]);\n// b\"key\"\nconst LABEL_KEY = new Uint8Array([107, 101, 121]);\n// b\"psk_id_hash\"\n// deno-fmt-ignore\nconst LABEL_PSK_ID_HASH = new Uint8Array([\n    112, 115, 107, 95, 105, 100, 95, 104, 97, 115, 104,\n]);\n// b\"secret\"\nconst LABEL_SECRET = new Uint8Array([115, 101, 99, 114, 101, 116]);\n// b\"HPKE\"\n// deno-fmt-ignore\nconst SUITE_ID_HEADER_HPKE = new Uint8Array([\n    72, 80, 75, 69, 0, 0, 0, 0, 0, 0,\n]);\n/**\n * The Hybrid Public Key Encryption (HPKE) ciphersuite,\n * which is implemented using only\n * {@link https://www.w3.org/TR/WebCryptoAPI/ | Web Cryptography API}.\n *\n * This is the super class of {@link CipherSuite} and the same as\n * {@link https://jsr.io/@hpke/core/doc/~/CipherSuite | @hpke/core#CipherSuite} as follows:\n * which supports only the ciphersuites that can be implemented on the native\n * {@link https://www.w3.org/TR/WebCryptoAPI/ | Web Cryptography API}.\n * Therefore, the following cryptographic algorithms are not supported for now:\n *   - DHKEM(X25519, HKDF-SHA256)\n *   - DHKEM(X448, HKDF-SHA512)\n *   - ChaCha20Poly1305\n *\n * In addtion, the HKDF functions contained in this class can only derive\n * keys of the same length as the `hashSize`.\n *\n * If you want to use the unsupported cryptographic algorithms\n * above or derive keys longer than the `hashSize`,\n * please use {@link CipherSuite}.\n *\n * This class provides following functions:\n *\n * - Creates encryption contexts both for senders and recipients.\n *   - {@link createSenderContext}\n *   - {@link createRecipientContext}\n * - Provides single-shot encryption API.\n *   - {@link seal}\n *   - {@link open}\n *\n * The calling of the constructor of this class is the starting\n * point for HPKE operations for both senders and recipients.\n *\n * @example Use only ciphersuites supported by Web Cryptography API.\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n *   CipherSuite,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n *\n * @example Use a ciphersuite which is currently not supported by Web Cryptography API.\n *\n * ```ts\n * import { Aes128Gcm, HkdfSha256, CipherSuite } from \"@hpke/core\";\n * // Use an extension module.\n * import { DhkemX25519HkdfSha256 } from \"@hpke/dhkem-x25519\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemX25519HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class CipherSuiteNative extends NativeAlgorithm {\n    /**\n     * @param params A set of parameters for building a cipher suite.\n     *\n     * If the error occurred, throws {@link InvalidParamError}.\n     *\n     * @throws {@link InvalidParamError}\n     */\n    constructor(params) {\n        super();\n        Object.defineProperty(this, \"_kem\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_kdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_aead\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_suiteId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // KEM\n        if (typeof params.kem === \"number\") {\n            throw new InvalidParamError(\"KemId cannot be used\");\n        }\n        this._kem = params.kem;\n        // KDF\n        if (typeof params.kdf === \"number\") {\n            throw new InvalidParamError(\"KdfId cannot be used\");\n        }\n        this._kdf = params.kdf;\n        // AEAD\n        if (typeof params.aead === \"number\") {\n            throw new InvalidParamError(\"AeadId cannot be used\");\n        }\n        this._aead = params.aead;\n        this._suiteId = new Uint8Array(SUITE_ID_HEADER_HPKE);\n        this._suiteId.set(i2Osp(this._kem.id, 2), 4);\n        this._suiteId.set(i2Osp(this._kdf.id, 2), 6);\n        this._suiteId.set(i2Osp(this._aead.id, 2), 8);\n        this._kdf.init(this._suiteId);\n    }\n    /**\n     * Gets the KEM context of the ciphersuite.\n     */\n    get kem() {\n        return this._kem;\n    }\n    /**\n     * Gets the KDF context of the ciphersuite.\n     */\n    get kdf() {\n        return this._kdf;\n    }\n    /**\n     * Gets the AEAD context of the ciphersuite.\n     */\n    get aead() {\n        return this._aead;\n    }\n    /**\n     * Creates an encryption context for a sender.\n     *\n     * If the error occurred, throws {@link DecapError} | {@link ValidationError}.\n     *\n     * @param params A set of parameters for the sender encryption context.\n     * @returns A sender encryption context.\n     * @throws {@link EncapError}, {@link ValidationError}\n     */\n    async createSenderContext(params) {\n        this._validateInputLength(params);\n        await this._setup();\n        const dh = await this._kem.encap(params);\n        let mode;\n        if (params.psk !== undefined) {\n            mode = params.senderKey !== undefined ? Mode.AuthPsk : Mode.Psk;\n        }\n        else {\n            mode = params.senderKey !== undefined ? Mode.Auth : Mode.Base;\n        }\n        return await this._keyScheduleS(mode, dh.sharedSecret, dh.enc, params);\n    }\n    /**\n     * Creates an encryption context for a recipient.\n     *\n     * If the error occurred, throws {@link DecapError}\n     * | {@link DeserializeError} | {@link ValidationError}.\n     *\n     * @param params A set of parameters for the recipient encryption context.\n     * @returns A recipient encryption context.\n     * @throws {@link DecapError}, {@link DeserializeError}, {@link ValidationError}\n     */\n    async createRecipientContext(params) {\n        this._validateInputLength(params);\n        await this._setup();\n        const sharedSecret = await this._kem.decap(params);\n        let mode;\n        if (params.psk !== undefined) {\n            mode = params.senderPublicKey !== undefined ? Mode.AuthPsk : Mode.Psk;\n        }\n        else {\n            mode = params.senderPublicKey !== undefined ? Mode.Auth : Mode.Base;\n        }\n        return await this._keyScheduleR(mode, sharedSecret, params);\n    }\n    /**\n     * Encrypts a message to a recipient.\n     *\n     * If the error occurred, throws `EncapError` | `MessageLimitReachedError` | `SealError` | `ValidationError`.\n     *\n     * @param params A set of parameters for building a sender encryption context.\n     * @param pt A plain text as bytes to be encrypted.\n     * @param aad Additional authenticated data as bytes fed by an application.\n     * @returns A cipher text and an encapsulated key as bytes.\n     * @throws {@link EncapError}, {@link MessageLimitReachedError}, {@link SealError}, {@link ValidationError}\n     */\n    async seal(params, pt, aad = EMPTY.buffer) {\n        const ctx = await this.createSenderContext(params);\n        return {\n            ct: await ctx.seal(pt, aad),\n            enc: ctx.enc,\n        };\n    }\n    /**\n     * Decrypts a message from a sender.\n     *\n     * If the error occurred, throws `DecapError` | `DeserializeError` | `OpenError` | `ValidationError`.\n     *\n     * @param params A set of parameters for building a recipient encryption context.\n     * @param ct An encrypted text as bytes to be decrypted.\n     * @param aad Additional authenticated data as bytes fed by an application.\n     * @returns A decrypted plain text as bytes.\n     * @throws {@link DecapError}, {@link DeserializeError}, {@link OpenError}, {@link ValidationError}\n     */\n    async open(params, ct, aad = EMPTY.buffer) {\n        const ctx = await this.createRecipientContext(params);\n        return await ctx.open(ct, aad);\n    }\n    // private verifyPskInputs(mode: Mode, params: KeyScheduleParams) {\n    //   const gotPsk = (params.psk !== undefined);\n    //   const gotPskId = (params.psk !== undefined && params.psk.id.byteLength > 0);\n    //   if (gotPsk !== gotPskId) {\n    //     throw new Error('Inconsistent PSK inputs');\n    //   }\n    //   if (gotPsk && (mode === Mode.Base || mode === Mode.Auth)) {\n    //     throw new Error('PSK input provided when not needed');\n    //   }\n    //   if (!gotPsk && (mode === Mode.Psk || mode === Mode.AuthPsk)) {\n    //     throw new Error('Missing required PSK input');\n    //   }\n    //   return;\n    // }\n    async _keySchedule(mode, sharedSecret, params) {\n        // Currently, there is no point in executing this function\n        // because this hpke library does not allow users to explicitly specify the mode.\n        //\n        // this.verifyPskInputs(mode, params);\n        const pskId = params.psk === undefined\n            ? EMPTY\n            : new Uint8Array(params.psk.id);\n        const pskIdHash = await this._kdf.labeledExtract(EMPTY.buffer, LABEL_PSK_ID_HASH, pskId);\n        const info = params.info === undefined\n            ? EMPTY\n            : new Uint8Array(params.info);\n        const infoHash = await this._kdf.labeledExtract(EMPTY.buffer, LABEL_INFO_HASH, info);\n        const keyScheduleContext = new Uint8Array(1 + pskIdHash.byteLength + infoHash.byteLength);\n        keyScheduleContext.set(new Uint8Array([mode]), 0);\n        keyScheduleContext.set(new Uint8Array(pskIdHash), 1);\n        keyScheduleContext.set(new Uint8Array(infoHash), 1 + pskIdHash.byteLength);\n        const psk = params.psk === undefined\n            ? EMPTY\n            : new Uint8Array(params.psk.key);\n        const ikm = this._kdf.buildLabeledIkm(LABEL_SECRET, psk)\n            .buffer;\n        const exporterSecretInfo = this._kdf.buildLabeledInfo(LABEL_EXP, keyScheduleContext, this._kdf.hashSize).buffer;\n        const exporterSecret = await this._kdf.extractAndExpand(sharedSecret, ikm, exporterSecretInfo, this._kdf.hashSize);\n        if (this._aead.id === AeadId.ExportOnly) {\n            return { aead: this._aead, exporterSecret: exporterSecret };\n        }\n        const keyInfo = this._kdf.buildLabeledInfo(LABEL_KEY, keyScheduleContext, this._aead.keySize).buffer;\n        const key = await this._kdf.extractAndExpand(sharedSecret, ikm, keyInfo, this._aead.keySize);\n        const baseNonceInfo = this._kdf.buildLabeledInfo(LABEL_BASE_NONCE, keyScheduleContext, this._aead.nonceSize).buffer;\n        const baseNonce = await this._kdf.extractAndExpand(sharedSecret, ikm, baseNonceInfo, this._aead.nonceSize);\n        return {\n            aead: this._aead,\n            exporterSecret: exporterSecret,\n            key: key,\n            baseNonce: new Uint8Array(baseNonce),\n            seq: 0,\n        };\n    }\n    async _keyScheduleS(mode, sharedSecret, enc, params) {\n        const res = await this._keySchedule(mode, sharedSecret, params);\n        if (res.key === undefined) {\n            return new SenderExporterContextImpl(this._api, this._kdf, res.exporterSecret, enc);\n        }\n        return new SenderContextImpl(this._api, this._kdf, res, enc);\n    }\n    async _keyScheduleR(mode, sharedSecret, params) {\n        const res = await this._keySchedule(mode, sharedSecret, params);\n        if (res.key === undefined) {\n            return new RecipientExporterContextImpl(this._api, this._kdf, res.exporterSecret);\n        }\n        return new RecipientContextImpl(this._api, this._kdf, res);\n    }\n    _validateInputLength(params) {\n        if (params.info !== undefined &&\n            params.info.byteLength > INFO_LENGTH_LIMIT) {\n            throw new InvalidParamError(\"Too long info\");\n        }\n        if (params.psk !== undefined) {\n            if (params.psk.key.byteLength < MINIMUM_PSK_LENGTH) {\n                throw new InvalidParamError(`PSK must have at least ${MINIMUM_PSK_LENGTH} bytes`);\n            }\n            if (params.psk.key.byteLength > INPUT_LENGTH_LIMIT) {\n                throw new InvalidParamError(\"Too long psk.key\");\n            }\n            if (params.psk.id.byteLength > INPUT_LENGTH_LIMIT) {\n                throw new InvalidParamError(\"Too long psk.id\");\n            }\n        }\n        return;\n    }\n}\n", "import { Dhkem, Ec, HkdfSha256Native, HkdfSha384Native, HkdfSha512Native, KemId, } from \"@hpke/common\";\nexport class DhkemP256HkdfSha256Native extends Dhkem {\n    constructor() {\n        const kdf = new HkdfSha256Native();\n        const prim = new Ec(KemId.DhkemP256HkdfSha256, kdf);\n        super(KemId.DhkemP256HkdfSha256, prim, kdf);\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KemId.DhkemP256HkdfSha256\n        });\n        Object.defineProperty(this, \"secretSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n        Object.defineProperty(this, \"encSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 65\n        });\n        Object.defineProperty(this, \"publicKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 65\n        });\n        Object.defineProperty(this, \"privateKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n    }\n}\nexport class DhkemP384HkdfSha384Native extends Dhkem {\n    constructor() {\n        const kdf = new HkdfSha384Native();\n        const prim = new Ec(KemId.DhkemP384HkdfSha384, kdf);\n        super(KemId.DhkemP384HkdfSha384, prim, kdf);\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KemId.DhkemP384HkdfSha384\n        });\n        Object.defineProperty(this, \"secretSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 48\n        });\n        Object.defineProperty(this, \"encSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 97\n        });\n        Object.defineProperty(this, \"publicKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 97\n        });\n        Object.defineProperty(this, \"privateKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 48\n        });\n    }\n}\nexport class DhkemP521HkdfSha512Native extends Dhkem {\n    constructor() {\n        const kdf = new HkdfSha512Native();\n        const prim = new Ec(KemId.DhkemP521HkdfSha512, kdf);\n        super(KemId.DhkemP521HkdfSha512, prim, kdf);\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KemId.DhkemP521HkdfSha512\n        });\n        Object.defineProperty(this, \"secretSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 64\n        });\n        Object.defineProperty(this, \"encSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 133\n        });\n        Object.defineProperty(this, \"publicKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 133\n        });\n        Object.defineProperty(this, \"privateKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 64\n        });\n    }\n}\n", "import { HkdfSha256Native, HkdfSha384Native, HkdfSha512Native, } from \"@hpke/common\";\nimport { CipherSuiteNative } from \"./cipherSuiteNative.js\";\nimport { DhkemP256HkdfSha256Native, DhkemP384HkdfSha384Native, DhkemP521HkdfSha512Native, } from \"./kems/dhkemNative.js\";\n/**\n * The Hybrid Public Key Encryption (HPKE) ciphersuite,\n * which is implemented using only\n * {@link https://www.w3.org/TR/WebCryptoAPI/ | Web Cryptography API}.\n *\n * This class is the same as\n * {@link https://jsr.io/@hpke/core/doc/~/CipherSuiteNative | @hpke/core#CipherSuiteNative} as follows:\n * which supports only the ciphersuites that can be implemented on the native\n * {@link https://www.w3.org/TR/WebCryptoAPI/ | Web Cryptography API}.\n * Therefore, the following cryptographic algorithms are not supported for now:\n * - `DHKEM(X25519, HKDF-SHA256)`\n * - `DHKEM(X448, HKDF-SHA512)`\n * - `ChaCha20Poly1305`\n *\n * In addtion, the HKDF functions contained in this `CipherSuiteNative`\n * class can only derive keys of the same length as the `hashSize`.\n *\n * If you want to use the unsupported cryptographic algorithms\n * above or derive keys longer than the `hashSize`,\n * please use {@link https://jsr.io/@hpke/hpke-js/doc/~/CipherSuite | hpke-js#CipherSuite}.\n *\n * This class provides following functions:\n *\n * - Creates encryption contexts both for senders and recipients.\n *     - {@link createSenderContext}\n *     - {@link createRecipientContext}\n * - Provides single-shot encryption API.\n *     - {@link seal}\n *     - {@link open}\n *\n * The calling of the constructor of this class is the starting\n * point for HPKE operations for both senders and recipients.\n *\n * @example Use only ciphersuites supported by Web Cryptography API.\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n *   CipherSuite,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n *\n * @example Use a ciphersuite which is currently not supported by Web Cryptography API.\n *\n * ```ts\n * import { Aes128Gcm, HkdfSha256, CipherSuite } from \"@hpke/core\";\n * import { DhkemX25519HkdfSha256 } from \"@hpke/dhkem-x25519\";\n * const suite = new CipherSuite({\n *   kem: new DhkemX25519HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class CipherSuite extends CipherSuiteNative {\n}\n/**\n * The DHKEM(P-256, HKDF-SHA256) for HPKE KEM implementing {@link KemInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KemId.DhkemP256HkdfSha256`\n * as follows:\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class DhkemP256HkdfSha256 extends DhkemP256HkdfSha256Native {\n}\n/**\n * The DHKEM(P-384, HKDF-SHA384) for HPKE KEM implementing {@link KemInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KemId.DhkemP384HkdfSha384`\n * as follows:\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   DhkemP384HkdfSha384,\n *   HkdfSha384,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP384HkdfSha384(),\n *   kdf: new HkdfSha384(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class DhkemP384HkdfSha384 extends DhkemP384HkdfSha384Native {\n}\n/**\n * The DHKEM(P-521, HKDF-SHA512) for HPKE KEM implementing {@link KemInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KemId.DhkemP521HkdfSha512`\n * as follows:\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes256Gcm,\n *   CipherSuite,\n *   DhkemP521HkdfSha512,\n *   HkdfSha512,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP521HkdfSha512(),\n *   kdf: new HkdfSha512(),\n *   aead: new Aes256Gcm(),\n * });\n * ```\n */\nexport class DhkemP521HkdfSha512 extends DhkemP521HkdfSha512Native {\n}\n/**\n * The HKDF-SHA256 for HPKE KDF implementing {@link KdfInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KdfId.HkdfSha256`.\n *\n * The KDF class can only derive keys of the same length as the `hashSize`.\n * If you want to derive keys longer than the `hashSize`,\n * please use {@link https://jsr.io/@hpke/hpke-js/doc/~/CipherSuite | hpke-js#CipherSuite}.\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   DhkemP256HkdfSha256,\n *   HkdfSha256,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP256HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class HkdfSha256 extends HkdfSha256Native {\n}\n/**\n * The HKDF-SHA384 for HPKE KDF implementing {@link KdfInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KdfId.HkdfSha384`.\n *\n * The KDF class can only derive keys of the same length as the `hashSize`.\n * If you want to derive keys longer than the `hashSize`,\n * please use {@link https://jsr.io/@hpke/hpke-js/doc/~/CipherSuite | hpke-js#CipherSuite}.\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   DhkemP384HkdfSha384,\n *   HkdfSha384,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP384HkdfSha384(),\n *   kdf: new HkdfSha384(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class HkdfSha384 extends HkdfSha384Native {\n}\n/**\n * The HKDF-SHA512 for HPKE KDF implementing {@link KdfInterface}.\n *\n * When using `@hpke/core`, the instance of this class must be specified\n * to the `kem` parameter of {@link CipherSuiteParams} instead of `KdfId.HkdfSha512`.\n *\n * The KDF class can only derive keys of the same length as the `hashSize`.\n * If you want to derive keys longer than the `hashSize`,\n * please use {@link https://jsr.io/@hpke/hpke-js/doc/~/CipherSuite | hpke-js#CipherSuite}.\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes256Gcm,\n *   CipherSuite,\n *   DhkemP521HkdfSha512,\n *   HkdfSha512,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemP521HkdfSha512(),\n *   kdf: new HkdfSha512(),\n *   aead: new Aes256Gcm(),\n * });\n * ```\n */\nexport class HkdfSha512 extends HkdfSha512Native {\n}\n", "import { base64UrlToBytes, DeriveKeyPairError, DeserializeError, EMPTY, KEM_USAGES, LABEL_DKP_PRK, LABEL_SK, NativeAlgorithm, NotSupportedError, SerializeError, } from \"@hpke/common\";\nconst ALG_NAME = \"X25519\";\n// deno-fmt-ignore\nconst PKCS8_ALG_ID_X25519 = new Uint8Array([\n    0x30, 0x2e, 0x02, 0x01, 0x00, 0x30, 0x05, 0x06,\n    0x03, 0x2b, 0x65, 0x6e, 0x04, 0x22, 0x04, 0x20,\n]);\nexport class X25519 extends NativeAlgorithm {\n    constructor(hkdf) {\n        super();\n        Object.defineProperty(this, \"_hkdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_alg\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nPk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nSk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nDh\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_pkcs8AlgId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._alg = { name: ALG_NAME };\n        this._hkdf = hkdf;\n        this._nPk = 32;\n        this._nSk = 32;\n        this._nDh = 32;\n        this._pkcs8AlgId = PKCS8_ALG_ID_X25519;\n    }\n    async serializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._api.exportKey(\"raw\", key);\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, true);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async serializePrivateKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            if (!(\"d\" in jwk)) {\n                throw new Error(\"Not private key\");\n            }\n            return base64UrlToBytes(jwk[\"d\"]).buffer;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePrivateKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, false);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async importKey(format, key, isPublic) {\n        await this._setup();\n        try {\n            if (format === \"raw\") {\n                return await this._importRawKey(key, isPublic);\n            }\n            // jwk\n            if (key instanceof ArrayBuffer) {\n                throw new Error(\"Invalid jwk key format\");\n            }\n            return await this._importJWK(key, isPublic);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async generateKeyPair() {\n        await this._setup();\n        try {\n            return await this._api.generateKey(ALG_NAME, true, KEM_USAGES);\n        }\n        catch (e) {\n            throw new NotSupportedError(e);\n        }\n    }\n    async deriveKeyPair(ikm) {\n        await this._setup();\n        try {\n            const dkpPrk = await this._hkdf.labeledExtract(EMPTY.buffer, LABEL_DKP_PRK, new Uint8Array(ikm));\n            const rawSk = await this._hkdf.labeledExpand(dkpPrk, LABEL_SK, EMPTY, this._nSk);\n            const rawSkBytes = new Uint8Array(rawSk);\n            const sk = await this._deserializePkcs8Key(rawSkBytes);\n            rawSkBytes.fill(0);\n            return {\n                privateKey: sk,\n                publicKey: await this.derivePublicKey(sk),\n            };\n        }\n        catch (e) {\n            throw new DeriveKeyPairError(e);\n        }\n    }\n    async derivePublicKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            delete jwk[\"d\"];\n            delete jwk[\"key_ops\"];\n            return await this._api.importKey(\"jwk\", jwk, this._alg, true, []);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async dh(sk, pk) {\n        await this._setup();\n        try {\n            const bits = await this._api.deriveBits({\n                name: ALG_NAME,\n                public: pk,\n            }, sk, this._nDh * 8);\n            return bits;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async _importRawKey(key, isPublic) {\n        if (isPublic && key.byteLength !== this._nPk) {\n            throw new Error(\"Invalid public key for the ciphersuite\");\n        }\n        if (!isPublic && key.byteLength !== this._nSk) {\n            throw new Error(\"Invalid private key for the ciphersuite\");\n        }\n        if (isPublic) {\n            return await this._api.importKey(\"raw\", key, this._alg, true, []);\n        }\n        return await this._deserializePkcs8Key(new Uint8Array(key));\n    }\n    async _importJWK(key, isPublic) {\n        if (typeof key.kty === \"undefined\" || key.kty !== \"OKP\") {\n            throw new Error(`Invalid kty: ${key.crv}`);\n        }\n        if (typeof key.crv === \"undefined\" || key.crv !== ALG_NAME) {\n            throw new Error(`Invalid crv: ${key.crv}`);\n        }\n        if (isPublic) {\n            if (typeof key.d !== \"undefined\") {\n                throw new Error(\"Invalid key: `d` should not be set\");\n            }\n            return await this._api.importKey(\"jwk\", key, this._alg, true, []);\n        }\n        if (typeof key.d === \"undefined\") {\n            throw new Error(\"Invalid key: `d` not found\");\n        }\n        return await this._api.importKey(\"jwk\", key, this._alg, true, KEM_USAGES);\n    }\n    async _deserializePkcs8Key(k) {\n        const pkcs8Key = new Uint8Array(this._pkcs8AlgId.length + k.length);\n        pkcs8Key.set(this._pkcs8AlgId, 0);\n        pkcs8Key.set(k, this._pkcs8AlgId.length);\n        return await this._api.importKey(\"pkcs8\", pkcs8Key, this._alg, true, KEM_USAGES);\n    }\n}\n", "import { Dhkem, HkdfSha256Native, KemId } from \"@hpke/common\";\nimport { X25519 } from \"./dhkemPrimitives/x25519.js\";\n/**\n * The DHKEM(X25519, HKDF-SHA256) for HPKE KEM implementing {@link KemInterface}.\n *\n * The instance of this class can be specified to the\n * {@link https://jsr.io/@hpke/core/doc/~/CipherSuiteParams | CipherSuiteParams} as follows:\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes128Gcm,\n *   CipherSuite,\n *   HkdfSha256,\n *   DhkemX25519HkdfSha256,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemX25519HkdfSha256(),\n *   kdf: new HkdfSha256(),\n *   aead: new Aes128Gcm(),\n * });\n * ```\n */\nexport class DhkemX25519HkdfSha256 extends Dhkem {\n    constructor() {\n        const kdf = new HkdfSha256Native();\n        super(KemId.DhkemX25519HkdfSha256, new X25519(kdf), kdf);\n        /** KemId.DhkemX25519HkdfSha256 (0x0020) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KemId.DhkemX25519HkdfSha256\n        });\n        /** 32 */\n        Object.defineProperty(this, \"secretSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n        /** 32 */\n        Object.defineProperty(this, \"encSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n        /** 32 */\n        Object.defineProperty(this, \"publicKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n        /** 32 */\n        Object.defineProperty(this, \"privateKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 32\n        });\n    }\n}\n", "import { base64UrlToBytes, DeriveKeyPairError, DeserializeError, EMPTY, KEM_USAGES, LABEL_DKP_PRK, LABEL_SK, NativeAlgorithm, NotSupportedError, SerializeError, } from \"@hpke/common\";\nconst ALG_NAME = \"X448\";\n// deno-fmt-ignore\nconst PKCS8_ALG_ID_X448 = new Uint8Array([\n    0x30, 0x46, 0x02, 0x01, 0x00, 0x30, 0x05, 0x06,\n    0x03, 0x2b, 0x65, 0x6f, 0x04, 0x3a, 0x04, 0x38,\n]);\nexport class X448 extends NativeAlgorithm {\n    constructor(hkdf) {\n        super();\n        Object.defineProperty(this, \"_hkdf\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_alg\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nPk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nSk\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nDh\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_pkcs8AlgId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this._alg = { name: ALG_NAME };\n        this._hkdf = hkdf;\n        this._nPk = 56;\n        this._nSk = 56;\n        this._nDh = 56;\n        this._pkcs8AlgId = PKCS8_ALG_ID_X448;\n    }\n    async serializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._api.exportKey(\"raw\", key);\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePublicKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, true);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async serializePrivateKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            if (!(\"d\" in jwk)) {\n                throw new Error(\"Not private key\");\n            }\n            return base64UrlToBytes(jwk[\"d\"]).buffer;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async deserializePrivateKey(key) {\n        await this._setup();\n        try {\n            return await this._importRawKey(key, false);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async importKey(format, key, isPublic) {\n        await this._setup();\n        try {\n            if (format === \"raw\") {\n                return await this._importRawKey(key, isPublic);\n            }\n            // jwk\n            if (key instanceof ArrayBuffer) {\n                throw new Error(\"Invalid jwk key format\");\n            }\n            return await this._importJWK(key, isPublic);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async generateKeyPair() {\n        await this._setup();\n        try {\n            return await this._api.generateKey(ALG_NAME, true, KEM_USAGES);\n        }\n        catch (e) {\n            throw new NotSupportedError(e);\n        }\n    }\n    async deriveKeyPair(ikm) {\n        await this._setup();\n        try {\n            const dkpPrk = await this._hkdf.labeledExtract(EMPTY.buffer, LABEL_DKP_PRK, new Uint8Array(ikm));\n            const rawSk = await this._hkdf.labeledExpand(dkpPrk, LABEL_SK, EMPTY, this._nSk);\n            const rawSkBytes = new Uint8Array(rawSk);\n            const sk = await this._deserializePkcs8Key(rawSkBytes);\n            rawSkBytes.fill(0);\n            return {\n                privateKey: sk,\n                publicKey: await this.derivePublicKey(sk),\n            };\n        }\n        catch (e) {\n            throw new DeriveKeyPairError(e);\n        }\n    }\n    async derivePublicKey(key) {\n        await this._setup();\n        try {\n            const jwk = await this._api.exportKey(\"jwk\", key);\n            delete jwk[\"d\"];\n            delete jwk[\"key_ops\"];\n            return await this._api.importKey(\"jwk\", jwk, this._alg, true, []);\n        }\n        catch (e) {\n            throw new DeserializeError(e);\n        }\n    }\n    async dh(sk, pk) {\n        await this._setup();\n        try {\n            const bits = await this._api.deriveBits({\n                name: ALG_NAME,\n                public: pk,\n            }, sk, this._nDh * 8);\n            return bits;\n        }\n        catch (e) {\n            throw new SerializeError(e);\n        }\n    }\n    async _importRawKey(key, isPublic) {\n        if (isPublic && key.byteLength !== this._nPk) {\n            throw new Error(\"Invalid public key for the ciphersuite\");\n        }\n        if (!isPublic && key.byteLength !== this._nSk) {\n            throw new Error(\"Invalid private key for the ciphersuite\");\n        }\n        if (isPublic) {\n            return await this._api.importKey(\"raw\", key, this._alg, true, []);\n        }\n        return await this._deserializePkcs8Key(new Uint8Array(key));\n    }\n    async _importJWK(key, isPublic) {\n        if (typeof key.kty === \"undefined\" || key.kty !== \"OKP\") {\n            throw new Error(`Invalid kty: ${key.crv}`);\n        }\n        if (typeof key.crv === \"undefined\" || key.crv !== ALG_NAME) {\n            throw new Error(`Invalid crv: ${key.crv}`);\n        }\n        if (isPublic) {\n            if (typeof key.d !== \"undefined\") {\n                throw new Error(\"Invalid key: `d` should not be set\");\n            }\n            return await this._api.importKey(\"jwk\", key, this._alg, true, []);\n        }\n        if (typeof key.d === \"undefined\") {\n            throw new Error(\"Invalid key: `d` not found\");\n        }\n        return await this._api.importKey(\"jwk\", key, this._alg, true, KEM_USAGES);\n    }\n    async _deserializePkcs8Key(k) {\n        const pkcs8Key = new Uint8Array(this._pkcs8AlgId.length + k.length);\n        pkcs8Key.set(this._pkcs8AlgId, 0);\n        pkcs8Key.set(k, this._pkcs8AlgId.length);\n        return await this._api.importKey(\"pkcs8\", pkcs8Key, this._alg, true, KEM_USAGES);\n    }\n}\n", "import { Dhkem, HkdfSha512Native, KemId } from \"@hpke/common\";\nimport { X448 } from \"./dhkemPrimitives/x448.js\";\n/**\n * The DHKEM(X448, HKDF-SHA512) for HPKE KEM implementing {@link KemInterface}.\n *\n * The instance of this class can be specified to the\n * {@link https://jsr.io/@hpke/core/doc/~/CipherSuiteParams | CipherSuiteParams} as follows:\n *\n * @example\n *\n * ```ts\n * import {\n *   Aes256Gcm,\n *   CipherSuite,\n *   HkdfSha512,\n *   DhkemX448HkdfSha512,\n * } from \"@hpke/core\";\n *\n * const suite = new CipherSuite({\n *   kem: new DhkemX448HkdfSha512(),\n *   kdf: new HkdfSha512(),\n *   aead: new Aes256Gcm(),\n * });\n * ```\n */\nexport class DhkemX448HkdfSha512 extends Dhkem {\n    constructor() {\n        const kdf = new HkdfSha512Native();\n        super(KemId.DhkemX448HkdfSha512, new X448(kdf), kdf);\n        /** KemId.DhkemX448HkdfSha512 (0x0021) */\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: KemId.DhkemX448HkdfSha512\n        });\n        /** 64 */\n        Object.defineProperty(this, \"secretSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 64\n        });\n        /** 56 */\n        Object.defineProperty(this, \"encSize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 56\n        });\n        /** 56 */\n        Object.defineProperty(this, \"publicKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 56\n        });\n        /** 56 */\n        Object.defineProperty(this, \"privateKeySize\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 56\n        });\n    }\n}\n", null, null, null, null, null, null, null, null, null, null, null, null, "import { openDB, deleteDB, wrap, unwrap, type IDBPDatabase, type IDBPObjectStore } from \"idb\";\nimport { type APKeyPackage, type IDBKeyPackage, NewAPKeyPackage } from \"../type/keyPackage\"\n\nimport { \n\ttype Credential,\n\ttype KeyPackage,\n\ttype PrivateKeyPackage,\n\n\tdefaultCapabilities,\n\tdefaultLifetime,\n\tgenerateKeyPackage, \n\tgetCiphersuiteImpl,\n\tgetCiphersuiteFromName\n} from \"ts-mls\"\nimport type { ActivityPubService } from \"./activityPub\";\n\n// This is the KeyPackage service, that manages all interactions with KeyPackages in the\n// local indexedDB database\nexport class KeyPackageService {\n\n\t// All class #properties are PRIVATE\n\t#activityPub: ActivityPubService\n\t#database: IDBPDatabase | undefined\n\t#keyPackages: IDBKeyPackage[] = []\n\t#actorID: string = \"\"\n\n\tconstructor(activityPub: ActivityPubService) {\n\t\tthis.#activityPub = activityPub\n\t}\n\n\tasync start(actorID: string) {\n\n\t\tthis.#actorID = actorID\n\n\t\t// Set up the database connection\n\t\tthis.#database = await openDB(\"KeyPackage\", 1, {\n\t\t\tupgrade: (db, oldVersion, _newVersion, transaction, event) => {\n\n\t\t\t\tif (oldVersion == 0) {\n\t\t\t\t\tvar keyPackages = db.createObjectStore(\"KeyPackage\")\n\t\t\t\t\tkeyPackages.createIndex(\"KeyPackage_id\", [\"id\"])\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\t// Load all KeyPackages from the IndexedDB\n\t\tconst transaction = this.#database.transaction(\"KeyPackage\", \"readwrite\")\n\t\tthis.#keyPackages = await transaction.store.getAll()\n\n\t\t// IF empty, create/sync a new KeyPackage\n\t\tif (this.#keyPackages.length == 0) {\n\t\t\tthis.createKeyPackage()\n\t\t}\n\t}\n\n\t// createKeyPackage creates a new KeyPackage and\n\t// synchronizes it with the server.\n\tprivate async createKeyPackage() {\n\n\t\tif (this.#database == undefined) {\n\t\t\treturn\n\t\t}\n\n\t\t// Create a new KeyPackage\n\t\tconst implementation = await getCiphersuiteImpl(getCiphersuiteFromName(\"MLS_128_DHKEMX25519_AES128GCM_SHA256_Ed25519\"))\n\n\t\tconst credential: Credential = {\n\t\t\tcredentialType: \"basic\", \n\t\t\tidentity: new TextEncoder().encode(\"alice\"),\n\t\t}\n\n\t\tvar newPackage = await generateKeyPackage(\n\t\t\tcredential, \n\t\t\tdefaultCapabilities(), \n\t\t\tdefaultLifetime, \n\t\t\t[], \n\t\t\timplementation,\n\t\t)\n\n\t\t// Create a new KeyPackage and send it to the Server\n\t\tvar remotePackage = NewAPKeyPackage(this.#actorID, newPackage.publicPackage)\n\t\tvar [remotePackage, err] = await this.#activityPub.createObject(remotePackage)\n\n\t\tif (err != \"\") {\n\t\t\tconsole.log(err)\n\t\t\treturn \n\t\t}\n\n\t\tconsole.log(remotePackage)\n\n\t\t// Create a new LOCAL record for this KeyPackage\n\t\tconst localPackage: IDBKeyPackage = {\n\t\t\tid: remotePackage.id,\n\t\t\tprivatePackage: newPackage.privatePackage,\n\t\t\tpublicPackage: newPackage.publicPackage,\n\t\t}\n\n\t\tconsole.log(localPackage)\n\n\t\t// Add the KeyPackage to the IndexedDB\n\t\tthis.#database.add(\"KeyPackage\", localPackage, localPackage.id)\n\t}\n}", "import { ActivityPubService } from \"./activityPub\"\nimport { KeyPackageService } from \"./keyPackage\"\nimport { type APActor } from \"../type/actor\"\n\nexport class ServiceFactory {\n\n\t// All class #properties are PRIVATE\n\t#actor: APActor | {} = {}\n\t#activityPub: ActivityPubService\n\t#keyPackage: KeyPackageService\n\n\tconstructor() {\n\t\tthis.#activityPub = new ActivityPubService()\n\t\tthis.#keyPackage = new KeyPackageService(this.#activityPub)\n\t}\n\n\tasync start() {\n\t\tconst actor = await this.loadActor()\n\t\tthis.#actor = actor\n\n\t\tawait this.#activityPub.start(actor.id)\n\t\tawait this.#keyPackage.start(actor.id)\n\t}\n\n\tasync loadActor(): Promise<APActor> {\n\n\t\tconst response = await fetch(\"http://localhost/@me\", {\n\t\t\theaders: [[\"Accept\", \"application/json\"]],\n\t\t\tcredentials: \"same-origin\",\n\t\t})\n\n\t\tconst result = await response.json()\n\n\t\tif (typeof result == \"object\") {\n\t\t\treturn result\n\t\t}\n\n\t\treturn {\n\t\t\tid:\"\",\n\t\t\tname:\"\",\n\t\t\tinbox:\"\",\n\t\t\tkeyPackages: {\n\t\t\t\ttype:\"Collection\",\n\t\t\t\tid:\"\",\n\t\t\t\titems:[]\n\t\t\t}\n\t\t}\n\t}\n}", "import m from \"mithril\"\nimport { type ServiceFactory} from \"./service/factory\"\n\nexport class ViewContainer {\n\n\t// All class #properties are PRIVATE\n\t#factory: ServiceFactory\n\n\tconstructor(factory:ServiceFactory) {\n\t\tconsole.log(factory)\n\t\tthis.#factory = factory\n\t}\n\n\tpublic view() {\n\t\treturn <div class=\"flex-row\">\n\t\t\t<div class=\"table no-top-border width-25% flex-shrink-0 scroll-vertical\" style=\"background-color:var(--gray10); view-transition-name:second-sidebar;\">\n\n\t\t\t\t<div\n\t\t\t\t\trole=\"button\"\n\t\t\t\t\tclass=\"link conversation-selector pos-relative padding-horizontal-sm flex-row flex-align-center\">\n\n\t\t\t\t\t<div class=\"width-32 flex-shrink-0 flex-center\">\n\t\t\t\t\t\t<div class=\"circle width-32 flex-shrink-0 flex-center\" style=\"font-size:24px;background-color:var(--blue50);color:var(--white);\">+</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ellipsis-block\" style=\"max-height:3em;\">New Conversation</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div>Convo 1</div>\n\t\t\t\t<div>Convo 2</div>\n\t\t\t\t<div>Convo 3</div>\n\t\t\t</div>\n\t\t\t<div class=\"width-75%\">\n\t\t\t\tHere be details...\n\t\t\t</div>\n\t\t</div>\n\t}\n}"],
  "mappings": "m4BAAA,IAAAA,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,SAASC,GAAMC,EAAKC,EAAKC,EAAOC,EAAUC,EAAMC,EAAK,CACpD,MAAO,CAAC,IAAKL,EAAK,IAAKC,EAAK,MAAOC,EAAO,SAAUC,EAAU,KAAMC,EAAM,IAAKC,EAAK,GAAI,OAAW,QAAS,OAAW,MAAO,OAAW,OAAQ,OAAW,SAAU,MAAS,CAChL,CACAN,GAAM,UAAY,SAASO,EAAM,CAChC,OAAI,MAAM,QAAQA,CAAI,EAAUP,GAAM,IAAK,OAAW,OAAWA,GAAM,kBAAkBO,CAAI,EAAG,OAAW,MAAS,EAChHA,GAAQ,MAAQ,OAAOA,GAAS,UAAkB,KAClD,OAAOA,GAAS,SAAiBA,EAC9BP,GAAM,IAAK,OAAW,OAAW,OAAOO,CAAI,EAAG,OAAW,MAAS,CAC3E,EACAP,GAAM,kBAAoB,SAASQ,EAAO,CASzC,QANIJ,EAAW,IAAI,MAAMI,EAAM,MAAM,EAKjCC,EAAW,EACNC,EAAI,EAAGA,EAAIF,EAAM,OAAQE,IACjCN,EAASM,CAAC,EAAIV,GAAM,UAAUQ,EAAME,CAAC,CAAC,EAClCN,EAASM,CAAC,IAAM,MAAQN,EAASM,CAAC,EAAE,KAAO,MAAMD,IAEtD,GAAIA,IAAa,GAAKA,IAAaD,EAAM,OACxC,MAAM,IAAI,UAAUJ,EAAS,SAAS,IAAI,EACvC,gLACA,mEACH,EAED,OAAOA,CACR,EAEAL,GAAO,QAAUC,KCjCjB,IAAAW,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAQ,KAWZD,GAAO,QAAU,SAASE,EAAOC,EAAU,CAC1C,OAAID,GAAS,MAAQ,OAAOA,GAAU,UAAYA,EAAM,KAAO,MAAQ,CAAC,MAAM,QAAQA,CAAK,EACtFC,EAAS,SAAW,GAAK,MAAM,QAAQA,EAAS,CAAC,CAAC,IAAGA,EAAWA,EAAS,CAAC,IAE9EA,EAAWA,EAAS,SAAW,GAAK,MAAM,QAAQD,CAAK,EAAIA,EAAQ,CAACA,EAAO,GAAGC,CAAQ,EACtFD,EAAQ,QAGFD,GAAM,GAAIC,GAASA,EAAM,IAAKA,EAAOC,CAAQ,CACrD,ICtBA,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAGAA,GAAO,QAAU,CAAC,EAAE,iBCHpB,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAGAA,GAAO,QAAU,CAAC,ICHlB,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAa,KASjBD,GAAO,QAAU,IAAI,IAAI,CAAC,CAACC,GAAY,EAAI,CAAC,CAAC,ICX7C,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAQ,KACRC,GAAmB,KACnBC,GAAS,KACTC,GAAa,KACbC,GAAyB,KAEzBC,GAAiB,+EACjBC,GAAgB,OAAO,OAAO,IAAI,EAEtC,SAASC,GAAQC,EAAQ,CACxB,QAASC,KAAOD,EAAQ,GAAIN,GAAO,KAAKM,EAAQC,CAAG,EAAG,MAAO,GAC7D,MAAO,EACR,CAEA,SAASC,GAAmBD,EAAK,CAChC,OAAOA,IAAQ,SAAWA,IAAQ,WAAaA,IAAQ,iBAAmBA,IAAQ,UACnF,CAEA,SAASE,GAAgBC,EAAU,CAElC,QADIC,EAAOC,EAAM,MAAOC,EAAU,CAAC,EAAGC,EAAQ,CAAC,EAAGC,EAAW,GACtDJ,EAAQR,GAAe,KAAKO,CAAQ,GAAG,CAC7C,IAAIM,EAAOL,EAAM,CAAC,EAAGM,EAAQN,EAAM,CAAC,EACpC,GAAIK,IAAS,IAAMC,IAAU,GAAIL,EAAMK,UAC9BD,IAAS,IAAKF,EAAM,GAAKG,UACzBD,IAAS,IAAKH,EAAQ,KAAKI,CAAK,UAChCN,EAAM,CAAC,EAAE,CAAC,IAAM,IAAK,CAC7B,IAAIO,EAAYP,EAAM,CAAC,EACnBO,IAAWA,EAAYA,EAAU,QAAQ,YAAa,IAAI,EAAE,QAAQ,QAAS,IAAI,GACjFP,EAAM,CAAC,IAAM,QAASE,EAAQ,KAAKK,CAAS,GAE/CJ,EAAMH,EAAM,CAAC,CAAC,EAAIO,IAAc,GAAKA,EAAYA,GAAa,GAC1DV,GAAmBG,EAAM,CAAC,CAAC,IAAGI,EAAW,IAE/C,CACD,CACA,OAAIF,EAAQ,OAAS,IAAGC,EAAM,UAAYD,EAAQ,KAAK,GAAG,GACtDR,GAAQS,CAAK,EAAGA,EAAQb,GACvBC,GAAuB,IAAIY,EAAOC,CAAQ,EACxCX,GAAcM,CAAQ,EAAI,CAAC,IAAKE,EAAK,MAAOE,EAAO,GAAIA,EAAM,EAAE,CACvE,CAEA,SAASK,GAAaC,EAAOC,EAAO,CACnCA,EAAM,IAAMD,EAAM,IAElB,IAAIN,EAAQO,EAAM,MAClB,GAAIP,GAAS,KACZ,OAAAO,EAAM,MAAQD,EAAM,MACpBC,EAAM,GAAKD,EAAM,GACVC,EAQR,GALIrB,GAAO,KAAKc,EAAO,OAAO,IACzBA,EAAM,OAAS,OAAMA,EAAM,UAAYA,EAAM,OACjDA,EAAM,MAAQ,MAGXM,EAAM,QAAUnB,GAAY,CAC/B,IAAIqB,EAAYR,EAAM,UACtBA,EAAQ,OAAO,OAAO,CAAC,EAAGM,EAAM,MAAON,CAAK,EAExCM,EAAM,MAAM,WAAa,OAAMN,EAAM,UACxCQ,GAAa,KACV,OAAOF,EAAM,MAAM,SAAS,EAAI,IAAM,OAAOE,CAAS,EACtDF,EAAM,MAAM,UACjB,CAKA,OAAIA,EAAM,MAAQ,SAAWpB,GAAO,KAAKc,EAAO,MAAM,IACrDA,EAAQ,OAAO,OAAO,CAAC,KAAMA,EAAM,IAAI,EAAGA,CAAK,GAIhDO,EAAM,GAAKP,EAAM,GAEjBO,EAAM,MAAQP,EAEPO,CACR,CAEA,SAASE,GAAYb,EAAUI,KAAUU,EAAU,CAClD,GAAId,GAAY,MAAQ,OAAOA,GAAa,UAAY,OAAOA,GAAa,YAAc,OAAOA,EAAS,MAAS,WAClH,MAAM,MAAM,sDAAsD,EAGnE,IAAIW,EAAQtB,GAAiBe,EAAOU,CAAQ,EAE5C,OAAI,OAAOd,GAAa,WACvBW,EAAM,SAAWvB,GAAM,kBAAkBuB,EAAM,QAAQ,EACnDX,IAAa,KAAYS,GAAaf,GAAcM,CAAQ,GAAKD,GAAgBC,CAAQ,EAAGW,CAAK,GAGlGA,EAAM,OAAS,OAAMA,EAAM,MAAQ,CAAC,GACxCA,EAAM,IAAMX,EACLW,EACR,CAEAxB,GAAO,QAAU0B,KCpGjB,IAAAE,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAQ,KAEZD,GAAO,QAAU,SAASE,EAAM,CAC/B,OAAIA,GAAQ,OAAMA,EAAO,IAClBD,GAAM,IAAK,OAAW,OAAWC,EAAM,OAAW,MAAS,CACnE,ICPA,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAQ,KACRC,GAAmB,KAEvBF,GAAO,QAAU,SAASG,KAAUC,EAAU,CAC7C,IAAIC,EAAQH,GAAiBC,EAAOC,CAAQ,EAE5C,OAAIC,EAAM,OAAS,OAAMA,EAAM,MAAQ,CAAC,GACxCA,EAAM,IAAM,IACZA,EAAM,SAAWJ,GAAM,kBAAkBI,EAAM,QAAQ,EAChDA,CACR,ICZA,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAc,KAElBA,GAAY,MAAQ,KACpBA,GAAY,SAAW,KAEvBD,GAAO,QAAUC,KCPjB,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEAA,GAAO,QAAU,IAAI,UCFrB,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAiB,KAErB,SAAUC,GAAOC,EAAO,CAGvB,IAAIC,EAAMD,EAAM,IACZE,EAAUF,EAAM,QAChBG,EAAaL,GAAe,IAAIG,CAAG,EACvC,GAAIA,GAAO,KAAM,EAAG,CACnB,IAAIG,EAAcH,EAAI,YAElBH,GAAe,IAAIG,CAAG,IAAME,IAC/B,MAAMF,EACNC,KAGDD,EAAMG,CACP,OACOF,EACR,CAEAL,GAAO,QAAUE,KCvBjB,IAAAM,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAQ,KACRC,GAAiB,KACjBC,GAAS,KACTC,GAAyB,KAE7BJ,GAAO,QAAU,UAAW,CAC3B,IAAIK,EAAY,CACf,IAAK,6BACL,KAAM,oCACP,EAEIC,EACAC,EAEJ,SAASC,EAAYC,EAAK,CACzB,OAAOA,EAAI,aACZ,CAEA,SAASC,EAAaC,EAAO,CAC5B,OAAOA,EAAM,OAASA,EAAM,MAAM,OAASN,EAAUM,EAAM,GAAG,CAC/D,CAGA,SAASC,EAAWD,EAAOE,EAAU,CACpC,GAAIF,EAAM,QAAUE,EAAU,MAAM,IAAI,MAAM,qCAAqC,CACpF,CAMA,SAASC,EAASH,EAAO,CACxB,IAAIE,EAAWF,EAAM,MACrB,GAAI,CACH,OAAO,KAAK,MAAME,EAAU,SAAS,CACtC,QAAE,CACDD,EAAWD,EAAOE,CAAQ,CAC3B,CACD,CAIA,SAASE,EAAcN,EAAK,CAC3B,GAAI,CACH,OAAOD,EAAYC,CAAG,EAAE,aACzB,MAAY,CACX,OAAO,IACR,CACD,CAEA,SAASO,EAAYC,EAAQC,EAAQC,EAAOC,EAAKC,EAAOC,EAAaC,GAAI,CACxE,QAASC,GAAIL,EAAOK,GAAIJ,EAAKI,KAAK,CACjC,IAAIb,GAAQO,EAAOM,EAAC,EAChBb,IAAS,MACZc,EAAWR,EAAQN,GAAOU,EAAOE,GAAID,CAAW,CAElD,CACD,CACA,SAASG,EAAWR,EAAQN,EAAOU,EAAOE,EAAID,EAAa,CAC1D,IAAII,EAAMf,EAAM,IAChB,GAAI,OAAOe,GAAQ,SAGlB,OAFAf,EAAM,MAAQ,CAAC,EACXA,EAAM,OAAS,MAAMgB,GAAchB,EAAM,MAAOA,EAAOU,CAAK,EACxDK,EAAK,CACZ,IAAK,IAAKE,EAAWX,EAAQN,EAAOW,CAAW,EAAG,MAClD,IAAK,IAAKO,EAAWZ,EAAQN,EAAOY,EAAID,CAAW,EAAG,MACtD,IAAK,IAAKQ,EAAeb,EAAQN,EAAOU,EAAOE,EAAID,CAAW,EAAG,MACjE,QAASS,EAAcd,EAAQN,EAAOU,EAAOE,EAAID,CAAW,CAC7D,MAEIU,EAAgBf,EAAQN,EAAOU,EAAOE,EAAID,CAAW,CAC3D,CACA,SAASM,EAAWX,EAAQN,EAAOW,EAAa,CAC/CX,EAAM,IAAMH,EAAYS,CAAM,EAAE,eAAeN,EAAM,QAAQ,EAC7DsB,EAAUhB,EAAQN,EAAM,IAAKW,CAAW,CACzC,CACA,IAAIY,EAAkB,CAAC,QAAS,QAAS,MAAO,QAAS,MAAO,QAAS,MAAO,QAAS,GAAI,QAAS,GAAI,KAAM,GAAI,KAAM,SAAU,QAAS,IAAK,UAAU,EAC5J,SAASL,EAAWZ,EAAQN,EAAOY,EAAID,EAAa,CACnD,IAAIa,EAAQxB,EAAM,SAAS,MAAM,eAAe,GAAK,CAAC,EAMlDyB,EAAO5B,EAAYS,CAAM,EAAE,cAAciB,EAAgBC,EAAM,CAAC,CAAC,GAAK,KAAK,EAC3EZ,IAAO,8BACVa,EAAK,UAAY,2CAA+CzB,EAAM,SAAW,SACjFyB,EAAOA,EAAK,YAEZA,EAAK,UAAYzB,EAAM,SAExBA,EAAM,IAAMyB,EAAK,WACjBzB,EAAM,QAAUyB,EAAK,WAAW,OAGhC,QAFIC,GAAW7B,EAAYS,CAAM,EAAE,uBAAuB,EACtDqB,GACGA,GAAQF,EAAK,YACnBC,GAAS,YAAYC,EAAK,EAE3BL,EAAUhB,EAAQoB,GAAUf,CAAW,CACxC,CACA,SAASQ,EAAeb,EAAQN,EAAOU,EAAOE,EAAID,EAAa,CAC9D,IAAIe,EAAW7B,EAAYS,CAAM,EAAE,uBAAuB,EAC1D,GAAIN,EAAM,UAAY,KAAM,CAC3B,IAAI4B,GAAW5B,EAAM,SACrBK,EAAYqB,EAAUE,GAAU,EAAGA,GAAS,OAAQlB,EAAO,KAAME,CAAE,CACpE,CACAZ,EAAM,IAAM0B,EAAS,WACrB1B,EAAM,QAAU0B,EAAS,WAAW,OACpCJ,EAAUhB,EAAQoB,EAAUf,CAAW,CACxC,CACA,SAASS,EAAcd,EAAQN,EAAOU,EAAOE,EAAID,EAAa,CAC7D,IAAII,EAAMf,EAAM,IACZ6B,GAAQ7B,EAAM,MACd8B,GAAK9B,EAAM,GAEfY,EAAKb,EAAaC,CAAK,GAAKY,EAE5B,IAAImB,GAAUnB,EACbkB,GAAKjC,EAAYS,CAAM,EAAE,gBAAgBM,EAAIG,EAAK,CAAC,GAAIe,EAAE,CAAC,EAAIjC,EAAYS,CAAM,EAAE,gBAAgBM,EAAIG,CAAG,EACzGe,GAAKjC,EAAYS,CAAM,EAAE,cAAcS,EAAK,CAAC,GAAIe,EAAE,CAAC,EAAIjC,EAAYS,CAAM,EAAE,cAAcS,CAAG,EAS9F,GARAf,EAAM,IAAM+B,GAERF,IAAS,MACZG,EAAShC,EAAO6B,GAAOjB,CAAE,EAG1BU,EAAUhB,EAAQyB,GAASpB,CAAW,EAElC,CAACsB,EAAwBjC,CAAK,GAC7BA,EAAM,UAAY,KAAM,CAC3B,IAAI4B,GAAW5B,EAAM,SACrBK,EAAY0B,GAASH,GAAU,EAAGA,GAAS,OAAQlB,EAAO,KAAME,CAAE,EAC9DZ,EAAM,MAAQ,UAAY6B,IAAS,MAAMK,GAAmBlC,EAAO6B,EAAK,CAC7E,CAEF,CACA,SAASM,EAAcnC,EAAOU,EAAO,CACpC,IAAI0B,EACJ,GAAI,OAAOpC,EAAM,IAAI,MAAS,WAAY,CAGzC,GAFAA,EAAM,MAAQ,OAAO,OAAOA,EAAM,GAAG,EACrCoC,EAAWpC,EAAM,MAAM,KACnBoC,EAAS,mBAAqB,KAAM,OACxCA,EAAS,kBAAoB,EAC9B,KAAO,CAGN,GAFApC,EAAM,MAAQ,OACdoC,EAAWpC,EAAM,IACboC,EAAS,mBAAqB,KAAM,OACxCA,EAAS,kBAAoB,GAC7BpC,EAAM,MAASA,EAAM,IAAI,WAAa,MAAQ,OAAOA,EAAM,IAAI,UAAU,MAAS,WAAc,IAAIA,EAAM,IAAIA,CAAK,EAAIA,EAAM,IAAIA,CAAK,CACvI,CAIA,GAHAgB,GAAchB,EAAM,MAAOA,EAAOU,CAAK,EACnCV,EAAM,OAAS,MAAMgB,GAAchB,EAAM,MAAOA,EAAOU,CAAK,EAChEV,EAAM,SAAWV,GAAM,UAAUa,EAAS,KAAKH,EAAM,MAAM,KAAMA,CAAK,CAAC,EACnEA,EAAM,WAAaA,EAAO,MAAM,MAAM,wDAAwD,EAClGoC,EAAS,kBAAoB,IAC9B,CACA,SAASf,EAAgBf,EAAQN,EAAOU,EAAOE,EAAID,EAAa,CAC/DwB,EAAcnC,EAAOU,CAAK,EACtBV,EAAM,UAAY,MACrBc,EAAWR,EAAQN,EAAM,SAAUU,EAAOE,EAAID,CAAW,EACzDX,EAAM,IAAMA,EAAM,SAAS,IAC3BA,EAAM,QAAUA,EAAM,SAAS,SAG/BA,EAAM,QAAU,CAElB,CAqGA,SAASqC,EAAY/B,EAAQgC,EAAK/B,EAAQG,EAAOC,EAAaC,EAAI,CACjE,GAAI,EAAA0B,IAAQ/B,GAAU+B,GAAO,MAAQ/B,GAAU,MAC1C,GAAI+B,GAAO,MAAQA,EAAI,SAAW,EAAGjC,EAAYC,EAAQC,EAAQ,EAAGA,EAAO,OAAQG,EAAOC,EAAaC,CAAE,UACrGL,GAAU,MAAQA,EAAO,SAAW,EAAGgC,EAAYjC,EAAQgC,EAAK,EAAGA,EAAI,MAAM,MACjF,CACJ,IAAIE,GAAaF,EAAI,CAAC,GAAK,MAAQA,EAAI,CAAC,EAAE,KAAO,KAC7CG,GAAUlC,EAAO,CAAC,GAAK,MAAQA,EAAO,CAAC,EAAE,KAAO,KAChDC,GAAQ,EAAGkC,GAAW,EAC1B,GAAI,CAACF,GAAY,KAAOE,GAAWJ,EAAI,QAAUA,EAAII,EAAQ,GAAK,MAAMA,KACxE,GAAI,CAACD,GAAS,KAAOjC,GAAQD,EAAO,QAAUA,EAAOC,EAAK,GAAK,MAAMA,KACrE,GAAIgC,KAAeC,GAClBF,EAAYjC,EAAQgC,EAAKI,GAAUJ,EAAI,MAAM,EAC7CjC,EAAYC,EAAQC,EAAQC,GAAOD,EAAO,OAAQG,EAAOC,EAAaC,CAAE,UAC7D6B,GAiBL,CAKN,QAHIE,GAASL,EAAI,OAAS,EAAG7B,GAAMF,EAAO,OAAS,EAAGqC,GAAKC,GAAGC,GAAGC,GAAIC,GAAIC,GAGlEN,IAAUD,IAAYjC,IAAOD,KACnCuC,GAAKT,EAAIK,EAAM,EACfK,GAAKzC,EAAOE,EAAG,EACXsC,GAAG,MAAQC,GAAG,MACdD,KAAOC,IAAIE,EAAW5C,EAAQyC,GAAIC,GAAItC,EAAOC,EAAaC,CAAE,EAC5DoC,GAAG,KAAO,OAAMrC,EAAcqC,GAAG,KACrCL,KAAUlC,KAGX,KAAOkC,IAAUD,IAAYjC,IAAOD,KACnCqC,GAAIP,EAAII,EAAQ,EAChBI,GAAIvC,EAAOC,EAAK,EACZqC,GAAE,MAAQC,GAAE,MAChBJ,KAAYlC,KACRqC,KAAMC,IAAGI,EAAW5C,EAAQuC,GAAGC,GAAGpC,EAAOyC,EAAeb,EAAKI,GAAU/B,CAAW,EAAGC,CAAE,EAG5F,KAAO+B,IAAUD,IAAYjC,IAAOD,IAC/B,EAAAA,KAAUC,IACVoC,GAAE,MAAQG,GAAG,KAAOD,GAAG,MAAQD,GAAE,MACrCG,GAAaE,EAAeb,EAAKI,GAAU/B,CAAW,EACtDyC,EAAQ9C,EAAQyC,GAAIE,EAAU,EAC1BF,KAAOD,IAAGI,EAAW5C,EAAQyC,GAAID,GAAGpC,EAAOuC,GAAYrC,CAAE,EACzD,EAAEJ,IAAS,EAAEC,IAAK2C,EAAQ9C,EAAQuC,GAAGlC,CAAW,EAChDkC,KAAMG,IAAIE,EAAW5C,EAAQuC,GAAGG,GAAItC,EAAOC,EAAaC,CAAE,EAC1DoC,GAAG,KAAO,OAAMrC,EAAcqC,GAAG,KACrCN,KAAYC,KACZI,GAAKT,EAAIK,EAAM,EACfK,GAAKzC,EAAOE,EAAG,EACfoC,GAAIP,EAAII,EAAQ,EAChBI,GAAIvC,EAAOC,EAAK,EAGjB,KAAOmC,IAAUD,IAAYjC,IAAOD,IAC/BuC,GAAG,MAAQC,GAAG,KACdD,KAAOC,IAAIE,EAAW5C,EAAQyC,GAAIC,GAAItC,EAAOC,EAAaC,CAAE,EAC5DoC,GAAG,KAAO,OAAMrC,EAAcqC,GAAG,KACrCL,KAAUlC,KACVsC,GAAKT,EAAIK,EAAM,EACfK,GAAKzC,EAAOE,EAAG,EAEhB,GAAID,GAAQC,GAAK8B,EAAYjC,EAAQgC,EAAKI,GAAUC,GAAS,CAAC,UACrDD,GAAWC,GAAQtC,EAAYC,EAAQC,EAAQC,GAAOC,GAAM,EAAGC,EAAOC,EAAaC,CAAE,MACzF,CAEJ,IAAIyC,GAAsB1C,EAAa2C,GAAe7C,GAAMD,GAAQ,EAAG+C,GAAa,IAAI,MAAMD,EAAY,EAAGE,GAAG,EAAG3C,GAAE,EAAG4C,GAAM,WAAYC,GAAU,EAAGd,GAAKe,GAC5J,IAAK9C,GAAI,EAAGA,GAAIyC,GAAczC,KAAK0C,GAAW1C,EAAC,EAAI,GACnD,IAAKA,GAAIJ,GAAKI,IAAKL,GAAOK,KAAK,CAC1B+B,IAAO,OAAMA,GAAMgB,EAAUtB,EAAKI,GAAUC,GAAS,CAAC,GAC1DK,GAAKzC,EAAOM,EAAC,EACb,IAAIgD,GAAWjB,GAAII,GAAG,GAAG,EACrBa,IAAY,OACfJ,GAAOI,GAAWJ,GAAOI,GAAW,GACpCN,GAAW1C,GAAEL,EAAK,EAAIqD,GACtBd,GAAKT,EAAIuB,EAAQ,EACjBvB,EAAIuB,EAAQ,EAAI,KACZd,KAAOC,IAAIE,EAAW5C,EAAQyC,GAAIC,GAAItC,EAAOC,EAAaC,CAAE,EAC5DoC,GAAG,KAAO,OAAMrC,EAAcqC,GAAG,KACrCU,KAEF,CAGA,GAFA/C,EAAc0C,GACVK,KAAYf,GAASD,GAAW,GAAGH,EAAYjC,EAAQgC,EAAKI,GAAUC,GAAS,CAAC,EAChFe,KAAY,EAAGrD,EAAYC,EAAQC,EAAQC,GAAOC,GAAM,EAAGC,EAAOC,EAAaC,CAAE,UAEhF6C,KAAQ,GAKX,IAFAE,GAAaG,EAAeP,EAAU,EACtCC,GAAKG,GAAW,OAAS,EACpB9C,GAAIJ,GAAKI,IAAKL,GAAOK,KACzBiC,GAAIvC,EAAOM,EAAC,EACR0C,GAAW1C,GAAEL,EAAK,IAAM,GAAIM,EAAWR,EAAQwC,GAAGpC,EAAOE,EAAID,CAAW,EAEvEgD,GAAWH,EAAE,IAAM3C,GAAIL,GAAOgD,KAC7BJ,EAAQ9C,EAAQwC,GAAGnC,CAAW,EAEhCmC,GAAE,KAAO,OAAMnC,EAAcJ,EAAOM,EAAC,EAAE,SAG5C,KAAKA,GAAIJ,GAAKI,IAAKL,GAAOK,KACzBiC,GAAIvC,EAAOM,EAAC,EACR0C,GAAW1C,GAAEL,EAAK,IAAM,IAAIM,EAAWR,EAAQwC,GAAGpC,EAAOE,EAAID,CAAW,EACxEmC,GAAE,KAAO,OAAMnC,EAAcJ,EAAOM,EAAC,EAAE,IAI/C,CACD,KA9GqB,CAEpB,IAAIkD,GAAezB,EAAI,OAAS/B,EAAO,OAAS+B,EAAI,OAAS/B,EAAO,OAKpE,IADAC,GAAQA,GAAQkC,GAAWlC,GAAQkC,GAC5BlC,GAAQuD,GAAcvD,KAC5BqC,GAAIP,EAAI9B,EAAK,EACbsC,GAAIvC,EAAOC,EAAK,EACZ,EAAAqC,KAAMC,IAAKD,IAAK,MAAQC,IAAK,QACxBD,IAAK,KAAM/B,EAAWR,EAAQwC,GAAGpC,EAAOE,EAAIuC,EAAeb,EAAK9B,GAAQ,EAAGG,CAAW,CAAC,EACvFmC,IAAK,KAAMkB,EAAW1D,EAAQuC,EAAC,EACnCK,EAAW5C,EAAQuC,GAAGC,GAAGpC,EAAOyC,EAAeb,EAAK9B,GAAQ,EAAGG,CAAW,EAAGC,CAAE,GAEjF0B,EAAI,OAASyB,IAAcxB,EAAYjC,EAAQgC,EAAK9B,GAAO8B,EAAI,MAAM,EACrE/B,EAAO,OAASwD,IAAc1D,EAAYC,EAAQC,EAAQC,GAAOD,EAAO,OAAQG,EAAOC,EAAaC,CAAE,CAC3G,CA8FD,CACD,CACA,SAASsC,EAAW5C,EAAQgC,EAAKtC,EAAOU,EAAOC,EAAaC,EAAI,CAC/D,IAAIqD,GAAS3B,EAAI,IAAKvB,GAAMf,EAAM,IAClC,GAAIiE,KAAWlD,IAAOuB,EAAI,KAAOtC,EAAM,GAAI,CAG1C,GAFAA,EAAM,MAAQsC,EAAI,MAClBtC,EAAM,OAASsC,EAAI,OACf4B,GAAgBlE,EAAOsC,CAAG,EAAG,OACjC,GAAI,OAAO2B,IAAW,SAIrB,OAHIjE,EAAM,OAAS,MAClBmE,GAAgBnE,EAAM,MAAOA,EAAOU,CAAK,EAElCuD,GAAQ,CACf,IAAK,IAAKG,EAAW9B,EAAKtC,CAAK,EAAG,MAClC,IAAK,IAAKqE,EAAW/D,EAAQgC,EAAKtC,EAAOY,EAAID,CAAW,EAAG,MAC3D,IAAK,IAAK2D,EAAehE,EAAQgC,EAAKtC,EAAOU,EAAOC,EAAaC,CAAE,EAAG,MACtE,QAAS2D,EAAcjC,EAAKtC,EAAOU,EAAOE,CAAE,CAC7C,MAEI4D,EAAgBlE,EAAQgC,EAAKtC,EAAOU,EAAOC,EAAaC,CAAE,CAChE,MAECoD,EAAW1D,EAAQgC,CAAG,EACtBxB,EAAWR,EAAQN,EAAOU,EAAOE,EAAID,CAAW,CAElD,CACA,SAASyD,EAAW9B,EAAKtC,EAAO,CAC3BsC,EAAI,SAAS,SAAS,IAAMtC,EAAM,SAAS,SAAS,IACvDsC,EAAI,IAAI,UAAYtC,EAAM,UAE3BA,EAAM,IAAMsC,EAAI,GACjB,CACA,SAAS+B,EAAW/D,EAAQgC,EAAKtC,EAAOY,EAAID,EAAa,CACpD2B,EAAI,WAAatC,EAAM,UAC1ByE,EAAUnE,EAAQgC,CAAG,EACrBpB,EAAWZ,EAAQN,EAAOY,EAAID,CAAW,IAGzCX,EAAM,IAAMsC,EAAI,IAChBtC,EAAM,QAAUsC,EAAI,QAEtB,CACA,SAASgC,EAAehE,EAAQgC,EAAKtC,EAAOU,EAAOC,EAAaC,EAAI,CACnEyB,EAAY/B,EAAQgC,EAAI,SAAUtC,EAAM,SAAUU,EAAOC,EAAaC,CAAE,EACxE,IAAI8D,GAAU,EAAG9C,GAAW5B,EAAM,SAElC,GADAA,EAAM,IAAM,KACR4B,IAAY,KACf,QAASf,GAAI,EAAGA,GAAIe,GAAS,OAAQf,KAAK,CACzC,IAAIc,GAAQC,GAASf,EAAC,EAClBc,IAAS,MAAQA,GAAM,KAAO,OAC7B3B,EAAM,KAAO,OAAMA,EAAM,IAAM2B,GAAM,KACzC+C,IAAW/C,GAAM,SAAW,EAE9B,CAED3B,EAAM,QAAU0E,EACjB,CACA,SAASH,EAAcjC,EAAKtC,EAAOU,EAAOE,EAAI,CAC7C,IAAImB,EAAU/B,EAAM,IAAMsC,EAAI,IAC9B1B,EAAKb,EAAaC,CAAK,GAAKY,GAExB0B,EAAI,OAAStC,EAAM,OAAUA,EAAM,OAAS,MAAQ,CAACP,GAAuB,IAAIO,EAAM,KAAK,IAC9F2E,GAAY3E,EAAOsC,EAAI,MAAOtC,EAAM,MAAOY,CAAE,EAEzCqB,EAAwBjC,CAAK,GACjCqC,EAAYN,EAASO,EAAI,SAAUtC,EAAM,SAAUU,EAAO,KAAME,CAAE,CAEpE,CACA,SAAS4D,EAAgBlE,EAAQgC,EAAKtC,EAAOU,EAAOC,EAAaC,EAAI,CAEpE,GADAZ,EAAM,SAAWV,GAAM,UAAUa,EAAS,KAAKH,EAAM,MAAM,KAAMA,CAAK,CAAC,EACnEA,EAAM,WAAaA,EAAO,MAAM,MAAM,wDAAwD,EAClGmE,GAAgBnE,EAAM,MAAOA,EAAOU,CAAK,EACrCV,EAAM,OAAS,MAAMmE,GAAgBnE,EAAM,MAAOA,EAAOU,CAAK,EAC9DV,EAAM,UAAY,MACjBsC,EAAI,UAAY,KAAMxB,EAAWR,EAAQN,EAAM,SAAUU,EAAOE,EAAID,CAAW,EAC9EuC,EAAW5C,EAAQgC,EAAI,SAAUtC,EAAM,SAAUU,EAAOC,EAAaC,CAAE,EAC5EZ,EAAM,IAAMA,EAAM,SAAS,IAC3BA,EAAM,QAAUA,EAAM,SAAS,UAG3BsC,EAAI,UAAY,MAAM0B,EAAW1D,EAAQgC,EAAI,QAAQ,EACzDtC,EAAM,QAAU,EAElB,CACA,SAAS4D,EAAUrD,EAAQC,EAAOC,EAAK,CAEtC,QADImC,EAAM,OAAO,OAAO,IAAI,EACrBpC,EAAQC,EAAKD,IAAS,CAC5B,IAAIR,EAAQO,EAAOC,CAAK,EACxB,GAAIR,GAAS,KAAM,CAClB,IAAI4E,EAAM5E,EAAM,IACZ4E,GAAO,OAAMhC,EAAIgC,CAAG,EAAIpE,EAC7B,CACD,CACA,OAAOoC,CACR,CAMA,IAAIiC,EAAU,CAAC,EACf,SAASf,EAAegB,EAAG,CAI1B,QAHIC,EAAS,CAAC,CAAC,EACXC,EAAI,EAAGlC,EAAI,EAAGjC,EAAI,EAClBoE,EAAKJ,EAAQ,OAASC,EAAE,OACnBjE,EAAI,EAAGA,EAAIoE,EAAIpE,IAAKgE,EAAQhE,CAAC,EAAIiE,EAAEjE,CAAC,EAC7C,QAASA,EAAI,EAAGA,EAAIoE,EAAI,EAAEpE,EACzB,GAAIiE,EAAEjE,CAAC,IAAM,GACb,KAAIqE,GAAIH,EAAOA,EAAO,OAAS,CAAC,EAChC,GAAID,EAAEI,EAAC,EAAIJ,EAAEjE,CAAC,EAAG,CAChBgE,EAAQhE,CAAC,EAAIqE,GACbH,EAAO,KAAKlE,CAAC,EACb,QACD,CAGA,IAFAmE,EAAI,EACJlC,EAAIiC,EAAO,OAAS,EACbC,EAAIlC,GAAG,CAGb,IAAIqC,IAAKH,IAAM,IAAMlC,IAAM,IAAMkC,EAAIlC,EAAI,GACrCgC,EAAEC,EAAOI,EAAC,CAAC,EAAIL,EAAEjE,CAAC,EACrBmE,EAAIG,GAAI,EAGRrC,EAAIqC,EAEN,CACIL,EAAEjE,CAAC,EAAIiE,EAAEC,EAAOC,CAAC,CAAC,IACjBA,EAAI,IAAGH,EAAQhE,CAAC,EAAIkE,EAAOC,EAAI,CAAC,GACpCD,EAAOC,CAAC,EAAInE,GAKd,IAFAmE,EAAID,EAAO,OACXjC,EAAIiC,EAAOC,EAAI,CAAC,EACTA,KAAM,GACZD,EAAOC,CAAC,EAAIlC,EACZA,EAAI+B,EAAQ/B,CAAC,EAEd,OAAA+B,EAAQ,OAAS,EACVE,CACR,CAEA,SAAS5B,EAAe5C,EAAQM,EAAGF,EAAa,CAC/C,KAAOE,EAAIN,EAAO,OAAQM,IACzB,GAAIN,EAAOM,CAAC,GAAK,MAAQN,EAAOM,CAAC,EAAE,KAAO,KAAM,OAAON,EAAOM,CAAC,EAAE,IAElE,OAAOF,CACR,CAGA,SAASyC,EAAQ9C,EAAQN,EAAOW,EAAa,CAC5C,GAAIX,EAAM,KAAO,KAAM,CACtB,IAAIoF,EACJ,GAAIpF,EAAM,SAAW,MAAQA,EAAM,UAAY,EAE9CoF,EAASpF,EAAM,QACT,CACNoF,EAASvF,EAAYS,CAAM,EAAE,uBAAuB,EACpD,QAASR,KAAON,GAAOQ,CAAK,EAAGoF,EAAO,YAAYtF,CAAG,CACtD,CACAwB,EAAUhB,EAAQ8E,EAAQzE,CAAW,CACtC,CACD,CAEA,SAASW,EAAUhB,EAAQR,EAAKa,EAAa,CACxCA,GAAe,KAAML,EAAO,aAAaR,EAAKa,CAAW,EACxDL,EAAO,YAAYR,CAAG,CAC5B,CAEA,SAASmC,EAAwBjC,EAAO,CACvC,GAAIA,EAAM,OAAS,MAClBA,EAAM,MAAM,iBAAmB,MAC/BA,EAAM,MAAM,iBAAmB,KAC7B,MAAO,GACV,IAAI4B,EAAW5B,EAAM,SACrB,GAAI4B,GAAY,MAAQA,EAAS,SAAW,GAAKA,EAAS,CAAC,EAAE,MAAQ,IAAK,CACzE,IAAIyD,EAAUzD,EAAS,CAAC,EAAE,SACtB5B,EAAM,IAAI,YAAcqF,IAASrF,EAAM,IAAI,UAAYqF,EAC5D,SACSzD,GAAY,MAAQA,EAAS,SAAW,EAAG,MAAM,IAAI,MAAM,kDAAkD,EACtH,MAAO,EACR,CAGA,SAASW,EAAYjC,EAAQC,EAAQC,EAAOC,EAAK,CAChD,QAASI,EAAIL,EAAOK,EAAIJ,EAAKI,IAAK,CACjC,IAAIb,EAAQO,EAAOM,CAAC,EAChBb,GAAS,MAAMgE,EAAW1D,EAAQN,CAAK,CAC5C,CACD,CACA,SAASsF,EAAehF,EAAQN,EAAOuF,EAAQC,EAAS,CACvD,IAAItF,EAAWF,EAAM,MACjB+E,EAAS5E,EAAS,KAAKoF,EAAO,eAAgBvF,CAAK,EACvD,GAAI+E,GAAU,KAEd,KAAIU,GAAa7F,EACjB,QAASE,MAAON,GAAOQ,CAAK,EAAGT,GAAe,IAAIO,GAAK2F,EAAU,EACjED,EAAQ,IAER,QAAQ,QAAQT,CAAM,EAAE,QAAQ,UAAY,CAC3C9E,EAAWD,EAAOE,CAAQ,EAC1BwF,EAAgBpF,EAAQN,EAAOwF,CAAO,CACvC,CAAC,EACF,CACA,SAASE,EAAgBpF,EAAQN,EAAOwF,EAAS,CAC5C,EAAEA,EAAQ,IAAM,IACnBG,EAAS3F,CAAK,EACdyE,EAAUnE,EAAQN,CAAK,EAEzB,CACA,SAASgE,EAAW1D,EAAQN,EAAO,CAClC,IAAIwF,EAAU,CAAC,EAAG,CAAC,EACf,OAAOxF,EAAM,KAAQ,UAAY,OAAOA,EAAM,MAAM,gBAAmB,YAAYsF,EAAehF,EAAQN,EAAOA,EAAM,MAAOwF,CAAO,EACrIxF,EAAM,OAAS,OAAOA,EAAM,MAAM,gBAAmB,YAAYsF,EAAehF,EAAQN,EAAOA,EAAM,MAAOwF,CAAO,EACvHE,EAAgBpF,EAAQN,EAAOwF,CAAO,CACvC,CACA,SAASf,EAAUnE,EAAQN,EAAO,CACjC,GAAIA,EAAM,KAAO,KACjB,GAAIA,EAAM,SAAW,MAAQA,EAAM,UAAY,EAC9CM,EAAO,YAAYN,EAAM,GAAG,MAE5B,SAASF,KAAON,GAAOQ,CAAK,EAAGM,EAAO,YAAYR,CAAG,CAEvD,CAEA,SAAS6F,EAAS3F,EAAO,CAGxB,GAFI,OAAOA,EAAM,KAAQ,UAAY,OAAOA,EAAM,MAAM,UAAa,YAAYG,EAAS,KAAKH,EAAM,MAAM,SAAUA,CAAK,EACtHA,EAAM,OAAS,OAAOA,EAAM,MAAM,UAAa,YAAYG,EAAS,KAAKH,EAAM,MAAM,SAAUA,CAAK,EACpG,OAAOA,EAAM,KAAQ,SACpBA,EAAM,UAAY,MAAM2F,EAAS3F,EAAM,QAAQ,MAC7C,CACFA,EAAM,QAAU,OAAMA,EAAM,OAAO,EAAI,MAC3C,IAAI4B,EAAW5B,EAAM,SACrB,GAAI,MAAM,QAAQ4B,CAAQ,EACzB,QAASf,EAAI,EAAGA,EAAIe,EAAS,OAAQf,IAAK,CACzC,IAAIc,EAAQC,EAASf,CAAC,EAClBc,GAAS,MAAMgE,EAAShE,CAAK,CAClC,CAEF,CACD,CAGA,SAASK,EAAShC,EAAO6B,EAAOjB,EAAI,CACnC,QAASgE,KAAO/C,EACf+D,EAAQ5F,EAAO4E,EAAK,KAAM/C,EAAM+C,CAAG,EAAGhE,CAAE,CAE1C,CACA,SAASgF,EAAQ5F,EAAO4E,EAAKtC,EAAKuD,EAAOjF,EAAI,CAC5C,GAAI,EAAAgE,IAAQ,OAASiB,GAAS,MAAQC,GAAkBlB,CAAG,GAAMtC,IAAQuD,GAAS,CAACE,GAAgB/F,EAAO4E,CAAG,GAAM,OAAOiB,GAAU,UACpI,IAAIjB,EAAI,CAAC,IAAM,KAAOA,EAAI,CAAC,IAAM,IAAK,OAAOoB,GAAYhG,EAAO4E,EAAKiB,CAAK,EAC1E,GAAIjB,EAAI,MAAM,EAAG,CAAC,IAAM,SAAU5E,EAAM,IAAI,eAAe,+BAAgC4E,EAAI,MAAM,CAAC,EAAGiB,CAAK,UACrGjB,IAAQ,QAASqB,GAAYjG,EAAM,IAAKsC,EAAKuD,CAAK,UAClDK,GAAelG,EAAO4E,EAAKhE,CAAE,EAAG,CACxC,GAAIgE,IAAQ,QAAS,CAUpB,IAJK5E,EAAM,MAAQ,SAAWA,EAAM,MAAQ,aAAeA,EAAM,IAAI,QAAU,GAAK6F,GAEhF7F,EAAM,MAAQ,UAAYsC,IAAQ,MAAQtC,EAAM,IAAI,QAAU,GAAK6F,GAEnE7F,EAAM,MAAQ,UAAYsC,IAAQ,MAAQtC,EAAM,IAAI,QAAU,GAAK6F,EAAO,OAG9E,GAAI7F,EAAM,MAAQ,SAAWA,EAAM,MAAM,OAAS,QAAU,GAAK6F,GAAU,GAAI,CAAE,QAAQ,MAAM,sCAAsC,EAAG,MAAO,CAEhJ,CAEI7F,EAAM,MAAQ,SAAW4E,IAAQ,OAAQ5E,EAAM,IAAI,aAAa4E,EAAKiB,CAAK,EACzE7F,EAAM,IAAI4E,CAAG,EAAIiB,CACvB,MACK,OAAOA,GAAU,UAChBA,EAAO7F,EAAM,IAAI,aAAa4E,EAAK,EAAE,EACpC5E,EAAM,IAAI,gBAAgB4E,CAAG,EAE9B5E,EAAM,IAAI,aAAa4E,IAAQ,YAAc,QAAUA,EAAKiB,CAAK,EAExE,CACA,SAASM,GAAWnG,EAAO4E,EAAKtC,EAAK1B,EAAI,CACxC,GAAI,EAAAgE,IAAQ,OAAStC,GAAO,MAAQwD,GAAkBlB,CAAG,GACzD,GAAIA,EAAI,CAAC,IAAM,KAAOA,EAAI,CAAC,IAAM,IAAKoB,GAAYhG,EAAO4E,EAAK,MAAS,UAC9DA,IAAQ,QAASqB,GAAYjG,EAAM,IAAKsC,EAAK,IAAI,UAEzD4D,GAAelG,EAAO4E,EAAKhE,CAAE,GAC1BgE,IAAQ,aACRA,IAAQ,SACR,EAAEA,IAAQ,UACZ5E,EAAM,MAAQ,UACXA,EAAM,MAAQ,UAAYA,EAAM,IAAI,gBAAkB,IAAMA,EAAM,MAAQI,EAAcJ,EAAM,GAAG,KAElG,EAAEA,EAAM,MAAQ,SAAW4E,IAAQ,QAEtC5E,EAAM,IAAI4E,CAAG,EAAI,SACX,CACN,IAAIwB,EAAcxB,EAAI,QAAQ,GAAG,EAC7BwB,IAAgB,KAAIxB,EAAMA,EAAI,MAAMwB,EAAc,CAAC,GACnD9D,IAAQ,IAAOtC,EAAM,IAAI,gBAAgB4E,IAAQ,YAAc,QAAUA,CAAG,CACjF,CACD,CACA,SAAS1C,GAAmBlC,EAAO6B,EAAO,CACzC,GAAI,UAAWA,EACd,GAAGA,EAAM,QAAU,KACd7B,EAAM,IAAI,gBAAkB,KAAIA,EAAM,IAAI,MAAQ,UAChD,CACN,IAAIqG,EAAa,GAAKxE,EAAM,OACxB7B,EAAM,IAAI,QAAUqG,GAAcrG,EAAM,IAAI,gBAAkB,MACjEA,EAAM,IAAI,MAAQqG,EAEpB,CAEG,kBAAmBxE,GAAO+D,EAAQ5F,EAAO,gBAAiB,KAAM6B,EAAM,cAAe,MAAS,CACnG,CACA,SAAS8C,GAAY3E,EAAOsC,EAAKT,EAAOjB,EAAI,CAG3C,IAAI0F,EACJ,GAAIhE,GAAO,KAAM,CACZA,IAAQT,GAAS,CAACpC,GAAuB,IAAIoC,CAAK,GACrD,QAAQ,KAAK,0FAA0F,EAExG,QAAS+C,KAAOtC,GACTgE,EAAMhE,EAAIsC,CAAG,IAAM,OAAU/C,GAAS,MAAQA,EAAM+C,CAAG,GAAK,OACjEuB,GAAWnG,EAAO4E,EAAK0B,EAAK1F,CAAE,CAGjC,CACA,GAAIiB,GAAS,KACZ,QAAS+C,KAAO/C,EACf+D,EAAQ5F,EAAO4E,EAAKtC,GAAOA,EAAIsC,CAAG,EAAG/C,EAAM+C,CAAG,EAAGhE,CAAE,CAGtD,CACA,SAASmF,GAAgB/F,EAAOuG,EAAM,CACrC,OAAOA,IAAS,SAAWA,IAAS,WAAaA,IAAS,iBAAmBA,IAAS,aAAevG,EAAM,MAAQI,EAAcJ,EAAM,GAAG,GAAKA,EAAM,MAAQ,UAAYA,EAAM,IAAI,aAAeI,EAAcJ,EAAM,GAAG,EAC1N,CACA,SAAS8F,GAAkBS,EAAM,CAChC,OAAOA,IAAS,UAAYA,IAAS,YAAcA,IAAS,YAAcA,IAAS,YAAcA,IAAS,kBAAoBA,IAAS,gBACxI,CACA,SAASL,GAAelG,EAAO4E,EAAKhE,EAAI,CAEvC,OAAOA,IAAO,SAEbZ,EAAM,IAAI,QAAQ,GAAG,EAAI,IAAMA,EAAM,IAErC4E,IAAQ,QAAUA,IAAQ,QAAUA,IAAQ,QAAUA,IAAQ,SAAWA,IAAQ,WAE7EA,KAAO5E,EAAM,GACnB,CAGA,SAASiG,GAAYlE,EAASO,EAAKkE,EAAO,CACzC,GAAIlE,IAAQkE,EAEL,GAAIA,GAAS,KAEnBzE,EAAQ,MAAQ,WACN,OAAOyE,GAAU,SAE3BzE,EAAQ,MAAQyE,UACNlE,GAAO,MAAQ,OAAOA,GAAQ,SAAU,CAElDP,EAAQ,MAAQ,GAEhB,QAAS6C,KAAO4B,EAAO,CACtB,IAAIX,EAAQW,EAAM5B,CAAG,EACjBiB,GAAS,OACRjB,EAAI,SAAS,GAAG,EAAG7C,EAAQ,MAAM,YAAY6C,EAAK,OAAOiB,CAAK,CAAC,EAC9D9D,EAAQ,MAAM6C,CAAG,EAAI,OAAOiB,CAAK,EAExC,CACD,KAAO,CAKN,QAASjB,KAAOtC,EACXA,EAAIsC,CAAG,GAAK,MAAQ4B,EAAM5B,CAAG,GAAK,OACjCA,EAAI,SAAS,GAAG,EAAG7C,EAAQ,MAAM,eAAe6C,CAAG,EAClD7C,EAAQ,MAAM6C,CAAG,EAAI,IAI5B,QAASA,KAAO4B,EAAO,CACtB,IAAIX,EAAQW,EAAM5B,CAAG,EACjBiB,GAAS,OAASA,EAAQ,OAAOA,CAAK,KAAO,OAAOvD,EAAIsC,CAAG,CAAC,IAC3DA,EAAI,SAAS,GAAG,EAAG7C,EAAQ,MAAM,YAAY6C,EAAKiB,CAAK,EACtD9D,EAAQ,MAAM6C,CAAG,EAAIiB,EAE5B,CACD,CACD,CAaA,SAASY,IAAY,CAEpB,KAAK,EAAI9G,CACV,CACA8G,GAAU,UAAY,OAAO,OAAO,IAAI,EACxCA,GAAU,UAAU,YAAc,SAAUC,EAAI,CAC/C,IAAIC,EAAU,KAAK,KAAOD,EAAG,IAAI,EAC7B3B,EACA,OAAO4B,GAAY,WAAY5B,EAAS4B,EAAQ,KAAKD,EAAG,cAAeA,CAAE,EACpE,OAAOC,EAAQ,aAAgB,YAAYA,EAAQ,YAAYD,CAAE,EAC1E,IAAIE,EAAO,KACPA,EAAK,GAAK,OACTF,EAAG,SAAW,OAAWE,EAAK,GAAG,EACjC7B,GAAU,MAAQ,OAAOA,EAAO,MAAS,YAC5C,QAAQ,QAAQA,CAAM,EAAE,KAAK,UAAY,CACpC6B,EAAK,GAAK,MAAQF,EAAG,SAAW,OAAWE,EAAK,GAAG,CACxD,CAAC,GAGC7B,IAAW,KACd2B,EAAG,eAAe,EAClBA,EAAG,gBAAgB,EAErB,EAGA,SAASV,GAAYhG,EAAO4E,EAAKiB,EAAO,CACvC,GAAI7F,EAAM,QAAU,KAAM,CAEzB,GADAA,EAAM,OAAO,EAAIL,EACbK,EAAM,OAAO4E,CAAG,IAAMiB,EAAO,OAC7BA,GAAS,OAAS,OAAOA,GAAU,YAAc,OAAOA,GAAU,WACjE7F,EAAM,OAAO4E,CAAG,GAAK,MAAM5E,EAAM,IAAI,iBAAiB4E,EAAI,MAAM,CAAC,EAAG5E,EAAM,OAAQ,EAAK,EAC3FA,EAAM,OAAO4E,CAAG,EAAIiB,IAEhB7F,EAAM,OAAO4E,CAAG,GAAK,MAAM5E,EAAM,IAAI,oBAAoB4E,EAAI,MAAM,CAAC,EAAG5E,EAAM,OAAQ,EAAK,EAC9FA,EAAM,OAAO4E,CAAG,EAAI,OAEtB,MAAWiB,GAAS,OAAS,OAAOA,GAAU,YAAc,OAAOA,GAAU,YAC5E7F,EAAM,OAAS,IAAIyG,GACnBzG,EAAM,IAAI,iBAAiB4E,EAAI,MAAM,CAAC,EAAG5E,EAAM,OAAQ,EAAK,EAC5DA,EAAM,OAAO4E,CAAG,EAAIiB,EAEtB,CAGA,SAAS7E,GAAcuE,EAAQvF,EAAOU,EAAO,CACxC,OAAO6E,EAAO,QAAW,YAAYpF,EAAS,KAAKoF,EAAO,OAAQvF,CAAK,EACvE,OAAOuF,EAAO,UAAa,YAAY7E,EAAM,KAAKP,EAAS,KAAKoF,EAAO,SAAUvF,CAAK,CAAC,CAC5F,CACA,SAASmE,GAAgBoB,EAAQvF,EAAOU,EAAO,CAC1C,OAAO6E,EAAO,UAAa,YAAY7E,EAAM,KAAKP,EAAS,KAAKoF,EAAO,SAAUvF,CAAK,CAAC,CAC5F,CACA,SAASkE,GAAgBlE,EAAOsC,EAAK,CACpC,EAAG,CACF,GAAItC,EAAM,OAAS,MAAQ,OAAOA,EAAM,MAAM,gBAAmB,WAAY,CAC5E,IAAI6G,EAAQ1G,EAAS,KAAKH,EAAM,MAAM,eAAgBA,EAAOsC,CAAG,EAChE,GAAIuE,IAAU,QAAa,CAACA,EAAO,KACpC,CACA,GAAI,OAAO7G,EAAM,KAAQ,UAAY,OAAOA,EAAM,MAAM,gBAAmB,WAAY,CACtF,IAAI6G,EAAQ1G,EAAS,KAAKH,EAAM,MAAM,eAAgBA,EAAOsC,CAAG,EAChE,GAAIuE,IAAU,QAAa,CAACA,EAAO,KACpC,CACA,MAAO,EACR,OAAS,IACT,OAAA7G,EAAM,IAAMsC,EAAI,IAChBtC,EAAM,QAAUsC,EAAI,QACpBtC,EAAM,SAAWsC,EAAI,SAQrBtC,EAAM,MAAQsC,EAAI,MAClBtC,EAAM,SAAWsC,EAAI,SACrBtC,EAAM,KAAOsC,EAAI,KACV,EACR,CAEA,IAAIwE,GAEJ,OAAO,SAAShH,EAAKS,EAAQwG,EAAQ,CACpC,GAAI,CAACjH,EAAK,MAAM,IAAI,UAAU,+CAA+C,EAC7E,GAAIgH,IAAc,MAAQhH,EAAI,SAASgH,EAAU,EAChD,MAAM,IAAI,UAAU,yDAAyD,EAE9E,IAAIE,EAAarH,EACbsH,EAAUH,GACVpG,EAAQ,CAAC,EACTwG,GAAS9G,EAAcN,CAAG,EAC1BqH,GAAYrH,EAAI,aAEpBgH,GAAahH,EACbH,EAAgB,OAAOoH,GAAW,WAAaA,EAAS,OACxDnH,EAAgB,CAAC,EACjB,GAAI,CAECE,EAAI,QAAU,OAAMA,EAAI,YAAc,IAC1CS,EAASjB,GAAM,kBAAkB,MAAM,QAAQiB,CAAM,EAAIA,EAAS,CAACA,CAAM,CAAC,EAC1E8B,EAAYvC,EAAKA,EAAI,OAAQS,EAAQG,EAAO,KAAMyG,KAAc,+BAAiC,OAAYA,EAAS,EACtHrH,EAAI,OAASS,EAET2G,IAAU,MAAQ9G,EAAcN,CAAG,IAAMoH,IAAU,OAAOA,GAAO,OAAU,YAAYA,GAAO,MAAM,EACxG,QAASrG,GAAI,EAAGA,GAAIH,EAAM,OAAQG,KAAKH,EAAMG,EAAC,EAAE,CACjD,QAAE,CACDlB,EAAgBqH,EAChBF,GAAaG,CACd,CACD,CACD,IC74BA,IAAAG,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEAA,GAAO,QAAU,KAA2B,ICF5C,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAQ,KAEZD,GAAO,QAAU,SAASE,EAAQC,EAAUC,EAAS,CACpD,IAAIC,EAAgB,CAAC,EACjBC,EAAU,GACVC,EAAS,GAEb,SAASC,GAAO,CACf,IAAKD,EAAS,EAAGA,EAASF,EAAc,OAAQE,GAAU,EACzD,GAAI,CAAEL,EAAOG,EAAcE,CAAM,EAAGN,GAAMI,EAAcE,EAAS,CAAC,CAAC,EAAGE,CAAM,CAAE,OACvEC,EAAG,CAAEN,EAAQ,MAAMM,CAAC,CAAE,CAE9BH,EAAS,EACV,CAEA,SAASE,GAAS,CACZH,IACJA,EAAU,GACVH,EAAS,UAAW,CACnBG,EAAU,GACVE,EAAK,CACN,CAAC,EAEH,CAEAC,EAAO,KAAOD,EAEd,SAASG,EAAMC,EAAMC,EAAW,CAC/B,GAAIA,GAAa,MAAQA,EAAU,MAAQ,MAAQ,OAAOA,GAAc,WACvE,MAAM,IAAI,UAAU,2CAA2C,EAGhE,IAAIC,EAAQT,EAAc,QAAQO,CAAI,EAClCE,GAAS,IACZT,EAAc,OAAOS,EAAO,CAAC,EACzBA,GAASP,IAAQA,GAAU,GAC/BL,EAAOU,EAAM,CAAC,CAAC,GAGZC,GAAa,OAChBR,EAAc,KAAKO,EAAMC,CAAS,EAClCX,EAAOU,EAAMX,GAAMY,CAAS,EAAGJ,CAAM,EAEvC,CAEA,MAAO,CAAC,MAAOE,EAAO,OAAQF,CAAM,CACrC,IChDA,IAAAM,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAS,KAEbD,GAAO,QAAU,KAA8BC,GAAQ,OAAO,sBAA0B,IAAc,sBAAwB,KAAM,OAAO,QAAY,IAAc,QAAU,IAAI,ICJnL,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEAA,GAAO,QAAU,SAASC,EAAQ,CACjC,GAAI,OAAO,UAAU,SAAS,KAAKA,CAAM,IAAM,kBAAmB,MAAO,GAEzE,IAAIC,EAAO,CAAC,EACZ,QAASC,KAAOF,EACfG,EAAYD,EAAKF,EAAOE,CAAG,CAAC,EAG7B,OAAOD,EAAK,KAAK,GAAG,EAEpB,SAASE,EAAYD,EAAKE,EAAO,CAChC,GAAI,MAAM,QAAQA,CAAK,EACtB,QAASC,EAAI,EAAGA,EAAID,EAAM,OAAQC,IACjCF,EAAYD,EAAM,IAAMG,EAAI,IAAKD,EAAMC,CAAC,CAAC,UAGlC,OAAO,UAAU,SAAS,KAAKD,CAAK,IAAM,kBAClD,QAASC,KAAKD,EACbD,EAAYD,EAAM,IAAMG,EAAI,IAAKD,EAAMC,CAAC,CAAC,OAGtCJ,EAAK,KAAK,mBAAmBC,CAAG,GAAKE,GAAS,MAAQA,IAAU,GAAK,IAAM,mBAAmBA,CAAK,EAAI,GAAG,CAChH,CACD,ICzBA,IAAAE,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAmB,KAGvBD,GAAO,QAAU,SAASE,EAAUC,EAAQ,CAC3C,GAAK,wBAAyB,KAAKD,CAAQ,EAC1C,MAAM,IAAI,YAAY,0EAA0E,EAEjG,GAAIC,GAAU,KAAM,OAAOD,EAC3B,IAAIE,EAAaF,EAAS,QAAQ,GAAG,EACjCG,EAAYH,EAAS,QAAQ,GAAG,EAChCI,EAAWD,EAAY,EAAIH,EAAS,OAASG,EAC7CE,EAAUH,EAAa,EAAIE,EAAWF,EACtCI,EAAON,EAAS,MAAM,EAAGK,CAAO,EAChCE,EAAQ,CAAC,EAEb,OAAO,OAAOA,EAAON,CAAM,EAE3B,IAAIO,EAAWF,EAAK,QAAQ,wBAAyB,SAASG,EAAGC,EAAKC,EAAU,CAG/E,OAFA,OAAOJ,EAAMG,CAAG,EAEZT,EAAOS,CAAG,GAAK,KAAaD,EAEzBE,EAAWV,EAAOS,CAAG,EAAI,mBAAmB,OAAOT,EAAOS,CAAG,CAAC,CAAC,CACvE,CAAC,EAGGE,EAAgBJ,EAAS,QAAQ,GAAG,EACpCK,EAAeL,EAAS,QAAQ,GAAG,EACnCM,EAAcD,EAAe,EAAIL,EAAS,OAASK,EACnDE,EAAaH,EAAgB,EAAIE,EAAcF,EAC/CI,EAASR,EAAS,MAAM,EAAGO,CAAU,EAErCb,GAAc,IAAGc,GAAUhB,EAAS,MAAME,EAAYE,CAAQ,GAC9DQ,GAAiB,IAAGI,IAAWd,EAAa,EAAI,IAAM,KAAOM,EAAS,MAAMI,EAAeE,CAAW,GAC1G,IAAIG,EAAclB,GAAiBQ,CAAK,EACxC,OAAIU,IAAaD,IAAWd,EAAa,GAAKU,EAAgB,EAAI,IAAM,KAAOK,GAC3Ed,GAAa,IAAGa,GAAUhB,EAAS,MAAMG,CAAS,GAClDU,GAAgB,IAAGG,IAAWb,EAAY,EAAI,GAAK,KAAOK,EAAS,MAAMK,CAAY,GAClFG,CACR,ICzCA,IAAAE,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAgB,KAChBC,GAAS,KAEbF,GAAO,QAAU,SAASG,EAASC,EAAc,CAChD,SAASC,EAAaC,EAAU,CAC/B,OAAO,IAAI,QAAQA,CAAQ,CAC5B,CAEA,SAASC,EAAYC,EAAKC,EAAM,CAC/B,OAAO,IAAI,QAAQ,SAASC,EAASC,EAAQ,CAC5CH,EAAMP,GAAcO,EAAKC,EAAK,MAAM,EACpC,IAAIG,EAASH,EAAK,QAAU,KAAOA,EAAK,OAAO,YAAY,EAAI,MAC3DI,EAAOJ,EAAK,KACZK,GAAcL,EAAK,WAAa,MAAQA,EAAK,YAAc,KAAK,YAAc,EAAEI,aAAgBV,EAAQ,UAAYU,aAAgBV,EAAQ,iBAC5IY,EAAeN,EAAK,eAAiB,OAAOA,EAAK,SAAY,WAAa,GAAK,QAE/EO,EAAM,IAAIb,EAAQ,eAAkBc,EAAU,GAAOC,EAAY,GACjEC,EAAWH,EAAKI,EAChBC,EAAQL,EAAI,MAEhBA,EAAI,MAAQ,UAAW,CACtBC,EAAU,GACVI,EAAM,KAAK,IAAI,CAChB,EAEAL,EAAI,KAAKJ,EAAQJ,EAAKC,EAAK,QAAU,GAAO,OAAOA,EAAK,MAAS,SAAWA,EAAK,KAAO,OAAW,OAAOA,EAAK,UAAa,SAAWA,EAAK,SAAW,MAAS,EAE5JK,GAAcD,GAAQ,MAAQ,CAACS,EAAUb,EAAM,cAAc,GAChEO,EAAI,iBAAiB,eAAgB,iCAAiC,EAEnE,OAAOP,EAAK,aAAgB,YAAc,CAACa,EAAUb,EAAM,QAAQ,GACtEO,EAAI,iBAAiB,SAAU,0BAA0B,EAEtDP,EAAK,kBAAiBO,EAAI,gBAAkBP,EAAK,iBACjDA,EAAK,UAASO,EAAI,QAAUP,EAAK,SACrCO,EAAI,aAAeD,EAEnB,QAASQ,KAAOd,EAAK,QAChBP,GAAO,KAAKO,EAAK,QAASc,CAAG,GAChCP,EAAI,iBAAiBO,EAAKd,EAAK,QAAQc,CAAG,CAAC,EAI7CP,EAAI,mBAAqB,SAASQ,EAAI,CAErC,GAAI,CAAAP,GAEAO,EAAG,OAAO,aAAe,EAC5B,GAAI,CACH,IAAIC,EAAWD,EAAG,OAAO,QAAU,KAAOA,EAAG,OAAO,OAAS,KAAQA,EAAG,OAAO,SAAW,KAAQ,cAAe,KAAKhB,CAAG,EAMrHkB,EAAWF,EAAG,OAAO,SAAUG,EAEnC,GAAIZ,IAAiB,QAGpB,GAAI,CAACS,EAAG,OAAO,cAAgB,OAAOf,EAAK,SAAY,WAEtD,GAAI,CAAEiB,EAAW,KAAK,MAAMF,EAAG,OAAO,YAAY,CAAE,MAC1C,CAAEE,EAAW,IAAK,OAEnB,CAACX,GAAgBA,IAAiB,SAMxCW,GAAY,OAAMA,EAAWF,EAAG,OAAO,cAU5C,GAPI,OAAOf,EAAK,SAAY,YAC3BiB,EAAWjB,EAAK,QAAQe,EAAG,OAAQf,CAAI,EACvCgB,EAAU,IACA,OAAOhB,EAAK,aAAgB,aACtCiB,EAAWjB,EAAK,YAAYiB,CAAQ,GAGjCD,EAAS,CACZ,GAAI,OAAOhB,EAAK,MAAS,WACxB,GAAI,MAAM,QAAQiB,CAAQ,EACzB,QAASE,EAAI,EAAGA,EAAIF,EAAS,OAAQE,IACpCF,EAASE,CAAC,EAAI,IAAInB,EAAK,KAAKiB,EAASE,CAAC,CAAC,OAGpCF,EAAW,IAAIjB,EAAK,KAAKiB,CAAQ,EAEvChB,EAAQgB,CAAQ,CACjB,KACK,CACJ,IAAIG,EAAwB,UAAW,CACtC,GAAI,CAAEF,EAAUH,EAAG,OAAO,YAAa,MAC7B,CAAEG,EAAUD,CAAS,CAC/B,IAAII,EAAQ,IAAI,MAAMH,CAAO,EAC7BG,EAAM,KAAON,EAAG,OAAO,OACvBM,EAAM,SAAWJ,EACjBf,EAAOmB,CAAK,CACb,EAEId,EAAI,SAAW,EAKlB,WAAW,UAAW,CACjBE,GACJW,EAAsB,CACvB,CAAC,EACKA,EAAsB,CAC9B,CACD,OACOE,EAAG,CACTpB,EAAOoB,CAAC,CACT,CAEF,EAEAf,EAAI,UAAY,SAAUQ,EAAI,CAC7BN,EAAY,GACZ,IAAIY,EAAQ,IAAI,MAAM,mBAAmB,EACzCA,EAAM,KAAON,EAAG,OAAO,OACvBb,EAAOmB,CAAK,CACb,EAEI,OAAOrB,EAAK,QAAW,aAC1BO,EAAMP,EAAK,OAAOO,EAAKP,EAAMD,CAAG,GAAKQ,EAGjCA,IAAQG,IACXC,EAAgBJ,EAAI,MACpBA,EAAI,MAAQ,UAAW,CACtBC,EAAU,GACVG,EAAc,KAAK,IAAI,CACxB,IAIEP,GAAQ,KAAMG,EAAI,KAAK,EAClB,OAAOP,EAAK,WAAc,WAAYO,EAAI,KAAKP,EAAK,UAAUI,CAAI,CAAC,EACnEA,aAAgBV,EAAQ,UAAYU,aAAgBV,EAAQ,gBAAiBa,EAAI,KAAKH,CAAI,EAC9FG,EAAI,KAAK,KAAK,UAAUH,CAAI,CAAC,CACnC,CAAC,CACF,CAKAR,EAAa,UAAY,QAAQ,UACjCA,EAAa,UAAY,QAEzB,SAASiB,EAAUb,EAAMuB,EAAM,CAC9B,QAAST,KAAOd,EAAK,QACpB,GAAIP,GAAO,KAAKO,EAAK,QAASc,CAAG,GAAKA,EAAI,YAAY,IAAMS,EAAM,MAAO,GAE1E,MAAO,EACR,CAEA,MAAO,CACN,QAAS,SAASxB,EAAKC,EAAM,CACxB,OAAOD,GAAQ,UAAYC,EAAOD,EAAKA,EAAMA,EAAI,KAC5CC,GAAQ,OAAMA,EAAO,CAAC,GAC/B,IAAIwB,EAAU1B,EAAYC,EAAKC,CAAI,EACnC,GAAIA,EAAK,aAAe,GAAM,OAAOwB,EACrC,IAAIC,EAAQ,EACZ,SAASC,GAAW,CACf,EAAED,IAAU,GAAK,OAAO9B,GAAiB,YAAYA,EAAa,CACvE,CAEA,OAAOgC,EAAKH,CAAO,EAEnB,SAASG,EAAKH,EAAS,CACtB,IAAII,EAAOJ,EAAQ,KAQnB,OAAAA,EAAQ,YAAc5B,EACtB4B,EAAQ,KAAO,UAAW,CACzBC,IACA,IAAII,EAAOD,EAAK,MAAMJ,EAAS,SAAS,EACxC,OAAAK,EAAK,KAAKH,EAAU,SAASJ,EAAG,CAE/B,GADAI,EAAS,EACLD,IAAU,EAAG,MAAMH,CACxB,CAAC,EACMK,EAAKE,CAAI,CACjB,EACOL,CACR,CACD,CACD,CACD,ICtMA,IAAAM,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAc,KAElBD,GAAO,QAAU,KAA6B,OAAO,OAAW,IAAc,OAAS,KAAMC,GAAY,MAAM,ICJ/G,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cA8BA,IAAIC,GAAqB,qHAEzBD,GAAO,QAAU,SAASE,EAAK,CAC9B,OAAO,OAAOA,CAAG,EAAE,QAAQD,GAAoB,kBAAkB,CAClE,IClCA,IAAAE,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAyB,KAE7BD,GAAO,QAAU,SAASE,EAAQ,CACjC,GAAIA,IAAW,IAAMA,GAAU,KAAM,MAAO,CAAC,EACzCA,EAAO,OAAO,CAAC,IAAM,MAAKA,EAASA,EAAO,MAAM,CAAC,GAGrD,QADIC,EAAUD,EAAO,MAAM,GAAG,EAAGE,EAAW,CAAC,EAAGC,EAAO,CAAC,EAC/CC,EAAI,EAAGA,EAAIH,EAAQ,OAAQG,IAAK,CACxC,IAAIC,EAAQJ,EAAQG,CAAC,EAAE,MAAM,GAAG,EAC5BE,EAAMP,GAAuBM,EAAM,CAAC,CAAC,EACrCE,EAAQF,EAAM,SAAW,EAAIN,GAAuBM,EAAM,CAAC,CAAC,EAAI,GAEhEE,IAAU,OAAQA,EAAQ,GACrBA,IAAU,UAASA,EAAQ,IAEpC,IAAIC,EAASF,EAAI,MAAM,UAAU,EAC7BG,EAASN,EACTG,EAAI,QAAQ,GAAG,EAAI,IAAIE,EAAO,IAAI,EACtC,QAASE,EAAI,EAAGA,EAAIF,EAAO,OAAQE,IAAK,CACvC,IAAIC,EAAQH,EAAOE,CAAC,EAAGE,EAAYJ,EAAOE,EAAI,CAAC,EAC3CG,EAAWD,GAAa,IAAM,CAAC,MAAM,SAASA,EAAW,EAAE,CAAC,EAChE,GAAID,IAAU,GAAI,CACjB,IAAIL,EAAME,EAAO,MAAM,EAAGE,CAAC,EAAE,KAAK,EAC9BR,EAASI,CAAG,GAAK,OACpBJ,EAASI,CAAG,EAAI,MAAM,QAAQG,CAAM,EAAIA,EAAO,OAAS,GAEzDE,EAAQT,EAASI,CAAG,GACrB,SAESK,IAAU,YAAa,MAChC,GAAID,IAAMF,EAAO,OAAS,EAAGC,EAAOE,CAAK,EAAIJ,MACxC,CAGJ,IAAIO,EAAO,OAAO,yBAAyBL,EAAQE,CAAK,EACpDG,GAAQ,OAAMA,EAAOA,EAAK,OAC1BA,GAAQ,OAAML,EAAOE,CAAK,EAAIG,EAAOD,EAAW,CAAC,EAAI,CAAC,GAC1DJ,EAASK,CACV,CACD,CACD,CACA,OAAOX,CACR,IC5CA,IAAAY,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAmB,KAGvBD,GAAO,QAAU,SAASE,EAAK,CAC9B,IAAIC,EAAaD,EAAI,QAAQ,GAAG,EAC5BE,EAAYF,EAAI,QAAQ,GAAG,EAC3BG,EAAWD,EAAY,EAAIF,EAAI,OAASE,EACxCE,EAAUH,EAAa,EAAIE,EAAWF,EACtCI,EAAOL,EAAI,MAAM,EAAGI,CAAO,EAAE,QAAQ,UAAW,GAAG,EAEvD,OAAKC,EAEAA,EAAK,CAAC,IAAM,MAAKA,EAAO,IAAMA,GAFxBA,EAAO,IAIX,CACN,KAAMA,EACN,OAAQJ,EAAa,EAClB,CAAC,EACDF,GAAiBC,EAAI,MAAMC,EAAa,EAAGE,CAAQ,CAAC,CACxD,CACD,ICtBA,IAAAG,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAgB,KAOpBD,GAAO,QAAU,SAASE,EAAU,CACnC,IAAIC,EAAeF,GAAcC,CAAQ,EACrCE,EAAe,OAAO,KAAKD,EAAa,MAAM,EAC9CE,EAAO,CAAC,EACRC,EAAS,IAAI,OAAO,IAAMH,EAAa,KAAK,QAK/C,qDACA,SAASI,EAAGC,EAAKC,EAAO,CACvB,OAAID,GAAO,KAAa,KAAOD,GAC/BF,EAAK,KAAK,CAAC,EAAGG,EAAK,EAAGC,IAAU,KAAK,CAAC,EAClCA,IAAU,MAAc,OACxBA,IAAU,IAAY,aACnB,WAAaA,GAAS,IAC9B,CACD,EAAI,OAAO,EACX,OAAO,SAASC,EAAM,CAGrB,QAASC,EAAI,EAAGA,EAAIP,EAAa,OAAQO,IACxC,GAAIR,EAAa,OAAOC,EAAaO,CAAC,CAAC,IAAMD,EAAK,OAAON,EAAaO,CAAC,CAAC,EAAG,MAAO,GAGnF,GAAI,CAACN,EAAK,OAAQ,OAAOC,EAAO,KAAKI,EAAK,IAAI,EAC9C,IAAIE,EAASN,EAAO,KAAKI,EAAK,IAAI,EAClC,GAAIE,GAAU,KAAM,MAAO,GAC3B,QAASD,EAAI,EAAGA,EAAIN,EAAK,OAAQM,IAChCD,EAAK,OAAOL,EAAKM,CAAC,EAAE,CAAC,EAAIN,EAAKM,CAAC,EAAE,EAAIC,EAAOD,EAAI,CAAC,EAAI,mBAAmBC,EAAOD,EAAI,CAAC,CAAC,EAEtF,MAAO,EACR,CACD,IC1CA,IAAAE,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAyBA,IAAIC,GAAS,KACTC,GAAQ,4EAEZF,GAAO,QAAU,SAASG,EAAOC,EAAQ,CACxC,IAAIC,EAAS,CAAC,EAEd,GAAID,GAAU,KACb,QAASE,KAAOH,EACXF,GAAO,KAAKE,EAAOG,CAAG,GAAK,CAACJ,GAAM,KAAKI,CAAG,GAAKF,EAAO,QAAQE,CAAG,EAAI,IACxED,EAAOC,CAAG,EAAIH,EAAMG,CAAG,OAIzB,SAASA,KAAOH,EACXF,GAAO,KAAKE,EAAOG,CAAG,GAAK,CAACJ,GAAM,KAAKI,CAAG,IAC7CD,EAAOC,CAAG,EAAIH,EAAMG,CAAG,GAK1B,OAAOD,CACR,IC9CA,IAAAE,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAQ,KACRC,GAAc,KAEdC,GAAyB,KACzBC,GAAgB,KAChBC,GAAgB,KAChBC,GAAkB,KAClBC,GAAS,KAEbP,GAAO,QAAU,SAASQ,EAASC,EAAa,CAC/C,IAAIC,EAAI,QAAQ,QAAQ,EAEpBC,EAAY,GAEZC,EAAQ,GACRC,EAAkB,GAElBC,EAAKC,EAAUC,EAEfC,EAAiBC,EAAWC,EAAOC,EAAaC,EAEhDC,EAAa,CAChB,SAAU,UAAW,CACpBV,EAAQC,EAAkB,GAC1BL,EAAQ,oBAAoB,WAAYe,EAAW,EAAK,CACzD,EACA,KAAM,UAAW,CAKhB,IAAIC,EAAQvB,GAAMiB,EAAWC,EAAM,IAAKA,CAAK,EAC7C,OAAIF,EAAwBA,EAAgB,OAAOO,CAAK,EAEjD,CAACA,CAAK,CACd,CACD,EAEIC,EAAOC,EAAM,KAAO,CAAC,EAEzB,SAASC,GAAe,CACvBhB,EAAY,GAGZ,IAAIiB,EAASpB,EAAQ,SAAS,KAC1BkB,EAAM,OAAO,CAAC,IAAM,MACvBE,EAASpB,EAAQ,SAAS,OAASoB,EAC/BF,EAAM,OAAO,CAAC,IAAM,MACvBE,EAASpB,EAAQ,SAAS,SAAWoB,EACjCA,EAAO,CAAC,IAAM,MAAKA,EAAS,IAAMA,KAGxC,IAAIC,EAAO1B,GAAuByB,CAAM,EAAE,MAAMF,EAAM,OAAO,MAAM,EAC/DI,EAAOzB,GAAcwB,CAAI,EAE7B,OAAO,OAAOC,EAAK,OAAQtB,EAAQ,QAAQ,KAAK,EAEhD,SAASuB,EAAOC,EAAG,CAClB,QAAQ,MAAMA,CAAC,EACfN,EAAM,IAAIV,EAAe,KAAM,CAAC,QAAS,EAAI,CAAC,CAC/C,CAEAiB,EAAK,CAAC,EACN,SAASA,EAAKC,EAAG,CAChB,KAAOA,EAAInB,EAAS,OAAQmB,IAC3B,GAAInB,EAASmB,CAAC,EAAE,MAAMJ,CAAI,EAAG,CAC5B,IAAIK,EAAUpB,EAASmB,CAAC,EAAE,UACtBE,EAAerB,EAASmB,CAAC,EAAE,MAC3BG,EAAYF,EACZG,EAASjB,EAAa,SAASkB,EAAM,CACxC,GAAID,IAAWjB,EACf,IAAIkB,IAASd,EAAM,OAAOQ,EAAKC,EAAI,CAAC,EACpChB,EAAYqB,GAAQ,OAAS,OAAOA,EAAK,MAAS,YAAc,OAAOA,GAAS,YAAaA,EAAO,MACpGpB,EAAQW,EAAK,OAAQV,EAAcS,EAAMR,EAAa,KACtDJ,EAAkBkB,EAAQ,OAASA,EAAU,KACzCtB,EAAiBJ,EAAY,OAAO,GAEvCI,EAAkB,GAClBJ,EAAY,MAAMK,EAAKQ,CAAU,GAEnC,EAGIa,EAAQ,MAAQ,OAAOA,GAAY,YACtCA,EAAU,CAAC,EACXG,EAAOD,CAAS,GAERF,EAAQ,QAChBzB,EAAE,KAAK,UAAY,CAClB,OAAOyB,EAAQ,QAAQL,EAAK,OAAQD,EAAMO,CAAY,CACvD,CAAC,EAAE,KAAKE,EAAQT,IAASb,EAAgB,KAAOe,CAAM,EAElDO,EAAkB,EACvB,MACD,CAGD,GAAIT,IAASb,EACZ,MAAM,IAAI,MAAM,mCAAqCA,EAAgB,GAAG,EAEzEU,EAAM,IAAIV,EAAe,KAAM,CAAC,QAAS,EAAI,CAAC,CAC/C,CACD,CAEA,SAASO,GAAY,CACfZ,IACJA,EAAY,GAIZ,WAAWgB,CAAY,EAEzB,CAEA,SAASD,EAAMc,EAAMC,EAAcC,EAAQ,CAC1C,GAAI,CAACF,EAAM,MAAM,IAAI,UAAU,+CAA+C,EAc9E,GAZAzB,EAAW,OAAO,KAAK2B,CAAM,EAAE,IAAI,SAAShB,EAAO,CAClD,GAAIA,EAAM,CAAC,IAAM,IAAK,MAAM,IAAI,YAAY,+BAA+B,EAC3E,GAAK,wBAAyB,KAAKA,CAAK,EACvC,MAAM,IAAI,YAAY,uEAAuE,EAE9F,MAAO,CACN,MAAOA,EACP,UAAWgB,EAAOhB,CAAK,EACvB,MAAOpB,GAAgBoB,CAAK,CAC7B,CACD,CAAC,EACDV,EAAgByB,EACZA,GAAgB,KAAM,CACzB,IAAIE,EAActC,GAAcoC,CAAY,EAE5C,GAAI,CAAC1B,EAAS,KAAK,SAAUmB,EAAG,CAAE,OAAOA,EAAE,MAAMS,CAAW,CAAE,CAAC,EAC9D,MAAM,IAAI,eAAe,+CAA+C,CAE1E,CACA7B,EAAM0B,EAENhC,EAAQ,iBAAiB,WAAYe,EAAW,EAAK,EAErDX,EAAQ,GAGRe,EAAa,CACd,CACA,OAAAD,EAAM,IAAM,SAASG,EAAMC,EAAMc,EAAS,CAQzC,GAPIvB,GAAc,OACjBuB,EAAUA,GAAW,CAAC,EACtBA,EAAQ,QAAU,IAEnBvB,EAAa,KAEbQ,EAAOzB,GAAcyB,EAAMC,CAAI,EAC3BlB,EAAO,CACVW,EAAU,EACV,IAAIsB,EAAQD,EAAUA,EAAQ,MAAQ,KAClCE,EAAQF,EAAUA,EAAQ,MAAQ,KAClCA,GAAWA,EAAQ,QAASpC,EAAQ,QAAQ,aAAaqC,EAAOC,EAAOpB,EAAM,OAASG,CAAI,EACzFrB,EAAQ,QAAQ,UAAUqC,EAAOC,EAAOpB,EAAM,OAASG,CAAI,CACjE,MAECrB,EAAQ,SAAS,KAAOkB,EAAM,OAASG,CAEzC,EACAH,EAAM,IAAM,UAAW,CAAC,OAAON,CAAW,EAC1CM,EAAM,OAAS,KACfA,EAAM,KAAO,CACZ,KAAM,SAASF,EAAO,CAMrB,IAAIuB,EAAQ7C,GACXsB,EAAM,MAAM,UAAY,IACxBjB,GAAOiB,EAAM,MAAO,CAAC,UAAW,SAAU,WAAY,SAAS,CAAC,EAChEA,EAAM,QACP,EACIoB,EAASI,EAASC,EAQtB,OAAIF,EAAM,MAAM,SAAW,EAAQA,EAAM,MAAM,WAC9CA,EAAM,MAAM,KAAO,KACnBA,EAAM,MAAM,eAAe,EAAI,SAI/BH,EAAUpB,EAAM,MAAM,QACtBwB,EAAUxB,EAAM,MAAM,QAEtByB,EAAO7C,GAAc2C,EAAM,MAAM,KAAMvB,EAAM,MAAM,MAAM,EACzDuB,EAAM,MAAM,KAAOrB,EAAM,OAASuB,EAClCF,EAAM,MAAM,QAAU,SAASf,EAAG,CACjC,IAAIkB,EACA,OAAOF,GAAY,WACtBE,EAASF,EAAQ,KAAKhB,EAAE,cAAeA,CAAC,EAC9BgB,GAAW,MAAQ,OAAOA,GAAY,UAEtC,OAAOA,EAAQ,aAAgB,YACzCA,EAAQ,YAAYhB,CAAC,EAcrBkB,IAAW,IAAS,CAAClB,EAAE,mBAEtBA,EAAE,SAAW,GAAKA,EAAE,QAAU,GAAKA,EAAE,QAAU,KAE/C,CAACA,EAAE,cAAc,QAAUA,EAAE,cAAc,SAAW,UAEvD,CAACA,EAAE,SAAW,CAACA,EAAE,SAAW,CAACA,EAAE,UAAY,CAACA,EAAE,SAE9CA,EAAE,eAAe,EACjBA,EAAE,OAAS,GACXN,EAAM,IAAIuB,EAAM,KAAML,CAAO,EAE/B,GAEMG,CACR,CACD,EACArB,EAAM,MAAQ,SAASyB,EAAK,CAC3B,OAAOhC,GAASgC,GAAO,KAAOhC,EAAMgC,CAAG,EAAIhC,CAC5C,EAEOO,CACR,IClPA,IAAA0B,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAc,KAElBD,GAAO,QAAU,KAAwB,OAAO,OAAW,IAAc,OAAS,KAAMC,EAAW,ICJnG,IAAAC,GAAAC,GAAA,CAAAC,GAAAC,KAAA,cAEA,IAAIC,GAAc,KACdC,GAAc,KACdC,GAAU,KACVC,GAAS,KAETC,GAAI,UAAa,CAAE,OAAOJ,GAAY,MAAM,KAAM,SAAS,CAAE,EACjEI,GAAE,EAAIJ,GACNI,GAAE,MAAQJ,GAAY,MACtBI,GAAE,SAAWJ,GAAY,SACzBI,GAAE,SAAW,IACbA,GAAE,MAAQH,GAAY,MACtBG,GAAE,MAAQD,GACVC,GAAE,OAAS,KACXA,GAAE,OAASH,GAAY,OACvBG,GAAE,QAAUF,GAAQ,QACpBE,GAAE,iBAAmB,KACrBA,GAAE,iBAAmB,KACrBA,GAAE,cAAgB,KAClBA,GAAE,cAAgB,KAClBA,GAAE,MAAQ,KACVA,GAAE,OAAS,KACXA,GAAE,OAAS,KAEXL,GAAO,QAAUK,KClBX,SAAUC,GAAQC,EAAU,CAChC,OAAOA,aAAa,YAAe,YAAY,OAAOA,CAAC,GAAKA,EAAE,YAAY,OAAS,YACrF,CAGM,SAAUC,GAAMC,EAAU,CAC9B,GAAI,OAAOA,GAAM,UAAW,MAAM,IAAI,MAAM,yBAAyBA,CAAC,EAAE,CAC1E,CAGM,SAAUC,GAAQC,EAAS,CAC/B,GAAI,CAAC,OAAO,cAAcA,CAAC,GAAKA,EAAI,EAAG,MAAM,IAAI,MAAM,kCAAoCA,CAAC,CAC9F,CAGM,SAAUC,GAAOC,EAAmBC,EAAiBC,EAAgB,GAAE,CAC3E,IAAMC,EAAQV,GAAQO,CAAK,EACrBI,EAAMJ,GAAO,OACbK,EAAWJ,IAAW,OAC5B,GAAI,CAACE,GAAUE,GAAYD,IAAQH,EAAS,CAC1C,IAAMK,EAASJ,GAAS,IAAIA,CAAK,KAC3BK,EAAQF,EAAW,cAAcJ,CAAM,GAAK,GAC5CO,EAAML,EAAQ,UAAUC,CAAG,GAAK,QAAQ,OAAOJ,CAAK,GAC1D,MAAM,IAAI,MAAMM,EAAS,sBAAwBC,EAAQ,SAAWC,CAAG,CACzE,CACA,OAAOR,CACT,CAGM,SAAUS,GAAQC,EAAeC,EAAgB,GAAI,CACzD,GAAID,EAAS,UAAW,MAAM,IAAI,MAAM,kCAAkC,EAC1E,GAAIC,GAAiBD,EAAS,SAAU,MAAM,IAAI,MAAM,uCAAuC,CACjG,CAGM,SAAUE,GAAQC,EAAUH,EAAa,CAC7CX,GAAOc,EAAK,OAAW,QAAQ,EAC/B,IAAMC,EAAMJ,EAAS,UACrB,GAAIG,EAAI,OAASC,EACf,MAAM,IAAI,MAAM,yDAA2DA,CAAG,CAElF,CAoBM,SAAUC,GAAIC,EAAe,CACjC,OAAO,IAAI,YAAYA,EAAI,OAAQA,EAAI,WAAY,KAAK,MAAMA,EAAI,WAAa,CAAC,CAAC,CACnF,CAGM,SAAUC,MAASC,EAAoB,CAC3C,QAASC,EAAI,EAAGA,EAAID,EAAO,OAAQC,IACjCD,EAAOC,CAAC,EAAE,KAAK,CAAC,CAEpB,CAGM,SAAUC,GAAWJ,EAAe,CACxC,OAAO,IAAI,SAASA,EAAI,OAAQA,EAAI,WAAYA,EAAI,UAAU,CAChE,CAmJM,SAAUK,GACdC,EACAC,EAAQ,CAER,GAAIA,GAAQ,MAAQ,OAAOA,GAAS,SAAU,MAAM,IAAI,MAAM,yBAAyB,EAEvF,OADe,OAAO,OAAOD,EAAUC,CAAI,CAE7C,CAGM,SAAUC,GAAW9B,EAAeE,EAAa,CACrD,GAAIF,EAAE,SAAWE,EAAE,OAAQ,MAAO,GAClC,IAAI6B,EAAO,EACX,QAASN,EAAI,EAAGA,EAAIzB,EAAE,OAAQyB,IAAKM,GAAQ/B,EAAEyB,CAAC,EAAIvB,EAAEuB,CAAC,EACrD,OAAOM,IAAS,CAClB,CAmIM,SAAUC,GACdC,EACAd,EACAe,EAAc,GAAI,CAElB,GAAIf,IAAQ,OAAW,OAAO,IAAI,WAAWc,CAAc,EAC3D,GAAId,EAAI,SAAWc,EACjB,MAAM,IAAI,MACR,0CAA4CA,EAAiB,UAAYd,EAAI,MAAM,EAEvF,GAAIe,GAAe,CAACC,GAAYhB,CAAG,EAAG,MAAM,IAAI,MAAM,iCAAiC,EACvF,OAAOA,CACT,CAEM,SAAUiB,GAAWC,EAAoBC,EAAmBC,EAAa,CAC7EtC,GAAMsC,CAAI,EACV,IAAMC,EAAM,IAAI,WAAW,EAAE,EACvBC,EAAOf,GAAWc,CAAG,EAC3B,OAAAC,EAAK,aAAa,EAAG,OAAOH,CAAS,EAAGC,CAAI,EAC5CE,EAAK,aAAa,EAAG,OAAOJ,CAAU,EAAGE,CAAI,EACtCC,CACT,CAGM,SAAUL,GAAY1B,EAAiB,CAC3C,OAAOA,EAAM,WAAa,IAAM,CAClC,CAGM,SAAUiC,GAAUjC,EAAiB,CACzC,OAAO,WAAW,KAAKA,CAAK,CAC9B,CAGM,SAAUkC,GAAYC,EAAc,GAAE,CAC1C,IAAMC,EAAK,OAAO,YAAe,SAAY,WAAmB,OAAS,KACzE,GAAI,OAAOA,GAAI,iBAAoB,WACjC,MAAM,IAAI,MAAM,wCAAwC,EAC1D,OAAOA,EAAG,gBAAgB,IAAI,WAAWD,CAAW,CAAC,CACvD,CA9ZA,IAqFaL,GA+NAO,GApTbC,GAAAC,GAAA,KAqFaT,GACX,IAAI,WAAW,IAAI,YAAY,CAAC,SAAU,CAAC,EAAE,MAAM,EAAE,CAAC,IAAM,GA8NjDO,GAAa,CACxBG,EACAC,IACS,CACT,SAASC,EAAcC,KAAoBC,EAAW,CAKpD,GAHAhD,GAAO+C,EAAK,OAAW,KAAK,EAGxB,CAACb,GAAM,MAAM,IAAI,MAAM,iDAAiD,EAG5E,GAAIU,EAAO,cAAgB,OAAW,CACpC,IAAMK,EAAQD,EAAK,CAAC,EACpBhD,GAAOiD,EAAOL,EAAO,aAAe,OAAYA,EAAO,YAAa,OAAO,CAC7E,CAGA,IAAMM,EAAON,EAAO,UAChBM,GAAQF,EAAK,CAAC,IAAM,QAAWhD,GAAOgD,EAAK,CAAC,EAAG,OAAW,KAAK,EAEnE,IAAMG,EAASN,EAAYE,EAAK,GAAGC,CAAI,EACjCI,EAAc,CAACC,EAAkBC,IAAuB,CAC5D,GAAIA,IAAW,OAAW,CACxB,GAAID,IAAa,EAAG,MAAM,IAAI,MAAM,6BAA6B,EACjErD,GAAOsD,EAAQ,OAAW,QAAQ,CACpC,CACF,EAEIC,EAAS,GAkBb,MAjBiB,CACf,QAAQC,EAAkBF,EAAmB,CAC3C,GAAIC,EAAQ,MAAM,IAAI,MAAM,8CAA8C,EAC1E,OAAAA,EAAS,GACTvD,GAAOwD,CAAI,EACXJ,EAAYD,EAAO,QAAQ,OAAQG,CAAM,EACjCH,EAA4B,QAAQK,EAAMF,CAAM,CAC1D,EACA,QAAQE,EAAkBF,EAAmB,CAE3C,GADAtD,GAAOwD,CAAI,EACPN,GAAQM,EAAK,OAASN,EACxB,MAAM,IAAI,MAAM,sDAAwDA,CAAI,EAC9E,OAAAE,EAAYD,EAAO,QAAQ,OAAQG,CAAM,EACjCH,EAA4B,QAAQK,EAAMF,CAAM,CAC1D,EAIJ,CAEA,cAAO,OAAOR,EAAeF,CAAM,EAC5BE,CACT,IC7SM,SAAUW,EAAKC,EAAWC,EAAS,CACvC,OAAQD,GAAKC,EAAMD,IAAO,GAAKC,CACjC,CAkCA,SAASC,GAAYD,EAAa,CAChC,OAAOA,EAAE,WAAa,IAAM,CAC9B,CAWA,SAASE,GACPC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAAc,CAEd,IAAMC,EAAMJ,EAAK,OACXK,EAAQ,IAAI,WAAWC,EAAS,EAChCC,EAAMC,GAAIH,CAAK,EAEfI,EAAYf,GAAYM,CAAI,GAAKN,GAAYO,CAAM,EACnDS,EAAMD,EAAYD,GAAIR,CAAI,EAAIW,GAC9BC,EAAMH,EAAYD,GAAIP,CAAM,EAAIU,GACtC,QAASE,EAAM,EAAGA,EAAMT,EAAKF,IAAW,CAEtC,GADAN,EAAKC,EAAOC,EAAKC,EAAOQ,EAAKL,EAASC,CAAM,EACxCD,GAAWY,GAAa,MAAM,IAAI,MAAM,uBAAuB,EACnE,IAAMC,EAAO,KAAK,IAAIT,GAAWF,EAAMS,CAAG,EAE1C,GAAIJ,GAAaM,IAAST,GAAW,CACnC,IAAMU,EAAQH,EAAM,EACpB,GAAIA,EAAM,IAAM,EAAG,MAAM,IAAI,MAAM,6BAA6B,EAChE,QAASI,EAAI,EAAGC,EAAcD,EAAIE,GAAaF,IAC7CC,EAAOF,EAAQC,EACfL,EAAIM,CAAI,EAAIR,EAAIQ,CAAI,EAAIX,EAAIU,CAAC,EAE/BJ,GAAOP,GACP,QACF,CACA,QAASW,EAAI,EAAGC,EAAMD,EAAIF,EAAME,IAC9BC,EAAOL,EAAMI,EACbhB,EAAOiB,CAAI,EAAIlB,EAAKkB,CAAI,EAAIb,EAAMY,CAAC,EAErCJ,GAAOE,CACT,CACF,CAGM,SAAUK,GAAaxB,EAAoByB,EAAgB,CAC/D,GAAM,CAAE,eAAAC,EAAgB,cAAAC,EAAe,cAAAC,EAAe,aAAAC,EAAc,OAAAtB,CAAM,EAAKuB,GAC7E,CAAE,eAAgB,GAAO,cAAe,EAAG,aAAc,GAAO,OAAQ,EAAE,EAC1EL,CAAI,EAEN,GAAI,OAAOzB,GAAS,WAAY,MAAM,IAAI,MAAM,yBAAyB,EACzE,OAAA+B,GAAQH,CAAa,EACrBG,GAAQxB,CAAM,EACdyB,GAAMH,CAAY,EAClBG,GAAMN,CAAc,EACb,CACLxB,EACAC,EACAC,EACAC,EACAC,EAAU,IACI,CACd2B,GAAO/B,EAAK,OAAW,KAAK,EAC5B+B,GAAO9B,EAAO,OAAW,OAAO,EAChC8B,GAAO7B,EAAM,OAAW,MAAM,EAC9B,IAAMI,EAAMJ,EAAK,OAIjB,GAHIC,IAAW,SAAWA,EAAS,IAAI,WAAWG,CAAG,GACrDyB,GAAO5B,EAAQ,OAAW,QAAQ,EAClC0B,GAAQzB,CAAO,EACXA,EAAU,GAAKA,GAAWY,GAAa,MAAM,IAAI,MAAM,uBAAuB,EAClF,GAAIb,EAAO,OAASG,EAClB,MAAM,IAAI,MAAM,gBAAgBH,EAAO,MAAM,2BAA2BG,CAAG,GAAG,EAChF,IAAM0B,EAAU,CAAA,EAKZC,EAAIjC,EAAI,OACRkC,EACAnC,EACJ,GAAIkC,IAAM,GACRD,EAAQ,KAAME,EAAIC,GAAUnC,CAAG,CAAE,EACjCD,EAAQqC,WACCH,IAAM,IAAMT,EACrBU,EAAI,IAAI,WAAW,EAAE,EACrBA,EAAE,IAAIlC,CAAG,EACTkC,EAAE,IAAIlC,EAAK,EAAE,EACbD,EAAQsC,GACRL,EAAQ,KAAKE,CAAC,MAEd,OAAAH,GAAO/B,EAAK,GAAI,SAAS,EACnB,IAAI,MAAM,kBAAkB,EAW/BJ,GAAYK,CAAK,GAAG+B,EAAQ,KAAM/B,EAAQkC,GAAUlC,CAAK,CAAE,EAEhE,IAAMqC,EAAM5B,GAAIwB,CAAC,EAEjB,GAAIT,EAAe,CACjB,GAAIxB,EAAM,SAAW,GAAI,MAAM,IAAI,MAAM,sCAAsC,EAC/EwB,EAAc1B,EAAOuC,EAAK5B,GAAIT,EAAM,SAAS,EAAG,EAAE,CAAC,EAAGqC,CAAG,EACzDrC,EAAQA,EAAM,SAAS,EAAE,CAC3B,CAGA,IAAMsC,EAAa,GAAKb,EACxB,GAAIa,IAAetC,EAAM,OACvB,MAAM,IAAI,MAAM,sBAAsBsC,CAAU,cAAc,EAGhE,GAAIA,IAAe,GAAI,CACrB,IAAMC,EAAK,IAAI,WAAW,EAAE,EAC5BA,EAAG,IAAIvC,EAAO0B,EAAe,EAAI,GAAK1B,EAAM,MAAM,EAClDA,EAAQuC,EACRR,EAAQ,KAAK/B,CAAK,CACpB,CACA,IAAMwC,EAAM/B,GAAIT,CAAK,EACrB,OAAAJ,GAAUC,EAAMC,EAAOuC,EAAKG,EAAKvC,EAAMC,EAAQC,EAASC,CAAM,EAC9DqC,GAAM,GAAGV,CAAO,EACT7B,CACT,CACF,CAzOA,IAoDMwC,GACAC,GACAC,GACAR,GACAD,GA4CA5B,GACAa,GAIAL,GAEAH,GAiIOiC,GA6FAC,GAzUbC,GAAAC,GAAA,KAsCAC,KAcMP,GAAaQ,GAAgB,WAAW,KAAKA,EAAI,MAAM,EAAE,EAAIC,GAAMA,EAAE,WAAW,CAAC,CAAC,EAClFR,GAAUD,GAAU,kBAAkB,EACtCE,GAAUF,GAAU,kBAAkB,EACtCN,GAAa3B,GAAIkC,EAAO,EACxBR,GAAa1B,GAAImC,EAAO,EA4CxBrC,GAAY,GACZa,GAAc,GAIdL,GAAc,GAAK,GAAK,EAExBH,GAAY,YAAY,GAAE,EAiInBiC,GAAP,MAAOO,CAAa,CACf,SACA,OACA,SACD,MACA,IACA,IACA,MACA,IACA,IACA,OACR,YACEC,EACAC,EACAC,EACAC,EACAC,EAAgB,CAEhB,KAAK,OAASJ,EACd,KAAK,SAAWC,EAChB,KAAK,OAASC,EACd,KAAK,SAAWC,EAChB,KAAK,MAAQ,IAAI,WAAW,KAAK,OAAS,KAAK,QAAQ,EACvD,KAAK,OAAOC,CAAI,EAChB,KAAK,IAAM,EACX,KAAK,IAAM,KAAK,SAChB,KAAK,IAAM,IAAI,WAAW,KAAK,QAAQ,EACvC,KAAK,IAAM,KAAK,MAAM,SAAS,EAAG,KAAK,MAAM,EAC7C,KAAK,MAAQ,KAAK,MAAM,SAAS,KAAK,MAAM,CAC9C,CACQ,OAAOA,EAAgB,CAE7B,GADA3B,GAAO2B,CAAI,EACP,CAACA,GAAQA,EAAK,SAAW,EAAG,MAAM,IAAI,MAAM,kBAAkB,EAClE,QAASC,EAAI,EAAGA,EAAID,EAAK,OAAQC,IAAK,KAAK,MAAMA,EAAI,KAAK,MAAM,MAAM,GAAKD,EAAKC,CAAC,EACjF,KAAK,IAAM,EACX,KAAK,IAAM,KAAK,QAClB,CACA,WAAWD,EAAgB,CACzB,KAAK,MAAM,IAAI,KAAK,YAAY,KAAK,MAAM,MAAM,CAAC,EAClD,KAAK,OAAOA,CAAI,CAClB,CACA,YAAYpD,EAAW,CAErB,GADAuB,GAAQvB,CAAG,EACPA,IAAQ,EAAG,OAAO,IAAI,WAAW,CAAC,EACtC,IAAMsD,EAAM,IAAI,WAAWtD,CAAG,EAC1BuD,EAAS,EAEb,GAAI,KAAK,IAAM,KAAK,SAAU,CAC5B,IAAM5C,EAAO,KAAK,IAAIX,EAAK,KAAK,SAAW,KAAK,GAAG,EAInD,GAHAsD,EAAI,IAAI,KAAK,IAAI,SAAS,KAAK,IAAK,KAAK,IAAM3C,CAAI,EAAG,CAAC,EACvD,KAAK,KAAOA,EACZ4C,GAAU5C,EACN4C,IAAWvD,EAAK,OAAOsD,CAC7B,CAEA,IAAME,EAAS,KAAK,OAAOxD,EAAMuD,GAAU,KAAK,QAAQ,EACxD,GAAIC,EAAS,EAAG,CACd,IAAMC,EAAaD,EAAS,KAAK,SAC3BnE,EAAIiE,EAAI,SAASC,EAAQA,EAASE,CAAU,EAClD,KAAK,OAAO,KAAK,IAAK,KAAK,MAAOpE,EAAGA,EAAG,KAAK,GAAG,EAChD,KAAK,KAAOmE,EACZD,GAAUE,CACZ,CAEA,IAAMC,EAAO1D,EAAMuD,EACnB,OAAIG,EAAO,IACT,KAAK,IAAI,KAAK,CAAC,EAEf,KAAK,OAAO,KAAK,IAAK,KAAK,MAAO,KAAK,IAAK,KAAK,IAAK,KAAK,KAAK,EAChEJ,EAAI,IAAI,KAAK,IAAI,SAAS,EAAGI,CAAI,EAAGH,CAAM,EAC1C,KAAK,IAAMG,GAENJ,CACT,CACA,OAAK,CACH,OAAO,IAAIP,EACT,KAAK,OACL,KAAK,SACL,KAAK,OACL,KAAK,SACL,KAAK,YAAY,KAAK,MAAM,MAAM,CAAC,CAEvC,CACA,OAAK,CACH,KAAK,IAAM,EACX,KAAK,IAAM,EACX,KAAK,IAAI,KAAK,CAAC,EACf,KAAK,MAAM,KAAK,CAAC,CACnB,GAKWN,GAAY,CACvBO,EACAC,EACAC,EACAC,IAEO,CAACC,EAAmBO,GAAY,EAAE,IACvC,IAAInB,GAAcQ,EAAQC,EAAUC,EAAQC,EAAUC,CAAI,ICtT9D,SAASQ,GAAOC,EAAeC,EAAS,CACtC,OAAQD,EAAEC,GAAG,EAAI,KAAUD,EAAEC,GAAG,EAAI,MAAS,CAC/C,CAwTM,SAAUC,GACdC,EAAgC,CAOhC,IAAMC,EAAQ,CAACC,EAAiBC,IAC9BH,EAASG,CAAG,EAAE,OAAOD,CAAG,EAAE,OAAM,EAC5BE,EAAMJ,EAAS,IAAI,WAAW,EAAE,CAAC,EACvC,OAAAC,EAAM,UAAYG,EAAI,UACtBH,EAAM,SAAWG,EAAI,SACrBH,EAAM,OAAUE,GAAoBH,EAASG,CAAG,EACzCF,CACT,CAnWA,IA2EaI,GA2RAC,GAtWbC,GAAAC,GAAA,KAoBAC,KAuDaJ,GAAP,KAAe,CACV,SAAW,GACX,UAAY,GACb,OAAS,IAAI,WAAW,EAAE,EAC1B,EAAI,IAAI,YAAY,EAAE,EACtB,EAAI,IAAI,YAAY,EAAE,EACtB,IAAM,IAAI,YAAY,CAAC,EACvB,IAAM,EACJ,SAAW,GAGrB,YAAYF,EAAe,CACzBA,EAAMO,GAAUC,GAAOR,EAAK,GAAI,KAAK,CAAC,EACtC,IAAMS,EAAKhB,GAAOO,EAAK,CAAC,EAClBU,EAAKjB,GAAOO,EAAK,CAAC,EAClBW,EAAKlB,GAAOO,EAAK,CAAC,EAClBY,EAAKnB,GAAOO,EAAK,CAAC,EAClBa,EAAKpB,GAAOO,EAAK,CAAC,EAClBc,EAAKrB,GAAOO,EAAK,EAAE,EACnBe,EAAKtB,GAAOO,EAAK,EAAE,EACnBgB,EAAKvB,GAAOO,EAAK,EAAE,EAGzB,KAAK,EAAE,CAAC,EAAIS,EAAK,KACjB,KAAK,EAAE,CAAC,GAAMA,IAAO,GAAOC,GAAM,GAAM,KACxC,KAAK,EAAE,CAAC,GAAMA,IAAO,GAAOC,GAAM,GAAM,KACxC,KAAK,EAAE,CAAC,GAAMA,IAAO,EAAMC,GAAM,GAAM,KACvC,KAAK,EAAE,CAAC,GAAMA,IAAO,EAAMC,GAAM,IAAO,IACxC,KAAK,EAAE,CAAC,EAAKA,IAAO,EAAK,KACzB,KAAK,EAAE,CAAC,GAAMA,IAAO,GAAOC,GAAM,GAAM,KACxC,KAAK,EAAE,CAAC,GAAMA,IAAO,GAAOC,GAAM,GAAM,KACxC,KAAK,EAAE,CAAC,GAAMA,IAAO,EAAMC,GAAM,GAAM,KACvC,KAAK,EAAE,CAAC,EAAKA,IAAO,EAAK,IACzB,QAASrB,EAAI,EAAGA,EAAI,EAAGA,IAAK,KAAK,IAAIA,CAAC,EAAIF,GAAOO,EAAK,GAAK,EAAIL,CAAC,CAClE,CAEQ,QAAQsB,EAAkBC,EAAgBC,EAAS,GAAK,CAC9D,IAAMC,EAAQD,EAAS,EAAI,KACrB,CAAE,EAAAE,EAAG,EAAAC,CAAC,EAAK,KACXC,EAAKD,EAAE,CAAC,EACRE,EAAKF,EAAE,CAAC,EACRG,EAAKH,EAAE,CAAC,EACRI,EAAKJ,EAAE,CAAC,EACRK,EAAKL,EAAE,CAAC,EACRM,EAAKN,EAAE,CAAC,EACRO,EAAKP,EAAE,CAAC,EACRQ,EAAKR,EAAE,CAAC,EACRS,EAAKT,EAAE,CAAC,EACRU,EAAKV,EAAE,CAAC,EAERb,EAAKhB,GAAOwB,EAAMC,EAAS,CAAC,EAC5BR,EAAKjB,GAAOwB,EAAMC,EAAS,CAAC,EAC5BP,EAAKlB,GAAOwB,EAAMC,EAAS,CAAC,EAC5BN,EAAKnB,GAAOwB,EAAMC,EAAS,CAAC,EAC5BL,EAAKpB,GAAOwB,EAAMC,EAAS,CAAC,EAC5BJ,EAAKrB,GAAOwB,EAAMC,EAAS,EAAE,EAC7BH,EAAKtB,GAAOwB,EAAMC,EAAS,EAAE,EAC7BF,EAAKvB,GAAOwB,EAAMC,EAAS,EAAE,EAE/Be,EAAKZ,EAAE,CAAC,GAAKZ,EAAK,MAClByB,EAAKb,EAAE,CAAC,IAAOZ,IAAO,GAAOC,GAAM,GAAM,MACzCyB,EAAKd,EAAE,CAAC,IAAOX,IAAO,GAAOC,GAAM,GAAM,MACzCyB,EAAKf,EAAE,CAAC,IAAOV,IAAO,EAAMC,GAAM,GAAM,MACxCyB,EAAKhB,EAAE,CAAC,IAAOT,IAAO,EAAMC,GAAM,IAAO,MACzCyB,EAAKjB,EAAE,CAAC,GAAMR,IAAO,EAAK,MAC1B0B,EAAKlB,EAAE,CAAC,IAAOR,IAAO,GAAOC,GAAM,GAAM,MACzC0B,EAAKnB,EAAE,CAAC,IAAOP,IAAO,GAAOC,GAAM,GAAM,MACzC0B,EAAKpB,EAAE,CAAC,IAAON,IAAO,EAAMC,GAAM,GAAM,MACxC0B,EAAKrB,EAAE,CAAC,GAAML,IAAO,EAAKI,GAE1BuB,EAAI,EAEJC,EAAKD,EAAIV,EAAKV,EAAKW,GAAM,EAAIF,GAAMG,GAAM,EAAIJ,GAAMK,GAAM,EAAIN,GAAMO,GAAM,EAAIR,GACjFc,EAAIC,IAAO,GACXA,GAAM,KACNA,GAAMN,GAAM,EAAIV,GAAMW,GAAM,EAAIZ,GAAMa,GAAM,EAAId,GAAMe,GAAM,EAAIhB,GAAMiB,GAAM,EAAIlB,GAChFmB,GAAKC,IAAO,GACZA,GAAM,KAEN,IAAIC,EAAKF,EAAIV,EAAKT,EAAKU,EAAKX,EAAKY,GAAM,EAAIH,GAAMI,GAAM,EAAIL,GAAMM,GAAM,EAAIP,GAC3Ea,EAAIE,IAAO,GACXA,GAAM,KACNA,GAAMP,GAAM,EAAIT,GAAMU,GAAM,EAAIX,GAAMY,GAAM,EAAIb,GAAMc,GAAM,EAAIf,GAAMgB,GAAM,EAAIjB,GAChFkB,GAAKE,IAAO,GACZA,GAAM,KAEN,IAAIC,EAAKH,EAAIV,EAAKR,EAAKS,EAAKV,EAAKW,EAAKZ,EAAKa,GAAM,EAAIJ,GAAMK,GAAM,EAAIN,GACrEY,EAAIG,IAAO,GACXA,GAAM,KACNA,GAAMR,GAAM,EAAIR,GAAMS,GAAM,EAAIV,GAAMW,GAAM,EAAIZ,GAAMa,GAAM,EAAId,GAAMe,GAAM,EAAIhB,GAChFiB,GAAKG,IAAO,GACZA,GAAM,KAEN,IAAIC,GAAKJ,EAAIV,EAAKP,EAAKQ,EAAKT,EAAKU,EAAKX,EAAKY,EAAKb,EAAKc,GAAM,EAAIL,GAC/DW,EAAII,KAAO,GACXA,IAAM,KACNA,IAAMT,GAAM,EAAIP,GAAMQ,GAAM,EAAIT,GAAMU,GAAM,EAAIX,GAAMY,GAAM,EAAIb,GAAMc,GAAM,EAAIf,GAChFgB,GAAKI,KAAO,GACZA,IAAM,KAEN,IAAIC,GAAKL,EAAIV,EAAKN,EAAKO,EAAKR,EAAKS,EAAKV,EAAKW,EAAKZ,EAAKa,EAAKd,EAC1DoB,EAAIK,KAAO,GACXA,IAAM,KACNA,IAAMV,GAAM,EAAIN,GAAMO,GAAM,EAAIR,GAAMS,GAAM,EAAIV,GAAMW,GAAM,EAAIZ,GAAMa,GAAM,EAAId,GAChFe,GAAKK,KAAO,GACZA,IAAM,KAEN,IAAIC,GAAKN,EAAIV,EAAKL,EAAKM,EAAKP,EAAKQ,EAAKT,EAAKU,EAAKX,EAAKY,EAAKb,EAC1DmB,EAAIM,KAAO,GACXA,IAAM,KACNA,IAAMX,EAAKf,EAAKgB,GAAM,EAAIP,GAAMQ,GAAM,EAAIT,GAAMU,GAAM,EAAIX,GAAMY,GAAM,EAAIb,GAC1Ec,GAAKM,KAAO,GACZA,IAAM,KAEN,IAAIC,GAAKP,EAAIV,EAAKJ,EAAKK,EAAKN,EAAKO,EAAKR,EAAKS,EAAKV,EAAKW,EAAKZ,EAC1DkB,EAAIO,KAAO,GACXA,IAAM,KACNA,IAAMZ,EAAKd,EAAKe,EAAKhB,EAAKiB,GAAM,EAAIR,GAAMS,GAAM,EAAIV,GAAMW,GAAM,EAAIZ,GACpEa,GAAKO,KAAO,GACZA,IAAM,KAEN,IAAIC,GAAKR,EAAIV,EAAKH,EAAKI,EAAKL,EAAKM,EAAKP,EAAKQ,EAAKT,EAAKU,EAAKX,EAC1DiB,EAAIQ,KAAO,GACXA,IAAM,KACNA,IAAMb,EAAKb,EAAKc,EAAKf,EAAKgB,EAAKjB,EAAKkB,GAAM,EAAIT,GAAMU,GAAM,EAAIX,GAC9DY,GAAKQ,KAAO,GACZA,IAAM,KAEN,IAAIC,GAAKT,EAAIV,EAAKF,EAAKG,EAAKJ,EAAKK,EAAKN,EAAKO,EAAKR,EAAKS,EAAKV,EAC1DgB,EAAIS,KAAO,GACXA,IAAM,KACNA,IAAMd,EAAKZ,EAAKa,EAAKd,EAAKe,EAAKhB,EAAKiB,EAAKlB,EAAKmB,GAAM,EAAIV,GACxDW,GAAKS,KAAO,GACZA,IAAM,KAEN,IAAIC,GAAKV,EAAIV,EAAKD,EAAKE,EAAKH,EAAKI,EAAKL,EAAKM,EAAKP,EAAKQ,EAAKT,EAC1De,EAAIU,KAAO,GACXA,IAAM,KACNA,IAAMf,EAAKX,EAAKY,EAAKb,EAAKc,EAAKf,EAAKgB,EAAKjB,EAAKkB,EAAKnB,EACnDoB,GAAKU,KAAO,GACZA,IAAM,KAENV,GAAMA,GAAK,GAAKA,EAAK,EACrBA,EAAKA,EAAIC,EAAM,EACfA,EAAKD,EAAI,KACTA,EAAIA,IAAM,GACVE,GAAMF,EAENtB,EAAE,CAAC,EAAIuB,EACPvB,EAAE,CAAC,EAAIwB,EACPxB,EAAE,CAAC,EAAIyB,EACPzB,EAAE,CAAC,EAAI0B,GACP1B,EAAE,CAAC,EAAI2B,GACP3B,EAAE,CAAC,EAAI4B,GACP5B,EAAE,CAAC,EAAI6B,GACP7B,EAAE,CAAC,EAAI8B,GACP9B,EAAE,CAAC,EAAI+B,GACP/B,EAAE,CAAC,EAAIgC,EACT,CAEQ,UAAQ,CACd,GAAM,CAAE,EAAAhC,EAAG,IAAAiC,CAAG,EAAK,KACbC,EAAI,IAAI,YAAY,EAAE,EACxBZ,EAAItB,EAAE,CAAC,IAAM,GACjBA,EAAE,CAAC,GAAK,KACR,QAAS1B,EAAI,EAAGA,EAAI,GAAIA,IACtB0B,EAAE1B,CAAC,GAAKgD,EACRA,EAAItB,EAAE1B,CAAC,IAAM,GACb0B,EAAE1B,CAAC,GAAK,KAEV0B,EAAE,CAAC,GAAKsB,EAAI,EACZA,EAAItB,EAAE,CAAC,IAAM,GACbA,EAAE,CAAC,GAAK,KACRA,EAAE,CAAC,GAAKsB,EACRA,EAAItB,EAAE,CAAC,IAAM,GACbA,EAAE,CAAC,GAAK,KACRA,EAAE,CAAC,GAAKsB,EAERY,EAAE,CAAC,EAAIlC,EAAE,CAAC,EAAI,EACdsB,EAAIY,EAAE,CAAC,IAAM,GACbA,EAAE,CAAC,GAAK,KACR,QAAS5D,EAAI,EAAGA,EAAI,GAAIA,IACtB4D,EAAE5D,CAAC,EAAI0B,EAAE1B,CAAC,EAAIgD,EACdA,EAAIY,EAAE5D,CAAC,IAAM,GACb4D,EAAE5D,CAAC,GAAK,KAEV4D,EAAE,CAAC,GAAK,KAER,IAAIC,GAAQb,EAAI,GAAK,EACrB,QAAShD,EAAI,EAAGA,EAAI,GAAIA,IAAK4D,EAAE5D,CAAC,GAAK6D,EACrCA,EAAO,CAACA,EACR,QAAS7D,EAAI,EAAGA,EAAI,GAAIA,IAAK0B,EAAE1B,CAAC,EAAK0B,EAAE1B,CAAC,EAAI6D,EAAQD,EAAE5D,CAAC,EACvD0B,EAAE,CAAC,GAAKA,EAAE,CAAC,EAAKA,EAAE,CAAC,GAAK,IAAO,MAC/BA,EAAE,CAAC,GAAMA,EAAE,CAAC,IAAM,EAAMA,EAAE,CAAC,GAAK,IAAO,MACvCA,EAAE,CAAC,GAAMA,EAAE,CAAC,IAAM,EAAMA,EAAE,CAAC,GAAK,GAAM,MACtCA,EAAE,CAAC,GAAMA,EAAE,CAAC,IAAM,EAAMA,EAAE,CAAC,GAAK,GAAM,MACtCA,EAAE,CAAC,GAAMA,EAAE,CAAC,IAAM,GAAOA,EAAE,CAAC,GAAK,EAAMA,EAAE,CAAC,GAAK,IAAO,MACtDA,EAAE,CAAC,GAAMA,EAAE,CAAC,IAAM,EAAMA,EAAE,CAAC,GAAK,IAAO,MACvCA,EAAE,CAAC,GAAMA,EAAE,CAAC,IAAM,EAAMA,EAAE,CAAC,GAAK,GAAM,MACtCA,EAAE,CAAC,GAAMA,EAAE,CAAC,IAAM,EAAMA,EAAE,CAAC,GAAK,GAAM,MAEtC,IAAIoC,EAAIpC,EAAE,CAAC,EAAIiC,EAAI,CAAC,EACpBjC,EAAE,CAAC,EAAIoC,EAAI,MACX,QAAS9D,EAAI,EAAGA,EAAI,EAAGA,IACrB8D,GAAOpC,EAAE1B,CAAC,EAAI2D,EAAI3D,CAAC,EAAK,IAAM8D,IAAM,IAAO,EAC3CpC,EAAE1B,CAAC,EAAI8D,EAAI,MAEbC,GAAMH,CAAC,CACT,CACA,OAAOtC,EAAgB,CACrB0C,GAAQ,IAAI,EACZnD,GAAOS,CAAI,EACXA,EAAOV,GAAUU,CAAI,EACrB,GAAM,CAAE,OAAA2C,EAAQ,SAAAC,CAAQ,EAAK,KACvBC,EAAM7C,EAAK,OAEjB,QAAS8C,EAAM,EAAGA,EAAMD,GAAO,CAC7B,IAAME,EAAO,KAAK,IAAIH,EAAW,KAAK,IAAKC,EAAMC,CAAG,EAEpD,GAAIC,IAASH,EAAU,CACrB,KAAOA,GAAYC,EAAMC,EAAKA,GAAOF,EAAU,KAAK,QAAQ5C,EAAM8C,CAAG,EACrE,QACF,CACAH,EAAO,IAAI3C,EAAK,SAAS8C,EAAKA,EAAMC,CAAI,EAAG,KAAK,GAAG,EACnD,KAAK,KAAOA,EACZD,GAAOC,EACH,KAAK,MAAQH,IACf,KAAK,QAAQD,EAAQ,EAAG,EAAK,EAC7B,KAAK,IAAM,EAEf,CACA,OAAO,IACT,CACA,SAAO,CACLF,GAAM,KAAK,EAAG,KAAK,EAAG,KAAK,OAAQ,KAAK,GAAG,CAC7C,CACA,WAAWO,EAAe,CACxBN,GAAQ,IAAI,EACZO,GAAQD,EAAK,IAAI,EACjB,KAAK,SAAW,GAChB,GAAM,CAAE,OAAAL,EAAQ,EAAAvC,CAAC,EAAK,KAClB,CAAE,IAAA0C,CAAG,EAAK,KACd,GAAIA,EAAK,CAEP,IADAH,EAAOG,GAAK,EAAI,EACTA,EAAM,GAAIA,IAAOH,EAAOG,CAAG,EAAI,EACtC,KAAK,QAAQH,EAAQ,EAAG,EAAI,CAC9B,CACA,KAAK,SAAQ,EACb,IAAIO,EAAO,EACX,QAASxE,EAAI,EAAGA,EAAI,EAAGA,IACrBsE,EAAIE,GAAM,EAAI9C,EAAE1B,CAAC,IAAM,EACvBsE,EAAIE,GAAM,EAAI9C,EAAE1B,CAAC,IAAM,EAEzB,OAAOsE,CACT,CACA,QAAM,CACJ,GAAM,CAAE,OAAAL,EAAQ,UAAAQ,CAAS,EAAK,KAC9B,KAAK,WAAWR,CAAM,EACtB,IAAMS,EAAMT,EAAO,MAAM,EAAGQ,CAAS,EACrC,YAAK,QAAO,EACLC,CACT,GAsBWlE,GACXP,GAAwBI,GAAQ,IAAIE,GAASF,CAAG,CAAC,ICvWnD,IAAAsE,GAAA,GAAAC,GAAAD,GAAA,oBAAAE,GAAA,aAAAC,GAAA,aAAAC,GAAA,iBAAAC,GAAA,qBAAAC,GAAA,YAAAC,GAAA,YAAAC,GAAA,gBAAAC,GAAA,eAAAC,GAAA,cAAAC,GAAA,sBAAAC,KAkGA,SAASC,GACPC,EAAgBC,EAAgBC,EAAgBC,EAAkBC,EAAaC,EAAS,GAAE,CAE1F,IAAIC,EAAMN,EAAE,CAAC,EAAGO,EAAMP,EAAE,CAAC,EAAGQ,EAAMR,EAAE,CAAC,EAAGS,EAAMT,EAAE,CAAC,EAC7CU,EAAMT,EAAE,CAAC,EAAGU,EAAMV,EAAE,CAAC,EAAGW,EAAMX,EAAE,CAAC,EAAGY,EAAMZ,EAAE,CAAC,EAC7Ca,EAAMb,EAAE,CAAC,EAAGc,EAAMd,EAAE,CAAC,EAAGe,EAAMf,EAAE,CAAC,EAAGgB,EAAMhB,EAAE,CAAC,EAC7CiB,EAAMd,EAAMe,EAAMjB,EAAE,CAAC,EAAGkB,EAAMlB,EAAE,CAAC,EAAGmB,EAAMnB,EAAE,CAAC,EAE7CoB,EAAMhB,EAAKiB,EAAMhB,EAAKiB,EAAMhB,EAAKiB,EAAMhB,EACvCiB,EAAMhB,EAAKiB,EAAMhB,EAAKiB,EAAMhB,EAAKiB,EAAMhB,EACvCiB,EAAMhB,EAAKiB,EAAMhB,EAAKiB,EAAMhB,EAAKiB,EAAMhB,EACvCiB,EAAMhB,EAAKiB,EAAMhB,EAAKiB,EAAMhB,EAAKiB,EAAMhB,EAC3C,QAASiB,GAAI,EAAGA,GAAIjC,EAAQiC,IAAK,EAC/BhB,EAAOA,EAAMI,EAAO,EAAGQ,EAAMK,EAAKL,EAAMZ,EAAK,EAAE,EAC/CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMa,EAAKb,EAAMI,EAAK,EAAE,EAC/CR,EAAOA,EAAMI,EAAO,EAAGQ,EAAMK,EAAKL,EAAMZ,EAAK,CAAC,EAC9CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMa,EAAKb,EAAMI,EAAK,CAAC,EAE9CP,EAAOA,EAAMI,EAAO,EAAGQ,EAAMI,EAAKJ,EAAMZ,EAAK,EAAE,EAC/CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMY,EAAKZ,EAAMI,EAAK,EAAE,EAC/CR,EAAOA,EAAMI,EAAO,EAAGQ,EAAMI,EAAKJ,EAAMZ,EAAK,CAAC,EAC9CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMY,EAAKZ,EAAMI,EAAK,CAAC,EAE9CP,EAAOA,EAAMI,EAAO,EAAGQ,EAAMG,EAAKH,EAAMZ,EAAK,EAAE,EAC/CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMW,EAAKX,EAAMI,EAAK,EAAE,EAC/CR,EAAOA,EAAMI,EAAO,EAAGQ,EAAMG,EAAKH,EAAMZ,EAAK,CAAC,EAC9CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMW,EAAKX,EAAMI,EAAK,CAAC,EAE9CP,EAAOA,EAAMI,EAAO,EAAGQ,EAAME,EAAKF,EAAMZ,EAAK,EAAE,EAC/CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMU,EAAKV,EAAMI,EAAK,EAAE,EAC/CR,EAAOA,EAAMI,EAAO,EAAGQ,EAAME,EAAKF,EAAMZ,EAAK,CAAC,EAC9CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMU,EAAKV,EAAMI,EAAK,CAAC,EAE9CX,EAAOA,EAAMK,EAAO,EAAGU,EAAME,EAAKF,EAAMf,EAAK,EAAE,EAC/CU,EAAOA,EAAMK,EAAO,EAAGV,EAAMY,EAAKZ,EAAMK,EAAK,EAAE,EAC/CV,EAAOA,EAAMK,EAAO,EAAGU,EAAME,EAAKF,EAAMf,EAAK,CAAC,EAC9CU,EAAOA,EAAMK,EAAO,EAAGV,EAAMY,EAAKZ,EAAMK,EAAK,CAAC,EAE9CT,EAAOA,EAAMK,EAAO,EAAGM,EAAMK,EAAKL,EAAMX,EAAK,EAAE,EAC/CU,EAAOA,EAAMC,EAAO,EAAGN,EAAMW,EAAKX,EAAMK,EAAK,EAAE,EAC/CV,EAAOA,EAAMK,EAAO,EAAGM,EAAMK,EAAKL,EAAMX,EAAK,CAAC,EAC9CU,EAAOA,EAAMC,EAAO,EAAGN,EAAMW,EAAKX,EAAMK,EAAK,CAAC,EAE9CT,EAAOA,EAAMK,EAAO,EAAGM,EAAMI,EAAKJ,EAAMX,EAAK,EAAE,EAC/CM,EAAOA,EAAMK,EAAO,EAAGN,EAAMU,EAAKV,EAAMC,EAAK,EAAE,EAC/CN,EAAOA,EAAMK,EAAO,EAAGM,EAAMI,EAAKJ,EAAMX,EAAK,CAAC,EAC9CM,EAAOA,EAAMK,EAAO,EAAGN,EAAMU,EAAKV,EAAMC,EAAK,CAAC,EAE9CL,EAAOA,EAAMC,EAAO,EAAGU,EAAMG,EAAKH,EAAMX,EAAK,EAAE,EAC/CM,EAAOA,EAAMK,EAAO,EAAGV,EAAMa,EAAKb,EAAMK,EAAK,EAAE,EAC/CN,EAAOA,EAAMC,EAAO,EAAGU,EAAMG,EAAKH,EAAMX,EAAK,CAAC,EAC9CM,EAAOA,EAAMK,EAAO,EAAGV,EAAMa,EAAKb,EAAMK,EAAK,CAAC,EAGhD,IAAIS,EAAK,EACTrC,EAAIqC,GAAI,EAAKlC,EAAMgB,EAAO,EAAGnB,EAAIqC,GAAI,EAAKjC,EAAMgB,EAAO,EACvDpB,EAAIqC,GAAI,EAAKhC,EAAMgB,EAAO,EAAGrB,EAAIqC,GAAI,EAAK/B,EAAMgB,EAAO,EACvDtB,EAAIqC,GAAI,EAAK9B,EAAMgB,EAAO,EAAGvB,EAAIqC,GAAI,EAAK7B,EAAMgB,EAAO,EACvDxB,EAAIqC,GAAI,EAAK5B,EAAMgB,EAAO,EAAGzB,EAAIqC,GAAI,EAAK3B,EAAMgB,EAAO,EACvD1B,EAAIqC,GAAI,EAAK1B,EAAMgB,EAAO,EAAG3B,EAAIqC,GAAI,EAAKzB,EAAMgB,EAAO,EACvD5B,EAAIqC,GAAI,EAAKxB,EAAMgB,EAAO,EAAG7B,EAAIqC,GAAI,EAAKvB,EAAMgB,EAAO,EACvD9B,EAAIqC,GAAI,EAAKtB,EAAMgB,EAAO,EAAG/B,EAAIqC,GAAI,EAAKrB,EAAMgB,EAAO,EACvDhC,EAAIqC,GAAI,EAAKpB,EAAMgB,EAAO,EAAGjC,EAAIqC,GAAI,EAAKnB,EAAMgB,EAAO,CACzD,CAOM,SAAU3C,GACdM,EAAgBC,EAAgBwC,EAAgBtC,EAAgB,CAEhE,IAAImB,EAAMtB,EAAE,CAAC,EAAGuB,EAAMvB,EAAE,CAAC,EAAGwB,EAAMxB,EAAE,CAAC,EAAGyB,EAAMzB,EAAE,CAAC,EAC7C0B,EAAMzB,EAAE,CAAC,EAAG0B,EAAM1B,EAAE,CAAC,EAAG2B,EAAM3B,EAAE,CAAC,EAAG4B,EAAM5B,EAAE,CAAC,EAC7C6B,EAAM7B,EAAE,CAAC,EAAG8B,EAAM9B,EAAE,CAAC,EAAG+B,EAAM/B,EAAE,CAAC,EAAGgC,EAAMhC,EAAE,CAAC,EAC7CiC,EAAMO,EAAE,CAAC,EAAGN,EAAMM,EAAE,CAAC,EAAGL,EAAMK,EAAE,CAAC,EAAGJ,EAAMI,EAAE,CAAC,EACjD,QAASH,EAAI,EAAGA,EAAI,GAAIA,GAAK,EAC3BhB,EAAOA,EAAMI,EAAO,EAAGQ,EAAMK,EAAKL,EAAMZ,EAAK,EAAE,EAC/CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMa,EAAKb,EAAMI,EAAK,EAAE,EAC/CR,EAAOA,EAAMI,EAAO,EAAGQ,EAAMK,EAAKL,EAAMZ,EAAK,CAAC,EAC9CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMa,EAAKb,EAAMI,EAAK,CAAC,EAE9CP,EAAOA,EAAMI,EAAO,EAAGQ,EAAMI,EAAKJ,EAAMZ,EAAK,EAAE,EAC/CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMY,EAAKZ,EAAMI,EAAK,EAAE,EAC/CR,EAAOA,EAAMI,EAAO,EAAGQ,EAAMI,EAAKJ,EAAMZ,EAAK,CAAC,EAC9CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMY,EAAKZ,EAAMI,EAAK,CAAC,EAE9CP,EAAOA,EAAMI,EAAO,EAAGQ,EAAMG,EAAKH,EAAMZ,EAAK,EAAE,EAC/CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMW,EAAKX,EAAMI,EAAK,EAAE,EAC/CR,EAAOA,EAAMI,EAAO,EAAGQ,EAAMG,EAAKH,EAAMZ,EAAK,CAAC,EAC9CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMW,EAAKX,EAAMI,EAAK,CAAC,EAE9CP,EAAOA,EAAMI,EAAO,EAAGQ,EAAME,EAAKF,EAAMZ,EAAK,EAAE,EAC/CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMU,EAAKV,EAAMI,EAAK,EAAE,EAC/CR,EAAOA,EAAMI,EAAO,EAAGQ,EAAME,EAAKF,EAAMZ,EAAK,CAAC,EAC9CQ,EAAOA,EAAMI,EAAO,EAAGR,EAAMU,EAAKV,EAAMI,EAAK,CAAC,EAE9CX,EAAOA,EAAMK,EAAO,EAAGU,EAAME,EAAKF,EAAMf,EAAK,EAAE,EAC/CU,EAAOA,EAAMK,EAAO,EAAGV,EAAMY,EAAKZ,EAAMK,EAAK,EAAE,EAC/CV,EAAOA,EAAMK,EAAO,EAAGU,EAAME,EAAKF,EAAMf,EAAK,CAAC,EAC9CU,EAAOA,EAAMK,EAAO,EAAGV,EAAMY,EAAKZ,EAAMK,EAAK,CAAC,EAE9CT,EAAOA,EAAMK,EAAO,EAAGM,EAAMK,EAAKL,EAAMX,EAAK,EAAE,EAC/CU,EAAOA,EAAMC,EAAO,EAAGN,EAAMW,EAAKX,EAAMK,EAAK,EAAE,EAC/CV,EAAOA,EAAMK,EAAO,EAAGM,EAAMK,EAAKL,EAAMX,EAAK,CAAC,EAC9CU,EAAOA,EAAMC,EAAO,EAAGN,EAAMW,EAAKX,EAAMK,EAAK,CAAC,EAE9CT,EAAOA,EAAMK,EAAO,EAAGM,EAAMI,EAAKJ,EAAMX,EAAK,EAAE,EAC/CM,EAAOA,EAAMK,EAAO,EAAGN,EAAMU,EAAKV,EAAMC,EAAK,EAAE,EAC/CN,EAAOA,EAAMK,EAAO,EAAGM,EAAMI,EAAKJ,EAAMX,EAAK,CAAC,EAC9CM,EAAOA,EAAMK,EAAO,EAAGN,EAAMU,EAAKV,EAAMC,EAAK,CAAC,EAE9CL,EAAOA,EAAMC,EAAO,EAAGU,EAAMG,EAAKH,EAAMX,EAAK,EAAE,EAC/CM,EAAOA,EAAMK,EAAO,EAAGV,EAAMa,EAAKb,EAAMK,EAAK,EAAE,EAC/CN,EAAOA,EAAMC,EAAO,EAAGU,EAAMG,EAAKH,EAAMX,EAAK,CAAC,EAC9CM,EAAOA,EAAMK,EAAO,EAAGV,EAAMa,EAAKb,EAAMK,EAAK,CAAC,EAEhD,IAAIS,EAAK,EACTrC,EAAIqC,GAAI,EAAIlB,EAAKnB,EAAIqC,GAAI,EAAIjB,EAC7BpB,EAAIqC,GAAI,EAAIhB,EAAKrB,EAAIqC,GAAI,EAAIf,EAC7BtB,EAAIqC,GAAI,EAAIN,EAAK/B,EAAIqC,GAAI,EAAIL,EAC7BhC,EAAIqC,GAAI,EAAIJ,EAAKjC,EAAIqC,GAAI,EAAIH,CAC/B,CAoDA,SAASK,GACPC,EACAC,EACAC,EACAC,EACAC,EAAgB,CAEZA,IAAQ,QAAWC,GAAOD,EAAK,OAAW,KAAK,EACnD,IAAME,EAAUN,EAAGC,EAAKC,EAAOK,EAAO,EAChCC,EAAUC,GAAWN,EAAW,OAAQC,EAAMA,EAAI,OAAS,EAAG,EAAI,EAIlEM,EAAIC,GAAS,OAAOL,CAAO,EAC7BF,GAAKQ,GAAaF,EAAGN,CAAG,EAC5BQ,GAAaF,EAAGP,CAAU,EAC1BO,EAAE,OAAOF,CAAO,EAChB,IAAMK,EAAMH,EAAE,OAAM,EACpB,OAAAI,GAAMR,EAASE,CAAO,EACfK,CACT,CArSA,IAgOajE,GASAD,GAUAO,GAQAJ,GAOAJ,GAMPqE,GAEAH,GAMAL,GA8BO9D,GAsCAI,GAUAM,GAUAH,GAMAC,GA9Wb+D,GAAAC,GAAA,KAgBAC,KACAC,KACAC,KA8MaxE,GAA0CyE,GAAajE,GAAY,CAC9E,aAAc,GACd,cAAe,EACf,eAAgB,GACjB,EAKYT,GAAsC0E,GAAajE,GAAY,CAC1E,aAAc,GACd,cAAe,EACf,eAAgB,GACjB,EAMYF,GAAuCmE,GAAajE,GAAY,CAC3E,aAAc,GACd,cAAe,EACf,cAAeL,GACf,eAAgB,GACjB,EAGYD,GAAqCuE,GAAajE,GAAY,CACzE,aAAc,GACd,cAAe,EACf,OAAQ,EACT,EAGYV,GAAsC2E,GAAajE,GAAY,CAC1E,aAAc,GACd,cAAe,EACf,OAAQ,GACT,EAEK2D,GAA0B,IAAI,WAAW,EAAE,EAE3CH,GAAe,CAACF,EAAuCY,IAAmB,CAC9EZ,EAAE,OAAOY,CAAG,EACZ,IAAMC,EAAWD,EAAI,OAAS,GAC1BC,GAAUb,EAAE,OAAOK,GAAQ,SAASQ,CAAQ,CAAC,CACnD,EAEMhB,GAA0B,IAAI,WAAW,EAAE,EA8BpC9D,GACV+E,GACD,CAACvB,EAAiBC,EAAmBE,KAE5B,CACL,QAAQqB,EAAuBC,EAAmB,CAChD,IAAMC,EAAUF,EAAU,OAC1BC,EAASE,GAAUD,EAAU,GAAWD,EAAQ,EAAK,EACrDA,EAAO,IAAID,CAAS,EACpB,IAAMI,EAASH,EAAO,SAAS,EAAG,GAAU,EAE5CF,EAAUvB,EAAKC,EAAO2B,EAAQA,EAAQ,CAAC,EACvC,IAAMC,EAAM/B,GAAWyB,EAAWvB,EAAKC,EAAO2B,EAAQzB,CAAG,EACzD,OAAAsB,EAAO,IAAII,EAAKH,CAAO,EACvBb,GAAMgB,CAAG,EACFJ,CACT,EACA,QAAQvB,EAAwBuB,EAAmB,CACjDA,EAASE,GAAUzB,EAAW,OAAS,GAAWuB,EAAQ,EAAK,EAC/D,IAAMK,EAAO5B,EAAW,SAAS,EAAG,GAAU,EACxC6B,EAAY7B,EAAW,SAAS,GAAU,EAC1C2B,EAAM/B,GAAWyB,EAAWvB,EAAKC,EAAO6B,EAAM3B,CAAG,EACvD,GAAI,CAAC6B,GAAWD,EAAWF,CAAG,EAAG,MAAM,IAAI,MAAM,aAAa,EAC9D,OAAAJ,EAAO,IAAIvB,EAAW,SAAS,EAAG,GAAU,CAAC,EAE7CqB,EAAUvB,EAAKC,EAAOwB,EAAQA,EAAQ,CAAC,EACvCZ,GAAMgB,CAAG,EACFJ,CACT,IAUO7E,GAA8CqF,GACzD,CAAE,UAAW,GAAI,YAAa,GAAI,UAAW,EAAE,EAC/CzF,GAAeE,EAAQ,CAAC,EAQbQ,GAA+C+E,GAC1D,CAAE,UAAW,GAAI,YAAa,GAAI,UAAW,EAAE,EAC/CzF,GAAeS,EAAS,CAAC,EAQdF,GAAsCmF,GAAUvF,GAAc,GAAI,GAAI,CAAC,EAMvEK,GAAqCkF,GAAUrF,GAAS,GAAI,GAAI,EAAE,ICxWzE,SAAUsF,GAAQC,EAAU,CAChC,OAAOA,aAAa,YAAe,YAAY,OAAOA,CAAC,GAAKA,EAAE,YAAY,OAAS,YACrF,CAGM,SAAUC,GAAQC,EAAWC,EAAgB,GAAE,CACnD,GAAI,CAAC,OAAO,cAAcD,CAAC,GAAKA,EAAI,EAAG,CACrC,IAAME,EAASD,GAAS,IAAIA,CAAK,KACjC,MAAM,IAAI,MAAM,GAAGC,CAAM,8BAA8BF,CAAC,EAAE,CAC5D,CACF,CAGM,SAAUG,EAAOC,EAAmBC,EAAiBJ,EAAgB,GAAE,CAC3E,IAAMK,EAAQT,GAAQO,CAAK,EACrBG,EAAMH,GAAO,OACbI,EAAWH,IAAW,OAC5B,GAAI,CAACC,GAAUE,GAAYD,IAAQF,EAAS,CAC1C,IAAMH,EAASD,GAAS,IAAIA,CAAK,KAC3BQ,EAAQD,EAAW,cAAcH,CAAM,GAAK,GAC5CK,EAAMJ,EAAQ,UAAUC,CAAG,GAAK,QAAQ,OAAOH,CAAK,GAC1D,MAAM,IAAI,MAAMF,EAAS,sBAAwBO,EAAQ,SAAWC,CAAG,CACzE,CACA,OAAON,CACT,CAGM,SAAUO,GAAMC,EAAQ,CAC5B,GAAI,OAAOA,GAAM,YAAc,OAAOA,EAAE,QAAW,WACjD,MAAM,IAAI,MAAM,yCAAyC,EAC3Db,GAAQa,EAAE,SAAS,EACnBb,GAAQa,EAAE,QAAQ,CACpB,CAGM,SAAUC,GAAQC,EAAeC,EAAgB,GAAI,CACzD,GAAID,EAAS,UAAW,MAAM,IAAI,MAAM,kCAAkC,EAC1E,GAAIC,GAAiBD,EAAS,SAAU,MAAM,IAAI,MAAM,uCAAuC,CACjG,CAGM,SAAUE,GAAQC,EAAUH,EAAa,CAC7CX,EAAOc,EAAK,OAAW,qBAAqB,EAC5C,IAAMC,EAAMJ,EAAS,UACrB,GAAIG,EAAI,OAASC,EACf,MAAM,IAAI,MAAM,oDAAsDA,CAAG,CAE7E,CAaM,SAAUC,GAAIC,EAAe,CACjC,OAAO,IAAI,YAAYA,EAAI,OAAQA,EAAI,WAAY,KAAK,MAAMA,EAAI,WAAa,CAAC,CAAC,CACnF,CAGM,SAAUC,MAASC,EAAoB,CAC3C,QAASC,EAAI,EAAGA,EAAID,EAAO,OAAQC,IACjCD,EAAOC,CAAC,EAAE,KAAK,CAAC,CAEpB,CAGM,SAAUC,GAAWJ,EAAe,CACxC,OAAO,IAAI,SAASA,EAAI,OAAQA,EAAI,WAAYA,EAAI,UAAU,CAChE,CAGM,SAAUK,GAAKC,EAAcC,EAAa,CAC9C,OAAQD,GAAS,GAAKC,EAAWD,IAASC,CAC5C,CAYM,SAAUC,GAASF,EAAY,CACnC,OACIA,GAAQ,GAAM,WACdA,GAAQ,EAAK,SACbA,IAAS,EAAK,MACdA,IAAS,GAAM,GAErB,CAOM,SAAUG,GAAWT,EAAgB,CACzC,QAASG,EAAI,EAAGA,EAAIH,EAAI,OAAQG,IAC9BH,EAAIG,CAAC,EAAIK,GAASR,EAAIG,CAAC,CAAC,EAE1B,OAAOH,CACT,CAoBM,SAAUU,GAAWxB,EAAiB,CAG1C,GAFAH,EAAOG,CAAK,EAERyB,GAAe,OAAOzB,EAAM,MAAK,EAErC,IAAI0B,EAAM,GACV,QAAST,EAAI,EAAGA,EAAIjB,EAAM,OAAQiB,IAChCS,GAAOC,GAAM3B,EAAMiB,CAAC,CAAC,EAEvB,OAAOS,CACT,CAIA,SAASE,GAAcC,EAAU,CAC/B,GAAIA,GAAMC,GAAO,IAAMD,GAAMC,GAAO,GAAI,OAAOD,EAAKC,GAAO,GAC3D,GAAID,GAAMC,GAAO,GAAKD,GAAMC,GAAO,EAAG,OAAOD,GAAMC,GAAO,EAAI,IAC9D,GAAID,GAAMC,GAAO,GAAKD,GAAMC,GAAO,EAAG,OAAOD,GAAMC,GAAO,EAAI,GAEhE,CAMM,SAAUC,GAAWL,EAAW,CACpC,GAAI,OAAOA,GAAQ,SAAU,MAAM,IAAI,MAAM,4BAA8B,OAAOA,CAAG,EAErF,GAAID,GAAe,OAAO,WAAW,QAAQC,CAAG,EAChD,IAAMM,EAAKN,EAAI,OACTO,EAAKD,EAAK,EAChB,GAAIA,EAAK,EAAG,MAAM,IAAI,MAAM,mDAAqDA,CAAE,EACnF,IAAME,EAAQ,IAAI,WAAWD,CAAE,EAC/B,QAASE,EAAK,EAAGC,EAAK,EAAGD,EAAKF,EAAIE,IAAMC,GAAM,EAAG,CAC/C,IAAMC,EAAKT,GAAcF,EAAI,WAAWU,CAAE,CAAC,EACrCE,EAAKV,GAAcF,EAAI,WAAWU,EAAK,CAAC,CAAC,EAC/C,GAAIC,IAAO,QAAaC,IAAO,OAAW,CACxC,IAAMC,EAAOb,EAAIU,CAAE,EAAIV,EAAIU,EAAK,CAAC,EACjC,MAAM,IAAI,MAAM,+CAAiDG,EAAO,cAAgBH,CAAE,CAC5F,CACAF,EAAMC,CAAE,EAAIE,EAAK,GAAKC,CACxB,CACA,OAAOJ,CACT,CAoDM,SAAUM,MAAexB,EAAoB,CACjD,IAAIyB,EAAM,EACV,QAASxB,EAAI,EAAGA,EAAID,EAAO,OAAQC,IAAK,CACtC,IAAMzB,EAAIwB,EAAOC,CAAC,EAClBpB,EAAOL,CAAC,EACRiD,GAAOjD,EAAE,MACX,CACA,IAAMkD,EAAM,IAAI,WAAWD,CAAG,EAC9B,QAASxB,EAAI,EAAG0B,EAAM,EAAG1B,EAAID,EAAO,OAAQC,IAAK,CAC/C,IAAMzB,EAAIwB,EAAOC,CAAC,EAClByB,EAAI,IAAIlD,EAAGmD,CAAG,EACdA,GAAOnD,EAAE,MACX,CACA,OAAOkD,CACT,CAoEM,SAAUE,GACdC,EACAC,EAAiB,CAAA,EAAE,CAEnB,IAAMC,EAAa,CAACC,EAAiBC,IAAgBJ,EAASI,CAAI,EAAE,OAAOD,CAAG,EAAE,OAAM,EAChFE,EAAML,EAAS,MAAS,EAC9B,OAAAE,EAAM,UAAYG,EAAI,UACtBH,EAAM,SAAWG,EAAI,SACrBH,EAAM,OAAUE,GAAgBJ,EAASI,CAAI,EAC7C,OAAO,OAAOF,EAAOD,CAAI,EAClB,OAAO,OAAOC,CAAK,CAC5B,CAGM,SAAUI,GAAYC,EAAc,GAAE,CAC1C,IAAMC,EAAK,OAAO,YAAe,SAAY,WAAmB,OAAS,KACzE,GAAI,OAAOA,GAAI,iBAAoB,WACjC,MAAM,IAAI,MAAM,wCAAwC,EAC1D,OAAOA,EAAG,gBAAgB,IAAI,WAAWD,CAAW,CAAC,CACvD,CA5UA,IA6FaE,GAyBAC,GAKP9B,GAKAE,GAqBAG,GA0LO0B,GA/UbC,GAAAC,GAAA,KA6FaJ,GACX,IAAI,WAAW,IAAI,YAAY,CAAC,SAAU,CAAC,EAAE,MAAM,EAAE,CAAC,IAAM,GAwBjDC,GAA8CD,GACtDK,GAAmBA,EACpBpC,GAGEE,GAEJ,OAAO,WAAW,KAAK,CAAA,CAAE,EAAE,OAAU,YAAc,OAAO,WAAW,SAAY,WAG7EE,GAAwB,MAAM,KAAK,CAAE,OAAQ,GAAG,EAAI,CAACiC,EAAG3C,IAC5DA,EAAE,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,CAAC,EAoB3Ba,GAAS,CAAE,GAAI,GAAI,GAAI,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,GAAG,EA0L/C0B,GAAWK,IAAwC,CAC9D,IAAK,WAAW,KAAK,CAAC,EAAM,EAAM,GAAM,IAAM,GAAM,EAAM,IAAM,EAAM,EAAM,EAAMA,CAAM,CAAC,MCzUrF,SAAUC,GAAIC,EAAWC,EAAWC,EAAS,CACjD,OAAQF,EAAIC,EAAM,CAACD,EAAIE,CACzB,CAGM,SAAUC,GAAIH,EAAWC,EAAWC,EAAS,CACjD,OAAQF,EAAIC,EAAMD,EAAIE,EAAMD,EAAIC,CAClC,CAdA,IAoBsBE,GAoHTC,GAUAC,GAMAC,GAxJbC,GAAAC,GAAA,KAIAC,KAgBsBN,GAAhB,KAAsB,CAOjB,SACA,UACA,UACA,KAGC,OACA,KACA,SAAW,GACX,OAAS,EACT,IAAM,EACN,UAAY,GAEtB,YAAYO,EAAkBC,EAAmBC,EAAmBC,EAAa,CAC/E,KAAK,SAAWH,EAChB,KAAK,UAAYC,EACjB,KAAK,UAAYC,EACjB,KAAK,KAAOC,EACZ,KAAK,OAAS,IAAI,WAAWH,CAAQ,EACrC,KAAK,KAAOI,GAAW,KAAK,MAAM,CACpC,CACA,OAAOC,EAAgB,CACrBC,GAAQ,IAAI,EACZC,EAAOF,CAAI,EACX,GAAM,CAAE,KAAAG,EAAM,OAAAC,EAAQ,SAAAT,CAAQ,EAAK,KAC7BU,EAAML,EAAK,OACjB,QAASM,EAAM,EAAGA,EAAMD,GAAO,CAC7B,IAAME,EAAO,KAAK,IAAIZ,EAAW,KAAK,IAAKU,EAAMC,CAAG,EAEpD,GAAIC,IAASZ,EAAU,CACrB,IAAMa,EAAWT,GAAWC,CAAI,EAChC,KAAOL,GAAYU,EAAMC,EAAKA,GAAOX,EAAU,KAAK,QAAQa,EAAUF,CAAG,EACzE,QACF,CACAF,EAAO,IAAIJ,EAAK,SAASM,EAAKA,EAAMC,CAAI,EAAG,KAAK,GAAG,EACnD,KAAK,KAAOA,EACZD,GAAOC,EACH,KAAK,MAAQZ,IACf,KAAK,QAAQQ,EAAM,CAAC,EACpB,KAAK,IAAM,EAEf,CACA,YAAK,QAAUH,EAAK,OACpB,KAAK,WAAU,EACR,IACT,CACA,WAAWS,EAAe,CACxBR,GAAQ,IAAI,EACZS,GAAQD,EAAK,IAAI,EACjB,KAAK,SAAW,GAIhB,GAAM,CAAE,OAAAL,EAAQ,KAAAD,EAAM,SAAAR,EAAU,KAAAG,CAAI,EAAK,KACrC,CAAE,IAAAQ,CAAG,EAAK,KAEdF,EAAOE,GAAK,EAAI,IAChBK,GAAM,KAAK,OAAO,SAASL,CAAG,CAAC,EAG3B,KAAK,UAAYX,EAAWW,IAC9B,KAAK,QAAQH,EAAM,CAAC,EACpBG,EAAM,GAGR,QAASM,EAAIN,EAAKM,EAAIjB,EAAUiB,IAAKR,EAAOQ,CAAC,EAAI,EAIjDT,EAAK,aAAaR,EAAW,EAAG,OAAO,KAAK,OAAS,CAAC,EAAGG,CAAI,EAC7D,KAAK,QAAQK,EAAM,CAAC,EACpB,IAAMU,EAAQd,GAAWU,CAAG,EACtBJ,EAAM,KAAK,UAEjB,GAAIA,EAAM,EAAG,MAAM,IAAI,MAAM,2CAA2C,EACxE,IAAMS,EAAST,EAAM,EACfU,EAAQ,KAAK,IAAG,EACtB,GAAID,EAASC,EAAM,OAAQ,MAAM,IAAI,MAAM,oCAAoC,EAC/E,QAASH,EAAI,EAAGA,EAAIE,EAAQF,IAAKC,EAAM,UAAU,EAAID,EAAGG,EAAMH,CAAC,EAAGd,CAAI,CACxE,CACA,QAAM,CACJ,GAAM,CAAE,OAAAM,EAAQ,UAAAR,CAAS,EAAK,KAC9B,KAAK,WAAWQ,CAAM,EACtB,IAAMY,EAAMZ,EAAO,MAAM,EAAGR,CAAS,EACrC,YAAK,QAAO,EACLoB,CACT,CACA,WAAWC,EAAM,CACfA,IAAO,IAAK,KAAK,YACjBA,EAAG,IAAI,GAAG,KAAK,IAAG,CAAE,EACpB,GAAM,CAAE,SAAAtB,EAAU,OAAAS,EAAQ,OAAAc,EAAQ,SAAAC,EAAU,UAAAC,EAAW,IAAAd,CAAG,EAAK,KAC/D,OAAAW,EAAG,UAAYG,EACfH,EAAG,SAAWE,EACdF,EAAG,OAASC,EACZD,EAAG,IAAMX,EACLY,EAASvB,GAAUsB,EAAG,OAAO,IAAIb,CAAM,EACpCa,CACT,CACA,OAAK,CACH,OAAO,KAAK,WAAU,CACxB,GASW5B,GAAyC,YAAY,KAAK,CACrE,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WACrF,EAQYC,GAAyC,YAAY,KAAK,CACrE,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WACpF,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WACrF,EAGYC,GAAyC,YAAY,KAAK,CACrE,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WACpF,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UACrF,ICnJD,SAAS8B,GACPC,EACAC,EAAK,GAAK,CAKV,OAAIA,EAAW,CAAE,EAAG,OAAOD,EAAIE,EAAU,EAAG,EAAG,OAAQF,GAAKG,GAAQD,EAAU,CAAC,EACxE,CAAE,EAAG,OAAQF,GAAKG,GAAQD,EAAU,EAAI,EAAG,EAAG,OAAOF,EAAIE,EAAU,EAAI,CAAC,CACjF,CAEA,SAASE,GAAMC,EAAeJ,EAAK,GAAK,CACtC,IAAMK,EAAMD,EAAI,OACZE,EAAK,IAAI,YAAYD,CAAG,EACxBE,EAAK,IAAI,YAAYF,CAAG,EAC5B,QAAS,EAAI,EAAG,EAAIA,EAAK,IAAK,CAC5B,GAAM,CAAE,EAAAG,EAAG,EAAAC,CAAC,EAAKX,GAAQM,EAAI,CAAC,EAAGJ,CAAE,EACnC,CAACM,EAAG,CAAC,EAAGC,EAAG,CAAC,CAAC,EAAI,CAACC,EAAGC,CAAC,CACxB,CACA,MAAO,CAACH,EAAIC,CAAE,CAChB,CAwBA,SAASG,GACPJ,EACAC,EACAI,EACAC,EAAU,CAKV,IAAMH,GAAKF,IAAO,IAAMK,IAAO,GAC/B,MAAO,CAAE,EAAIN,EAAKK,GAAOF,EAAI,GAAK,GAAM,GAAM,EAAG,EAAGA,EAAI,CAAC,CAC3D,CA/DA,IAKMR,GACAC,GA0BAW,GACAC,GAEAC,GACAC,GAEAC,GACAC,GAKAC,GACAC,GAEAC,GACAC,GAiBAC,GACAC,GAEAC,GAEAC,GAEAC,GAEAC,GA1ENC,GAAAC,GAAA,KAKM7B,GAA6B,OAAO,UAAW,EAC/CC,GAAuB,OAAO,EAAE,EA0BhCW,GAAQ,CAACL,EAAWuB,EAAYC,IAAsBxB,IAAMwB,EAC5DlB,GAAQ,CAACN,EAAWC,EAAWuB,IAAuBxB,GAAM,GAAKwB,EAAOvB,IAAMuB,EAE9EjB,GAAS,CAACP,EAAWC,EAAWuB,IAAuBxB,IAAMwB,EAAMvB,GAAM,GAAKuB,EAC9EhB,GAAS,CAACR,EAAWC,EAAWuB,IAAuBxB,GAAM,GAAKwB,EAAOvB,IAAMuB,EAE/Ef,GAAS,CAACT,EAAWC,EAAWuB,IAAuBxB,GAAM,GAAKwB,EAAOvB,IAAOuB,EAAI,GACpFd,GAAS,CAACV,EAAWC,EAAWuB,IAAuBxB,IAAOwB,EAAI,GAAQvB,GAAM,GAAKuB,EAKrFb,GAAS,CAACX,EAAWC,EAAWuB,IAAuBxB,GAAKwB,EAAMvB,IAAO,GAAKuB,EAC9EZ,GAAS,CAACZ,EAAWC,EAAWuB,IAAuBvB,GAAKuB,EAAMxB,IAAO,GAAKwB,EAE9EX,GAAS,CAACb,EAAWC,EAAWuB,IAAuBvB,GAAMuB,EAAI,GAAQxB,IAAO,GAAKwB,EACrFV,GAAS,CAACd,EAAWC,EAAWuB,IAAuBxB,GAAMwB,EAAI,GAAQvB,IAAO,GAAKuB,EAiBrFT,GAAQ,CAAChB,EAAYK,EAAYqB,KAAwB1B,IAAO,IAAMK,IAAO,IAAMqB,IAAO,GAC1FT,GAAQ,CAACU,EAAa5B,EAAYK,EAAYwB,IACjD7B,EAAKK,EAAKwB,GAAOD,EAAM,GAAK,GAAM,GAAM,EACrCT,GAAQ,CAAClB,EAAYK,EAAYqB,EAAYG,KAChD7B,IAAO,IAAMK,IAAO,IAAMqB,IAAO,IAAMG,IAAO,GAC3CV,GAAQ,CAACQ,EAAa5B,EAAYK,EAAYwB,EAAYE,IAC7D/B,EAAKK,EAAKwB,EAAKE,GAAOH,EAAM,GAAK,GAAM,GAAM,EAC1CP,GAAQ,CAACpB,EAAYK,EAAYqB,EAAYG,EAAYE,KAC5D/B,IAAO,IAAMK,IAAO,IAAMqB,IAAO,IAAMG,IAAO,IAAME,IAAO,GACxDV,GAAQ,CAACM,EAAa5B,EAAYK,EAAYwB,EAAYE,EAAYE,IACzEjC,EAAKK,EAAKwB,EAAKE,EAAKE,GAAOL,EAAM,GAAK,GAAM,GAAM,IC3ErD,IAgBMM,GAYAC,GAGSC,GA+EFC,GAoCPC,GAsBAC,GACAC,GAGAC,GACAC,GAGSC,GAsIFC,GAwBAC,GAkGAC,GAWAC,GAKAC,GAhcbC,GAAAC,GAAA,KAOAC,KACAC,KACAC,KAOMnB,GAA2B,YAAY,KAAK,CAChD,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WACpF,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WACpF,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WACpF,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UACpF,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WACpF,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UACpF,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WACpF,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WACrF,EAGKC,GAA2B,IAAI,YAAY,EAAE,EAGpCC,GAAf,cAAuDkB,EAAS,CAY9D,YAAYC,EAAiB,CAC3B,MAAM,GAAIA,EAAW,EAAG,EAAK,CAC/B,CACU,KAAG,CACX,GAAM,CAAE,EAAAC,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,CAAC,EAAK,KACnC,MAAO,CAACP,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,CAAC,CAChC,CAEU,IACRP,EAAWC,EAAWC,EAAWC,EAAWC,EAAWC,EAAWC,EAAWC,EAAS,CAEtF,KAAK,EAAIP,EAAI,EACb,KAAK,EAAIC,EAAI,EACb,KAAK,EAAIC,EAAI,EACb,KAAK,EAAIC,EAAI,EACb,KAAK,EAAIC,EAAI,EACb,KAAK,EAAIC,EAAI,EACb,KAAK,EAAIC,EAAI,EACb,KAAK,EAAIC,EAAI,CACf,CACU,QAAQC,EAAgBC,EAAc,CAE9C,QAASC,EAAI,EAAGA,EAAI,GAAIA,IAAKD,GAAU,EAAG9B,GAAS+B,CAAC,EAAIF,EAAK,UAAUC,EAAQ,EAAK,EACpF,QAASC,EAAI,GAAIA,EAAI,GAAIA,IAAK,CAC5B,IAAMC,EAAMhC,GAAS+B,EAAI,EAAE,EACrBE,EAAKjC,GAAS+B,EAAI,CAAC,EACnBG,EAAKC,GAAKH,EAAK,CAAC,EAAIG,GAAKH,EAAK,EAAE,EAAKA,IAAQ,EAC7CI,EAAKD,GAAKF,EAAI,EAAE,EAAIE,GAAKF,EAAI,EAAE,EAAKA,IAAO,GACjDjC,GAAS+B,CAAC,EAAKK,EAAKpC,GAAS+B,EAAI,CAAC,EAAIG,EAAKlC,GAAS+B,EAAI,EAAE,EAAK,CACjE,CAEA,GAAI,CAAE,EAAAV,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,CAAC,EAAK,KACjC,QAASG,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAC3B,IAAMM,EAASF,GAAKV,EAAG,CAAC,EAAIU,GAAKV,EAAG,EAAE,EAAIU,GAAKV,EAAG,EAAE,EAC9Ca,EAAMV,EAAIS,EAASE,GAAId,EAAGC,EAAGC,CAAC,EAAI5B,GAASgC,CAAC,EAAI/B,GAAS+B,CAAC,EAAK,EAE/DS,GADSL,GAAKd,EAAG,CAAC,EAAIc,GAAKd,EAAG,EAAE,EAAIc,GAAKd,EAAG,EAAE,GAC/BoB,GAAIpB,EAAGC,EAAGC,CAAC,EAAK,EACrCK,EAAID,EACJA,EAAID,EACJA,EAAID,EACJA,EAAKD,EAAIc,EAAM,EACfd,EAAID,EACJA,EAAID,EACJA,EAAID,EACJA,EAAKiB,EAAKE,EAAM,CAClB,CAEAnB,EAAKA,EAAI,KAAK,EAAK,EACnBC,EAAKA,EAAI,KAAK,EAAK,EACnBC,EAAKA,EAAI,KAAK,EAAK,EACnBC,EAAKA,EAAI,KAAK,EAAK,EACnBC,EAAKA,EAAI,KAAK,EAAK,EACnBC,EAAKA,EAAI,KAAK,EAAK,EACnBC,EAAKA,EAAI,KAAK,EAAK,EACnBC,EAAKA,EAAI,KAAK,EAAK,EACnB,KAAK,IAAIP,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,CAAC,CACjC,CACU,YAAU,CAClBc,GAAM1C,EAAQ,CAChB,CACA,SAAO,CACL,KAAK,IAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,CAAC,EAC/B0C,GAAM,KAAK,MAAM,CACnB,GAIWxC,GAAP,cAAuBD,EAAiB,CAGlC,EAAY0C,GAAU,CAAC,EAAI,EAC3B,EAAYA,GAAU,CAAC,EAAI,EAC3B,EAAYA,GAAU,CAAC,EAAI,EAC3B,EAAYA,GAAU,CAAC,EAAI,EAC3B,EAAYA,GAAU,CAAC,EAAI,EAC3B,EAAYA,GAAU,CAAC,EAAI,EAC3B,EAAYA,GAAU,CAAC,EAAI,EAC3B,EAAYA,GAAU,CAAC,EAAI,EACrC,aAAA,CACE,MAAM,EAAE,CACV,GAuBIxC,GAAkCyC,GAAM,CAC5C,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,qBAClE,qBAAsB,qBAAsB,qBAAsB,sBAClE,IAAIC,GAAK,OAAOA,CAAC,CAAC,CAAC,EACfzC,GAAmCD,GAAK,CAAC,EACzCE,GAAmCF,GAAK,CAAC,EAGzCG,GAA6B,IAAI,YAAY,EAAE,EAC/CC,GAA6B,IAAI,YAAY,EAAE,EAGtCC,GAAf,cAAuDW,EAAS,CAqB9D,YAAYC,EAAiB,CAC3B,MAAM,IAAKA,EAAW,GAAI,EAAK,CACjC,CAEU,KAAG,CAIX,GAAM,CAAE,GAAA0B,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,CAAE,EAAK,KAC3E,MAAO,CAACf,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,CAAE,CACxE,CAEU,IACRf,EAAYC,EAAYC,EAAYC,EAAYC,EAAYC,EAAYC,EAAYC,EACpFC,EAAYC,EAAYC,EAAYC,EAAYC,EAAYC,EAAYC,EAAYC,EAAU,CAE9F,KAAK,GAAKf,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,EACf,KAAK,GAAKC,EAAK,CACjB,CACU,QAAQhC,EAAgBC,EAAc,CAE9C,QAASC,EAAI,EAAGA,EAAI,GAAIA,IAAKD,GAAU,EACrCxB,GAAWyB,CAAC,EAAIF,EAAK,UAAUC,CAAM,EACrCvB,GAAWwB,CAAC,EAAIF,EAAK,UAAWC,GAAU,CAAE,EAE9C,QAASC,EAAI,GAAIA,EAAI,GAAIA,IAAK,CAE5B,IAAM+B,EAAOxD,GAAWyB,EAAI,EAAE,EAAI,EAC5BgC,EAAOxD,GAAWwB,EAAI,EAAE,EAAI,EAC5BiC,EAAUC,GAAOH,EAAMC,EAAM,CAAC,EAAQE,GAAOH,EAAMC,EAAM,CAAC,EAAQG,GAAMJ,EAAMC,EAAM,CAAC,EACrFI,EAAUC,GAAON,EAAMC,EAAM,CAAC,EAAQK,GAAON,EAAMC,EAAM,CAAC,EAAQM,GAAMP,EAAMC,EAAM,CAAC,EAErFO,EAAMhE,GAAWyB,EAAI,CAAC,EAAI,EAC1BwC,EAAMhE,GAAWwB,EAAI,CAAC,EAAI,EAC1ByC,EAAUP,GAAOK,EAAKC,EAAK,EAAE,EAAQE,GAAOH,EAAKC,EAAK,EAAE,EAAQL,GAAMI,EAAKC,EAAK,CAAC,EACjFG,EAAUN,GAAOE,EAAKC,EAAK,EAAE,EAAQI,GAAOL,EAAKC,EAAK,EAAE,EAAQF,GAAMC,EAAKC,EAAK,CAAC,EAEjFK,EAAWC,GAAMV,EAAKO,EAAKnE,GAAWwB,EAAI,CAAC,EAAGxB,GAAWwB,EAAI,EAAE,CAAC,EAChE+C,EAAWC,GAAMH,EAAMZ,EAAKQ,EAAKlE,GAAWyB,EAAI,CAAC,EAAGzB,GAAWyB,EAAI,EAAE,CAAC,EAC5EzB,GAAWyB,CAAC,EAAI+C,EAAO,EACvBvE,GAAWwB,CAAC,EAAI6C,EAAO,CACzB,CACA,GAAI,CAAE,GAAA9B,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,EAAI,GAAAC,CAAE,EAAK,KAEzE,QAAS9B,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAE3B,IAAMiD,EAAcf,GAAOX,EAAIC,EAAI,EAAE,EAAQU,GAAOX,EAAIC,EAAI,EAAE,EAAQkB,GAAOnB,EAAIC,EAAI,EAAE,EACjF0B,EAAcb,GAAOd,EAAIC,EAAI,EAAE,EAAQa,GAAOd,EAAIC,EAAI,EAAE,EAAQoB,GAAOrB,EAAIC,EAAI,EAAE,EAEjF2B,EAAQ5B,EAAKE,EAAO,CAACF,EAAKI,EAC1ByB,EAAQ5B,EAAKE,EAAO,CAACF,EAAKI,EAG1ByB,EAAWC,GAAMxB,EAAIoB,EAASE,EAAM9E,GAAU0B,CAAC,EAAGxB,GAAWwB,CAAC,CAAC,EAC/DuD,EAAUC,GAAMH,EAAMxB,EAAIoB,EAASE,EAAM9E,GAAU2B,CAAC,EAAGzB,GAAWyB,CAAC,CAAC,EACpEyD,EAAMJ,EAAO,EAEbK,EAAcxB,GAAOnB,EAAIC,EAAI,EAAE,EAAQ0B,GAAO3B,EAAIC,EAAI,EAAE,EAAQ0B,GAAO3B,EAAIC,EAAI,EAAE,EACjF2C,EAActB,GAAOtB,EAAIC,EAAI,EAAE,EAAQ4B,GAAO7B,EAAIC,EAAI,EAAE,EAAQ4B,GAAO7B,EAAIC,EAAI,EAAE,EACjF4C,EAAQ7C,EAAKE,EAAOF,EAAKI,EAAOF,EAAKE,EACrC0C,EAAQ7C,EAAKE,EAAOF,EAAKI,EAAOF,EAAKE,EAC3CS,EAAKF,EAAK,EACVG,EAAKF,EAAK,EACVD,EAAKF,EAAK,EACVG,EAAKF,EAAK,EACVD,EAAKF,EAAK,EACVG,EAAKF,EAAK,EACT,CAAE,EAAGD,EAAI,EAAGC,CAAE,EAASsC,GAAIzC,EAAK,EAAGC,EAAK,EAAGiC,EAAM,EAAGE,EAAM,CAAC,EAC5DpC,EAAKF,EAAK,EACVG,EAAKF,EAAK,EACVD,EAAKF,EAAK,EACVG,EAAKF,EAAK,EACVD,EAAKF,EAAK,EACVG,EAAKF,EAAK,EACV,IAAM+C,EAAUC,GAAMP,EAAKE,EAASE,CAAI,EACxC9C,EAASkD,GAAMF,EAAKR,EAAKG,EAASE,CAAI,EACtC5C,EAAK+C,EAAM,CACb,EAEC,CAAE,EAAGhD,EAAI,EAAGC,CAAE,EAAS8C,GAAI,KAAK,GAAK,EAAG,KAAK,GAAK,EAAG/C,EAAK,EAAGC,EAAK,CAAC,GACnE,CAAE,EAAGC,EAAI,EAAGC,CAAE,EAAS4C,GAAI,KAAK,GAAK,EAAG,KAAK,GAAK,EAAG7C,EAAK,EAAGC,EAAK,CAAC,EACnE,CAAE,EAAGC,EAAI,EAAGC,CAAE,EAAS0C,GAAI,KAAK,GAAK,EAAG,KAAK,GAAK,EAAG3C,EAAK,EAAGC,EAAK,CAAC,EACnE,CAAE,EAAGC,EAAIC,CAAK,EAASwC,GAAI,KAAK,GAAK,EAAG,KAAK,GAAK,EAAGzC,EAAK,EAAGC,EAAK,CAAC,EACnE,CAAE,EAAGC,EAAI,EAAGC,CAAE,EAASsC,GAAI,KAAK,GAAK,EAAG,KAAK,GAAK,EAAGvC,EAAK,EAAGC,EAAK,CAAC,EACnE,CAAEC,EAAO,EAAGC,CAAE,EAASoC,GAAI,KAAK,GAAK,EAAG,KAAK,GAAK,EAAGrC,EAAK,EAAGC,EAAK,CAAC,EACnE,CAAE,EAAGC,EAAI,EAAGC,CAAE,EAASkC,GAAI,KAAK,GAAK,EAAG,KAAK,GAAK,EAAGnC,EAAK,EAAGC,EAAK,CAAC,EACnE,CAAE,EAAGC,EAAI,EAAGC,CAAE,EAASgC,GAAI,KAAK,GAAK,EAAG,KAAK,GAAK,EAAGjC,EAAK,EAAGC,EAAK,CAAC,EACpE,KAAK,IAAIf,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,CAAE,CACzE,CACU,YAAU,CAClBnB,GAAMpC,GAAYC,EAAU,CAC9B,CACA,SAAO,CACLmC,GAAM,KAAK,MAAM,EACjB,KAAK,IAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,CAAC,CACzD,GAIWjC,GAAP,cAAuBD,EAAiB,CAClC,GAAayF,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,EAAE,EAAI,EAC7B,GAAaA,GAAU,EAAE,EAAI,EAC7B,GAAaA,GAAU,EAAE,EAAI,EAC7B,GAAaA,GAAU,EAAE,EAAI,EAC7B,GAAaA,GAAU,EAAE,EAAI,EAC7B,GAAaA,GAAU,EAAE,EAAI,EAEvC,aAAA,CACE,MAAM,EAAE,CACV,GAIWvF,GAAP,cAAuBF,EAAiB,CAClC,GAAa0F,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,CAAC,EAAI,EAC5B,GAAaA,GAAU,EAAE,EAAI,EAC7B,GAAaA,GAAU,EAAE,EAAI,EAC7B,GAAaA,GAAU,EAAE,EAAI,EAC7B,GAAaA,GAAU,EAAE,EAAI,EAC7B,GAAaA,GAAU,EAAE,EAAI,EAC7B,GAAaA,GAAU,EAAE,EAAI,EAEvC,aAAA,CACE,MAAM,EAAE,CACV,GA8EWvF,GAAyCwF,GACpD,IAAM,IAAIjG,GACMkG,GAAQ,CAAI,CAAC,EASlBxF,GAAyCuF,GACpD,IAAM,IAAI1F,GACM2F,GAAQ,CAAI,CAAC,EAGlBvF,GAAyCsF,GACpD,IAAM,IAAIzF,GACM0F,GAAQ,CAAI,CAAC,ICnazB,SAAUC,GAAMC,EAAgBC,EAAgB,GAAE,CACtD,GAAI,OAAOD,GAAU,UAAW,CAC9B,IAAME,EAASD,GAAS,IAAIA,CAAK,KACjC,MAAM,IAAI,MAAMC,EAAS,8BAAgC,OAAOF,CAAK,CACvE,CACA,OAAOA,CACT,CAGA,SAASG,GAAWC,EAAkB,CACpC,GAAI,OAAOA,GAAM,UACf,GAAI,CAACC,GAASD,CAAC,EAAG,MAAM,IAAI,MAAM,iCAAmCA,CAAC,OACjEE,GAAQF,CAAC,EAChB,OAAOA,CACT,CAEM,SAAUG,GAAYP,EAAeC,EAAgB,GAAE,CAC3D,GAAI,CAAC,OAAO,cAAcD,CAAK,EAAG,CAChC,IAAME,EAASD,GAAS,IAAIA,CAAK,KACjC,MAAM,IAAI,MAAMC,EAAS,mCAAqC,OAAOF,CAAK,CAC5E,CACF,CAEM,SAAUQ,GAAoBC,EAAoB,CACtD,IAAMC,EAAMP,GAAWM,CAAG,EAAE,SAAS,EAAE,EACvC,OAAOC,EAAI,OAAS,EAAI,IAAMA,EAAMA,CACtC,CAEM,SAAUC,GAAYD,EAAW,CACrC,GAAI,OAAOA,GAAQ,SAAU,MAAM,IAAI,MAAM,4BAA8B,OAAOA,CAAG,EACrF,OAAOA,IAAQ,GAAKE,GAAM,OAAO,KAAOF,CAAG,CAC7C,CAGM,SAAUG,GAAgBC,EAAiB,CAC/C,OAAOH,GAAYI,GAAYD,CAAK,CAAC,CACvC,CACM,SAAUE,GAAgBF,EAAiB,CAC/C,OAAOH,GAAYI,GAAYE,GAAUC,EAAQJ,CAAK,CAAC,EAAE,QAAO,CAAE,CAAC,CACrE,CAEM,SAAUK,GAAgBf,EAAoBgB,EAAW,CAC7Dd,GAAQc,CAAG,EACXhB,EAAID,GAAWC,CAAC,EAChB,IAAMiB,EAAMC,GAAYlB,EAAE,SAAS,EAAE,EAAE,SAASgB,EAAM,EAAG,GAAG,CAAC,EAC7D,GAAIC,EAAI,SAAWD,EAAK,MAAM,IAAI,MAAM,kBAAkB,EAC1D,OAAOC,CACT,CACM,SAAUE,GAAgBnB,EAAoBgB,EAAW,CAC7D,OAAOD,GAAgBf,EAAGgB,CAAG,EAAE,QAAO,CACxC,CAOM,SAAUI,GAAWC,EAAeC,EAAa,CACrD,GAAID,EAAE,SAAWC,EAAE,OAAQ,MAAO,GAClC,IAAIC,EAAO,EACX,QAASC,EAAI,EAAGA,EAAIH,EAAE,OAAQG,IAAKD,GAAQF,EAAEG,CAAC,EAAIF,EAAEE,CAAC,EACrD,OAAOD,IAAS,CAClB,CAMM,SAAUV,GAAUH,EAAiB,CACzC,OAAO,WAAW,KAAKA,CAAK,CAC9B,CAOM,SAAUe,GAAaC,EAAa,CACxC,OAAO,WAAW,KAAKA,EAAO,CAACC,EAAGH,IAAK,CACrC,IAAMI,EAAWD,EAAE,WAAW,CAAC,EAC/B,GAAIA,EAAE,SAAW,GAAKC,EAAW,IAC/B,MAAM,IAAI,MACR,wCAAwCF,EAAMF,CAAC,CAAC,eAAeI,CAAQ,gBAAgBJ,CAAC,EAAE,EAG9F,OAAOI,CACT,CAAC,CACH,CAKM,SAAUC,GAAQ7B,EAAW8B,EAAaC,EAAW,CACzD,OAAO9B,GAASD,CAAC,GAAKC,GAAS6B,CAAG,GAAK7B,GAAS8B,CAAG,GAAKD,GAAO9B,GAAKA,EAAI+B,CAC1E,CAOM,SAAUC,GAASnC,EAAeG,EAAW8B,EAAaC,EAAW,CAMzE,GAAI,CAACF,GAAQ7B,EAAG8B,EAAKC,CAAG,EACtB,MAAM,IAAI,MAAM,kBAAoBlC,EAAQ,KAAOiC,EAAM,WAAaC,EAAM,SAAW/B,CAAC,CAC5F,CASM,SAAUiC,GAAOjC,EAAS,CAC9B,IAAIgB,EACJ,IAAKA,EAAM,EAAGhB,EAAIQ,GAAKR,IAAMkC,GAAKlB,GAAO,EAAE,CAC3C,OAAOA,CACT,CAkCM,SAAUmB,GACdC,EACAC,EACAC,EAA4D,CAI5D,GAFApC,GAAQkC,EAAS,SAAS,EAC1BlC,GAAQmC,EAAU,UAAU,EACxB,OAAOC,GAAW,WAAY,MAAM,IAAI,MAAM,2BAA2B,EAC7E,IAAMC,EAAOvB,GAA4B,IAAI,WAAWA,CAAG,EACrDwB,EAAO,WAAW,GAAE,EACpBC,EAAQ,WAAW,GAAG,CAAI,EAC1BC,EAAQ,WAAW,GAAG,CAAI,EAC1BC,EAAgB,IAGlBC,EAAIL,EAAIH,CAAO,EACfS,EAAIN,EAAIH,CAAO,EACfZ,EAAI,EACFsB,EAAQ,IAAK,CACjBF,EAAE,KAAK,CAAC,EACRC,EAAE,KAAK,CAAC,EACRrB,EAAI,CACN,EACMuB,EAAI,IAAIC,IAAuBV,EAAOO,EAAGI,GAAaL,EAAG,GAAGI,CAAI,CAAC,EACjEE,EAAS,CAACC,EAAmBX,IAAQ,CAEzCK,EAAIE,EAAEN,EAAOU,CAAI,EACjBP,EAAIG,EAAC,EACDI,EAAK,SAAW,IACpBN,EAAIE,EAAEL,EAAOS,CAAI,EACjBP,EAAIG,EAAC,EACP,EACMK,EAAM,IAAK,CAEf,GAAI5B,KAAOmB,EAAe,MAAM,IAAI,MAAM,sCAAsC,EAChF,IAAI3B,EAAM,EACJqC,EAAoB,CAAA,EAC1B,KAAOrC,EAAMqB,GAAU,CACrBO,EAAIG,EAAC,EACL,IAAMO,EAAKV,EAAE,MAAK,EAClBS,EAAI,KAAKC,CAAE,EACXtC,GAAO4B,EAAE,MACX,CACA,OAAOK,GAAa,GAAGI,CAAG,CAC5B,EASA,MARiB,CAACF,EAAkBI,IAAoB,CACtDT,EAAK,EACLI,EAAOC,CAAI,EACX,IAAIlC,EACJ,KAAO,EAAEA,EAAMsC,EAAKH,EAAG,CAAE,IAAIF,EAAM,EACnC,OAAAJ,EAAK,EACE7B,CACT,CAEF,CAEM,SAAUuC,GACdC,EACAC,EAAiC,CAAA,EACjCC,EAAoC,CAAA,EAAE,CAEtC,GAAI,CAACF,GAAU,OAAOA,GAAW,SAAU,MAAM,IAAI,MAAM,+BAA+B,EAE1F,SAASG,EAAWC,EAAiBC,EAAsBC,EAAc,CACvE,IAAMC,EAAMP,EAAOI,CAAS,EAC5B,GAAIE,GAASC,IAAQ,OAAW,OAChC,IAAMC,EAAU,OAAOD,EACvB,GAAIC,IAAYH,GAAgBE,IAAQ,KACtC,MAAM,IAAI,MAAM,UAAUH,CAAS,0BAA0BC,CAAY,SAASG,CAAO,EAAE,CAC/F,CACA,IAAMC,EAAO,CAACC,EAAkBJ,IAC9B,OAAO,QAAQI,CAAC,EAAE,QAAQ,CAAC,CAACtB,EAAGD,CAAC,IAAMgB,EAAWf,EAAGD,EAAGmB,CAAK,CAAC,EAC/DG,EAAKR,EAAQ,EAAK,EAClBQ,EAAKP,EAAW,EAAI,CACtB,CAaM,SAAUS,GACdC,EAA6B,CAE7B,IAAMC,EAAM,IAAI,QAChB,MAAO,CAACC,KAAWC,IAAc,CAC/B,IAAMR,EAAMM,EAAI,IAAIC,CAAG,EACvB,GAAIP,IAAQ,OAAW,OAAOA,EAC9B,IAAMS,EAAWJ,EAAGE,EAAK,GAAGC,CAAI,EAChC,OAAAF,EAAI,IAAIC,EAAKE,CAAQ,EACdA,CACT,CACF,CA7RA,IAqBMjE,GACA0B,GAmGAjC,GAsDOyE,GA2FAC,GA1QbC,GAAAC,GAAA,KAKAD,KAOAA,KASMpE,GAAsB,OAAO,CAAC,EAC9B0B,GAAsB,OAAO,CAAC,EAmG9BjC,GAAYD,GAAc,OAAOA,GAAM,UAAYQ,IAAOR,EAsDnD0E,GAAW1E,IAAuBkC,IAAO,OAAOlC,CAAC,GAAKkC,GA2FtDyC,GAAiB,IAAY,CACxC,MAAM,IAAI,MAAM,iBAAiB,CACnC,ICjPM,SAAUG,GAAIC,EAAWC,EAAS,CACtC,IAAMC,EAASF,EAAIC,EACnB,OAAOC,GAAUC,GAAMD,EAASD,EAAIC,CACtC,CAYM,SAAUE,GAAKC,EAAWC,EAAeC,EAAc,CAC3D,IAAIC,EAAMH,EACV,KAAOC,KAAUH,IACfK,GAAOA,EACPA,GAAOD,EAET,OAAOC,CACT,CAMM,SAAUC,GAAOC,EAAgBH,EAAc,CACnD,GAAIG,IAAWP,GAAK,MAAM,IAAI,MAAM,kCAAkC,EACtE,GAAII,GAAUJ,GAAK,MAAM,IAAI,MAAM,0CAA4CI,CAAM,EAErF,IAAIP,EAAID,GAAIW,EAAQH,CAAM,EACtBN,EAAIM,EAEJF,EAAIF,GAAKQ,EAAIC,GAAKC,EAAID,GAAKE,EAAIX,GACnC,KAAOH,IAAMG,IAAK,CAEhB,IAAMY,EAAId,EAAID,EACRgB,EAAIf,EAAID,EACRiB,EAAIZ,EAAIQ,EAAIE,EACZG,EAAIP,EAAIG,EAAIC,EAElBd,EAAID,EAAGA,EAAIgB,EAAGX,EAAIQ,EAAGF,EAAIG,EAAGD,EAAII,EAAGH,EAAII,CACzC,CAEA,GADYjB,IACAW,GAAK,MAAM,IAAI,MAAM,wBAAwB,EACzD,OAAOb,GAAIM,EAAGE,CAAM,CACtB,CAEA,SAASY,GAAkBC,EAAeC,EAASH,EAAI,CACrD,GAAI,CAACE,EAAG,IAAIA,EAAG,IAAIC,CAAI,EAAGH,CAAC,EAAG,MAAM,IAAI,MAAM,yBAAyB,CACzE,CAMA,SAASI,GAAaF,EAAeF,EAAI,CACvC,IAAMK,GAAUH,EAAG,MAAQR,IAAOY,GAC5BH,EAAOD,EAAG,IAAIF,EAAGK,CAAM,EAC7B,OAAAJ,GAAeC,EAAIC,EAAMH,CAAC,EACnBG,CACT,CAEA,SAASI,GAAaL,EAAeF,EAAI,CACvC,IAAMQ,GAAUN,EAAG,MAAQO,IAAOC,GAC5BC,EAAKT,EAAG,IAAIF,EAAGY,EAAG,EAClBhB,EAAIM,EAAG,IAAIS,EAAIH,CAAM,EACrBK,EAAKX,EAAG,IAAIF,EAAGJ,CAAC,EAChBkB,EAAIZ,EAAG,IAAIA,EAAG,IAAIW,EAAID,EAAG,EAAGhB,CAAC,EAC7BO,EAAOD,EAAG,IAAIW,EAAIX,EAAG,IAAIY,EAAGZ,EAAG,GAAG,CAAC,EACzC,OAAAD,GAAeC,EAAIC,EAAMH,CAAC,EACnBG,CACT,CAIA,SAASY,GAAWC,EAAS,CAC3B,IAAMC,EAAMC,GAAMF,CAAC,EACbG,EAAKC,GAAcJ,CAAC,EACpBK,EAAKF,EAAGF,EAAKA,EAAI,IAAIA,EAAI,GAAG,CAAC,EAC7BK,EAAKH,EAAGF,EAAKI,CAAE,EACfE,EAAKJ,EAAGF,EAAKA,EAAI,IAAII,CAAE,CAAC,EACxBG,GAAMR,EAAIS,IAAOC,GACvB,MAAO,CAAIxB,EAAeF,IAAQ,CAChC,IAAI2B,EAAMzB,EAAG,IAAIF,EAAGwB,CAAE,EAClBI,EAAM1B,EAAG,IAAIyB,EAAKN,CAAE,EAClBQ,EAAM3B,EAAG,IAAIyB,EAAKL,CAAE,EACpBQ,EAAM5B,EAAG,IAAIyB,EAAKJ,CAAE,EACpBQ,EAAK7B,EAAG,IAAIA,EAAG,IAAI0B,CAAG,EAAG5B,CAAC,EAC1BgC,EAAK9B,EAAG,IAAIA,EAAG,IAAI2B,CAAG,EAAG7B,CAAC,EAChC2B,EAAMzB,EAAG,KAAKyB,EAAKC,EAAKG,CAAE,EAC1BH,EAAM1B,EAAG,KAAK4B,EAAKD,EAAKG,CAAE,EAC1B,IAAMC,EAAK/B,EAAG,IAAIA,EAAG,IAAI0B,CAAG,EAAG5B,CAAC,EAC1BG,EAAOD,EAAG,KAAKyB,EAAKC,EAAKK,CAAE,EACjC,OAAAhC,GAAeC,EAAIC,EAAMH,CAAC,EACnBG,CACT,CACF,CASM,SAAUiB,GAAcJ,EAAS,CAGrC,GAAIA,EAAIkB,GAAK,MAAM,IAAI,MAAM,qCAAqC,EAElE,IAAIC,EAAInB,EAAItB,GACR0C,EAAI,EACR,KAAOD,EAAIvB,KAAQ3B,IACjBkD,GAAKvB,GACLwB,IAIF,IAAIC,EAAIzB,GACF0B,EAAMpB,GAAMF,CAAC,EACnB,KAAOuB,GAAWD,EAAKD,CAAC,IAAM,GAG5B,GAAIA,IAAM,IAAM,MAAM,IAAI,MAAM,+CAA+C,EAGjF,GAAID,IAAM,EAAG,OAAOhC,GAIpB,IAAIoC,EAAKF,EAAI,IAAID,EAAGF,CAAC,EACfM,GAAUN,EAAIzC,IAAOkB,GAC3B,OAAO,SAAwBV,EAAeF,EAAI,CAChD,GAAIE,EAAG,IAAIF,CAAC,EAAG,OAAOA,EAEtB,GAAIuC,GAAWrC,EAAIF,CAAC,IAAM,EAAG,MAAM,IAAI,MAAM,yBAAyB,EAGtE,IAAI0C,EAAIN,EACJO,EAAIzC,EAAG,IAAIA,EAAG,IAAKsC,CAAE,EACrBI,EAAI1C,EAAG,IAAIF,EAAGmC,CAAC,EACfU,EAAI3C,EAAG,IAAIF,EAAGyC,CAAM,EAIxB,KAAO,CAACvC,EAAG,IAAI0C,EAAG1C,EAAG,GAAG,GAAG,CACzB,GAAIA,EAAG,IAAI0C,CAAC,EAAG,OAAO1C,EAAG,KACzB,IAAIY,EAAI,EAGJgC,EAAQ5C,EAAG,IAAI0C,CAAC,EACpB,KAAO,CAAC1C,EAAG,IAAI4C,EAAO5C,EAAG,GAAG,GAG1B,GAFAY,IACAgC,EAAQ5C,EAAG,IAAI4C,CAAK,EAChBhC,IAAM4B,EAAG,MAAM,IAAI,MAAM,yBAAyB,EAIxD,IAAMK,EAAWrD,IAAO,OAAOgD,EAAI5B,EAAI,CAAC,EAClC/B,EAAImB,EAAG,IAAIyC,EAAGI,CAAQ,EAG5BL,EAAI5B,EACJ6B,EAAIzC,EAAG,IAAInB,CAAC,EACZ6D,EAAI1C,EAAG,IAAI0C,EAAGD,CAAC,EACfE,EAAI3C,EAAG,IAAI2C,EAAG9D,CAAC,CACjB,CACA,OAAO8D,CACT,CACF,CAaM,SAAUG,GAAOhC,EAAS,CAE9B,OAAIA,EAAIV,KAAQ4B,GAAY9B,GAExBY,EAAIN,KAAQD,GAAYF,GAExBS,EAAIU,KAASuB,GAAYlC,GAAWC,CAAC,EAElCI,GAAcJ,CAAC,CACxB,CAsDM,SAAUkC,GAAiBC,EAAgB,CAC/C,IAAMC,EAAU,CACd,MAAO,SACP,MAAO,SACP,KAAM,UAEFC,EAAOC,GAAa,OAAO,CAACC,EAAKC,KACrCD,EAAIC,CAAG,EAAI,WACJD,GACNH,CAAO,EACV,OAAAK,GAAeN,EAAOE,CAAI,EAInBF,CACT,CAQM,SAAUO,GAASxD,EAAeyD,EAAQvE,EAAa,CAC3D,GAAIA,EAAQH,GAAK,MAAM,IAAI,MAAM,yCAAyC,EAC1E,GAAIG,IAAUH,GAAK,OAAOiB,EAAG,IAC7B,GAAId,IAAUM,GAAK,OAAOiE,EAC1B,IAAIC,EAAI1D,EAAG,IACP2D,EAAIF,EACR,KAAOvE,EAAQH,IACTG,EAAQM,KAAKkE,EAAI1D,EAAG,IAAI0D,EAAGC,CAAC,GAChCA,EAAI3D,EAAG,IAAI2D,CAAC,EACZzE,IAAUM,GAEZ,OAAOkE,CACT,CAOM,SAAUE,GAAiB5D,EAAe6D,EAAWC,EAAW,GAAK,CACzE,IAAMC,EAAW,IAAI,MAAMF,EAAK,MAAM,EAAE,KAAKC,EAAW9D,EAAG,KAAO,MAAS,EAErEgE,EAAgBH,EAAK,OAAO,CAACI,EAAKR,EAAK7C,IACvCZ,EAAG,IAAIyD,CAAG,EAAUQ,GACxBF,EAASnD,CAAC,EAAIqD,EACPjE,EAAG,IAAIiE,EAAKR,CAAG,GACrBzD,EAAG,GAAG,EAEHkE,EAAclE,EAAG,IAAIgE,CAAa,EAExC,OAAAH,EAAK,YAAY,CAACI,EAAKR,EAAK7C,IACtBZ,EAAG,IAAIyD,CAAG,EAAUQ,GACxBF,EAASnD,CAAC,EAAIZ,EAAG,IAAIiE,EAAKF,EAASnD,CAAC,CAAC,EAC9BZ,EAAG,IAAIiE,EAAKR,CAAG,GACrBS,CAAW,EACPH,CACT,CAgBM,SAAU1B,GAAcrC,EAAeF,EAAI,CAG/C,IAAMqE,GAAUnE,EAAG,MAAQR,IAAOkB,GAC5B0D,EAAUpE,EAAG,IAAIF,EAAGqE,CAAM,EAC1BE,EAAMrE,EAAG,IAAIoE,EAASpE,EAAG,GAAG,EAC5BsE,EAAOtE,EAAG,IAAIoE,EAASpE,EAAG,IAAI,EAC9BuE,EAAKvE,EAAG,IAAIoE,EAASpE,EAAG,IAAIA,EAAG,GAAG,CAAC,EACzC,GAAI,CAACqE,GAAO,CAACC,GAAQ,CAACC,EAAI,MAAM,IAAI,MAAM,gCAAgC,EAC1E,OAAOF,EAAM,EAAIC,EAAO,EAAI,EAC9B,CAUM,SAAUE,GAAQ1E,EAAW2E,EAAmB,CAEhDA,IAAe,QAAWC,GAAQD,CAAU,EAChD,IAAME,EAAcF,IAAe,OAAYA,EAAa3E,EAAE,SAAS,CAAC,EAAE,OACpE8E,EAAc,KAAK,KAAKD,EAAc,CAAC,EAC7C,MAAO,CAAE,WAAYA,EAAa,YAAAC,CAAW,CAC/C,CAqKM,SAAU5D,GAAM6D,EAAe1B,EAAkB,CAAA,EAAE,CACvD,OAAO,IAAI2B,GAAOD,EAAO1B,CAAI,CAC/B,CAsBM,SAAU4B,GAAc/E,EAAegF,EAAM,CACjD,GAAI,CAAChF,EAAG,MAAO,MAAM,IAAI,MAAM,0BAA0B,EACzD,IAAMC,EAAOD,EAAG,KAAKgF,CAAG,EACxB,OAAOhF,EAAG,MAAMC,CAAI,EAAID,EAAG,IAAIC,CAAI,EAAIA,CACzC,CAQM,SAAUgF,GAAoBC,EAAkB,CACpD,GAAI,OAAOA,GAAe,SAAU,MAAM,IAAI,MAAM,4BAA4B,EAChF,IAAMC,EAAYD,EAAW,SAAS,CAAC,EAAE,OACzC,OAAO,KAAK,KAAKC,EAAY,CAAC,CAChC,CASM,SAAUC,GAAiBF,EAAkB,CACjD,IAAMG,EAASJ,GAAoBC,CAAU,EAC7C,OAAOG,EAAS,KAAK,KAAKA,EAAS,CAAC,CACtC,CAeM,SAAUC,GAAeC,EAAiBL,EAAoBM,EAAO,GAAK,CAC9EC,EAAOF,CAAG,EACV,IAAMG,EAAMH,EAAI,OACVI,EAAWV,GAAoBC,CAAU,EACzCU,EAASR,GAAiBF,CAAU,EAE1C,GAAIQ,EAAM,IAAMA,EAAME,GAAUF,EAAM,KACpC,MAAM,IAAI,MAAM,YAAcE,EAAS,6BAA+BF,CAAG,EAC3E,IAAMjC,EAAM+B,EAAOK,GAAgBN,CAAG,EAAIO,GAAgBP,CAAG,EAEvDQ,EAAUpH,GAAI8E,EAAKyB,EAAa1F,EAAG,EAAIA,GAC7C,OAAOgG,EAAOQ,GAAgBD,EAASJ,CAAQ,EAAIM,GAAgBF,EAASJ,CAAQ,CACtF,CA5mBA,IAmBM5G,GAAiCS,GAAiCkB,GAElEsB,GAAiC5B,GAAiCG,GAElEgB,GAAiCf,GAAiCuC,GAClEvB,GAwMO0E,GA8CP9C,GAqHA0B,GAnYNqB,GAAAC,GAAA,KAOAC,KAYMtH,GAAsB,OAAO,CAAC,EAAGS,GAAsB,OAAO,CAAC,EAAGkB,GAAsB,OAAO,CAAC,EAEhGsB,GAAsB,OAAO,CAAC,EAAG5B,GAAsB,OAAO,CAAC,EAAGG,GAAsB,OAAO,CAAC,EAEhGgB,GAAsB,OAAO,CAAC,EAAGf,GAAsB,OAAO,CAAC,EAAGuC,GAAsB,OAAO,CAAC,EAChGvB,GAAuB,OAAO,EAAE,EAwMzB0E,GAAe,CAACzC,EAAatE,KACvCR,GAAI8E,EAAKtE,CAAM,EAAIK,MAASA,GA6CzB4D,GAAe,CACnB,SAAU,UAAW,MAAO,MAAO,MAAO,OAAQ,MAClD,MAAO,MAAO,MAAO,MAAO,MAAO,MACnC,OAAQ,OAAQ,OAAQ,QAkHpB0B,GAAN,KAAY,CACD,MACA,KACA,MACA,KACA,KAAO/F,GACP,IAAMS,GACN,SACD,MACS,KACjB,YAAYqF,EAAe1B,EAAkB,CAAA,EAAE,CAC7C,GAAI0B,GAAS9F,GAAK,MAAM,IAAI,MAAM,0CAA4C8F,CAAK,EACnF,IAAIyB,EACJ,KAAK,KAAO,GACRnD,GAAQ,MAAQ,OAAOA,GAAS,WAC9B,OAAOA,EAAK,MAAS,WAAUmD,EAAcnD,EAAK,MAClD,OAAOA,EAAK,MAAS,aAAY,KAAK,KAAOA,EAAK,MAClD,OAAOA,EAAK,MAAS,YAAW,KAAK,KAAOA,EAAK,MACjDA,EAAK,iBAAgB,KAAK,SAAWA,EAAK,gBAAgB,MAAK,GAC/D,OAAOA,EAAK,cAAiB,YAAW,KAAK,KAAOA,EAAK,eAE/D,GAAM,CAAE,WAAAsB,EAAY,YAAAG,CAAW,EAAKJ,GAAQK,EAAOyB,CAAW,EAC9D,GAAI1B,EAAc,KAAM,MAAM,IAAI,MAAM,gDAAgD,EACxF,KAAK,MAAQC,EACb,KAAK,KAAOJ,EACZ,KAAK,MAAQG,EACb,KAAK,MAAQ,OACb,OAAO,kBAAkB,IAAI,CAC/B,CAEA,OAAOnB,EAAW,CAChB,OAAO9E,GAAI8E,EAAK,KAAK,KAAK,CAC5B,CACA,QAAQA,EAAW,CACjB,GAAI,OAAOA,GAAQ,SACjB,MAAM,IAAI,MAAM,+CAAiD,OAAOA,CAAG,EAC7E,OAAO1E,IAAO0E,GAAOA,EAAM,KAAK,KAClC,CACA,IAAIA,EAAW,CACb,OAAOA,IAAQ1E,EACjB,CAEA,YAAY0E,EAAW,CACrB,MAAO,CAAC,KAAK,IAAIA,CAAG,GAAK,KAAK,QAAQA,CAAG,CAC3C,CACA,MAAMA,EAAW,CACf,OAAQA,EAAMjE,MAASA,EACzB,CACA,IAAIiE,EAAW,CACb,OAAO9E,GAAI,CAAC8E,EAAK,KAAK,KAAK,CAC7B,CACA,IAAI8C,EAAaC,EAAW,CAC1B,OAAOD,IAAQC,CACjB,CAEA,IAAI/C,EAAW,CACb,OAAO9E,GAAI8E,EAAMA,EAAK,KAAK,KAAK,CAClC,CACA,IAAI8C,EAAaC,EAAW,CAC1B,OAAO7H,GAAI4H,EAAMC,EAAK,KAAK,KAAK,CAClC,CACA,IAAID,EAAaC,EAAW,CAC1B,OAAO7H,GAAI4H,EAAMC,EAAK,KAAK,KAAK,CAClC,CACA,IAAID,EAAaC,EAAW,CAC1B,OAAO7H,GAAI4H,EAAMC,EAAK,KAAK,KAAK,CAClC,CACA,IAAI/C,EAAavE,EAAa,CAC5B,OAAOsE,GAAM,KAAMC,EAAKvE,CAAK,CAC/B,CACA,IAAIqH,EAAaC,EAAW,CAC1B,OAAO7H,GAAI4H,EAAMlH,GAAOmH,EAAK,KAAK,KAAK,EAAG,KAAK,KAAK,CACtD,CAGA,KAAK/C,EAAW,CACd,OAAOA,EAAMA,CACf,CACA,KAAK8C,EAAaC,EAAW,CAC3B,OAAOD,EAAMC,CACf,CACA,KAAKD,EAAaC,EAAW,CAC3B,OAAOD,EAAMC,CACf,CACA,KAAKD,EAAaC,EAAW,CAC3B,OAAOD,EAAMC,CACf,CAEA,IAAI/C,EAAW,CACb,OAAOpE,GAAOoE,EAAK,KAAK,KAAK,CAC/B,CACA,KAAKA,EAAW,CAEd,OAAK,KAAK,QAAO,KAAK,MAAQX,GAAO,KAAK,KAAK,GACxC,KAAK,MAAM,KAAMW,CAAG,CAC7B,CACA,QAAQA,EAAW,CACjB,OAAO,KAAK,KAAOuC,GAAgBvC,EAAK,KAAK,KAAK,EAAIwC,GAAgBxC,EAAK,KAAK,KAAK,CACvF,CACA,UAAUgD,EAAmBC,EAAiB,GAAK,CACjDjB,EAAOgB,CAAK,EACZ,GAAM,CAAE,SAAUE,EAAgB,MAAAC,EAAO,KAAApB,EAAM,MAAAX,EAAO,KAAMgC,CAAY,EAAK,KAC7E,GAAIF,EAAgB,CAClB,GAAI,CAACA,EAAe,SAASF,EAAM,MAAM,GAAKA,EAAM,OAASG,EAC3D,MAAM,IAAI,MACR,6BAA+BD,EAAiB,eAAiBF,EAAM,MAAM,EAGjF,IAAMK,EAAS,IAAI,WAAWF,CAAK,EAEnCE,EAAO,IAAIL,EAAOjB,EAAO,EAAIsB,EAAO,OAASL,EAAM,MAAM,EACzDA,EAAQK,CACV,CACA,GAAIL,EAAM,SAAWG,EACnB,MAAM,IAAI,MAAM,6BAA+BA,EAAQ,eAAiBH,EAAM,MAAM,EACtF,IAAIM,EAASvB,EAAOK,GAAgBY,CAAK,EAAIX,GAAgBW,CAAK,EAElE,GADII,IAAcE,EAASpI,GAAIoI,EAAQlC,CAAK,GACxC,CAAC6B,GACC,CAAC,KAAK,QAAQK,CAAM,EACtB,MAAM,IAAI,MAAM,kDAAkD,EAGtE,OAAOA,CACT,CAEA,YAAYC,EAAa,CACvB,OAAOpD,GAAc,KAAMoD,CAAG,CAChC,CAGA,KAAKpI,EAAWC,EAAWoI,EAAkB,CAC3C,OAAOA,EAAYpI,EAAID,CACzB,KCxYI,SAAUsI,GAAwCC,EAAoBC,EAAO,CACjF,IAAMC,EAAMD,EAAK,OAAM,EACvB,OAAOD,EAAYE,EAAMD,CAC3B,CAQM,SAAUE,GACdC,EACAC,EAAW,CAEX,IAAMC,EAAaC,GACjBH,EAAE,GACFC,EAAO,IAAKG,GAAMA,EAAE,CAAE,CAAC,EAEzB,OAAOH,EAAO,IAAI,CAACG,EAAGC,IAAML,EAAE,WAAWI,EAAE,SAASF,EAAWG,CAAC,CAAC,CAAC,CAAC,CACrE,CAEA,SAASC,GAAUC,EAAWC,EAAY,CACxC,GAAI,CAAC,OAAO,cAAcD,CAAC,GAAKA,GAAK,GAAKA,EAAIC,EAC5C,MAAM,IAAI,MAAM,qCAAuCA,EAAO,YAAcD,CAAC,CACjF,CAWA,SAASE,GAAUF,EAAWG,EAAkB,CAC9CJ,GAAUC,EAAGG,CAAU,EACvB,IAAMC,EAAU,KAAK,KAAKD,EAAaH,CAAC,EAAI,EACtCK,EAAa,IAAML,EAAI,GACvBM,EAAY,GAAKN,EACjBO,EAAOC,GAAQR,CAAC,EAChBS,EAAU,OAAOT,CAAC,EACxB,MAAO,CAAE,QAAAI,EAAS,WAAAC,EAAY,KAAAE,EAAM,UAAAD,EAAW,QAAAG,CAAO,CACxD,CAEA,SAASC,GAAYC,EAAWC,EAAgBC,EAAY,CAC1D,GAAM,CAAE,WAAAR,EAAY,KAAAE,EAAM,UAAAD,EAAW,QAAAG,CAAO,EAAKI,EAC7CC,EAAQ,OAAOH,EAAIJ,CAAI,EACvBQ,EAAQJ,GAAKF,EAQbK,EAAQT,IAEVS,GAASR,EACTS,GAASC,IAEX,IAAMC,EAAcL,EAASP,EACvBa,EAASD,EAAc,KAAK,IAAIH,CAAK,EAAI,EACzCK,EAASL,IAAU,EACnBM,EAAQN,EAAQ,EAChBO,EAAST,EAAS,IAAM,EAE9B,MAAO,CAAE,MAAAG,EAAO,OAAAG,EAAQ,OAAAC,EAAQ,MAAAC,EAAO,OAAAC,EAAQ,QAD/BJ,CACsC,CACxD,CAEA,SAASK,GAAkB5B,EAAeD,EAAM,CAC9C,GAAI,CAAC,MAAM,QAAQC,CAAM,EAAG,MAAM,IAAI,MAAM,gBAAgB,EAC5DA,EAAO,QAAQ,CAACG,EAAGC,IAAK,CACtB,GAAI,EAAED,aAAaJ,GAAI,MAAM,IAAI,MAAM,0BAA4BK,CAAC,CACtE,CAAC,CACH,CACA,SAASyB,GAAmBC,EAAgBC,EAAU,CACpD,GAAI,CAAC,MAAM,QAAQD,CAAO,EAAG,MAAM,IAAI,MAAM,2BAA2B,EACxEA,EAAQ,QAAQ,CAACE,EAAG5B,IAAK,CACvB,GAAI,CAAC2B,EAAM,QAAQC,CAAC,EAAG,MAAM,IAAI,MAAM,2BAA6B5B,CAAC,CACvE,CAAC,CACH,CAQA,SAAS6B,GAAKC,EAAM,CAGlB,OAAOC,GAAiB,IAAID,CAAC,GAAK,CACpC,CAEA,SAASE,GAAQnB,EAAS,CACxB,GAAIA,IAAMoB,GAAK,MAAM,IAAI,MAAM,cAAc,CAC/C,CA6LM,SAAUC,GACdC,EACAC,EACAC,EACAC,EAAU,CAEV,IAAIC,EAAMH,EACNI,EAAKL,EAAM,KACXM,EAAKN,EAAM,KACf,KAAOE,EAAKJ,IAAOK,EAAKL,IAClBI,EAAKnB,KAAKsB,EAAKA,EAAG,IAAID,CAAG,GACzBD,EAAKpB,KAAKuB,EAAKA,EAAG,IAAIF,CAAG,GAC7BA,EAAMA,EAAI,OAAM,EAChBF,IAAOnB,GACPoB,IAAOpB,GAET,MAAO,CAAE,GAAAsB,EAAI,GAAAC,CAAE,CACjB,CAYM,SAAUC,GACd/C,EACAC,EACA8B,EAAiB,CAQjB,IAAMiB,EAAShD,EAAE,GACjB6B,GAAkB5B,EAAQD,CAAC,EAC3B8B,GAAmBC,EAASiB,CAAM,EAClC,IAAMC,EAAUhD,EAAO,OACjBiD,EAAUnB,EAAQ,OACxB,GAAIkB,IAAYC,EAAS,MAAM,IAAI,MAAM,qDAAqD,EAE9F,IAAMC,EAAOnD,EAAE,KACTqB,EAAQ+B,GAAO,OAAOH,CAAO,CAAC,EAChCrC,EAAa,EACbS,EAAQ,GAAIT,EAAaS,EAAQ,EAC5BA,EAAQ,EAAGT,EAAaS,EAAQ,EAChCA,EAAQ,IAAGT,EAAa,GACjC,IAAMyC,EAAOtC,GAAQH,CAAU,EACzB0C,EAAU,IAAI,MAAM,OAAOD,CAAI,EAAI,CAAC,EAAE,KAAKF,CAAI,EAC/CI,EAAW,KAAK,OAAOP,EAAO,KAAO,GAAKpC,CAAU,EAAIA,EAC1D4C,EAAML,EACV,QAAS9C,EAAIkD,EAAUlD,GAAK,EAAGA,GAAKO,EAAY,CAC9C0C,EAAQ,KAAKH,CAAI,EACjB,QAASM,EAAI,EAAGA,EAAIP,EAASO,IAAK,CAChC,IAAMC,EAAS3B,EAAQ0B,CAAC,EAClBpC,EAAQ,OAAQqC,GAAU,OAAOrD,CAAC,EAAKgD,CAAI,EACjDC,EAAQjC,CAAK,EAAIiC,EAAQjC,CAAK,EAAE,IAAIpB,EAAOwD,CAAC,CAAC,CAC/C,CACA,IAAIE,EAAOR,EAEX,QAASM,EAAIH,EAAQ,OAAS,EAAGM,EAAOT,EAAMM,EAAI,EAAGA,IACnDG,EAAOA,EAAK,IAAIN,EAAQG,CAAC,CAAC,EAC1BE,EAAOA,EAAK,IAAIC,CAAI,EAGtB,GADAJ,EAAMA,EAAI,IAAIG,CAAI,EACdtD,IAAM,EAAG,QAASoD,EAAI,EAAGA,EAAI7C,EAAY6C,IAAKD,EAAMA,EAAI,OAAM,CACpE,CACA,OAAOA,CACT,CA8FA,SAASK,GAAeC,EAAe9B,EAAmB+B,EAAc,CACtE,GAAI/B,EAAO,CACT,GAAIA,EAAM,QAAU8B,EAAO,MAAM,IAAI,MAAM,gDAAgD,EAC3F,OAAAE,GAAchC,CAAK,EACZA,CACT,KACE,QAAOiC,GAAMH,EAAO,CAAE,KAAAC,CAAI,CAAE,CAEhC,CAIM,SAAUG,GACdC,EACAC,EACAC,EAA8B,CAAA,EAC9BC,EAAgB,CAGhB,GADIA,IAAW,SAAWA,EAASH,IAAS,WACxC,CAACC,GAAS,OAAOA,GAAU,SAAU,MAAM,IAAI,MAAM,kBAAkBD,CAAI,eAAe,EAC9F,QAAW/D,IAAK,CAAC,IAAK,IAAK,GAAG,EAAY,CACxC,IAAMmE,EAAMH,EAAMhE,CAAC,EACnB,GAAI,EAAE,OAAOmE,GAAQ,UAAYA,EAAMjC,IACrC,MAAM,IAAI,MAAM,SAASlC,CAAC,0BAA0B,CACxD,CACA,IAAMoE,EAAKX,GAAYO,EAAM,EAAGC,EAAU,GAAIC,CAAM,EAC9CG,EAAKZ,GAAYO,EAAM,EAAGC,EAAU,GAAIC,CAAM,EAE9CI,EAAS,CAAC,KAAM,KAAM,IADNP,IAAS,cAAgB,IAAM,GAClB,EACnC,QAAW/D,KAAKsE,EAEd,GAAI,CAACF,EAAG,QAAQJ,EAAMhE,CAAC,CAAC,EACtB,MAAM,IAAI,MAAM,SAASA,CAAC,0CAA0C,EAExE,OAAAgE,EAAQ,OAAO,OAAO,OAAO,OAAO,CAAA,EAAIA,CAAK,CAAC,EACvC,CAAE,MAAAA,EAAO,GAAAI,EAAI,GAAAC,CAAE,CACxB,CAMM,SAAUE,GACdC,EACAC,EAAoC,CAEpC,OAAO,SAAgBC,EAAiB,CACtC,IAAMC,EAAYH,EAAgBE,CAAI,EACtC,MAAO,CAAE,UAAAC,EAAW,UAAWF,EAAaE,CAAS,CAAC,CACxD,CACF,CAxnBA,IASMzC,GACAf,GA4MAyD,GACA5C,GA8BO6C,GArPbC,GAAAC,GAAA,KAMAC,KACAC,KAEM/C,GAAsB,OAAO,CAAC,EAC9Bf,GAAsB,OAAO,CAAC,EA4M9ByD,GAAmB,IAAI,QACvB5C,GAAmB,IAAI,QA8BhB6C,GAAP,KAAW,CACE,KACA,KACA,GACR,KAGT,YAAYzC,EAAWhC,EAAY,CACjC,KAAK,KAAOgC,EAAM,KAClB,KAAK,KAAOA,EAAM,KAClB,KAAK,GAAKA,EAAM,GAChB,KAAK,KAAOhC,CACd,CAGA,cAAc8E,EAAepE,EAAWd,EAAc,KAAK,KAAI,CAC7D,IAAImF,EAAcD,EAClB,KAAOpE,EAAIoB,IACLpB,EAAIK,KAAKnB,EAAIA,EAAE,IAAImF,CAAC,GACxBA,EAAIA,EAAE,OAAM,EACZrE,IAAMK,GAER,OAAOnB,CACT,CAcQ,iBAAiBqC,EAAiBlC,EAAS,CACjD,GAAM,CAAE,QAAAI,EAAS,WAAAC,CAAU,EAAKH,GAAUF,EAAG,KAAK,IAAI,EAChDN,EAAqB,CAAA,EACvBG,EAAcqC,EACd+C,EAAOpF,EACX,QAASe,EAAS,EAAGA,EAASR,EAASQ,IAAU,CAC/CqE,EAAOpF,EACPH,EAAO,KAAKuF,CAAI,EAEhB,QAASnF,EAAI,EAAGA,EAAIO,EAAYP,IAC9BmF,EAAOA,EAAK,IAAIpF,CAAC,EACjBH,EAAO,KAAKuF,CAAI,EAElBpF,EAAIoF,EAAK,OAAM,CACjB,CACA,OAAOvF,CACT,CAQQ,KAAKM,EAAWkF,EAAyB,EAAS,CAExD,GAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,EAAG,MAAM,IAAI,MAAM,gBAAgB,EAEzD,IAAIrF,EAAI,KAAK,KACTsF,EAAI,KAAK,KAMPC,EAAKlF,GAAUF,EAAG,KAAK,IAAI,EACjC,QAASY,EAAS,EAAGA,EAASwE,EAAG,QAASxE,IAAU,CAElD,GAAM,CAAE,MAAAG,EAAO,OAAAG,EAAQ,OAAAC,EAAQ,MAAAC,EAAO,OAAAC,EAAQ,QAAAgE,CAAO,EAAK3E,GAAY,EAAGE,EAAQwE,CAAE,EACnF,EAAIrE,EACAI,EAGFgE,EAAIA,EAAE,IAAI/F,GAASiC,EAAQ6D,EAAYG,CAAO,CAAC,CAAC,EAGhDxF,EAAIA,EAAE,IAAIT,GAASgC,EAAO8D,EAAYhE,CAAM,CAAC,CAAC,CAElD,CACA,OAAAY,GAAQ,CAAC,EAIF,CAAE,EAAAjC,EAAG,EAAAsF,CAAC,CACf,CAOQ,WACNnF,EACAkF,EACA,EACA7C,EAAgB,KAAK,KAAI,CAEzB,IAAM+C,EAAKlF,GAAUF,EAAG,KAAK,IAAI,EACjC,QAASY,EAAS,EAAGA,EAASwE,EAAG,SAC3B,IAAMrD,GAD8BnB,IAAU,CAElD,GAAM,CAAE,MAAAG,EAAO,OAAAG,EAAQ,OAAAC,EAAQ,MAAAC,CAAK,EAAKV,GAAY,EAAGE,EAAQwE,CAAE,EAElE,GADA,EAAIrE,EACA,CAAAI,EAIG,CACL,IAAM7B,EAAO4F,EAAYhE,CAAM,EAC/BmB,EAAMA,EAAI,IAAIjB,EAAQ9B,EAAK,OAAM,EAAKA,CAAI,CAC5C,CACF,CACA,OAAAwC,GAAQ,CAAC,EACFO,CACT,CAEQ,eAAerC,EAAWkC,EAAiBoD,EAA4B,CAE7E,IAAIC,EAAOd,GAAiB,IAAIvC,CAAK,EACrC,OAAKqD,IACHA,EAAO,KAAK,iBAAiBrD,EAAOlC,CAAC,EACjCA,IAAM,IAEJ,OAAOsF,GAAc,aAAYC,EAAOD,EAAUC,CAAI,GAC1Dd,GAAiB,IAAIvC,EAAOqD,CAAI,IAG7BA,CACT,CAEA,OACErD,EACAiB,EACAmC,EAA4B,CAE5B,IAAMtF,EAAI2B,GAAKO,CAAK,EACpB,OAAO,KAAK,KAAKlC,EAAG,KAAK,eAAeA,EAAGkC,EAAOoD,CAAS,EAAGnC,CAAM,CACtE,CAEA,OAAOjB,EAAiBiB,EAAgBmC,EAA8BE,EAAe,CACnF,IAAMxF,EAAI2B,GAAKO,CAAK,EACpB,OAAIlC,IAAM,EAAU,KAAK,cAAckC,EAAOiB,EAAQqC,CAAI,EACnD,KAAK,WAAWxF,EAAG,KAAK,eAAeA,EAAGkC,EAAOoD,CAAS,EAAGnC,EAAQqC,CAAI,CAClF,CAKA,YAAY5D,EAAa5B,EAAS,CAChCD,GAAUC,EAAG,KAAK,IAAI,EACtB6B,GAAiB,IAAID,EAAG5B,CAAC,EACzByE,GAAiB,OAAO7C,CAAC,CAC3B,CAEA,SAASmD,EAAa,CACpB,OAAOpD,GAAKoD,CAAG,IAAM,CACvB,KCvOF,SAASU,GAAYC,EAAoBC,EAAoBC,EAAWC,EAAS,CAC/E,IAAMC,EAAKJ,EAAG,IAAIE,CAAC,EACbG,EAAKL,EAAG,IAAIG,CAAC,EACbG,EAAON,EAAG,IAAIA,EAAG,IAAIC,EAAM,EAAGG,CAAE,EAAGC,CAAE,EACrCE,EAAQP,EAAG,IAAIA,EAAG,IAAKA,EAAG,IAAIC,EAAM,EAAGD,EAAG,IAAII,EAAIC,CAAE,CAAC,CAAC,EAC5D,OAAOL,EAAG,IAAIM,EAAMC,CAAK,CAC3B,CAEM,SAAUC,GAAQC,EAAqBC,EAA8B,CAAA,EAAE,CAC3E,IAAMC,EAAYC,GAAkB,UAAWH,EAAQC,EAAWA,EAAU,MAAM,EAC5E,CAAE,GAAAV,EAAI,GAAAa,CAAE,EAAKF,EACfV,EAAQU,EAAU,MAChB,CAAE,EAAGG,CAAQ,EAAKb,EACxBc,GAAeL,EAAW,CAAA,EAAI,CAAE,QAAS,UAAU,CAAE,EAMrD,IAAMM,EAAOC,IAAQ,OAAOJ,EAAG,MAAQ,CAAC,EAAIK,GACtCC,EAAQC,GAAcpB,EAAG,OAAOoB,CAAC,EAGjCC,EACJX,EAAU,UACT,CAACY,EAAW,IAAa,CACxB,GAAI,CACF,MAAO,CAAE,QAAS,GAAM,MAAOtB,EAAG,KAAKA,EAAG,IAAIsB,EAAG,CAAC,CAAC,CAAC,CACtD,MAAY,CACV,MAAO,CAAE,QAAS,GAAO,MAAOC,EAAG,CACrC,CACF,GAIF,GAAI,CAACxB,GAAYC,EAAIC,EAAOA,EAAM,GAAIA,EAAM,EAAE,EAC5C,MAAM,IAAI,MAAM,mCAAmC,EAMrD,SAASuB,EAAOC,EAAeL,EAAWM,EAAU,GAAK,CACvD,IAAMC,EAAMD,EAAUR,GAAMK,GAC5B,OAAAK,GAAS,cAAgBH,EAAOL,EAAGO,EAAKX,CAAI,EACrCI,CACT,CAEA,SAASS,EAASC,EAAc,CAC9B,GAAI,EAAEA,aAAiBC,GAAQ,MAAM,IAAI,MAAM,uBAAuB,CACxE,CAGA,IAAMC,EAAeC,GAAS,CAACC,EAAUC,IAAoC,CAC3E,GAAM,CAAE,EAAAC,EAAG,EAAAC,EAAG,EAAAC,CAAC,EAAKJ,EACdK,EAAML,EAAE,IAAG,EACbC,GAAM,OAAMA,EAAKI,EAAMC,GAAOxC,EAAG,IAAIsC,CAAC,GAC1C,IAAMpC,EAAIiB,EAAKiB,EAAID,CAAE,EACfhC,EAAIgB,EAAKkB,EAAIF,CAAE,EACfM,EAAKzC,EAAG,IAAIsC,EAAGH,CAAE,EACvB,GAAII,EAAK,MAAO,CAAE,EAAGhB,GAAK,EAAGL,EAAG,EAChC,GAAIuB,IAAOvB,GAAK,MAAM,IAAI,MAAM,kBAAkB,EAClD,MAAO,CAAE,EAAAhB,EAAG,EAAAC,CAAC,CACf,CAAC,EACKuC,EAAkBT,GAAUC,GAAY,CAC5C,GAAM,CAAE,EAAAS,EAAG,EAAAC,CAAC,EAAK3C,EACjB,GAAIiC,EAAE,IAAG,EAAI,MAAM,IAAI,MAAM,iBAAiB,EAG9C,GAAM,CAAE,EAAAE,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAO,CAAC,EAAKX,EACjBY,EAAK3B,EAAKiB,EAAIA,CAAC,EACfW,EAAK5B,EAAKkB,EAAIA,CAAC,EACfW,EAAK7B,EAAKmB,EAAIA,CAAC,EACfW,EAAK9B,EAAK6B,EAAKA,CAAE,EACjBE,EAAM/B,EAAK2B,EAAKH,CAAC,EACjBrC,EAAOa,EAAK6B,EAAK7B,EAAK+B,EAAMH,CAAE,CAAC,EAC/BxC,EAAQY,EAAK8B,EAAK9B,EAAKyB,EAAIzB,EAAK2B,EAAKC,CAAE,CAAC,CAAC,EAC/C,GAAIzC,IAASC,EAAO,MAAM,IAAI,MAAM,uCAAuC,EAE3E,IAAM4C,EAAKhC,EAAKiB,EAAIC,CAAC,EACfe,EAAKjC,EAAKmB,EAAIO,CAAC,EACrB,GAAIM,IAAOC,EAAI,MAAM,IAAI,MAAM,uCAAuC,EACtE,MAAO,EACT,CAAC,EAID,MAAMrB,CAAK,CAET,OAAgB,KAAO,IAAIA,EAAM9B,EAAM,GAAIA,EAAM,GAAIiB,GAAKC,EAAKlB,EAAM,GAAKA,EAAM,EAAE,CAAC,EAEnF,OAAgB,KAAO,IAAI8B,EAAMR,GAAKL,GAAKA,GAAKK,EAAG,EAEnD,OAAgB,GAAKvB,EAErB,OAAgB,GAAKa,EAEZ,EACA,EACA,EACA,EAET,YAAYuB,EAAWC,EAAWC,EAAWO,EAAS,CACpD,KAAK,EAAIrB,EAAO,IAAKY,CAAC,EACtB,KAAK,EAAIZ,EAAO,IAAKa,CAAC,EACtB,KAAK,EAAIb,EAAO,IAAKc,EAAG,EAAI,EAC5B,KAAK,EAAId,EAAO,IAAKqB,CAAC,EACtB,OAAO,OAAO,IAAI,CACpB,CAEA,OAAO,OAAK,CACV,OAAO5C,CACT,CAEA,OAAO,WAAWiC,EAAsB,CACtC,GAAIA,aAAaH,EAAO,MAAM,IAAI,MAAM,4BAA4B,EACpE,GAAM,CAAE,EAAA7B,EAAG,EAAAC,CAAC,EAAK+B,GAAK,CAAA,EACtB,OAAAV,EAAO,IAAKtB,CAAC,EACbsB,EAAO,IAAKrB,CAAC,EACN,IAAI4B,EAAM7B,EAAGC,EAAGe,GAAKC,EAAKjB,EAAIC,CAAC,CAAC,CACzC,CAGA,OAAO,UAAUkD,EAAmBC,EAAS,GAAK,CAChD,IAAMC,EAAMvD,EAAG,MACT,CAAE,EAAA2C,EAAG,EAAAC,CAAC,EAAK3C,EACjBoD,EAAQG,GAAUC,EAAOJ,EAAOE,EAAK,OAAO,CAAC,EAC7CG,GAAMJ,EAAQ,QAAQ,EACtB,IAAMK,EAASH,GAAUH,CAAK,EACxBO,EAAWP,EAAME,EAAM,CAAC,EAC9BI,EAAOJ,EAAM,CAAC,EAAIK,EAAW,KAC7B,IAAMzD,EAAI0D,GAAgBF,CAAM,EAM1BG,EAAMR,EAAStC,EAAOhB,EAAG,MAC/B4B,GAAS,UAAWzB,EAAGoB,GAAKuC,CAAG,EAI/B,IAAMzD,EAAKc,EAAKhB,EAAIA,CAAC,EACfmB,EAAIH,EAAKd,EAAKa,EAAG,EACjB6C,EAAI5C,EAAKyB,EAAIvC,EAAKsC,CAAC,EACrB,CAAE,QAAAqB,EAAS,MAAO9D,CAAC,EAAKmB,EAAQC,EAAGyC,CAAC,EACxC,GAAI,CAACC,EAAS,MAAM,IAAI,MAAM,iCAAiC,EAC/D,IAAMC,GAAU/D,EAAIgB,MAASA,GACvBgD,GAAiBN,EAAW,OAAU,EAC5C,GAAI,CAACN,GAAUpD,IAAMqB,IAAO2C,EAE1B,MAAM,IAAI,MAAM,0BAA0B,EAC5C,OAAIA,IAAkBD,IAAQ/D,EAAIiB,EAAK,CAACjB,CAAC,GAClC6B,EAAM,WAAW,CAAE,EAAA7B,EAAG,EAAAC,CAAC,CAAE,CAClC,CAEA,OAAO,QAAQgE,EAAab,EAAS,GAAK,CACxC,OAAOvB,EAAM,UAAUqC,GAAWD,CAAG,EAAGb,CAAM,CAChD,CAEA,IAAI,GAAC,CACH,OAAO,KAAK,SAAQ,EAAG,CACzB,CACA,IAAI,GAAC,CACH,OAAO,KAAK,SAAQ,EAAG,CACzB,CAEA,WAAWe,EAAqB,EAAGC,EAAS,GAAI,CAC9C,OAAAC,EAAK,YAAY,KAAMF,CAAU,EAC5BC,GAAQ,KAAK,SAASrD,EAAG,EACvB,IACT,CAGA,gBAAc,CACZyB,EAAgB,IAAI,CACtB,CAGA,OAAOZ,EAAY,CACjBD,EAASC,CAAK,EACd,GAAM,CAAE,EAAG0C,EAAI,EAAGC,EAAI,EAAGC,CAAE,EAAK,KAC1B,CAAE,EAAG5B,EAAI,EAAGC,EAAI,EAAGC,CAAE,EAAKlB,EAC1B6C,EAAOxD,EAAKqD,EAAKxB,CAAE,EACnB4B,EAAOzD,EAAK2B,EAAK4B,CAAE,EACnBG,EAAO1D,EAAKsD,EAAKzB,CAAE,EACnB8B,EAAO3D,EAAK4B,EAAK2B,CAAE,EACzB,OAAOC,IAASC,GAAQC,IAASC,CACnC,CAEA,KAAG,CACD,OAAO,KAAK,OAAO/C,EAAM,IAAI,CAC/B,CAEA,QAAM,CAEJ,OAAO,IAAIA,EAAMZ,EAAK,CAAC,KAAK,CAAC,EAAG,KAAK,EAAG,KAAK,EAAGA,EAAK,CAAC,KAAK,CAAC,CAAC,CAC/D,CAKA,QAAM,CACJ,GAAM,CAAE,EAAAwB,CAAC,EAAK1C,EACR,CAAE,EAAGuE,EAAI,EAAGC,EAAI,EAAGC,CAAE,EAAK,KAC1BK,EAAI5D,EAAKqD,EAAKA,CAAE,EAChBQ,EAAI7D,EAAKsD,EAAKA,CAAE,EAChBQ,EAAI9D,EAAKF,GAAME,EAAKuD,EAAKA,CAAE,CAAC,EAC5BQ,EAAI/D,EAAKwB,EAAIoC,CAAC,EACdI,EAAOX,EAAKC,EACZW,EAAIjE,EAAKA,EAAKgE,EAAOA,CAAI,EAAIJ,EAAIC,CAAC,EAClCK,EAAIH,EAAIF,EACRM,EAAID,EAAIJ,EACRM,EAAIL,EAAIF,EACRQ,EAAKrE,EAAKiE,EAAIE,CAAC,EACfG,EAAKtE,EAAKkE,EAAIE,CAAC,EACfG,EAAKvE,EAAKiE,EAAIG,CAAC,EACfI,EAAKxE,EAAKmE,EAAID,CAAC,EACrB,OAAO,IAAItD,EAAMyD,EAAIC,EAAIE,EAAID,CAAE,CACjC,CAKA,IAAI5D,EAAY,CACdD,EAASC,CAAK,EACd,GAAM,CAAE,EAAAa,EAAG,EAAAC,CAAC,EAAK3C,EACX,CAAE,EAAGuE,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGkB,CAAE,EAAK,KACjC,CAAE,EAAG9C,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAG6C,CAAE,EAAK/D,EACjCiD,EAAI5D,EAAKqD,EAAK1B,CAAE,EAChBkC,EAAI7D,EAAKsD,EAAK1B,CAAE,EAChBkC,EAAI9D,EAAKyE,EAAKhD,EAAIiD,CAAE,EACpBX,EAAI/D,EAAKuD,EAAK1B,CAAE,EAChBoC,EAAIjE,GAAMqD,EAAKC,IAAO3B,EAAKC,GAAMgC,EAAIC,CAAC,EACtCM,EAAIJ,EAAID,EACRI,EAAIH,EAAID,EACRM,EAAIpE,EAAK6D,EAAIrC,EAAIoC,CAAC,EAClBS,EAAKrE,EAAKiE,EAAIE,CAAC,EACfG,EAAKtE,EAAKkE,EAAIE,CAAC,EACfG,EAAKvE,EAAKiE,EAAIG,CAAC,EACfI,GAAKxE,EAAKmE,EAAID,CAAC,EACrB,OAAO,IAAItD,EAAMyD,EAAIC,EAAIE,GAAID,CAAE,CACjC,CAEA,SAAS5D,EAAY,CACnB,OAAO,KAAK,IAAIA,EAAM,OAAM,CAAE,CAChC,CAGA,SAASgE,EAAc,CAErB,GAAI,CAACjF,EAAG,YAAYiF,CAAM,EAAG,MAAM,IAAI,MAAM,4CAA4C,EACzF,GAAM,CAAE,EAAA5D,EAAG,EAAA6D,CAAC,EAAKxB,EAAK,OAAO,KAAMuB,EAAS5D,GAAM8D,GAAWjE,EAAOG,CAAC,CAAC,EACtE,OAAO8D,GAAWjE,EAAO,CAACG,EAAG6D,CAAC,CAAC,EAAE,CAAC,CACpC,CAOA,eAAeD,EAAgBG,EAAMlE,EAAM,KAAI,CAE7C,GAAI,CAAClB,EAAG,QAAQiF,CAAM,EAAG,MAAM,IAAI,MAAM,4CAA4C,EACrF,OAAIA,IAAWvE,GAAYQ,EAAM,KAC7B,KAAK,IAAG,GAAM+D,IAAW5E,GAAY,KAClCqD,EAAK,OAAO,KAAMuB,EAAS5D,GAAM8D,GAAWjE,EAAOG,CAAC,EAAG+D,CAAG,CACnE,CAMA,cAAY,CACV,OAAO,KAAK,eAAenF,CAAQ,EAAE,IAAG,CAC1C,CAIA,eAAa,CACX,OAAOyD,EAAK,OAAO,KAAMtE,EAAM,CAAC,EAAE,IAAG,CACvC,CAIA,SAASiG,EAAkB,CACzB,OAAOlE,EAAa,KAAMkE,CAAS,CACrC,CAEA,eAAa,CACX,OAAIpF,IAAaI,GAAY,KACtB,KAAK,eAAeJ,CAAQ,CACrC,CAEA,SAAO,CACL,GAAM,CAAE,EAAAZ,EAAG,EAAAC,CAAC,EAAK,KAAK,SAAQ,EAExBkD,EAAQrD,EAAG,QAAQG,CAAC,EAG1B,OAAAkD,EAAMA,EAAM,OAAS,CAAC,GAAKnD,EAAIgB,GAAM,IAAO,EACrCmC,CACT,CACA,OAAK,CACH,OAAO8C,GAAW,KAAK,QAAO,CAAE,CAClC,CAEA,UAAQ,CACN,MAAO,UAAU,KAAK,IAAG,EAAK,OAAS,KAAK,MAAK,CAAE,GACrD,EAEF,IAAM5B,EAAO,IAAI6B,GAAKrE,EAAOlB,EAAG,IAAI,EACpC,OAAAkB,EAAM,KAAK,WAAW,CAAC,EAChBA,CACT,CA8GM,SAAUsE,GAAMtE,EAAyBuE,EAAcC,EAAuB,CAAA,EAAE,CACpF,GAAI,OAAOD,GAAU,WAAY,MAAM,IAAI,MAAM,mCAAmC,EACpFvF,GACEwF,EACA,CAAA,EACA,CACE,kBAAmB,WACnB,YAAa,WACb,OAAQ,WACR,QAAS,WACT,WAAY,WACb,EAGH,GAAM,CAAE,QAAAC,CAAO,EAAKD,EACd,CAAE,KAAAE,EAAM,GAAAzG,EAAI,GAAAa,CAAE,EAAKkB,EAEnB2E,EAAcH,EAAU,aAAeG,GACvCC,EAAoBJ,EAAU,oBAAuBlD,GAAsBA,GAC3EuD,EACJL,EAAU,SACT,CAACM,EAAkBC,EAAiBC,IAAmB,CAEtD,GADArD,GAAMqD,EAAQ,QAAQ,EAClBD,EAAI,QAAUC,EAAQ,MAAM,IAAI,MAAM,qCAAqC,EAC/E,OAAOF,CACT,GAGF,SAASG,EAAQC,EAAgB,CAC/B,OAAOpG,EAAG,OAAOgD,GAAgBoD,CAAI,CAAC,CACxC,CAGA,SAASC,EAAiBC,EAAe,CACvC,IAAM5D,EAAM6D,EAAQ,UACpB3D,EAAO0D,EAAKC,EAAQ,UAAW,WAAW,EAG1C,IAAMC,EAAS5D,EAAO6C,EAAMa,CAAG,EAAG,EAAI5D,EAAK,iBAAiB,EACtD+D,EAAOX,EAAkBU,EAAO,MAAM,EAAG9D,CAAG,CAAC,EAC7CgE,EAASF,EAAO,MAAM9D,EAAK,EAAIA,CAAG,EAClCuC,EAASkB,EAAQM,CAAI,EAC3B,MAAO,CAAE,KAAAA,EAAM,OAAAC,EAAQ,OAAAzB,CAAM,CAC/B,CAGA,SAAS0B,EAAqBC,EAAqB,CACjD,GAAM,CAAE,KAAAH,EAAM,OAAAC,EAAQ,OAAAzB,CAAM,EAAKoB,EAAiBO,CAAS,EACrDC,EAAQjB,EAAK,SAASX,CAAM,EAC5B6B,EAAaD,EAAM,QAAO,EAChC,MAAO,CAAE,KAAAJ,EAAM,OAAAC,EAAQ,OAAAzB,EAAQ,MAAA4B,EAAO,WAAAC,CAAU,CAClD,CAGA,SAASC,EAAaH,EAAqB,CACzC,OAAOD,EAAqBC,CAAS,EAAE,UACzC,CAGA,SAASI,EAAmBC,EAAsB,WAAW,GAAE,KAAOC,EAAkB,CACtF,IAAMC,EAAMC,GAAY,GAAGF,CAAI,EAC/B,OAAOf,EAAQV,EAAMM,EAAOoB,EAAKvE,EAAOqE,EAAS,OAAW,SAAS,EAAG,CAAC,CAACtB,CAAO,CAAC,CAAC,CACrF,CAGA,SAAS0B,EACPF,EACAP,EACAU,EAAoC,CAAA,EAAE,CAEtCH,EAAMvE,EAAOuE,EAAK,OAAW,SAAS,EAClCxB,IAASwB,EAAMxB,EAAQwB,CAAG,GAC9B,GAAM,CAAE,OAAAT,EAAQ,OAAAzB,EAAQ,WAAA6B,CAAU,EAAKH,EAAqBC,CAAS,EAC/DW,EAAIP,EAAmBM,EAAQ,QAASZ,EAAQS,CAAG,EACnDK,EAAI5B,EAAK,SAAS2B,CAAC,EAAE,QAAO,EAC5BE,EAAIT,EAAmBM,EAAQ,QAASE,EAAGV,EAAYK,CAAG,EAC1DO,EAAI1H,EAAG,OAAOuH,EAAIE,EAAIxC,CAAM,EAClC,GAAI,CAACjF,EAAG,QAAQ0H,CAAC,EAAG,MAAM,IAAI,MAAM,wBAAwB,EAC5D,IAAMC,EAAKP,GAAYI,EAAGxH,EAAG,QAAQ0H,CAAC,CAAC,EACvC,OAAO9E,EAAO+E,EAAIpB,EAAQ,UAAW,QAAQ,CAC/C,CAGA,IAAMqB,EAAyD,CAAE,OAAQ,EAAI,EAM7E,SAASC,EACPC,EACAX,EACAY,EACAT,EAAUM,EAAU,CAEpB,GAAM,CAAE,QAAAX,EAAS,OAAAxE,CAAM,EAAK6E,EACtB5E,EAAM6D,EAAQ,UACpBuB,EAAMlF,EAAOkF,EAAKpF,EAAK,WAAW,EAClCyE,EAAMvE,EAAOuE,EAAK,OAAW,SAAS,EACtCY,EAAYnF,EAAOmF,EAAWxB,EAAQ,UAAW,WAAW,EACxD9D,IAAW,QAAWI,GAAMJ,EAAQ,QAAQ,EAC5CkD,IAASwB,EAAMxB,EAAQwB,CAAG,GAE9B,IAAMa,EAAMtF,EAAM,EACZ6E,EAAIO,EAAI,SAAS,EAAGE,CAAG,EACvBN,EAAI1E,GAAgB8E,EAAI,SAASE,EAAKtF,CAAG,CAAC,EAC5CwB,EAAGsD,EAAGS,EACV,GAAI,CAIF/D,EAAIhD,EAAM,UAAU6G,EAAWtF,CAAM,EACrC+E,EAAItG,EAAM,UAAUqG,EAAG9E,CAAM,EAC7BwF,EAAKrC,EAAK,eAAe8B,CAAC,CAC5B,MAAgB,CACd,MAAO,EACT,CACA,GAAI,CAACjF,GAAUyB,EAAE,aAAY,EAAI,MAAO,GAExC,IAAMuD,EAAIT,EAAmBC,EAASO,EAAE,QAAO,EAAItD,EAAE,QAAO,EAAIiD,CAAG,EAInE,OAHYK,EAAE,IAAItD,EAAE,eAAeuD,CAAC,CAAC,EAG1B,SAASQ,CAAE,EAAE,cAAa,EAAG,IAAG,CAC7C,CAEA,IAAMC,EAAQ/I,EAAG,MACXoH,EAAU,CACd,UAAW2B,EACX,UAAWA,EACX,UAAW,EAAIA,EACf,KAAMA,GAER,SAASC,EAAgBC,EAAOvC,EAAYU,EAAQ,IAAI,EAAC,CACvD,OAAO3D,EAAOwF,EAAM7B,EAAQ,KAAM,MAAM,CAC1C,CAEA,SAAS8B,EAAiB/B,EAAe,CACvC,OAAOgC,GAAQhC,CAAG,GAAKA,EAAI,SAAWtG,EAAG,KAC3C,CAEA,SAASuI,EAAiBjC,EAAiB7D,EAAgB,CACzD,GAAI,CACF,MAAO,CAAC,CAACvB,EAAM,UAAUoF,EAAK7D,CAAM,CACtC,MAAgB,CACd,MAAO,EACT,CACF,CAEA,IAAM+F,EAAQ,CACZ,qBAAA7B,EACA,gBAAAwB,EACA,iBAAAE,EACA,iBAAAE,EAUA,aAAaR,EAAqB,CAChC,GAAM,CAAE,EAAAzI,CAAC,EAAK4B,EAAM,UAAU6G,CAAS,EACjCU,EAAOlC,EAAQ,UACfmC,EAAUD,IAAS,GACzB,GAAI,CAACC,GAAWD,IAAS,GAAI,MAAM,IAAI,MAAM,gCAAgC,EAC7E,IAAMhI,EAAIiI,EAAUvJ,EAAG,IAAIkB,GAAMf,EAAGe,GAAMf,CAAC,EAAIH,EAAG,IAAIG,EAAIe,GAAKf,EAAIe,EAAG,EACtE,OAAOlB,EAAG,QAAQsB,CAAC,CACrB,EACA,mBAAmBmG,EAAqB,CACtC,IAAM6B,EAAOlC,EAAQ,UACrB3D,EAAOgE,EAAW6B,CAAI,EACtB,IAAMjC,EAASf,EAAMmB,EAAU,SAAS,EAAG6B,CAAI,CAAC,EAChD,OAAO3C,EAAkBU,CAAM,EAAE,SAAS,EAAGiC,CAAI,CACnD,GAGF,OAAO,OAAO,OAAO,CACnB,OAAQE,GAAaR,EAAiBpB,CAAY,EAClD,aAAAA,EACA,KAAAM,EACA,OAAAQ,EACA,MAAAW,EACA,MAAAtH,EACA,QAAAqF,EACD,CACH,CApxBA,IAsCM7F,GAAiBL,GAAiBD,GAAiBuB,GA2cnCiH,GAjftBC,GAAAC,GAAA,KAOAC,KAiBAC,KAcMtI,GAAM,OAAO,CAAC,EAAGL,GAAM,OAAO,CAAC,EAAGD,GAAM,OAAO,CAAC,EAAGuB,GAAM,OAAO,CAAC,EA2cjDiH,GAAhB,KAAiC,CAGrC,OAAO,KACP,OAAO,KACP,OAAO,GACP,OAAO,GAEY,GAEnB,YAAYK,EAAgB,CAC1B,KAAK,GAAKA,CACZ,CAOA,OAAO,UAAUC,EAAkB,CACjCC,GAAc,CAChB,CAEA,OAAO,QAAQC,EAAY,CACzBD,GAAc,CAChB,CAEA,IAAI,GAAC,CACH,OAAO,KAAK,SAAQ,EAAG,CACzB,CACA,IAAI,GAAC,CACH,OAAO,KAAK,SAAQ,EAAG,CACzB,CAGA,eAAa,CAEX,OAAO,IACT,CAEA,gBAAc,CACZ,KAAK,GAAG,eAAc,CACxB,CAEA,SAAS9D,EAAkB,CACzB,OAAO,KAAK,GAAG,SAASA,CAAS,CACnC,CAEA,OAAK,CACH,OAAOC,GAAW,KAAK,QAAO,CAAE,CAClC,CAEA,UAAQ,CACN,OAAO,KAAK,MAAK,CACnB,CAEA,eAAa,CACX,MAAO,EACT,CAEA,cAAY,CACV,MAAO,EACT,CAEA,IAAIrE,EAAQ,CACV,YAAK,WAAWA,CAAK,EACd,KAAK,KAAK,KAAK,GAAG,IAAIA,EAAM,EAAE,CAAC,CACxC,CAEA,SAASA,EAAQ,CACf,YAAK,WAAWA,CAAK,EACd,KAAK,KAAK,KAAK,GAAG,SAASA,EAAM,EAAE,CAAC,CAC7C,CAEA,SAASgE,EAAc,CACrB,OAAO,KAAK,KAAK,KAAK,GAAG,SAASA,CAAM,CAAC,CAC3C,CAEA,eAAeA,EAAc,CAC3B,OAAO,KAAK,KAAK,KAAK,GAAG,eAAeA,CAAM,CAAC,CACjD,CAEA,QAAM,CACJ,OAAO,KAAK,KAAK,KAAK,GAAG,OAAM,CAAE,CACnC,CAEA,QAAM,CACJ,OAAO,KAAK,KAAK,KAAK,GAAG,OAAM,CAAE,CACnC,CAEA,WAAWzB,EAAqBC,EAAgB,CAC9C,OAAO,KAAK,KAAK,KAAK,GAAG,WAAWD,EAAYC,CAAM,CAAC,CACzD,KCvgBF,SAAS4F,GAAMC,EAAeC,EAAc,CAG1C,GAFAC,GAAYF,CAAK,EACjBE,GAAYD,CAAM,EACdD,EAAQ,GAAKA,GAAS,GAAM,EAAIC,EAAS,MAAM,IAAI,MAAM,wBAA0BD,CAAK,EAC5F,IAAMG,EAAM,MAAM,KAAK,CAAE,OAAAF,CAAM,CAAE,EAAE,KAAK,CAAC,EACzC,QAASG,EAAIH,EAAS,EAAGG,GAAK,EAAGA,IAC/BD,EAAIC,CAAC,EAAIJ,EAAQ,IACjBA,KAAW,EAEb,OAAO,IAAI,WAAWG,CAAG,CAC3B,CAEA,SAASE,GAAOC,EAAeC,EAAa,CAC1C,IAAMC,EAAM,IAAI,WAAWF,EAAE,MAAM,EACnC,QAASF,EAAI,EAAGA,EAAIE,EAAE,OAAQF,IAC5BI,EAAIJ,CAAC,EAAIE,EAAEF,CAAC,EAAIG,EAAEH,CAAC,EAErB,OAAOI,CACT,CAIA,SAASC,GAAQC,EAAiB,CAChC,GAAI,CAACC,GAAQD,CAAG,GAAK,OAAOA,GAAQ,SAClC,MAAM,IAAI,MAAM,wCAAwC,EAC1D,OAAO,OAAOA,GAAQ,SAAWE,GAAaF,CAAG,EAAIA,CACvD,CAMM,SAAUG,GACdC,EACAJ,EACAK,EACAC,EAAQ,CAERC,EAAOH,CAAG,EACVZ,GAAYa,CAAU,EACtBL,EAAMD,GAAQC,CAAG,EAEbA,EAAI,OAAS,MAAKA,EAAMM,EAAEE,GAAYN,GAAa,mBAAmB,EAAGF,CAAG,CAAC,GACjF,GAAM,CAAE,UAAWS,EAAY,SAAUC,CAAU,EAAKJ,EAClDK,EAAM,KAAK,KAAKN,EAAaI,CAAU,EAC7C,GAAIJ,EAAa,OAASM,EAAM,IAAK,MAAM,IAAI,MAAM,wCAAwC,EAC7F,IAAMC,EAAYJ,GAAYR,EAAKX,GAAMW,EAAI,OAAQ,CAAC,CAAC,EACjDa,EAAQxB,GAAM,EAAGqB,CAAU,EAC3BI,EAAYzB,GAAMgB,EAAY,CAAC,EAC/BR,EAAI,IAAI,MAAkBc,CAAG,EAC7BI,EAAMT,EAAEE,GAAYK,EAAOT,EAAKU,EAAWzB,GAAM,EAAG,CAAC,EAAGuB,CAAS,CAAC,EACxEf,EAAE,CAAC,EAAIS,EAAEE,GAAYO,EAAK1B,GAAM,EAAG,CAAC,EAAGuB,CAAS,CAAC,EACjD,QAASlB,EAAI,EAAGA,GAAKiB,EAAKjB,IAAK,CAC7B,IAAMsB,EAAO,CAACrB,GAAOoB,EAAKlB,EAAEH,EAAI,CAAC,CAAC,EAAGL,GAAMK,EAAI,EAAG,CAAC,EAAGkB,CAAS,EAC/Df,EAAEH,CAAC,EAAIY,EAAEE,GAAY,GAAGQ,CAAI,CAAC,CAC/B,CAEA,OAD4BR,GAAY,GAAGX,CAAC,EACjB,MAAM,EAAGQ,CAAU,CAChD,CASM,SAAUY,GACdb,EACAJ,EACAK,EACAa,EACAZ,EAAQ,CAOR,GALAC,EAAOH,CAAG,EACVZ,GAAYa,CAAU,EACtBL,EAAMD,GAAQC,CAAG,EAGbA,EAAI,OAAS,IAAK,CACpB,IAAMmB,EAAQ,KAAK,KAAM,EAAID,EAAK,CAAC,EACnClB,EAAMM,EAAE,OAAO,CAAE,MAAAa,CAAK,CAAE,EAAE,OAAOjB,GAAa,mBAAmB,CAAC,EAAE,OAAOF,CAAG,EAAE,OAAM,CACxF,CACA,GAAIK,EAAa,OAASL,EAAI,OAAS,IACrC,MAAM,IAAI,MAAM,wCAAwC,EAC1D,OACEM,EAAE,OAAO,CAAE,MAAOD,CAAU,CAAE,EAC3B,OAAOD,CAAG,EACV,OAAOf,GAAMgB,EAAY,CAAC,CAAC,EAE3B,OAAOL,CAAG,EACV,OAAOX,GAAMW,EAAI,OAAQ,CAAC,CAAC,EAC3B,OAAM,CAEb,CAUM,SAAUoB,GAAchB,EAAiBiB,EAAeC,EAAgB,CAC5EC,GAAeD,EAAS,CACtB,EAAG,SACH,EAAG,SACH,EAAG,SACH,KAAM,WACP,EACD,GAAM,CAAE,EAAAE,EAAG,EAAAN,EAAG,EAAAO,EAAG,KAAAC,EAAM,OAAAC,EAAQ,IAAA3B,CAAG,EAAKsB,EACvC9B,GAAYkC,EAAK,UAAW,YAAY,EACxCnB,EAAOH,CAAG,EACVZ,GAAY6B,CAAK,EACjB,IAAMO,EAAQJ,EAAE,SAAS,CAAC,EAAE,OACtBK,EAAI,KAAK,MAAMD,EAAQV,GAAK,CAAC,EAC7BY,EAAeT,EAAQI,EAAII,EAC7BE,EACJ,GAAIJ,IAAW,MACbI,EAAM5B,GAAmBC,EAAKJ,EAAK8B,EAAcJ,CAAI,UAC5CC,IAAW,MACpBI,EAAMd,GAAmBb,EAAKJ,EAAK8B,EAAcZ,EAAGQ,CAAI,UAC/CC,IAAW,iBAEpBI,EAAM3B,MAEN,OAAM,IAAI,MAAM,+BAA+B,EAEjD,IAAM4B,EAAI,IAAI,MAAMX,CAAK,EACzB,QAAS3B,EAAI,EAAGA,EAAI2B,EAAO3B,IAAK,CAC9B,IAAMuC,EAAI,IAAI,MAAMR,CAAC,EACrB,QAASS,EAAI,EAAGA,EAAIT,EAAGS,IAAK,CAC1B,IAAMC,EAAaN,GAAKK,EAAIxC,EAAI+B,GAC1BW,EAAKL,EAAI,SAASI,EAAYA,EAAaN,CAAC,EAClDI,EAAEC,CAAC,EAAIG,GAAIC,GAAMF,CAAE,EAAGZ,CAAC,CACzB,CACAQ,EAAEtC,CAAC,EAAIuC,CACT,CACA,OAAOD,CACT,CAyBM,SAAUO,GACdC,EACAC,EACAC,EAAgD,CAEhD,GAAI,OAAOD,GAAe,WAAY,MAAM,IAAI,MAAM,8BAA8B,EACpF,SAASE,EAAIC,EAAa,CACxB,OAAOJ,EAAM,WAAWC,EAAWG,CAAG,CAAC,CACzC,CACA,SAASC,EAAMC,EAAiB,CAC9B,IAAMC,EAAID,EAAQ,cAAa,EAC/B,OAAIC,EAAE,OAAOP,EAAM,IAAI,EAAUA,EAAM,MACvCO,EAAE,eAAc,EACTA,EACT,CAEA,MAAO,CACL,SAAU,OAAO,OAAOL,CAAQ,EAChC,MAAAF,EAEA,YAAYpC,EAAiBkB,EAAoB,CAC/C,IAAM0B,EAAO,OAAO,OAAO,CAAA,EAAIN,EAAUpB,CAAO,EAC1CU,EAAIZ,GAAchB,EAAK,EAAG4C,CAAI,EAC9BC,EAAKN,EAAIX,EAAE,CAAC,CAAC,EACbkB,EAAKP,EAAIX,EAAE,CAAC,CAAC,EACnB,OAAOa,EAAMI,EAAG,IAAIC,CAAE,CAAa,CACrC,EACA,cAAc9C,EAAiBkB,EAAoB,CACjD,IAAM6B,EAAUT,EAAS,UAAY,CAAE,IAAKA,EAAS,SAAS,EAAK,CAAA,EAC7DM,EAAO,OAAO,OAAO,CAAA,EAAIN,EAAUS,EAAS7B,CAAO,EACnDU,EAAIZ,GAAchB,EAAK,EAAG4C,CAAI,EAC9BC,EAAKN,EAAIX,EAAE,CAAC,CAAC,EACnB,OAAOa,EAAMI,CAAE,CACjB,EAEA,WAAWG,EAA0B,CAEnC,GAAIV,EAAS,IAAM,EAAG,CACpB,GAAI,OAAOU,GAAY,SAAU,MAAM,IAAI,MAAM,uBAAuB,EACxE,OAAOP,EAAMF,EAAI,CAACS,CAAO,CAAC,CAAC,CAC7B,CACA,GAAI,CAAC,MAAM,QAAQA,CAAO,EAAG,MAAM,IAAI,MAAM,2BAA2B,EACxE,QAAW1D,KAAK0D,EACd,GAAI,OAAO1D,GAAM,SAAU,MAAM,IAAI,MAAM,2BAA2B,EACxE,OAAOmD,EAAMF,EAAIS,CAAO,CAAC,CAC3B,EAIA,aAAahD,EAAiBkB,EAAoB,CAEhD,IAAM+B,EAAIb,EAAM,GAAG,MACbQ,EAAO,OAAO,OAAO,CAAA,EAAIN,EAAU,CAAE,EAAGW,EAAG,EAAG,EAAG,IAAKC,EAAW,EAAIhC,CAAO,EAClF,OAAOF,GAAchB,EAAK,EAAG4C,CAAI,EAAE,CAAC,EAAE,CAAC,CACzC,EAEJ,CA3RA,IA2DMV,GAqKOgB,GAhObC,GAAAC,GAAA,KAAAC,KAUAC,KAiDMpB,GAAQqB,GAqKDL,GAA0BpD,GAAa,eAAe,IC3LnE,SAAS0D,GAAaC,EAAqB,CACzC,OAAAC,GAAeD,EAAO,CACpB,kBAAmB,WACnB,WAAY,WACb,EACM,OAAO,OAAO,CAAE,GAAGA,CAAK,CAAW,CAC5C,CAEM,SAAUE,GAAWC,EAAwB,CACjD,IAAMC,EAAQL,GAAaI,CAAQ,EAC7B,CAAE,EAAAE,EAAG,KAAAC,EAAM,kBAAAC,EAAmB,WAAAC,EAAY,YAAaC,CAAI,EAAKL,EAChEM,EAAUJ,IAAS,SACzB,GAAI,CAACI,GAAWJ,IAAS,OAAQ,MAAM,IAAI,MAAM,cAAc,EAC/D,IAAMK,EAAeF,GAAQG,GAEvBC,EAAiBH,EAAU,IAAM,IACjCI,EAAWJ,EAAU,GAAK,GAC1BK,EAAe,OAAVL,EAAiB,EAAY,CAAX,EAKvBM,EAAgB,OAAVN,EAAiB,OAAiB,KAAX,EAI7BO,EAAYP,EAAUQ,IAAO,OAAO,GAAG,EAAIA,IAAO,OAAO,GAAG,EAC5DC,EAAWT,EACb,OAAO,CAAC,EAAIQ,IAAO,OAAO,GAAG,EAAIE,GACjC,OAAO,CAAC,EAAIF,IAAO,OAAO,GAAG,EAAIE,GAC/BC,EAAYJ,EAAYE,EAAWC,GACnCE,EAAQC,GAAcC,GAAID,EAAGlB,CAAC,EAC9BoB,EAAUC,EAAQX,CAAE,EAC1B,SAASW,EAAQC,EAAS,CACxB,OAAOC,GAAgBN,EAAKK,CAAC,EAAGb,CAAQ,CAC1C,CACA,SAASe,EAAQF,EAAa,CAC5B,IAAMG,EAAKC,GAAUC,EAAOL,EAAGb,EAAU,aAAa,CAAC,EAGvD,OAAIJ,IAASoB,EAAG,EAAE,GAAK,KAKhBR,EAAKW,GAAgBH,CAAE,CAAC,CACjC,CACA,SAASI,EAAaC,EAAkB,CACtC,OAAOF,GAAgB1B,EAAkBwB,GAAUC,EAAOG,EAAQrB,EAAU,QAAQ,CAAC,CAAC,CAAC,CACzF,CACA,SAASsB,EAAWD,EAAoBR,EAAa,CACnD,IAAMU,EAAKC,EAAiBT,EAAQF,CAAC,EAAGO,EAAaC,CAAM,CAAC,EAI5D,GAAIE,IAAOE,GAAK,MAAM,IAAI,MAAM,wCAAwC,EACxE,OAAOb,EAAQW,CAAE,CACnB,CAEA,SAASG,EAAeL,EAAkB,CACxC,OAAOC,EAAWD,EAAQV,CAAO,CACnC,CACA,IAAMgB,EAAeD,EACfE,EAAkBN,EAGxB,SAASO,EAAMC,EAAcC,EAAaC,EAAW,CAInD,IAAMC,EAAQzB,EAAKsB,GAAQC,EAAMC,EAAI,EACrC,OAAAD,EAAMvB,EAAKuB,EAAME,CAAK,EACtBD,EAAMxB,EAAKwB,EAAMC,CAAK,EACf,CAAE,IAAAF,EAAK,IAAAC,CAAG,CACnB,CAQA,SAASR,EAAiBX,EAAWQ,EAAc,CACjDa,GAAS,IAAKrB,EAAGY,GAAKlC,CAAC,EACvB2C,GAAS,SAAUb,EAAQlB,EAAWI,CAAS,EAC/C,IAAM4B,EAAId,EACJe,EAAMvB,EACRkB,EAAMzB,GACN+B,EAAMZ,GACNO,EAAMnB,EACNyB,EAAMhC,GACNwB,EAAOL,GACX,QAASc,GAAI,OAAOxC,EAAiB,CAAC,EAAGwC,IAAKd,GAAKc,KAAK,CACtD,IAAMC,GAAOL,GAAKI,GAAKjC,GACvBwB,GAAQU,GACP,CAAE,IAAAT,EAAK,IAAAC,CAAG,EAAKH,EAAMC,EAAMC,EAAKC,CAAG,EACnC,CAAE,IAAKK,EAAK,IAAKC,CAAG,EAAKT,EAAMC,EAAMO,EAAKC,CAAG,EAC9CR,EAAOU,GAEP,IAAMC,GAAIV,EAAMM,EACVK,GAAKlC,EAAKiC,GAAIA,EAAC,EACfE,GAAIZ,EAAMM,EACVO,GAAKpC,EAAKmC,GAAIA,EAAC,EACfE,GAAIH,GAAKE,GACTE,GAAId,EAAMM,EACVS,GAAIf,EAAMM,EACVU,GAAKxC,EAAKuC,GAAIN,EAAC,EACfQ,GAAKzC,EAAKsC,GAAIH,EAAC,EACfO,GAAOF,GAAKC,GACZE,EAAQH,GAAKC,GACnBjB,EAAMxB,EAAK0C,GAAOA,EAAI,EACtBZ,EAAM9B,EAAK4B,EAAM5B,EAAK2C,EAAQA,CAAK,CAAC,EACpCpB,EAAMvB,EAAKkC,GAAKE,EAAE,EAClBP,EAAM7B,EAAKqC,IAAKH,GAAKlC,EAAKN,EAAM2C,EAAC,EAAE,CACrC,EACC,CAAE,IAAAd,EAAK,IAAAC,CAAG,EAAKH,EAAMC,EAAMC,EAAKC,CAAG,GACnC,CAAE,IAAKK,EAAK,IAAKC,CAAG,EAAKT,EAAMC,EAAMO,EAAKC,CAAG,EAC9C,IAAMc,GAAK1D,EAAW2C,CAAG,EACzB,OAAO7B,EAAKuB,EAAMqB,EAAE,CACtB,CACA,IAAMC,EAAU,CACd,UAAWrD,EACX,UAAWA,EACX,KAAMA,GAEFsD,EAAkB,CAACC,EAAO1D,EAAaG,CAAQ,KACnDkB,EAAOqC,EAAMF,EAAQ,KAAM,MAAM,EAC1BE,GAEHC,EAAQ,CAAE,gBAAAF,CAAe,EAE/B,OAAO,OAAO,OAAO,CACnB,OAAQG,GAAaH,EAAiB3B,CAAY,EAClD,gBAAAC,EACA,aAAAD,EACA,WAAAL,EACA,eAAAI,EACA,MAAA8B,EACA,QAAS7C,EAAQ,MAAK,EACtB,QAAA0C,EACD,CACH,CA1LA,IAoBM5B,GACAnB,GACAF,GAtBNsD,GAAAC,GAAA,KAOAC,KAUAC,KACAC,KAEMrC,GAAM,OAAO,CAAC,EACdnB,GAAM,OAAO,CAAC,EACdF,GAAM,OAAO,CAAC,IC+Sd,SAAU2D,GAAyCC,EAAiB,CACxEC,GAAeD,EAAM,CACnB,KAAM,SACN,KAAM,WACN,aAAc,WACd,YAAa,WACd,EAGD,GAAM,CAAE,KAAAE,EAAM,MAAAC,EAAO,KAAAC,CAAI,EAAKJ,EACxB,CAAE,GAAAK,CAAE,EAAKF,EAETG,EAAc,CAACC,EAAiBC,IACpCR,EAAK,YAAYO,EAAK,CACpB,IAAKE,GAAYC,GAAa,cAAc,EAAGF,CAAG,EACnD,EACGG,EAAuB,CAACJ,EAAiBC,IAC7CR,EAAK,aAAaO,EAAK,CAAE,IAAKE,GAAYG,GAAaJ,CAAG,CAAC,CAAE,EACzDK,EAAe,CAACC,EAAWC,KAAe,CAC9C,IAAMC,EAAIC,GAAeH,EAAII,GAAiBb,EAAG,KAAK,CAAC,EAAGA,EAAG,MAAOA,EAAG,IAAI,EAG3E,OAAOA,EAAG,KAAOc,GAAgBH,CAAC,EAAII,GAAgBJ,CAAC,CACzD,EAEMK,EAAM,CAACC,EAAaC,IAAsBC,GAAUrB,EAAOmB,EAAQC,CAAO,EAE1EE,EAAUC,GACdjB,GAAYC,GAAa,SAAS,EAAG,IAAI,WAAW,CAACgB,CAAI,CAAC,EAAGhB,GAAa,IAAMR,CAAI,CAAC,EACjFyB,EAAUF,EAAO,CAAI,EACrBG,EAAWH,EAAO,CAAI,EACtBI,EAAWJ,EAAO,CAAI,EAE5B,SAASK,KAAUC,EAAsC,CACvD,IAAMC,EAAM,CAAA,EACZ,QAAWC,KAAKF,EACV,OAAOE,GAAM,SAAUD,EAAI,KAAKE,GAAgBD,EAAG,CAAC,CAAC,EAChD,OAAOA,GAAM,SAAUD,EAAI,KAAKtB,GAAauB,CAAC,CAAC,GAEtDE,EAAOF,CAAC,EACRD,EAAI,KAAKE,GAAgBD,EAAE,OAAQ,CAAC,EAAGA,CAAC,GAI5C,OAAOxB,GAAY,GAAGuB,CAAG,CAC3B,CACA,IAAMI,EAAY,IAAIC,IAAwBjC,EAAK0B,EAAO,GAAGO,EAAO,UAAU,CAAC,EAE/E,SAASC,EAAeC,EAAMC,EAAQC,EAAQjC,EAAU,CACtD,IAAMkC,EAAKH,EAAE,QAAO,EACdI,EAAOvC,EAAK0B,EAAOY,EAAIjC,GAAYC,GAAa,OAAO,EAAGF,CAAG,CAAC,CAAC,EAC/DwB,EAAgB,CAAA,EACtB,QAASY,EAAI,EAAGA,EAAIJ,EAAE,OAAQI,IAAK,CACjC,IAAMC,EAAKL,EAAEI,CAAC,EAAE,QAAO,EACjBE,EAAKL,EAAEG,CAAC,EAAE,QAAO,EACjBG,EAAKpC,EAAqBmB,EAAOa,EAAMC,EAAGC,EAAIC,EAAI,WAAW,EAAGtC,CAAG,EACzEwB,EAAI,KAAKe,CAAE,CACb,CACA,OAAOf,CACT,CAEA,SAASgB,EAAkBT,EAAMC,EAAQC,EAAQjC,EAAU,CACzD,IAAMyC,EAAIX,EAAeC,EAAGC,EAAGC,EAAGjC,CAAG,EAC/B0C,EAAI7B,EAAImB,EAAGS,CAAC,EACZE,EAAI9B,EAAIoB,EAAGQ,CAAC,EAClB,MAAO,CAAE,EAAAC,EAAG,EAAAC,CAAC,CACf,CAEA,SAASC,EAAsBC,EAAWd,EAAMC,EAAQC,EAAQjC,EAAU,CACxE,IAAMyC,EAAIX,EAAeC,EAAGC,EAAGC,EAAGjC,CAAG,EAC/B0C,EAAI7B,EAAImB,EAAGS,CAAC,EACZE,EAAID,EAAE,SAASG,CAAC,EACtB,MAAO,CAAE,EAAAH,EAAG,EAAAC,CAAC,CACf,CAEA,SAASG,EAAoBf,EAAMW,EAAMC,EAAMI,EAAOC,EAAOhD,EAAU,CACrE,GAAM,CAACkC,EAAIe,EAAIC,EAAIC,EAAIC,CAAE,EAAI,CAACrB,EAAGW,EAAGC,EAAGI,EAAIC,CAAE,EAAE,IAAKZ,IAAMA,GAAE,QAAO,CAAE,EACrE,OAAOjC,EAAqBmB,EAAOY,EAAIe,EAAIC,EAAIC,EAAIC,EAAI,WAAW,EAAGpD,CAAG,CAC1E,CAEA,SAASqD,EAAcrD,EAAY6C,EAAWd,EAAMC,EAAQC,EAAQ3B,EAAQ,CAC1E,GAAM,CAAE,EAAAoC,EAAG,EAAAC,CAAC,EAAKC,EAAsBC,EAAGd,EAAGC,EAAGC,EAAGjC,CAAG,EAChDsD,EAAIjD,EAAaC,CAAG,EACpByC,EAAKpD,EAAM,KAAK,SAAS2D,CAAC,EAC1BN,EAAKN,EAAE,SAASY,CAAC,EACjBC,GAAIT,EAAoBf,EAAGW,EAAGC,EAAGI,EAAIC,EAAIhD,CAAG,EAC5CwD,GAAI3D,EAAG,IAAIyD,EAAGzD,EAAG,IAAI0D,GAAGV,CAAC,CAAC,EAChC,OAAO5C,GAAY,GAAG,CAACsD,GAAGC,EAAC,EAAE,IAAKpB,IAAMvC,EAAG,QAAQuC,EAAC,CAAC,CAAC,CACxD,CAEA,SAASqB,EAAYzD,EAAY+B,EAAMC,EAAQC,EAAQyB,EAAY,CACjE/B,EAAO+B,EAAO,EAAI7D,EAAG,KAAK,EAC1B,GAAM,CAAE,EAAA6C,EAAG,EAAAC,CAAC,EAAKH,EAAkBT,EAAGC,EAAGC,EAAGjC,CAAG,EACzC,CAACuD,EAAGC,CAAC,EAAI,CAACE,EAAM,SAAS,EAAG7D,EAAG,KAAK,EAAG6D,EAAM,SAAS7D,EAAG,KAAK,CAAC,EAAE,IAAK8D,IAC1E9D,EAAG,UAAU8D,EAAC,CAAC,EAEXZ,EAAKpD,EAAM,KAAK,SAAS6D,CAAC,EAAE,IAAIzB,EAAE,SAASwB,CAAC,CAAC,EAC7CP,EAAKN,EAAE,SAASc,CAAC,EAAE,IAAIb,EAAE,SAASY,CAAC,CAAC,EACpCK,GAAYd,EAAoBf,EAAGW,EAAGC,EAAGI,EAAIC,EAAIhD,CAAG,EAC1D,GAAI,CAACH,EAAG,IAAI0D,EAAGK,EAAS,EAAG,MAAM,IAAI,MAAM,2BAA2B,CACxE,CAEA,SAASC,GAAe,CACtB,IAAMC,EAAMzD,EAAY,EAClB0D,EAAMpE,EAAM,KAAK,SAASmE,CAAG,EACnC,MAAO,CAAE,UAAWjE,EAAG,QAAQiE,CAAG,EAAG,UAAWC,EAAI,QAAO,CAAE,CAC/D,CAEA,SAASC,EAAchE,EAAYmC,EAAa8B,EAAW,CACzD,IAAMC,EAAMjE,GAAYC,GAAa,eAAe,EAAGF,CAAG,EACpDD,EAAME,GAAYkC,EAAMb,EAAO2C,CAAI,EAAG,WAAW,GAAG,CAAC,CAAC,EAC5D,QAASE,EAAU,EAAGA,GAAW,IAAKA,IAAW,CAC/CpE,EAAIA,EAAI,OAAS,CAAC,EAAIoE,EACtB,IAAML,EAAMtE,EAAK,aAAaO,EAAK,CAAE,IAAKmE,CAAG,CAAE,EAC/C,GAAI,CAAArE,EAAG,IAAIiE,CAAG,EACd,MAAO,CAAE,UAAWjE,EAAG,QAAQiE,CAAG,EAAG,UAAWnE,EAAM,KAAK,SAASmE,CAAG,EAAE,QAAO,CAAE,CACpF,CACA,MAAM,IAAI,MAAM,mBAAmB,CACrC,CACA,SAASM,EAAMpE,EAAYqE,EAAmB/D,EAAWC,GAAW,CAClE,IAAM6D,EAAQ/D,EAAaC,CAAG,EACxBgE,EAAaxE,EAAYuE,EAAOrE,CAAG,EACzC,GAAIsE,EAAW,OAAO3E,EAAM,IAAI,EAAG,MAAM,IAAI,MAAM,yBAAyB,EAC5E,IAAM4E,EAAUD,EAAW,SAASF,CAAK,EACzC,MAAO,CAAE,MAAOvE,EAAG,QAAQuE,CAAK,EAAG,QAASG,EAAQ,QAAO,CAAE,CAC/D,CACA,SAASC,EAASxE,EAAYyE,EAAwBJ,EAAY,CAChE,IAAMP,EAAMjE,EAAG,UAAU4E,CAAS,EAC5BH,EAAaxE,EAAYuE,EAAOrE,CAAG,EACzC,GAAIsE,EAAW,OAAO3E,EAAM,IAAI,EAAG,MAAM,IAAI,MAAM,yBAAyB,EAC5E,IAAM+E,EAAYJ,EAAW,SAASR,CAAG,EAAE,QAAO,EAClD,OAAOlC,EAAUyC,EAAOK,CAAS,CACnC,CACA,IAAMC,EAAO,CACX,gBAAAd,EACA,cAAe,CAAC1B,EAAayC,IAAmBZ,EAAc7C,EAASgB,EAAMyC,CAAO,EACpF,MAAO,CAACP,EAAc/D,EAAWC,KAAgB6D,EAAMjD,EAASkD,EAAO/D,CAAG,EAC1E,cAAcmE,EAAwBI,EAAwB,CAC5D,IAAMf,EAAMjE,EAAG,UAAU4E,CAAS,EAElC,OADY9E,EAAM,UAAUkF,CAAY,EAC7B,SAASf,CAAG,EAAE,QAAO,CAClC,EACA,SAASO,EAAcS,EAAyBC,EAA0B,CACxE,IAAMX,EAAQvE,EAAG,UAAUiF,CAAU,EAE/BJ,EADY/E,EAAM,UAAUoF,CAAc,EACpB,SAASlF,EAAG,IAAIuE,CAAK,CAAC,EAAE,QAAO,EAC3D,OAAOxC,EAAUyC,EAAOK,CAAS,CACnC,EACA,SAAU,CAACD,EAAwBJ,IAAiBG,EAASrD,EAASsD,EAAWJ,CAAK,GA6HxF,OAAO,OAAO,OAAO,CAAE,KAAA3E,EAAM,KAAAiF,EAAM,MA1HrB,CACZ,gBAAAd,EACA,cAAe,CAAC1B,EAAayC,IAAmBZ,EAAc5C,EAAUe,EAAMyC,CAAO,EACrF,MAAO,CAACP,EAAc/D,EAAWC,KAAgB6D,EAAMhD,EAAUiD,EAAO/D,CAAG,EAC3E,mBACEmE,EACAO,EACAT,EACAjE,EAAWC,GAAW,CAEtB,GAAI,CAAC,MAAM,QAAQgE,CAAO,EAAG,MAAM,IAAI,MAAM,gBAAgB,EAC7D,IAAMT,EAAMjE,EAAG,UAAU4E,CAAS,EAC5BV,EAAMpE,EAAM,UAAUqF,CAAS,EAC/BC,EAAgBV,EAAQ,IAAI5E,EAAM,SAAS,EAC3CuF,EAAYD,EAAc,IAAK7C,GAAMA,EAAE,SAAS0B,CAAG,CAAC,EACpDJ,EAAQL,EAAcjC,EAAU0C,EAAKC,EAAKkB,EAAeC,EAAW5E,CAAG,EAC7E,MAAO,CAAE,UAAW4E,EAAU,IAAK9C,GAAMA,EAAE,QAAO,CAAE,EAAG,MAAAsB,CAAK,CAC9D,EACA,cACEe,EACAO,EACAT,EACAjE,EAAWC,GAAW,CAEtB,IAAMiB,EAAM,KAAK,mBAAmBiD,EAAWO,EAAW,CAACT,CAAO,EAAGjE,CAAG,EACxE,MAAO,CAAE,UAAWkB,EAAI,UAAU,CAAC,EAAG,MAAOA,EAAI,KAAK,CACxD,EACA,cAAc2D,EAA2BH,EAAuBtB,EAAY,CAC1E,GAAI,CAAC,MAAM,QAAQyB,CAAK,EAAG,MAAM,IAAI,MAAM,gBAAgB,EAC3D,IAAMpB,EAAMpE,EAAM,UAAUqF,CAAS,EAC/BC,EAAgBE,EAAM,IAAK/C,GAAMA,EAAE,OAAO,EAAE,IAAIzC,EAAM,SAAS,EAC/DyF,EAAaD,EAAM,IAAK/C,GAAMA,EAAE,SAAS,EAAE,IAAIzC,EAAM,SAAS,EACpE,OAAA8D,EAAYrC,EAAU2C,EAAKkB,EAAeG,EAAY1B,CAAK,EACpDyB,EAAM,IAAK/C,GAAMuC,EAAK,SAASvC,EAAE,MAAOA,EAAE,MAAOA,EAAE,SAAS,CAAC,CACtE,EACA,SACEiC,EACAD,EACAc,EACAX,EACAS,EACAtB,EAAY,CAEZ,OAAO,KAAK,cAAc,CAAC,CAAE,MAAAW,EAAO,MAAAD,EAAO,UAAAc,EAAW,QAAAX,CAAO,CAAE,EAAGS,EAAWtB,CAAK,EAAE,CAAC,CACvF,EACA,SAAU,CAACe,EAAwBJ,IAAiBG,EAASpD,EAAUqD,EAAWJ,CAAK,GA6E/C,MA1E3BJ,GAAe,CAC5B,IAAMoB,EAAIlF,EAAqBmB,EAAO,OAAQ2C,CAAI,EAAG5C,CAAQ,EACvDoB,EAAI9C,EAAM,KAAK,SAAS0F,CAAC,EAC/B,MAAO,CACL,gBAAAxB,EACA,cAAe,CAAC1B,EAAayC,IAAmBZ,EAAc3C,EAAUc,EAAMyC,CAAO,EACrF,MAAMP,EAAcW,EAAuB1E,EAAWC,GAAW,CAC/D,IAAMwD,EAAMpE,EAAM,UAAUqF,CAAS,EAC/BM,EAAa7C,EAAE,IAAIsB,CAAG,EAC5B,GAAIuB,EAAW,OAAO3F,EAAM,IAAI,EAAG,MAAM,IAAI,MAAM,8BAA8B,EACjF,IAAMyE,EAAQ/D,EAAaC,CAAG,EACxBgE,EAAaxE,EAAYuE,EAAOhD,CAAQ,EAC9C,GAAIiD,EAAW,OAAO3E,EAAM,IAAI,EAAG,MAAM,IAAI,MAAM,yBAAyB,EAC5E,IAAMkF,EAAeP,EAAW,SAASF,CAAK,EAC9C,MAAO,CACL,MAAOvE,EAAG,QAAQuE,CAAK,EACvB,QAASS,EAAa,QAAO,EAC7B,WAAYS,EAAW,QAAO,EAElC,EACA,mBAAmBb,EAAwBF,EAAuBjE,EAAWC,GAAW,CACtF,GAAI,CAAC,MAAM,QAAQgE,CAAO,EAAG,MAAM,IAAI,MAAM,gBAAgB,EAC7D,IAAMT,EAAMjE,EAAG,UAAU4E,CAAS,EAC5BjE,EAAIX,EAAG,IAAIiE,EAAKuB,CAAC,EAGjBE,EAAO1F,EAAG,IAAIW,CAAC,EACfyE,EAAgBV,EAAQ,IAAI5E,EAAM,SAAS,EAC3CyF,EAAaH,EAAc,IAAK7C,IAAMA,GAAE,SAASmD,CAAI,CAAC,EACtDD,GAAa3F,EAAM,KAAK,SAASa,CAAC,EAClCkD,GAAQL,EAAchC,EAAUb,EAAG8E,GAAYF,EAAYH,EAAe3E,CAAG,EACnF,MAAO,CAAE,UAAW8E,EAAW,IAAKhD,IAAMA,GAAE,QAAO,CAAE,EAAG,MAAAsB,EAAK,CAC/D,EACA,cAAce,EAAwBF,EAAqBjE,EAAWC,GAAW,CAC/E,IAAMiB,EAAM,KAAK,mBAAmBiD,EAAW,CAACF,CAAO,EAAGjE,CAAG,EAC7D,MAAO,CAAE,UAAWkB,EAAI,UAAU,CAAC,EAAG,MAAOA,EAAI,KAAK,CACxD,EACA,cAAc2D,EAA2BzB,EAAc4B,EAAsB,CAC3E,GAAI,CAAC,MAAM,QAAQH,CAAK,EAAG,MAAM,IAAI,MAAM,gBAAgB,EAC3D,IAAMC,EAAaD,EAAM,IAAK/C,GAAMA,EAAE,SAAS,EAAE,IAAIzC,EAAM,SAAS,EACpE,OAAA8D,EACEpC,EACA1B,EAAM,UAAU2F,CAAU,EAC1BF,EACAD,EAAM,IAAK/C,GAAMA,EAAE,OAAO,EAAE,IAAIzC,EAAM,SAAS,EAC/C+D,CAAK,EAEAyB,EAAM,IAAI,CAAC/C,EAAGoD,IAAK,CACxB,IAAMpB,EAAQvE,EAAG,UAAUuC,EAAE,KAAK,EAC5BqD,EAAQL,EAAWI,CAAC,EAAE,SAAS3F,EAAG,IAAIuE,CAAK,CAAC,EAAE,QAAO,EAC3D,OAAOxC,EAAUQ,EAAE,MAAO6B,EAAMwB,CAAK,CACvC,CAAC,CACH,EACA,SACEpB,EACAD,EACAc,EACAX,EACAb,EACA4B,EAAsB,CAEtB,OAAO,KAAK,cAAc,CAAC,CAAE,MAAAjB,EAAO,MAAAD,EAAO,UAAAc,EAAW,QAAAX,CAAO,CAAE,EAAGb,EAAO4B,CAAU,EAAE,CAAC,CACxF,EACA,SAASb,EAAwBJ,EAAY,CAC3C,IAAMP,EAAMjE,EAAG,UAAU4E,CAAS,EAC5BH,EAAaxE,EAAYuE,EAAOhD,CAAQ,EAC9C,GAAIiD,EAAW,OAAO3E,EAAM,IAAI,EAAG,MAAM,IAAI,MAAM,yBAAyB,EAC5E,IAAMa,EAAIX,EAAG,IAAIiE,EAAKuB,CAAC,EACjBE,EAAO1F,EAAG,IAAIW,CAAC,EACfkE,EAAYJ,EAAW,SAASiB,CAAI,EAAE,QAAO,EACnD,OAAO3D,EAAUyC,EAAOJ,EAAMS,CAAS,CACzC,EAEJ,EACiD,QAAS,CAAE,GAAA7E,CAAE,CAAE,CAAE,CACpE,CAvlBA,IAAA6F,GAAAC,GAAA,KAmDAC,KAUAC,KACAC,KACAC,QC/DA,IAAAC,GAAA,GAAAC,GAAAD,GAAA,8BAAAE,GAAA,wCAAAC,GAAA,YAAAC,GAAA,mBAAAC,GAAA,eAAAC,GAAA,cAAAC,GAAA,iBAAAC,GAAA,wBAAAC,GAAA,sBAAAC,GAAA,WAAAC,KA+DA,SAASC,GAAoBC,EAAS,CAEpC,IAAMC,EAAO,OAAO,EAAE,EAAGC,EAAO,OAAO,EAAE,EAAGC,EAAO,OAAO,EAAE,EAAGC,EAAO,OAAO,EAAE,EACzEC,EAAIC,GAEJC,EADMP,EAAIA,EAAKK,EACJL,EAAKK,EAChBG,EAAMC,GAAKF,EAAIG,GAAKL,CAAC,EAAIE,EAAMF,EAC/BM,EAAMF,GAAKD,EAAII,GAAKP,CAAC,EAAIL,EAAKK,EAC9BQ,EAAOJ,GAAKE,EAAIG,GAAKT,CAAC,EAAIM,EAAMN,EAChCU,EAAON,GAAKI,EAAKZ,EAAMI,CAAC,EAAIQ,EAAOR,EACnCW,EAAOP,GAAKM,EAAKb,EAAMG,CAAC,EAAIU,EAAOV,EACnCY,EAAOR,GAAKO,EAAKb,EAAME,CAAC,EAAIW,EAAOX,EACnCa,EAAQT,GAAKQ,EAAKb,EAAMC,CAAC,EAAIY,EAAOZ,EACpCc,EAAQV,GAAKS,EAAMd,EAAMC,CAAC,EAAIY,EAAOZ,EACrCe,EAAQX,GAAKU,EAAMlB,EAAMI,CAAC,EAAIQ,EAAOR,EAG3C,MAAO,CAAE,UAFUI,GAAKW,EAAMV,GAAKL,CAAC,EAAIL,EAAKK,EAEzB,GAAAE,CAAE,CACxB,CAEA,SAASc,GAAkBC,EAAiB,CAG1C,OAAAA,EAAM,CAAC,GAAK,IAEZA,EAAM,EAAE,GAAK,IAEbA,EAAM,EAAE,GAAK,GACNA,CACT,CAQA,SAASC,GAAQC,EAAWC,EAAS,CACnC,IAAMpB,EAAIC,GACJoB,EAAKC,GAAIF,EAAIA,EAAIA,EAAGpB,CAAC,EACrBuB,EAAKD,GAAID,EAAKA,EAAKD,EAAGpB,CAAC,EAEvBwB,EAAM9B,GAAoByB,EAAII,CAAE,EAAE,UACpC5B,EAAI2B,GAAIH,EAAIE,EAAKG,EAAKxB,CAAC,EACrByB,EAAMH,GAAIF,EAAIzB,EAAIA,EAAGK,CAAC,EACtB0B,EAAQ/B,EACRgC,EAAQL,GAAI3B,EAAIiC,GAAiB5B,CAAC,EAClC6B,EAAWJ,IAAQN,EACnBW,EAAWL,IAAQH,GAAI,CAACH,EAAGnB,CAAC,EAC5B+B,EAASN,IAAQH,GAAI,CAACH,EAAIS,GAAiB5B,CAAC,EAClD,OAAI6B,IAAUlC,EAAI+B,IACdI,GAAYC,KAAQpC,EAAIgC,GACxBK,GAAarC,EAAGK,CAAC,IAAGL,EAAI2B,GAAI,CAAC3B,EAAGK,CAAC,GAC9B,CAAE,QAAS6B,GAAYC,EAAU,MAAOnC,CAAC,CAClD,CAMA,SAASsC,GAAeC,EAAkBC,EAAiBC,EAAe,CACxE,GAAID,EAAI,OAAS,IAAK,MAAM,IAAI,MAAM,oBAAoB,EAC1D,OAAOE,GACLC,GAAa,kCAAkC,EAC/C,IAAI,WAAW,CAACF,EAAS,EAAI,EAAGD,EAAI,MAAM,CAAC,EAC3CA,EACAD,CAAI,CAER,CAEA,SAASK,GAAGC,EAAe,CACzB,OAAOC,GAAMC,GAAeC,GAAQ,OAAO,OAAO,CAAE,kBAAA3B,EAAiB,EAAIwB,CAAI,CAAC,CAChF,CA0DM,SAAUvD,GAAoCkC,EAAS,CAG3D,IAAMyB,GAAW3C,GAAkBQ,IAAOoC,GACpCC,EAAS,OAAO,MAAM,EAExBC,EAAMC,EAAG,IAAI7B,CAAC,EAClB4B,EAAMC,EAAG,IAAID,EAAK1C,EAAG,EACrB,IAAI4C,EAAKD,EAAG,IAAID,EAAKC,EAAG,GAAG,EACvBE,EAAMF,EAAG,IAAIF,CAAM,EACnBK,EAAMH,EAAG,IAAIC,CAAE,EACfG,EAAMJ,EAAG,IAAIG,EAAKF,CAAE,EACpBI,EAAML,EAAG,IAAID,EAAKD,CAAM,EAC5BO,EAAML,EAAG,IAAIK,EAAKH,CAAG,EACrBG,EAAML,EAAG,IAAIK,EAAKF,CAAG,EACrBE,EAAML,EAAG,IAAIK,EAAKH,CAAG,EACrB,IAAII,EAAMN,EAAG,IAAII,CAAG,EACpBD,EAAMH,EAAG,IAAIM,CAAG,EAChBA,EAAMN,EAAG,IAAIM,EAAKF,CAAG,EACrBE,EAAMN,EAAG,IAAIM,EAAKD,CAAG,EACrBF,EAAMH,EAAG,IAAIG,EAAKG,CAAG,EACrB,IAAIC,EAAMP,EAAG,IAAIG,EAAKP,CAAO,EAC7BW,EAAMP,EAAG,IAAIO,EAAKD,CAAG,EACrB,IAAIE,EAAMR,EAAG,IAAIO,EAAKE,EAAO,EAC7BN,EAAMH,EAAG,IAAIO,CAAG,EAChBJ,EAAMH,EAAG,IAAIG,EAAKC,CAAG,EACrB,IAAIM,EAAKV,EAAG,IAAIG,EAAKE,CAAG,EACpBM,EAAKX,EAAG,KAAKQ,EAAKD,EAAKG,CAAE,EACzBE,EAAMZ,EAAG,IAAIE,EAAKH,CAAG,EACrBc,EAAMb,EAAG,IAAIO,EAAKpC,CAAC,EACvB0C,EAAMb,EAAG,IAAIa,EAAKC,EAAO,EACzB,IAAIC,EAAMf,EAAG,IAAIa,EAAKJ,EAAO,EACzBO,EAAMhB,EAAG,IAAIK,EAAKN,CAAG,EACzBI,EAAMH,EAAG,IAAIa,CAAG,EAChBV,EAAMH,EAAG,IAAIG,EAAKC,CAAG,EACrB,IAAIa,EAAKjB,EAAG,IAAIG,EAAKa,CAAG,EACpBE,EAAKlB,EAAG,KAAKe,EAAKF,EAAKI,CAAE,EAC7Bd,EAAMH,EAAG,IAAIW,CAAE,EACfR,EAAMH,EAAG,IAAIG,EAAKC,CAAG,EACrB,IAAIe,EAAKnB,EAAG,IAAIG,EAAKE,CAAG,EACpBe,EAAKpB,EAAG,KAAKY,EAAKV,EAAKiB,CAAE,EACzBE,EAAIrB,EAAG,KAAKkB,EAAIP,EAAIQ,CAAE,EACtBG,EAAKtB,EAAG,MAAOqB,CAAC,EACpB,OAAAA,EAAIrB,EAAG,KAAKqB,EAAGrB,EAAG,IAAIqB,CAAC,EAAGF,IAAOG,CAAE,EAC5B,CAAE,IAAKF,EAAI,IAAKnB,EAAI,IAAKoB,EAAG,IAAK9D,EAAG,CAC7C,CAGA,SAASgE,GAAqCpD,EAAS,CACrD,GAAM,CAAE,IAAAqD,EAAK,IAAAC,EAAK,IAAAC,EAAK,IAAAC,CAAG,EAAK1F,GAAoCkC,CAAC,EAEhEiD,EAAKpB,EAAG,IAAIwB,EAAKG,CAAG,EACxBP,EAAKpB,EAAG,IAAIoB,EAAIQ,EAAe,EAC/B,IAAI3B,EAAKD,EAAG,IAAIyB,EAAKC,CAAG,EACpBG,EAAK7B,EAAG,IAAIwB,EAAKC,CAAG,EACpBK,EAAK9B,EAAG,IAAIwB,EAAKC,CAAG,EACpB1B,EAAMC,EAAG,IAAIC,EAAI6B,CAAE,EACnBC,EAAI/B,EAAG,IAAID,EAAKC,EAAG,IAAI,EAC3BoB,EAAKpB,EAAG,KAAKoB,EAAIpB,EAAG,KAAM+B,CAAC,EAC3B9B,EAAKD,EAAG,KAAKC,EAAID,EAAG,IAAK+B,CAAC,EAC1BF,EAAK7B,EAAG,KAAK6B,EAAI7B,EAAG,IAAK+B,CAAC,EAC1BD,EAAK9B,EAAG,KAAK8B,EAAI9B,EAAG,IAAK+B,CAAC,EAC1B,GAAM,CAACC,EAAQC,CAAM,EAAIC,GAAclC,EAAI,CAACC,EAAI6B,CAAE,EAAG,EAAI,EACzD,MAAO,CAAE,EAAG9B,EAAG,IAAIoB,EAAIY,CAAM,EAAG,EAAGhC,EAAG,IAAI6B,EAAII,CAAM,CAAC,CACvD,CAiDA,SAASE,GAA0BC,EAAU,CAC3C,GAAM,CAAE,EAAAC,CAAC,EAAKC,GACRtF,EAAIC,GACJqB,EAAOiE,GAAcvC,EAAG,OAAOuC,CAAC,EAChCC,EAAIlE,EAAImE,GAAUL,EAAKA,CAAE,EACzBM,EAAKpE,GAAKkE,EAAIjF,IAAOoF,EAAc,EACrCC,EAAI,OAAO,EAAE,EACXC,EAAIvE,GAAKsE,EAAIP,EAAIG,GAAKlE,EAAIkE,EAAIH,CAAC,CAAC,EAClC,CAAE,QAASS,EAAY,MAAOC,CAAC,EAAK7E,GAAQwE,EAAIG,CAAC,EACjDG,EAAK1E,EAAIyE,EAAIX,CAAE,EACdpD,GAAagE,EAAIhG,CAAC,IAAGgG,EAAK1E,EAAI,CAAC0E,CAAE,GACjCF,IAAYC,EAAIC,GAChBF,IAAYF,EAAIJ,GACrB,IAAMS,EAAK3E,EAAIsE,GAAKJ,EAAIjF,IAAO2F,GAAiBL,CAAC,EAC3CM,EAAKJ,EAAIA,EACTK,EAAK9E,GAAKyE,EAAIA,GAAKF,CAAC,EACpBQ,EAAK/E,EAAI2E,EAAKK,EAAiB,EAC/BC,EAAKjF,EAAIf,GAAM4F,CAAE,EACjBK,EAAKlF,EAAIf,GAAM4F,CAAE,EACvB,OAAO,IAAIzD,GAAcpB,EAAI8E,EAAKI,CAAE,EAAGlF,EAAIiF,EAAKF,CAAE,EAAG/E,EAAI+E,EAAKG,CAAE,EAAGlF,EAAI8E,EAAKG,CAAE,CAAC,CACjF,CAtUA,IA0CME,GAAiClG,GAAiBF,GAAiBqG,GAEnEjG,GAAiBoC,GAGjB5C,GAMAqF,GA2CA1D,GAuBAc,GACAM,EACA2D,GA8BOzH,GAEAE,GAEAC,GAYAI,GAiBPmH,GACA9C,GACAL,GAsDAmB,GAoBOzF,GAgBPsG,GAEAa,GAIAO,GAIAlB,GAIAO,GAIAY,GAEAC,GAGAC,GAsCAC,GAyHO3H,GAKAC,GA6CAC,GAeAR,GA3gBbkI,GAAAC,GAAA,KAQAC,KACAC,KAEAC,KAUAC,KAQAC,KAQAC,KACAC,KACAL,KAGMZ,GAAsB,OAAO,CAAC,EAAGlG,GAAM,OAAO,CAAC,EAAGF,GAAM,OAAO,CAAC,EAAGqG,GAAsB,OAAO,CAAC,EAEjGjG,GAAM,OAAO,CAAC,EAAGoC,GAAM,OAAO,CAAC,EAG/B5C,GAAkB,OACtB,oEAAoE,EAKhEqF,GAAqD,CACzD,EAAGrF,GACH,EAAG,OAAO,oEAAoE,EAC9E,EAAG4C,GACH,EAAG,OAAO,oEAAoE,EAC9E,EAAG,OAAO,oEAAoE,EAC9E,GAAI,OAAO,oEAAoE,EAC/E,GAAI,OAAO,oEAAoE,GAoC3EjB,GAAkC,OACtC,+EAA+E,EAsB3Ec,GAAgCiF,GAAQrC,GAAe,CAAE,QAAApE,EAAO,CAAE,EAClE8B,EAA4BN,GAAc,GAC1CiE,GAA4BjE,GAAc,GA8BnCxD,GAAiCqD,GAAG,CAAA,CAAE,EAEtCnD,GAAoCmD,GAAG,CAAE,OAAQN,EAAc,CAAE,EAEjE5C,GAAmCkD,GAAG,CAAE,OAAQN,GAAgB,QAASU,EAAM,CAAE,EAYjFlD,IAA0C,IAAK,CAC1D,IAAMO,EAAIC,GACV,OAAO2H,GAAW,CAChB,EAAA5H,EACA,KAAM,SACN,WAAaL,GAAqB,CAEhC,GAAM,CAAE,UAAAkI,EAAW,GAAA3H,CAAE,EAAKR,GAAoBC,CAAC,EAC/C,OAAO2B,GAAIlB,GAAKyH,EAAWnB,GAAK1G,CAAC,EAAIE,EAAIF,CAAC,CAC5C,EACA,kBAAAgB,GACD,CACH,GAAE,EAKI4F,IAAkC3G,GAAkByG,IAAO7D,GAC3DiB,GAAiCd,EAAG,IAAI3C,GAAKuG,EAAO,EACpDnD,GAAiCT,EAAG,KAAKA,EAAG,IAAIA,EAAG,GAAG,CAAC,EAsDvD4B,GAAyCkD,GAAW9E,EAAIA,EAAG,IAAI,OAAO,MAAM,CAAC,CAAC,EAoBvE7D,GACX4I,GACErF,GACCsF,GAAsBzD,GAAqCyD,EAAQ,CAAC,CAAC,EACtE,CACE,IAAK,oCACL,UAAW,oCACX,EAAG/H,GACH,EAAG,EACH,EAAG,IACH,OAAQ,MACR,KAAM0C,GACP,EAIC8C,GAAU7D,GAEV0E,GAAoC,OACxC,+EAA+E,EAG3EO,GAAoC,OACxC,+EAA+E,EAG3ElB,GAAiC,OACrC,8EAA8E,EAG1EO,GAAiC,OACrC,+EAA+E,EAG3EY,GAAcmB,GAAmB/G,GAAQX,GAAK0H,CAAM,EAEpDlB,GAA2B,OAC/B,oEAAoE,EAEhEC,GAAsB/F,GAAsB+B,EAAG,OAAOkF,GAAgBjH,CAAK,EAAI8F,EAAQ,EAsCvFE,GAAN,MAAMkB,UAAwBC,EAAkC,CAI9D,OAAO,KACkB,IAAID,EAAgBzF,GAAc,IAAI,EAE/D,OAAO,KACkB,IAAIyF,EAAgBzF,GAAc,IAAI,EAE/D,OAAO,GACkBM,EAEzB,OAAO,GACkB2D,GAEzB,YAAY0B,EAAgB,CAC1B,MAAMA,CAAE,CACV,CAEA,OAAO,WAAWC,EAAuB,CACvC,OAAO,IAAIH,EAAgBzF,GAAc,WAAW4F,CAAE,CAAC,CACzD,CAEU,WAAWC,EAAsB,CACzC,GAAI,EAAEA,aAAiBJ,GAAkB,MAAM,IAAI,MAAM,yBAAyB,CACpF,CAEU,KAAKE,EAAgB,CAC7B,OAAO,IAAIF,EAAgBE,CAAE,CAC/B,CAEA,OAAO,UAAUpH,EAAiB,CAChCuH,EAAOvH,EAAO,EAAE,EAChB,GAAM,CAAE,EAAAwH,EAAG,EAAApD,CAAC,EAAKC,GACXtF,EAAIC,GACJqB,EAAOiE,GAAcvC,EAAG,OAAOuC,CAAC,EAChCQ,EAAIiB,GAAmB/F,CAAK,EAGlC,GAAI,CAACyH,GAAW1F,EAAG,QAAQ+C,CAAC,EAAG9E,CAAK,GAAKe,GAAa+D,EAAG/F,CAAC,EACxD,MAAM,IAAI,MAAM,iCAAiC,EACnD,IAAMmG,EAAK7E,EAAIyE,EAAIA,CAAC,EACd4C,EAAKrH,EAAIf,GAAMkI,EAAItC,CAAE,EACrByC,EAAKtH,EAAIf,GAAMkI,EAAItC,CAAE,EACrB0C,EAAOvH,EAAIqH,EAAKA,CAAE,EAClBG,EAAOxH,EAAIsH,EAAKA,CAAE,EAClBxH,EAAIE,EAAImH,EAAIpD,EAAIwD,EAAOC,CAAI,EAC3B,CAAE,QAAAC,EAAS,MAAOC,CAAC,EAAKlC,GAAWxF,EAAIF,EAAI0H,CAAI,CAAC,EAChDG,EAAK3H,EAAI0H,EAAIJ,CAAE,EACfM,EAAK5H,EAAI0H,EAAIC,EAAK7H,CAAC,EACrBzB,EAAI2B,GAAKyE,EAAIA,GAAKkD,CAAE,EACpBjH,GAAarC,EAAGK,CAAC,IAAGL,EAAI2B,EAAI,CAAC3B,CAAC,GAClC,IAAM0E,EAAI/C,EAAIqH,EAAKO,CAAE,EACfC,EAAI7H,EAAI3B,EAAI0E,CAAC,EACnB,GAAI,CAAC0E,GAAW/G,GAAamH,EAAGnJ,CAAC,GAAKqE,IAAMoC,GAC1C,MAAM,IAAI,MAAM,iCAAiC,EACnD,OAAO,IAAI0B,EAAgB,IAAIzF,GAAc/C,EAAG0E,EAAG9D,GAAK4I,CAAC,CAAC,CAC5D,CAOA,OAAO,QAAQC,EAAW,CACxB,OAAOjB,EAAgB,UAAUkB,GAAWD,CAAG,CAAC,CAClD,CAMA,SAAO,CACL,GAAI,CAAE,EAAAE,EAAG,EAAAC,EAAG,EAAAC,EAAG,EAAAC,CAAC,EAAK,KAAK,GACpBzJ,EAAIC,GACJqB,EAAOiE,GAAcvC,EAAG,OAAOuC,CAAC,EAChCoD,EAAKrH,EAAIA,EAAIkI,EAAID,CAAC,EAAIjI,EAAIkI,EAAID,CAAC,CAAC,EAChCX,EAAKtH,EAAIgI,EAAIC,CAAC,EAEdG,EAAOpI,EAAIsH,EAAKA,CAAE,EAClB,CAAE,MAAOe,CAAO,EAAK7C,GAAWxF,EAAIqH,EAAKe,CAAI,CAAC,EAC9CE,EAAKtI,EAAIqI,EAAUhB,CAAE,EACrBkB,EAAKvI,EAAIqI,EAAUf,CAAE,EACrBkB,EAAOxI,EAAIsI,EAAKC,EAAKJ,CAAC,EACxB5D,EACJ,GAAI7D,GAAayH,EAAIK,EAAM9J,CAAC,EAAG,CAC7B,IAAI+J,EAAKzI,EAAIiI,EAAI9D,EAAO,EACpBuE,EAAK1I,EAAIgI,EAAI7D,EAAO,EACxB6D,EAAIS,EACJR,EAAIS,EACJnE,EAAIvE,EAAIsI,EAAK/C,EAAiB,CAChC,MACEhB,EAAIgE,EAEF7H,GAAasH,EAAIQ,EAAM9J,CAAC,IAAGuJ,EAAIjI,EAAI,CAACiI,CAAC,GACzC,IAAIxD,EAAIzE,GAAKkI,EAAID,GAAK1D,CAAC,EACvB,OAAI7D,GAAa+D,EAAG/F,CAAC,IAAG+F,EAAIzE,EAAI,CAACyE,CAAC,GAC3B/C,EAAG,QAAQ+C,CAAC,CACrB,CAMA,OAAOwC,EAAsB,CAC3B,KAAK,WAAWA,CAAK,EACrB,GAAM,CAAE,EAAG0B,EAAI,EAAGC,CAAE,EAAK,KAAK,GACxB,CAAE,EAAGC,EAAI,EAAGC,CAAE,EAAK7B,EAAM,GACzBjH,EAAOiE,GAAcvC,EAAG,OAAOuC,CAAC,EAEhC8E,EAAM/I,EAAI2I,EAAKG,CAAE,IAAM9I,EAAI4I,EAAKC,CAAE,EAClCG,EAAMhJ,EAAI4I,EAAKE,CAAE,IAAM9I,EAAI2I,EAAKE,CAAE,EACxC,OAAOE,GAAOC,CAChB,CAEA,KAAG,CACD,OAAO,KAAK,OAAOnC,EAAgB,IAAI,CACzC,GAGW7I,GAET,CAAE,MAAO2H,EAAe,EAGf1H,GAA6D,CACxE,MAAO0H,GAaP,YAAYsD,EAAiBC,EAAoB,CAE/C,IAAMC,EAAMD,GAAS,KAAO,uCACtBE,EAAMC,GAAmBJ,EAAKE,EAAK,GAAI9H,EAAM,EAGnD,OAAOpD,GAAoB,cAAemL,CAAG,CAC/C,EACA,aAAaH,EAAiBC,EAAsB,CAAE,IAAKI,EAAW,EAAE,CACtE,IAAMF,EAAMC,GAAmBJ,EAAKC,EAAQ,IAAK,GAAI7H,EAAM,EAC3D,OAAOgE,GAAG,OAAOuB,GAAgBwC,CAAG,CAAC,CACvC,EAQA,cAAczJ,EAAiB,CAE7BuH,EAAOvH,EAAO,EAAE,EAChB,IAAM4J,EAAK7D,GAAmB/F,EAAM,SAAS,EAAG,EAAE,CAAC,EAC7C6J,EAAK3F,GAA0B0F,CAAE,EACjCE,EAAK/D,GAAmB/F,EAAM,SAAS,GAAI,EAAE,CAAC,EAC9C+J,EAAK7F,GAA0B4F,CAAE,EACvC,OAAO,IAAI9D,GAAgB6D,EAAG,IAAIE,CAAE,CAAC,CACvC,GAIWxL,GACXyL,GAAW,CACT,KAAM,sBACN,MAAOhE,GACP,KAAMtE,GACN,YAAapD,GAAoB,YACjC,aAAcA,GAAoB,aACnC,EAQUP,GAAqC,CAChD,mEACA,mEACA,mEACA,mEACA,mEACA,mEACA,mEACA,sECvdI,SAAUkM,GAAQC,EAAgBC,EAAiB,GAAE,CACzD,IAAMC,EAAI,IAAI,YAAY,EAAK,EAE/B,QAASC,EAAQ,GAAKF,EAAQE,EAAQ,GAAIA,IAAS,CAEjD,QAASC,EAAI,EAAGA,EAAI,GAAIA,IAAKF,EAAEE,CAAC,EAAIJ,EAAEI,CAAC,EAAIJ,EAAEI,EAAI,EAAE,EAAIJ,EAAEI,EAAI,EAAE,EAAIJ,EAAEI,EAAI,EAAE,EAAIJ,EAAEI,EAAI,EAAE,EACvF,QAASA,EAAI,EAAGA,EAAI,GAAIA,GAAK,EAAG,CAC9B,IAAMC,GAAQD,EAAI,GAAK,GACjBE,GAAQF,EAAI,GAAK,GACjBG,EAAKL,EAAEI,CAAI,EACXE,EAAKN,EAAEI,EAAO,CAAC,EACfG,EAAKC,GAAMH,EAAIC,EAAI,CAAC,EAAIN,EAAEG,CAAI,EAC9BM,EAAKC,GAAML,EAAIC,EAAI,CAAC,EAAIN,EAAEG,EAAO,CAAC,EACxC,QAASQ,EAAI,EAAGA,EAAI,GAAIA,GAAK,GAC3Bb,EAAEI,EAAIS,CAAC,GAAKJ,EACZT,EAAEI,EAAIS,EAAI,CAAC,GAAKF,CAEpB,CAEA,IAAIG,EAAOd,EAAE,CAAC,EACVe,EAAOf,EAAE,CAAC,EACd,QAASgB,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAC3B,IAAMC,EAAQC,GAAUF,CAAC,EACnBP,EAAKC,GAAMI,EAAMC,EAAME,CAAK,EAC5BN,EAAKC,GAAME,EAAMC,EAAME,CAAK,EAC5BE,EAAKC,GAAQJ,CAAC,EACpBF,EAAOd,EAAEmB,CAAE,EACXJ,EAAOf,EAAEmB,EAAK,CAAC,EACfnB,EAAEmB,CAAE,EAAIV,EACRT,EAAEmB,EAAK,CAAC,EAAIR,CACd,CAEA,QAASE,EAAI,EAAGA,EAAI,GAAIA,GAAK,GAAI,CAC/B,QAAST,EAAI,EAAGA,EAAI,GAAIA,IAAKF,EAAEE,CAAC,EAAIJ,EAAEa,EAAIT,CAAC,EAC3C,QAASA,EAAI,EAAGA,EAAI,GAAIA,IAAKJ,EAAEa,EAAIT,CAAC,GAAK,CAACF,GAAGE,EAAI,GAAK,EAAE,EAAIF,GAAGE,EAAI,GAAK,EAAE,CAC5E,CAEAJ,EAAE,CAAC,GAAKqB,GAAYlB,CAAK,EACzBH,EAAE,CAAC,GAAKsB,GAAYnB,CAAK,CAC3B,CACAoB,GAAMrB,CAAC,CACT,CArGA,IA4BMsB,GACAC,GACAC,GACAC,GACAC,GACAC,GACAT,GACAF,GACAY,GAeAC,GACAV,GACAC,GAGAZ,GACAE,GA+COoB,GAuKPC,GAYOC,GA3RbC,GAAAC,GAAA,KAWAC,KAEAC,KAeMd,GAAM,OAAO,CAAC,EACdC,GAAM,OAAO,CAAC,EACdC,GAAM,OAAO,CAAC,EACdC,GAAM,OAAO,CAAC,EACdC,GAAQ,OAAO,GAAG,EAClBC,GAAS,OAAO,GAAI,EACpBT,GAAoB,CAAA,EACpBF,GAAsB,CAAA,EACtBY,GAAuB,CAAA,EAC7B,QAAS3B,EAAQ,EAAGoC,EAAId,GAAKrB,EAAI,EAAGS,EAAI,EAAGV,EAAQ,GAAIA,IAAS,CAE9D,CAACC,EAAGS,CAAC,EAAI,CAACA,GAAI,EAAIT,EAAI,EAAIS,GAAK,CAAC,EAChCO,GAAQ,KAAK,GAAK,EAAIP,EAAIT,EAAE,EAE5Bc,GAAU,MAAQf,EAAQ,IAAMA,EAAQ,GAAM,EAAK,EAAE,EAErD,IAAIa,EAAIQ,GACR,QAASgB,EAAI,EAAGA,EAAI,EAAGA,IACrBD,GAAMA,GAAKd,IAASc,GAAKZ,IAAOE,IAAWD,GACvCW,EAAIb,KAAKV,GAAKS,KAASA,IAAO,OAAOe,CAAC,GAAKf,IAEjDK,GAAW,KAAKd,CAAC,CACnB,CACMe,GAAQU,GAAMX,GAAY,EAAI,EAC9BT,GAAcU,GAAM,CAAC,EACrBT,GAAcS,GAAM,CAAC,EAGrBrB,GAAQ,CAACgC,EAAWC,EAAW3C,IAAeA,EAAI,GAAK4C,GAAOF,EAAGC,EAAG3C,CAAC,EAAI6C,GAAOH,EAAGC,EAAG3C,CAAC,EACvFY,GAAQ,CAAC8B,EAAWC,EAAW3C,IAAeA,EAAI,GAAK8C,GAAOJ,EAAGC,EAAG3C,CAAC,EAAI+C,GAAOL,EAAGC,EAAG3C,CAAC,EA+ChFgC,GAAP,MAAOgB,CAAM,CACP,MACA,IAAM,EACN,OAAS,EACT,SAAW,GACX,QACA,UAAY,GAEf,SACA,OACA,UACG,UAAY,GACZ,OAGV,YACEC,EACAC,EACAC,EACAC,EAAY,GACZnD,EAAiB,GAAE,CAWnB,GATA,KAAK,SAAWgD,EAChB,KAAK,OAASC,EACd,KAAK,UAAYC,EACjB,KAAK,UAAYC,EACjB,KAAK,OAASnD,EAEdoD,GAAQF,EAAW,WAAW,EAG1B,EAAE,EAAIF,GAAYA,EAAW,KAC/B,MAAM,IAAI,MAAM,yCAAyC,EAC3D,KAAK,MAAQ,IAAI,WAAW,GAAG,EAC/B,KAAK,QAAUK,GAAI,KAAK,KAAK,CAC/B,CACA,OAAK,CACH,OAAO,KAAK,WAAU,CACxB,CACU,QAAM,CACdC,GAAW,KAAK,OAAO,EACvBxD,GAAQ,KAAK,QAAS,KAAK,MAAM,EACjCwD,GAAW,KAAK,OAAO,EACvB,KAAK,OAAS,EACd,KAAK,IAAM,CACb,CACA,OAAOC,EAAgB,CACrBC,GAAQ,IAAI,EACZC,EAAOF,CAAI,EACX,GAAM,CAAE,SAAAP,EAAU,MAAAU,CAAK,EAAK,KACtBC,EAAMJ,EAAK,OACjB,QAASK,EAAM,EAAGA,EAAMD,GAAO,CAC7B,IAAME,EAAO,KAAK,IAAIb,EAAW,KAAK,IAAKW,EAAMC,CAAG,EACpD,QAASE,EAAI,EAAGA,EAAID,EAAMC,IAAKJ,EAAM,KAAK,KAAK,GAAKH,EAAKK,GAAK,EAC1D,KAAK,MAAQZ,GAAU,KAAK,OAAM,CACxC,CACA,OAAO,IACT,CACU,QAAM,CACd,GAAI,KAAK,SAAU,OACnB,KAAK,SAAW,GAChB,GAAM,CAAE,MAAAU,EAAO,OAAAT,EAAQ,IAAAW,EAAK,SAAAZ,CAAQ,EAAK,KAEzCU,EAAME,CAAG,GAAKX,GACTA,EAAS,OAAU,GAAKW,IAAQZ,EAAW,GAAG,KAAK,OAAM,EAC9DU,EAAMV,EAAW,CAAC,GAAK,IACvB,KAAK,OAAM,CACb,CACU,UAAUe,EAAe,CACjCP,GAAQ,KAAM,EAAK,EACnBC,EAAOM,CAAG,EACV,KAAK,OAAM,EACX,IAAMC,EAAY,KAAK,MACjB,CAAE,SAAAhB,CAAQ,EAAK,KACrB,QAASY,EAAM,EAAGD,EAAMI,EAAI,OAAQH,EAAMD,GAAO,CAC3C,KAAK,QAAUX,GAAU,KAAK,OAAM,EACxC,IAAMa,EAAO,KAAK,IAAIb,EAAW,KAAK,OAAQW,EAAMC,CAAG,EACvDG,EAAI,IAAIC,EAAU,SAAS,KAAK,OAAQ,KAAK,OAASH,CAAI,EAAGD,CAAG,EAChE,KAAK,QAAUC,EACfD,GAAOC,CACT,CACA,OAAOE,CACT,CACA,QAAQA,EAAe,CAErB,GAAI,CAAC,KAAK,UAAW,MAAM,IAAI,MAAM,uCAAuC,EAC5E,OAAO,KAAK,UAAUA,CAAG,CAC3B,CACA,IAAIE,EAAa,CACf,OAAAb,GAAQa,CAAK,EACN,KAAK,QAAQ,IAAI,WAAWA,CAAK,CAAC,CAC3C,CACA,WAAWF,EAAe,CAExB,GADAG,GAAQH,EAAK,IAAI,EACb,KAAK,SAAU,MAAM,IAAI,MAAM,6BAA6B,EAChE,YAAK,UAAUA,CAAG,EAClB,KAAK,QAAO,EACLA,CACT,CACA,QAAM,CACJ,OAAO,KAAK,WAAW,IAAI,WAAW,KAAK,SAAS,CAAC,CACvD,CACA,SAAO,CACL,KAAK,UAAY,GACjBzC,GAAM,KAAK,KAAK,CAClB,CACA,WAAW6C,EAAW,CACpB,GAAM,CAAE,SAAAnB,EAAU,OAAAC,EAAQ,UAAAC,EAAW,OAAAlD,EAAQ,UAAAmD,CAAS,EAAK,KAC3D,OAAAgB,IAAO,IAAIpB,EAAOC,EAAUC,EAAQC,EAAWC,EAAWnD,CAAM,EAChEmE,EAAG,QAAQ,IAAI,KAAK,OAAO,EAC3BA,EAAG,IAAM,KAAK,IACdA,EAAG,OAAS,KAAK,OACjBA,EAAG,SAAW,KAAK,SACnBA,EAAG,OAASnE,EAEZmE,EAAG,OAASlB,EACZkB,EAAG,UAAYjB,EACfiB,EAAG,UAAYhB,EACfgB,EAAG,UAAY,KAAK,UACbA,CACT,GA+CInC,GAAW,CAACiB,EAAgBD,EAAkBE,EAAmBkB,EAAiB,CAAA,IACtFC,GACE,CAACC,EAAkB,CAAA,IACjB,IAAIvC,GAAOiB,EAAUC,EAAQqB,EAAK,QAAU,OAAYpB,EAAYoB,EAAK,MAAO,EAAI,EACtFF,CAAI,EAQKnC,GAEXD,GAAS,GAAM,IAAK,GAAoBuC,GAAQ,EAAI,CAAC,IC7RvD,IAAAC,GAAA,GAAAC,GAAAD,GAAA,UAAAE,GAAA,2BAAAC,GAAA,aAAAC,GAAA,oBAAAC,GAAA,kBAAAC,GAAA,UAAAC,GAAA,iBAAAC,GAAA,YAAAC,GAAA,SAAAC,KAyFA,SAASC,GAAsBC,EAAS,CACtC,IAAMC,EAAIC,GACJC,EAAMH,EAAIA,EAAIA,EAAKC,EACnBG,EAAMD,EAAKA,EAAKH,EAAKC,EACrBI,EAAMC,GAAKF,EAAIG,GAAKN,CAAC,EAAIG,EAAMH,EAC/BO,EAAMF,GAAKD,EAAIE,GAAKN,CAAC,EAAIG,EAAMH,EAC/BQ,EAAOH,GAAKE,EAAIE,GAAKT,CAAC,EAAIE,EAAMF,EAChCU,EAAOL,GAAKG,EAAKG,GAAMX,CAAC,EAAIQ,EAAOR,EACnCY,EAAOP,GAAKK,EAAKG,GAAMb,CAAC,EAAIU,EAAOV,EACnCc,EAAOT,GAAKO,EAAKG,GAAMf,CAAC,EAAIY,EAAOZ,EACnCgB,EAAQX,GAAKS,EAAKG,GAAMjB,CAAC,EAAIc,EAAOd,EACpCkB,EAAQb,GAAKW,EAAMD,GAAMf,CAAC,EAAIY,EAAOZ,EACrCmB,EAAQd,GAAKa,EAAMT,GAAKT,CAAC,EAAIE,EAAMF,EACnCoB,EAAQf,GAAKc,EAAME,GAAKrB,CAAC,EAAID,EAAKC,EACxC,OAAQK,GAAKe,EAAME,GAAOtB,CAAC,EAAImB,EAAQnB,CACzC,CAEA,SAASuB,GAAkBC,EAAiB,CAE1C,OAAAA,EAAM,CAAC,GAAK,IAEZA,EAAM,EAAE,GAAK,IAEbA,EAAM,EAAE,EAAI,EACLA,CACT,CAIA,SAASC,GAAQC,EAAWC,EAAS,CACnC,IAAM3B,EAAIC,GAOJ2B,EAAMC,GAAIH,EAAIA,EAAIC,EAAG3B,CAAC,EACtB8B,EAAMD,GAAID,EAAMF,EAAG1B,CAAC,EACpB+B,EAAOF,GAAIC,EAAMF,EAAMD,EAAG3B,CAAC,EAC3BgC,EAAOlC,GAAsBiC,CAAI,EACjChC,EAAI8B,GAAIC,EAAME,EAAMhC,CAAC,EAErBiC,EAAKJ,GAAI9B,EAAIA,EAAGC,CAAC,EAGvB,MAAO,CAAE,QAAS6B,GAAII,EAAKN,EAAG3B,CAAC,IAAM0B,EAAG,MAAO3B,CAAC,CAClD,CAaA,SAASmC,GAAKC,EAAkBC,EAAiBC,EAAe,CAC9D,GAAID,EAAI,OAAS,IAAK,MAAM,IAAI,MAAM,0CAA4CA,EAAI,MAAM,EAC5F,OAAOE,GACLC,GAAa,UAAU,EACvB,IAAI,WAAW,CAACF,EAAS,EAAI,EAAGD,EAAI,MAAM,CAAC,EAC3CA,EACAD,CAAI,CAER,CAGA,SAASK,GAAIC,EAAe,CAC1B,OAAOC,GAAMC,GAAaC,GAAc,OAAO,OAAO,CAAE,kBAAArB,GAAmB,OAAQW,EAAI,EAAIO,CAAI,CAAC,CAClG,CAsDA,SAASI,GAAiCnB,EAAS,CACjD,IAAIoB,EAAMC,EAAG,IAAIrB,CAAC,EACdsB,EAAKD,EAAG,IAAID,EAAKC,EAAG,GAAG,EAC3BD,EAAMC,EAAG,KAAKD,EAAKC,EAAG,KAAMC,CAAE,EAC9B,IAAIC,EAAKF,EAAG,IAAIA,EAAG,IAAKD,CAAG,EACvBI,EAAMH,EAAG,IAAII,EAAM,EACnBC,EAAML,EAAG,IAAIE,CAAE,EACfI,EAAMN,EAAG,IAAIK,EAAKH,CAAE,EACpBK,EAAMP,EAAG,IAAID,EAAKC,EAAG,IAAII,EAAM,CAAC,EACpCG,EAAMP,EAAG,IAAIO,EAAKJ,CAAG,EACrBI,EAAMP,EAAG,IAAIO,EAAKF,CAAG,EACrBE,EAAMP,EAAG,IAAIO,EAAKJ,CAAG,EACrB,IAAIK,EAAMR,EAAG,IAAIM,CAAG,EACpBD,EAAML,EAAG,IAAIO,EAAKD,CAAG,EACrBE,EAAMR,EAAG,IAAIQ,EAAKH,CAAG,EACrB,IAAII,EAAKT,EAAG,IAAIQ,EAAKE,EAAO,EAC5BD,EAAKT,EAAG,IAAIS,EAAIJ,CAAG,EACnB,IAAIM,EAAMX,EAAG,IAAIG,EAAKH,EAAG,IAAID,CAAG,CAAC,EAC7Ba,EAAKZ,EAAG,IAAIS,EAAI9B,CAAC,EACrBiC,EAAKZ,EAAG,KAAKY,EAAIZ,EAAG,KAAMC,CAAE,EAC5BI,EAAML,EAAG,IAAIS,CAAE,EACfJ,EAAML,EAAG,IAAIK,EAAKC,CAAG,EACrB,IAAIO,EAAKb,EAAG,IAAIK,EAAKE,CAAG,EACpBO,EAAKd,EAAG,KAAKW,EAAKR,EAAKU,CAAE,EACzBE,EAAIf,EAAG,KAAKY,EAAIH,EAAII,CAAE,EACtBG,EAAKhB,EAAG,MAAMe,CAAC,EACnB,OAAAA,EAAIf,EAAG,KAAKe,EAAGf,EAAG,IAAIe,CAAC,EAAGF,IAAOG,CAAE,EAC5B,CAAE,GAAAF,EAAI,GAAAZ,EAAI,GAAIa,EAAG,GAAIf,EAAG,GAAG,CACpC,CAEA,SAASiB,GAAmCtC,EAAS,CACnD,GAAI,CAAE,GAAAmC,EAAI,GAAAZ,EAAI,GAAAgB,EAAI,GAAAC,CAAE,EAAKrB,GAAiCnB,CAAC,EACvDyC,EAAMpB,EAAG,IAAIc,CAAE,EACfO,EAAMrB,EAAG,IAAIE,CAAE,EACfoB,EAAMtB,EAAG,IAAIqB,CAAG,EAChBE,EAAMvB,EAAG,IAAIkB,CAAE,EACfM,EAAMxB,EAAG,IAAImB,CAAE,EACfM,EAAMzB,EAAG,IAAIoB,EAAKC,CAAG,EACrBhB,EAAML,EAAG,IAAIyB,EAAKJ,CAAG,EACzBI,EAAMzB,EAAG,IAAIyB,EAAKJ,CAAG,EACrBI,EAAMzB,EAAG,IAAIyB,EAAKN,CAAE,EACpBM,EAAMzB,EAAG,IAAIyB,EAAKP,CAAE,EACpBO,EAAMzB,EAAG,IAAIyB,EAAKC,EAAG,EACrBrB,EAAML,EAAG,IAAIK,EAAKe,CAAG,EACrBf,EAAML,EAAG,IAAIK,EAAKmB,CAAG,EACrB,IAAIhB,EAAMR,EAAG,IAAIuB,EAAKG,EAAG,EACrB3B,EAAMC,EAAG,IAAIQ,EAAKgB,CAAG,EACzBzB,EAAMC,EAAG,IAAID,EAAKuB,CAAG,EACrB,IAAIK,EAAM3B,EAAG,IAAID,EAAKM,CAAG,EACzBA,EAAML,EAAG,IAAIK,EAAKS,CAAE,EACpB,IAAIc,EAAM5B,EAAG,IAAIc,EAAIQ,CAAG,EACpBO,EAAM7B,EAAG,IAAIQ,EAAKgB,CAAG,EACzBK,EAAM7B,EAAG,IAAI6B,EAAKD,CAAG,EACrBC,EAAM7B,EAAG,IAAI6B,EAAKxB,CAAG,EACrBN,EAAMC,EAAG,IAAIoB,EAAKC,CAAG,EACrBtB,EAAMC,EAAG,IAAID,EAAKsB,CAAG,EACrBtB,EAAMC,EAAG,IAAID,EAAKG,CAAE,EACpBH,EAAMC,EAAG,IAAID,EAAKwB,CAAG,EACrBxB,EAAMC,EAAG,IAAID,EAAK,OAAO,EAAE,CAAC,EAC5B,IAAI+B,EAAM9B,EAAG,IAAIK,EAAKN,CAAG,EACzB6B,EAAM5B,EAAG,IAAI4B,EAAKJ,CAAG,EACrBM,EAAM9B,EAAG,IAAI8B,EAAKF,CAAG,EACrB7B,EAAMC,EAAG,IAAI2B,EAAKG,CAAG,EACrB,IAAIC,EAAI/B,EAAG,IAAID,EAAKC,EAAG,IAAI,EAC3ByB,EAAMzB,EAAG,KAAKyB,EAAKzB,EAAG,KAAM+B,CAAC,EAC7BJ,EAAM3B,EAAG,KAAK2B,EAAK3B,EAAG,IAAK+B,CAAC,EAC5BF,EAAM7B,EAAG,KAAK6B,EAAK7B,EAAG,IAAK+B,CAAC,EAC5BD,EAAM9B,EAAG,KAAK8B,EAAK9B,EAAG,IAAK+B,CAAC,EAE5B,IAAMC,EAAMC,GAAcjC,EAAI,CAAC2B,EAAKG,CAAG,EAAG,EAAI,EAC9C,MAAO,CAAE,EAAG9B,EAAG,IAAIyB,EAAKO,EAAI,CAAC,CAAC,EAAG,EAAGhC,EAAG,IAAI6B,EAAKG,EAAI,CAAC,CAAC,CAAC,CACzD,CAkCA,SAASE,GAAsBC,EAAU,CACvC,GAAM,CAAE,EAAAC,EAAG,EAAGnF,CAAC,EAAKoF,GACdvD,EAAOwD,GAAcC,GAAM,OAAOD,CAAC,EAEnCE,EAAI1D,EAAI,EAAEqD,EAAKA,EAAG,EAClBM,EAAK3D,EAAIsD,GAAKI,EAAIlE,GAAI,EACtBoE,EAAK5D,GAAK2D,EAAKnE,KAAQmE,EAAKD,EAAE,EAE9B,CAAE,QAASG,EAAY,MAAO/D,CAAC,EAAKF,GAAQkE,GAAiB9D,GAAK0D,EAAIlE,IAAOoE,CAAE,CAAC,EAElFG,EAAUjE,EACT+D,IAAYE,EAAU/D,EAAIqD,EAAKvD,CAAC,GAErC,IAAIkE,EAAMxE,GACLqE,IAAYG,EAAMhE,EAAI,CAACR,EAAG,GAE/B,IAAMyE,EAAIjE,EAAI+D,GAAWL,EAAIlE,GAAI,EAC7B0E,EAAQD,EACRE,GAAaF,EAAG9F,CAAC,IAAG+F,EAAQlE,EAAI,CAACiE,CAAC,GAEtC,IAAMG,EAAKH,EAAIA,EACTI,EAAKrE,EAAIkE,EAAQtF,EAAG,EACpB0F,EAAKtE,EAAIoE,EAAK5E,EAAG,EACjB+E,EAAKvE,EAAIoE,EAAK5E,EAAG,EACjBgF,EAAKxE,EAAI+D,EAAUE,GAAKP,EAAIlE,IAAOsE,GAAkBE,CAAG,EAC9D,OAAO,IAAIlD,GAAYd,EAAIqE,EAAKG,CAAE,EAAGxE,EAAIuE,EAAKD,CAAE,EAAGtE,EAAIsE,EAAKE,CAAE,EAAGxE,EAAIqE,EAAKE,CAAE,CAAC,CAC/E,CA3VA,IAyCMnG,GAGAmF,GAqBAkB,GAaA1D,GACA2D,GAGAlF,GAAiBZ,GAAiBH,GAAiBmE,GAAiC9D,GAEpFE,GAAmBE,GAAmBE,GAAmBK,GA0DzDyB,EACAyD,GAEAlB,GACAmB,GAYA9D,GAkBOjD,GAIAE,GAKAP,GAaAQ,GAeP4D,GACAN,GA4EOxD,GAYP+G,GAEAf,GAEAgB,GAIAC,GAIAC,GA0CAC,GAyGOvH,GAKAC,GAsCAC,GAeAH,GAvgBbyH,GAAAC,GAAA,KASAC,KACAC,KAEAC,KAUAC,KAQAC,KACAC,KACAC,KACAL,KAQMjH,GAAgB,OACpB,oHAAoH,EAEhHmF,GAAmD,CACvD,EAAGnF,GACH,EAAG,OACD,oHAAoH,EAEtH,EAAG,OAAO,CAAC,EACX,EAAG,OAAO,CAAC,EACX,EAAG,OACD,oHAAoH,EAEtH,GAAI,OACF,oHAAoH,EAEtH,GAAI,OACF,oHAAoH,GAOlHqG,GACJ,OAAO,OAAO,CAAA,EAAIlB,GAAa,CAC7B,EAAG,OACD,oHAAoH,EAEtH,GAAI,OACF,oHAAoH,EAEtH,GAAI,OACF,oHAAoH,EAEvH,EAEGxC,GAA+B4E,GAAgB,IAAMC,GAAS,OAAO,CAAE,MAAO,GAAG,CAAE,CAAC,EACpFlB,GAA8BiB,GAAgB,IAAMC,GAAS,OAAO,CAAE,MAAO,EAAE,CAAE,CAAC,EAGlFpG,GAAM,OAAO,CAAC,EAAGZ,GAAM,OAAO,CAAC,EAAGH,GAAM,OAAO,CAAC,EAAGmE,GAAsB,OAAO,CAAC,EAAG9D,GAAO,OAAO,EAAE,EAEpGE,GAAO,OAAO,EAAE,EAAGE,GAAO,OAAO,EAAE,EAAGE,GAAO,OAAO,EAAE,EAAGK,GAAQ,OAAO,GAAG,EA0D3EyB,EAA4B2E,GAAMzH,GAAe,CAAE,KAAM,IAAK,KAAM,EAAI,CAAE,EAC1EuG,GAA4BkB,GAAMtC,GAAY,EAAG,CAAE,KAAM,IAAK,KAAM,EAAI,CAAE,EAE1EE,GAA+BoC,GAAMzH,GAAe,CAAE,KAAM,IAAK,KAAM,EAAI,CAAE,EAC7EwG,GAA+BiB,GAAMtC,GAAY,EAAG,CAAE,KAAM,IAAK,KAAM,EAAI,CAAE,EAY7EzC,GAA8BgF,GAAQvC,GAAa,CAAE,GAAArC,EAAI,GAAAyD,GAAI,QAAA/E,EAAO,CAAE,EAkB/D/B,GAA+B8C,GAAI,CAAA,CAAE,EAIrC5C,GAAiC4C,GAAI,CAAE,QAAS+D,EAAW,CAAE,EAK7DlH,GAAyCsI,GAAQrB,EAAU,EAa3DzG,IAAwC,IAAK,CACxD,IAAMG,EAAIC,GACV,OAAO2H,GAAW,CAChB,EAAA5H,EACA,KAAM,OACN,WAAaD,GAAqB,CAChC,IAAM8H,EAAc/H,GAAsBC,CAAC,EACrC+H,EAAUzH,GAAKwH,EAAapH,GAAKT,CAAC,EACxC,OAAO6B,GAAIiG,EAAU/H,EAAGC,CAAC,CAC3B,EACA,kBAAAuB,GACD,CACH,GAAE,EAGIkC,IAAkCxD,GAAgB,OAAO,CAAC,GAAK,OAAO,CAAC,EACvEkD,GAAyB,OAAO,MAAM,EA4E/BxD,GACX6H,GAAa7E,GAAcoF,GAAsB/D,GAAmC+D,EAAQ,CAAC,CAAC,EAAG,CAC/F,IAAK,mCACL,UAAW,mCACX,EAAG9H,GACH,EAAG,EACH,EAAG,IACH,OAAQ,MACR,KAAMwH,GACP,EAGGf,GAA8B,OAAO,OAAO,EAE5Cf,GAAkC,OAAO,OAAO,EAEhDgB,GAA+B,OACnC,wIAAwI,EAGpIC,GAAkC,OACtC,yIAAyI,EAGrIC,GAAcmB,GAAmBvG,GAAQJ,GAAK2G,CAAM,EA0CpDlB,GAAN,MAAMmB,UAAoBC,EAA8B,CAGtD,OAAO,KACkB,IAAID,EAAYtF,GAAY,IAAI,EAAE,eAAelC,EAAG,EAE7E,OAAO,KACkB,IAAIwH,EAAYtF,GAAY,IAAI,EAEzD,OAAO,GACkB2C,GAEzB,OAAO,GACkBmB,GAEzB,YAAY0B,EAAgB,CAC1B,MAAMA,CAAE,CACV,CAEA,OAAO,WAAWC,EAAuB,CACvC,OAAO,IAAIH,EAAYtF,GAAY,WAAWyF,CAAE,CAAC,CACnD,CAEU,WAAWC,EAAkB,CACrC,GAAI,EAAEA,aAAiBJ,GAAc,MAAM,IAAI,MAAM,qBAAqB,CAC5E,CAEU,KAAKE,EAAgB,CAC7B,OAAO,IAAIF,EAAYE,CAAE,CAC3B,CAEA,OAAO,UAAU3G,EAAiB,CAChC8G,EAAO9G,EAAO,EAAE,EAChB,GAAM,CAAE,EAAA2D,EAAG,EAAGnF,CAAC,EAAKoF,GACdvD,EAAOwD,GAAcC,GAAM,OAAOD,CAAC,EACnCS,EAAIR,GAAM,UAAU9D,CAAK,EAI/B,GAAI,CAAC+G,GAAW9B,GAAM,QAAQX,CAAC,EAAGtE,CAAK,GAAKwE,GAAaF,EAAG9F,CAAC,EAC3D,MAAM,IAAI,MAAM,6BAA6B,EAE/C,IAAMiG,EAAKpE,EAAIiE,EAAIA,CAAC,EACdL,EAAK5D,EAAIR,GAAM4E,CAAE,EACjBuC,EAAO3G,EAAI4D,EAAKA,CAAE,EAClBgD,EAAK5G,EAAI2G,EAAO/D,GAAMU,EAAIc,CAAE,EAE5B,CAAE,QAAAyC,EAAS,MAAOC,CAAO,EAAK9B,GAAWhF,EAAI4G,EAAKD,CAAI,CAAC,EAEzDI,EAAK/G,GAAKiE,EAAIA,GAAK6C,EAAUlD,EAAKkB,EAAY,EAC9CX,GAAa4C,EAAI5I,CAAC,IAAG4I,EAAK/G,EAAI,CAAC+G,CAAE,GAErC,IAAM7I,EAAI8B,EAAI+G,EAAKD,EAAUF,EAAK7B,EAAe,EAC3C9C,EAAIjC,GAAKR,GAAM4E,GAAM0C,EAAUlD,CAAE,EACjCoD,EAAIhH,EAAI9B,EAAI+D,CAAC,EAEnB,GAAI,CAAC4E,EAAS,MAAM,IAAI,MAAM,6BAA6B,EAC3D,OAAO,IAAIT,EAAY,IAAItF,GAAY5C,EAAG+D,EAAGzC,GAAKwH,CAAC,CAAC,CACtD,CAOA,OAAO,QAAQC,EAAW,CACxB,OAAOb,EAAY,UAAUc,GAAWD,CAAG,CAAC,CAC9C,CAMA,SAAO,CACL,GAAM,CAAE,EAAAE,EAAG,EAAAC,EAAG,EAAAC,CAAC,EAAK,KAAK,GACnBlJ,EAAIoF,GAAY,EAChBvD,EAAOwD,GAAcC,GAAM,OAAOD,CAAC,EACnCI,EAAK5D,EAAIA,EAAImH,EAAIE,CAAC,EAAIrH,EAAImH,EAAIE,CAAC,CAAC,EAChCjH,EAAKJ,EAAImH,EAAIA,CAAC,EACd,CAAE,MAAOL,CAAO,EAAK9B,GAAWhF,EAAI4D,EAAKiB,GAAczE,CAAE,CAAC,EAC5DkH,EAAQtH,EAAI8G,EAAUlD,EAAKkB,EAAY,EACvCX,GAAamD,EAAOnJ,CAAC,IAAGmJ,EAAQtH,EAAI,CAACsH,CAAK,GAC9C,IAAMV,EAAK5G,EAAI+E,GAAkBuC,EAAQF,EAAIC,CAAC,EAC1CpD,EAAIjE,EAAI6E,GAAciC,EAAUK,EAAIP,CAAE,EAC1C,OAAIzC,GAAaF,EAAG9F,CAAC,IAAG8F,EAAIjE,EAAI,CAACiE,CAAC,GAC3BW,GAAM,QAAQX,CAAC,CACxB,CAMA,OAAOuC,EAAkB,CACvB,KAAK,WAAWA,CAAK,EACrB,GAAM,CAAE,EAAGe,EAAI,EAAGC,CAAE,EAAK,KAAK,GACxB,CAAE,EAAGC,EAAI,EAAGC,CAAE,EAAKlB,EAAM,GAE/B,OAAO/C,GAAM,OAAO8D,EAAKG,CAAE,IAAMjE,GAAM,OAAO+D,EAAKC,CAAE,CACvD,CAEA,KAAG,CACD,OAAO,KAAK,OAAOrB,EAAY,IAAI,CACrC,GAGW1I,GAET,CAAE,MAAOuH,EAAW,EAGXtH,GAAqD,CAChE,MAAOsH,GACP,YAAY0C,EAAiBC,EAAoB,CAC/C,IAAMC,EAAMD,GAAS,KAAO,oCAC5B,OAAOjK,GAAgB,cAAemK,GAAmBH,EAAKE,EAAK,IAAK,IAAKjC,EAAQ,CAAC,CACxF,EAMA,aAAa+B,EAAiBC,EAAsB,CAAE,IAAKG,EAAW,EAAE,CAEtE,IAAMC,EAAMF,GAAmBH,EAAKC,EAAQ,IAAK,GAAI,IAAKhC,EAAQ,EAClE,OAAOhB,GAAM,OAAOqD,GAAgBD,CAAG,CAAC,CAC1C,EAQA,cAAcrI,EAAiB,CAC7B8G,EAAO9G,EAAO,GAAG,EACjB,IAAMuI,EAAiB,GAIjBC,EAAK1E,GAAM,OAAOA,GAAM,UAAU9D,EAAM,SAAS,EAAG,EAAE,EAAGuI,CAAc,CAAC,EACxEE,EAAKhF,GAAsB+E,CAAE,EAC7BE,EAAK5E,GAAM,OAAOA,GAAM,UAAU9D,EAAM,SAAS,GAAI,GAAG,EAAGuI,CAAc,CAAC,EAC1EI,EAAKlF,GAAsBiF,CAAE,EACnC,OAAO,IAAIpD,GAAYmD,EAAG,IAAIE,CAAE,CAAC,CACnC,GAIW1K,GACX2K,GAAW,CACT,KAAM,oBACN,MAAOtD,GACP,KAAO0C,GAAoB/B,GAAS+B,EAAK,CAAE,MAAO,EAAE,CAAE,EACtD,YAAahK,GAAgB,YAC7B,aAAcA,GAAgB,aAC/B,EAQUF,GAAmC,CAC9C,qHACA,qHACA,qHACA,wHC3gBF,IAOa+K,GAiFAC,GAxFbC,GAAAC,GAAA,KAIAC,KAGaJ,GAAP,KAAY,CAChB,MACA,MACA,SACA,UACQ,SAAW,GACX,UAAY,GAEpB,YAAYK,EAAaC,EAAe,CAItC,GAHAC,GAAMF,CAAI,EACVG,EAAOF,EAAK,OAAW,KAAK,EAC5B,KAAK,MAAQD,EAAK,OAAM,EACpB,OAAO,KAAK,MAAM,QAAW,WAC/B,MAAM,IAAI,MAAM,qDAAqD,EACvE,KAAK,SAAW,KAAK,MAAM,SAC3B,KAAK,UAAY,KAAK,MAAM,UAC5B,IAAMI,EAAW,KAAK,SAChBC,EAAM,IAAI,WAAWD,CAAQ,EAEnCC,EAAI,IAAIJ,EAAI,OAASG,EAAWJ,EAAK,OAAM,EAAG,OAAOC,CAAG,EAAE,OAAM,EAAKA,CAAG,EACxE,QAAS,EAAI,EAAG,EAAII,EAAI,OAAQ,IAAKA,EAAI,CAAC,GAAK,GAC/C,KAAK,MAAM,OAAOA,CAAG,EAErB,KAAK,MAAQL,EAAK,OAAM,EAExB,QAAS,EAAI,EAAG,EAAIK,EAAI,OAAQ,IAAKA,EAAI,CAAC,GAAK,IAC/C,KAAK,MAAM,OAAOA,CAAG,EACrBC,GAAMD,CAAG,CACX,CACA,OAAOE,EAAe,CACpB,OAAAC,GAAQ,IAAI,EACZ,KAAK,MAAM,OAAOD,CAAG,EACd,IACT,CACA,WAAWE,EAAe,CACxBD,GAAQ,IAAI,EACZL,EAAOM,EAAK,KAAK,UAAW,QAAQ,EACpC,KAAK,SAAW,GAChB,KAAK,MAAM,WAAWA,CAAG,EACzB,KAAK,MAAM,OAAOA,CAAG,EACrB,KAAK,MAAM,WAAWA,CAAG,EACzB,KAAK,QAAO,CACd,CACA,QAAM,CACJ,IAAMA,EAAM,IAAI,WAAW,KAAK,MAAM,SAAS,EAC/C,YAAK,WAAWA,CAAG,EACZA,CACT,CACA,WAAWC,EAAa,CAEtBA,IAAO,OAAO,OAAO,OAAO,eAAe,IAAI,EAAG,CAAA,CAAE,EACpD,GAAM,CAAE,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,EAAW,SAAAV,EAAU,UAAAW,CAAS,EAAK,KACnE,OAAAL,EAAKA,EACLA,EAAG,SAAWG,EACdH,EAAG,UAAYI,EACfJ,EAAG,SAAWN,EACdM,EAAG,UAAYK,EACfL,EAAG,MAAQC,EAAM,WAAWD,EAAG,KAAK,EACpCA,EAAG,MAAQE,EAAM,WAAWF,EAAG,KAAK,EAC7BA,CACT,CACA,OAAK,CACH,OAAO,KAAK,WAAU,CACxB,CACA,SAAO,CACL,KAAK,UAAY,GACjB,KAAK,MAAM,QAAO,EAClB,KAAK,MAAM,QAAO,CACpB,GAaWd,GAGT,CAACI,EAAaC,EAAiBe,IACjC,IAAIrB,GAAWK,EAAMC,CAAG,EAAE,OAAOe,CAAO,EAAE,OAAM,EAClDpB,GAAK,OAAS,CAACI,EAAaC,IAAoB,IAAIN,GAAWK,EAAMC,CAAG,ICclE,SAAUgB,GAAiBC,EAAWC,EAAkBC,EAAS,CAIrE,GAAM,CAAC,CAACC,EAAIC,CAAE,EAAG,CAACC,EAAIC,CAAE,CAAC,EAAIL,EACvBM,EAAKC,GAAWF,EAAKN,EAAGE,CAAC,EACzBO,EAAKD,GAAW,CAACJ,EAAKJ,EAAGE,CAAC,EAG5BQ,EAAKV,EAAIO,EAAKJ,EAAKM,EAAKJ,EACxBM,EAAK,CAACJ,EAAKH,EAAKK,EAAKH,EACnBM,EAAQF,EAAKG,GACbC,EAAQH,EAAKE,GACfD,IAAOF,EAAK,CAACA,GACbI,IAAOH,EAAK,CAACA,GAGjB,IAAMI,EAAUC,GAAQ,KAAK,KAAKC,GAAOf,CAAC,EAAI,CAAC,CAAC,EAAIgB,GACpD,GAAIR,EAAKG,IAAOH,GAAMK,GAAWJ,EAAKE,IAAOF,GAAMI,EACjD,MAAM,IAAI,MAAM,yCAA2Cf,CAAC,EAE9D,MAAO,CAAE,MAAAY,EAAO,GAAAF,EAAI,MAAAI,EAAO,GAAAH,CAAE,CAC/B,CA+DA,SAASQ,GAAkBC,EAAc,CACvC,GAAI,CAAC,CAAC,UAAW,YAAa,KAAK,EAAE,SAASA,CAAM,EAClD,MAAM,IAAI,MAAM,2DAA2D,EAC7E,OAAOA,CACT,CAEA,SAASC,GACPC,EACAC,EAAM,CAEN,IAAMC,EAAuB,CAAA,EAC7B,QAASC,KAAW,OAAO,KAAKF,CAAG,EAEjCC,EAAMC,CAAO,EAAIH,EAAKG,CAAO,IAAM,OAAYF,EAAIE,CAAO,EAAIH,EAAKG,CAAO,EAE5E,OAAAC,GAAMF,EAAM,KAAO,MAAM,EACzBE,GAAMF,EAAM,QAAU,SAAS,EAC3BA,EAAM,SAAW,QAAWL,GAAkBK,EAAM,MAAM,EACvDA,CACT,CAkQM,SAAUG,GACdC,EACAC,EAAqC,CAAA,EAAE,CAEvC,IAAMC,EAAYC,GAAkB,cAAeH,EAAQC,CAAS,EAC9D,CAAE,GAAAG,EAAI,GAAAC,CAAE,EAAKH,EACfI,EAAQJ,EAAU,MAChB,CAAE,EAAGK,EAAU,EAAGC,CAAW,EAAKF,EACxCG,GACER,EACA,CAAA,EACA,CACE,mBAAoB,UACpB,cAAe,WACf,cAAe,WACf,UAAW,WACX,QAAS,WACT,KAAM,SACP,EAGH,GAAM,CAAE,KAAAS,CAAI,EAAKT,EACjB,GAAIS,IAEE,CAACN,EAAG,IAAIE,EAAM,CAAC,GAAK,OAAOI,EAAK,MAAS,UAAY,CAAC,MAAM,QAAQA,EAAK,OAAO,GAClF,MAAM,IAAI,MAAM,4DAA4D,EAIhF,IAAMC,EAAUC,GAAYR,EAAIC,CAAE,EAElC,SAASQ,GAA4B,CACnC,GAAI,CAACT,EAAG,MAAO,MAAM,IAAI,MAAM,4DAA4D,CAC7F,CAGA,SAASU,EACPC,EACAC,EACAC,EAAqB,CAErB,GAAM,CAAE,EAAG,EAAAC,CAAC,EAAKF,EAAM,SAAQ,EACzBG,EAAKf,EAAG,QAAQ,CAAC,EAEvB,GADAN,GAAMmB,EAAc,cAAc,EAC9BA,EAAc,CAChBJ,EAA4B,EAC5B,IAAMO,EAAW,CAAChB,EAAG,MAAOc,CAAC,EAC7B,OAAOG,GAAYC,GAAQF,CAAQ,EAAGD,CAAE,CAC1C,KACE,QAAOE,GAAY,WAAW,GAAG,CAAI,EAAGF,EAAIf,EAAG,QAAQc,CAAC,CAAC,CAE7D,CACA,SAASK,EAAeC,EAAiB,CACvCC,EAAOD,EAAO,OAAW,OAAO,EAChC,GAAM,CAAE,UAAWE,EAAM,sBAAuBC,CAAM,EAAKhB,EACrDiB,EAASJ,EAAM,OACfK,EAAOL,EAAM,CAAC,EACdM,EAAON,EAAM,SAAS,CAAC,EAE7B,GAAII,IAAWF,IAASG,IAAS,GAAQA,IAAS,GAAO,CACvD,IAAME,EAAI3B,EAAG,UAAU0B,CAAI,EAC3B,GAAI,CAAC1B,EAAG,QAAQ2B,CAAC,EAAG,MAAM,IAAI,MAAM,qCAAqC,EACzE,IAAMC,EAAKC,EAAoBF,CAAC,EAC5Bb,EACJ,GAAI,CACFA,EAAId,EAAG,KAAK4B,CAAE,CAChB,OAASE,GAAW,CAClB,IAAMC,GAAMD,cAAqB,MAAQ,KAAOA,GAAU,QAAU,GACpE,MAAM,IAAI,MAAM,yCAA2CC,EAAG,CAChE,CACAtB,EAA4B,EAC5B,IAAMuB,EAAQhC,EAAG,MAAOc,CAAC,EAEzB,OADeW,EAAO,KAAO,IACfO,IAAOlB,EAAId,EAAG,IAAIc,CAAC,GAC1B,CAAE,EAAAa,EAAG,EAAAb,CAAC,CACf,SAAWU,IAAWD,GAAUE,IAAS,EAAM,CAE7C,IAAMQ,EAAIjC,EAAG,MACP2B,EAAI3B,EAAG,UAAU0B,EAAK,SAAS,EAAGO,CAAC,CAAC,EACpCnB,EAAId,EAAG,UAAU0B,EAAK,SAASO,EAAGA,EAAI,CAAC,CAAC,EAC9C,GAAI,CAACC,EAAUP,EAAGb,CAAC,EAAG,MAAM,IAAI,MAAM,4BAA4B,EAClE,MAAO,CAAE,EAAAa,EAAG,EAAAb,CAAC,CACf,KACE,OAAM,IAAI,MACR,yBAAyBU,CAAM,yBAAyBF,CAAI,oBAAoBC,CAAM,EAAE,CAG9F,CAEA,IAAMY,EAActC,EAAU,SAAWa,EACnC0B,EAAcvC,EAAU,WAAasB,EAC3C,SAASU,EAAoBF,EAAI,CAC/B,IAAMU,EAAKrC,EAAG,IAAI2B,CAAC,EACbW,EAAKtC,EAAG,IAAIqC,EAAIV,CAAC,EACvB,OAAO3B,EAAG,IAAIA,EAAG,IAAIsC,EAAItC,EAAG,IAAI2B,EAAGzB,EAAM,CAAC,CAAC,EAAGA,EAAM,CAAC,CACvD,CAIA,SAASgC,EAAUP,EAAM,EAAI,CAC3B,IAAMY,EAAOvC,EAAG,IAAI,CAAC,EACfwC,EAAQX,EAAoBF,CAAC,EACnC,OAAO3B,EAAG,IAAIuC,EAAMC,CAAK,CAC3B,CAIA,GAAI,CAACN,EAAUhC,EAAM,GAAIA,EAAM,EAAE,EAAG,MAAM,IAAI,MAAM,mCAAmC,EAIvF,IAAMuC,EAAOzC,EAAG,IAAIA,EAAG,IAAIE,EAAM,EAAGwC,EAAG,EAAGC,EAAG,EACvCC,EAAQ5C,EAAG,IAAIA,EAAG,IAAIE,EAAM,CAAC,EAAG,OAAO,EAAE,CAAC,EAChD,GAAIF,EAAG,IAAIA,EAAG,IAAIyC,EAAMG,CAAK,CAAC,EAAG,MAAM,IAAI,MAAM,0BAA0B,EAG3E,SAASC,EAAOC,EAAe5E,EAAM6E,EAAU,GAAK,CAClD,GAAI,CAAC/C,EAAG,QAAQ9B,CAAC,GAAM6E,GAAW/C,EAAG,IAAI9B,CAAC,EAAI,MAAM,IAAI,MAAM,wBAAwB4E,CAAK,EAAE,EAC7F,OAAO5E,CACT,CAEA,SAAS8E,EAAUC,EAAc,CAC/B,GAAI,EAAEA,aAAiBC,GAAQ,MAAM,IAAI,MAAM,4BAA4B,CAC7E,CAEA,SAASC,EAAiBnF,EAAS,CACjC,GAAI,CAACsC,GAAQ,CAACA,EAAK,QAAS,MAAM,IAAI,MAAM,SAAS,EACrD,OAAOvC,GAAiBC,EAAGsC,EAAK,QAASL,EAAG,KAAK,CACnD,CAOA,IAAMmD,EAAeC,GAAS,CAACC,EAAUC,IAA0B,CACjE,GAAM,CAAE,EAAAC,EAAG,EAAAC,EAAG,EAAAC,CAAC,EAAKJ,EAEpB,GAAItD,EAAG,IAAI0D,EAAG1D,EAAG,GAAG,EAAG,MAAO,CAAE,EAAGwD,EAAG,EAAGC,CAAC,EAC1C,IAAME,EAAML,EAAE,IAAG,EAGbC,GAAM,OAAMA,EAAKI,EAAM3D,EAAG,IAAMA,EAAG,IAAI0D,CAAC,GAC5C,IAAM/B,EAAI3B,EAAG,IAAIwD,EAAGD,CAAE,EAChBzC,EAAId,EAAG,IAAIyD,EAAGF,CAAE,EAChBK,EAAK5D,EAAG,IAAI0D,EAAGH,CAAE,EACvB,GAAII,EAAK,MAAO,CAAE,EAAG3D,EAAG,KAAM,EAAGA,EAAG,IAAI,EACxC,GAAI,CAACA,EAAG,IAAI4D,EAAI5D,EAAG,GAAG,EAAG,MAAM,IAAI,MAAM,kBAAkB,EAC3D,MAAO,CAAE,EAAA2B,EAAG,EAAAb,CAAC,CACf,CAAC,EAGK+C,EAAkBR,GAAUC,GAAY,CAC5C,GAAIA,EAAE,IAAG,EAAI,CAIX,GAAIzD,EAAU,oBAAsB,CAACG,EAAG,IAAIsD,EAAE,CAAC,EAAG,OAClD,MAAM,IAAI,MAAM,iBAAiB,CACnC,CAEA,GAAM,CAAE,EAAA3B,EAAG,EAAAb,CAAC,EAAKwC,EAAE,SAAQ,EAC3B,GAAI,CAACtD,EAAG,QAAQ2B,CAAC,GAAK,CAAC3B,EAAG,QAAQc,CAAC,EAAG,MAAM,IAAI,MAAM,sCAAsC,EAC5F,GAAI,CAACoB,EAAUP,EAAGb,CAAC,EAAG,MAAM,IAAI,MAAM,mCAAmC,EACzE,GAAI,CAACwC,EAAE,cAAa,EAAI,MAAM,IAAI,MAAM,wCAAwC,EAChF,MAAO,EACT,CAAC,EAED,SAASQ,EACPC,EACAC,EACAC,EACArF,EACAE,EAAc,CAEd,OAAAmF,EAAM,IAAIf,EAAMlD,EAAG,IAAIiE,EAAI,EAAGF,CAAQ,EAAGE,EAAI,EAAGA,EAAI,CAAC,EACrDD,EAAME,GAAStF,EAAOoF,CAAG,EACzBC,EAAMC,GAASpF,EAAOmF,CAAG,EAClBD,EAAI,IAAIC,CAAG,CACpB,CAOA,MAAMf,CAAK,CAET,OAAgB,KAAO,IAAIA,EAAMhD,EAAM,GAAIA,EAAM,GAAIF,EAAG,GAAG,EAE3D,OAAgB,KAAO,IAAIkD,EAAMlD,EAAG,KAAMA,EAAG,IAAKA,EAAG,IAAI,EAEzD,OAAgB,GAAKA,EAErB,OAAgB,GAAKC,EAEZ,EACA,EACA,EAGT,YAAYuD,EAAMC,EAAMC,EAAI,CAC1B,KAAK,EAAIb,EAAO,IAAKW,CAAC,EACtB,KAAK,EAAIX,EAAO,IAAKY,EAAG,EAAI,EAC5B,KAAK,EAAIZ,EAAO,IAAKa,CAAC,EACtB,OAAO,OAAO,IAAI,CACpB,CAEA,OAAO,OAAK,CACV,OAAOxD,CACT,CAGA,OAAO,WAAWoD,EAAiB,CACjC,GAAM,CAAE,EAAA3B,EAAG,EAAAb,CAAC,EAAKwC,GAAK,CAAA,EACtB,GAAI,CAACA,GAAK,CAACtD,EAAG,QAAQ2B,CAAC,GAAK,CAAC3B,EAAG,QAAQc,CAAC,EAAG,MAAM,IAAI,MAAM,sBAAsB,EAClF,GAAIwC,aAAaJ,EAAO,MAAM,IAAI,MAAM,8BAA8B,EAEtE,OAAIlD,EAAG,IAAI2B,CAAC,GAAK3B,EAAG,IAAIc,CAAC,EAAUoC,EAAM,KAClC,IAAIA,EAAMvB,EAAGb,EAAGd,EAAG,GAAG,CAC/B,CAEA,OAAO,UAAUoB,EAAiB,CAChC,IAAM+C,EAAIjB,EAAM,WAAWd,EAAYf,EAAOD,EAAO,OAAW,OAAO,CAAC,CAAC,EACzE,OAAA+C,EAAE,eAAc,EACTA,CACT,CAEA,OAAO,QAAQC,EAAW,CACxB,OAAOlB,EAAM,UAAUmB,GAAWD,CAAG,CAAC,CACxC,CAEA,IAAI,GAAC,CACH,OAAO,KAAK,SAAQ,EAAG,CACzB,CACA,IAAI,GAAC,CACH,OAAO,KAAK,SAAQ,EAAG,CACzB,CAQA,WAAWE,EAAqB,EAAGC,EAAS,GAAI,CAC9C,OAAAC,EAAK,YAAY,KAAMF,CAAU,EAC5BC,GAAQ,KAAK,SAAS7B,EAAG,EACvB,IACT,CAIA,gBAAc,CACZmB,EAAgB,IAAI,CACtB,CAEA,UAAQ,CACN,GAAM,CAAE,CAAC,EAAK,KAAK,SAAQ,EAC3B,GAAI,CAAC7D,EAAG,MAAO,MAAM,IAAI,MAAM,6BAA6B,EAC5D,MAAO,CAACA,EAAG,MAAM,CAAC,CACpB,CAGA,OAAOiD,EAAY,CACjBD,EAAUC,CAAK,EACf,GAAM,CAAE,EAAGwB,EAAI,EAAGC,EAAI,EAAGC,CAAE,EAAK,KAC1B,CAAE,EAAGC,EAAI,EAAGC,EAAI,EAAGC,CAAE,EAAK7B,EAC1B8B,EAAK/E,EAAG,IAAIA,EAAG,IAAIyE,EAAIK,CAAE,EAAG9E,EAAG,IAAI4E,EAAID,CAAE,CAAC,EAC1CK,EAAKhF,EAAG,IAAIA,EAAG,IAAI0E,EAAII,CAAE,EAAG9E,EAAG,IAAI6E,EAAIF,CAAE,CAAC,EAChD,OAAOI,GAAMC,CACf,CAGA,QAAM,CACJ,OAAO,IAAI9B,EAAM,KAAK,EAAGlD,EAAG,IAAI,KAAK,CAAC,EAAG,KAAK,CAAC,CACjD,CAMA,QAAM,CACJ,GAAM,CAAE,EAAAiF,EAAG,EAAAC,CAAC,EAAKhF,EACXiF,EAAKnF,EAAG,IAAIkF,EAAGxC,EAAG,EAClB,CAAE,EAAG+B,EAAI,EAAGC,EAAI,EAAGC,CAAE,EAAK,KAC5BS,EAAKpF,EAAG,KAAMqF,EAAKrF,EAAG,KAAMsF,EAAKtF,EAAG,KACpCuF,EAAKvF,EAAG,IAAIyE,EAAIA,CAAE,EAClBe,GAAKxF,EAAG,IAAI0E,EAAIA,CAAE,EAClBe,GAAKzF,EAAG,IAAI2E,EAAIA,CAAE,EAClBe,GAAK1F,EAAG,IAAIyE,EAAIC,CAAE,EACtB,OAAAgB,GAAK1F,EAAG,IAAI0F,GAAIA,EAAE,EAClBJ,EAAKtF,EAAG,IAAIyE,EAAIE,CAAE,EAClBW,EAAKtF,EAAG,IAAIsF,EAAIA,CAAE,EAClBF,EAAKpF,EAAG,IAAIiF,EAAGK,CAAE,EACjBD,EAAKrF,EAAG,IAAImF,EAAIM,EAAE,EAClBJ,EAAKrF,EAAG,IAAIoF,EAAIC,CAAE,EAClBD,EAAKpF,EAAG,IAAIwF,GAAIH,CAAE,EAClBA,EAAKrF,EAAG,IAAIwF,GAAIH,CAAE,EAClBA,EAAKrF,EAAG,IAAIoF,EAAIC,CAAE,EAClBD,EAAKpF,EAAG,IAAI0F,GAAIN,CAAE,EAClBE,EAAKtF,EAAG,IAAImF,EAAIG,CAAE,EAClBG,GAAKzF,EAAG,IAAIiF,EAAGQ,EAAE,EACjBC,GAAK1F,EAAG,IAAIuF,EAAIE,EAAE,EAClBC,GAAK1F,EAAG,IAAIiF,EAAGS,EAAE,EACjBA,GAAK1F,EAAG,IAAI0F,GAAIJ,CAAE,EAClBA,EAAKtF,EAAG,IAAIuF,EAAIA,CAAE,EAClBA,EAAKvF,EAAG,IAAIsF,EAAIC,CAAE,EAClBA,EAAKvF,EAAG,IAAIuF,EAAIE,EAAE,EAClBF,EAAKvF,EAAG,IAAIuF,EAAIG,EAAE,EAClBL,EAAKrF,EAAG,IAAIqF,EAAIE,CAAE,EAClBE,GAAKzF,EAAG,IAAI0E,EAAIC,CAAE,EAClBc,GAAKzF,EAAG,IAAIyF,GAAIA,EAAE,EAClBF,EAAKvF,EAAG,IAAIyF,GAAIC,EAAE,EAClBN,EAAKpF,EAAG,IAAIoF,EAAIG,CAAE,EAClBD,EAAKtF,EAAG,IAAIyF,GAAID,EAAE,EAClBF,EAAKtF,EAAG,IAAIsF,EAAIA,CAAE,EAClBA,EAAKtF,EAAG,IAAIsF,EAAIA,CAAE,EACX,IAAIpC,EAAMkC,EAAIC,EAAIC,CAAE,CAC7B,CAMA,IAAIrC,EAAY,CACdD,EAAUC,CAAK,EACf,GAAM,CAAE,EAAGwB,EAAI,EAAGC,EAAI,EAAGC,CAAE,EAAK,KAC1B,CAAE,EAAGC,EAAI,EAAGC,EAAI,EAAGC,CAAE,EAAK7B,EAC5BmC,EAAKpF,EAAG,KAAMqF,EAAKrF,EAAG,KAAMsF,EAAKtF,EAAG,KAClCiF,GAAI/E,EAAM,EACViF,GAAKnF,EAAG,IAAIE,EAAM,EAAGwC,EAAG,EAC1B6C,GAAKvF,EAAG,IAAIyE,EAAIG,CAAE,EAClBY,GAAKxF,EAAG,IAAI0E,EAAIG,CAAE,EAClBY,GAAKzF,EAAG,IAAI2E,EAAIG,CAAE,EAClBY,GAAK1F,EAAG,IAAIyE,EAAIC,CAAE,EAClBiB,GAAK3F,EAAG,IAAI4E,EAAIC,CAAE,EACtBa,GAAK1F,EAAG,IAAI0F,GAAIC,EAAE,EAClBA,GAAK3F,EAAG,IAAIuF,GAAIC,EAAE,EAClBE,GAAK1F,EAAG,IAAI0F,GAAIC,EAAE,EAClBA,GAAK3F,EAAG,IAAIyE,EAAIE,CAAE,EAClB,IAAIiB,GAAK5F,EAAG,IAAI4E,EAAIE,CAAE,EACtB,OAAAa,GAAK3F,EAAG,IAAI2F,GAAIC,EAAE,EAClBA,GAAK5F,EAAG,IAAIuF,GAAIE,EAAE,EAClBE,GAAK3F,EAAG,IAAI2F,GAAIC,EAAE,EAClBA,GAAK5F,EAAG,IAAI0E,EAAIC,CAAE,EAClBS,EAAKpF,EAAG,IAAI6E,EAAIC,CAAE,EAClBc,GAAK5F,EAAG,IAAI4F,GAAIR,CAAE,EAClBA,EAAKpF,EAAG,IAAIwF,GAAIC,EAAE,EAClBG,GAAK5F,EAAG,IAAI4F,GAAIR,CAAE,EAClBE,EAAKtF,EAAG,IAAIiF,GAAGU,EAAE,EACjBP,EAAKpF,EAAG,IAAImF,GAAIM,EAAE,EAClBH,EAAKtF,EAAG,IAAIoF,EAAIE,CAAE,EAClBF,EAAKpF,EAAG,IAAIwF,GAAIF,CAAE,EAClBA,EAAKtF,EAAG,IAAIwF,GAAIF,CAAE,EAClBD,EAAKrF,EAAG,IAAIoF,EAAIE,CAAE,EAClBE,GAAKxF,EAAG,IAAIuF,GAAIA,EAAE,EAClBC,GAAKxF,EAAG,IAAIwF,GAAID,EAAE,EAClBE,GAAKzF,EAAG,IAAIiF,GAAGQ,EAAE,EACjBE,GAAK3F,EAAG,IAAImF,GAAIQ,EAAE,EAClBH,GAAKxF,EAAG,IAAIwF,GAAIC,EAAE,EAClBA,GAAKzF,EAAG,IAAIuF,GAAIE,EAAE,EAClBA,GAAKzF,EAAG,IAAIiF,GAAGQ,EAAE,EACjBE,GAAK3F,EAAG,IAAI2F,GAAIF,EAAE,EAClBF,GAAKvF,EAAG,IAAIwF,GAAIG,EAAE,EAClBN,EAAKrF,EAAG,IAAIqF,EAAIE,EAAE,EAClBA,GAAKvF,EAAG,IAAI4F,GAAID,EAAE,EAClBP,EAAKpF,EAAG,IAAI0F,GAAIN,CAAE,EAClBA,EAAKpF,EAAG,IAAIoF,EAAIG,EAAE,EAClBA,GAAKvF,EAAG,IAAI0F,GAAIF,EAAE,EAClBF,EAAKtF,EAAG,IAAI4F,GAAIN,CAAE,EAClBA,EAAKtF,EAAG,IAAIsF,EAAIC,EAAE,EACX,IAAIrC,EAAMkC,EAAIC,EAAIC,CAAE,CAC7B,CAEA,SAASrC,EAAY,CACnB,OAAO,KAAK,IAAIA,EAAM,OAAM,CAAE,CAChC,CAEA,KAAG,CACD,OAAO,KAAK,OAAOC,EAAM,IAAI,CAC/B,CAWA,SAAS2C,EAAc,CACrB,GAAM,CAAE,KAAAvF,CAAI,EAAKT,EACjB,GAAI,CAACI,EAAG,YAAY4F,CAAM,EAAG,MAAM,IAAI,MAAM,8BAA8B,EAC3E,IAAIjF,EAAckF,EACZC,EAAO7H,GAAcsG,EAAK,OAAO,KAAMtG,EAAIoF,GAAM0C,GAAW9C,EAAOI,CAAC,CAAC,EAE3E,GAAIhD,EAAM,CACR,GAAM,CAAE,MAAA1B,EAAO,GAAAF,EAAI,MAAAI,EAAO,GAAAH,CAAE,EAAKwE,EAAiB0C,CAAM,EAClD,CAAE,EAAG7B,EAAK,EAAGiC,EAAG,EAAKF,EAAIrH,CAAE,EAC3B,CAAE,EAAGuF,GAAK,EAAGiC,EAAG,EAAKH,EAAIpH,CAAE,EACjCmH,EAAOG,GAAI,IAAIC,EAAG,EAClBtF,EAAQkD,EAAWxD,EAAK,KAAM0D,EAAKC,GAAKrF,EAAOE,CAAK,CACtD,KAAO,CACL,GAAM,CAAE,EAAAwE,EAAG,EAAA6C,CAAC,EAAKJ,EAAIF,CAAM,EAC3BjF,EAAQ0C,EACRwC,EAAOK,CACT,CAEA,OAAOH,GAAW9C,EAAO,CAACtC,EAAOkF,CAAI,CAAC,EAAE,CAAC,CAC3C,CAOA,eAAeM,EAAU,CACvB,GAAM,CAAE,KAAA9F,CAAI,EAAKT,EACXyD,EAAI,KACV,GAAI,CAACrD,EAAG,QAAQmG,CAAE,EAAG,MAAM,IAAI,MAAM,8BAA8B,EACnE,GAAIA,IAAOvH,IAAOyE,EAAE,IAAG,EAAI,OAAOJ,EAAM,KACxC,GAAIkD,IAAOlH,GAAK,OAAOoE,EACvB,GAAIkB,EAAK,SAAS,IAAI,EAAG,OAAO,KAAK,SAAS4B,CAAE,EAGhD,GAAI9F,EAAM,CACR,GAAM,CAAE,MAAA1B,EAAO,GAAAF,EAAI,MAAAI,EAAO,GAAAH,CAAE,EAAKwE,EAAiBiD,CAAE,EAC9C,CAAE,GAAAC,EAAI,GAAAC,CAAE,EAAKC,GAAcrD,EAAOI,EAAG5E,EAAIC,CAAE,EACjD,OAAOmF,EAAWxD,EAAK,KAAM+F,EAAIC,EAAI1H,EAAOE,CAAK,CACnD,KACE,QAAO0F,EAAK,OAAOlB,EAAG8C,CAAE,CAE5B,CAMA,SAASI,EAAa,CACpB,OAAOpD,EAAa,KAAMoD,CAAS,CACrC,CAMA,eAAa,CACX,GAAM,CAAE,cAAAC,CAAa,EAAK5G,EAC1B,OAAIM,IAAajB,GAAY,GACzBuH,EAAsBA,EAAcvD,EAAO,IAAI,EAC5CsB,EAAK,OAAO,KAAMpE,CAAW,EAAE,IAAG,CAC3C,CAEA,eAAa,CACX,GAAM,CAAE,cAAAsG,CAAa,EAAK7G,EAC1B,OAAIM,IAAajB,GAAY,KACzBwH,EAAsBA,EAAcxD,EAAO,IAAI,EAC5C,KAAK,eAAe/C,CAAQ,CACrC,CAEA,cAAY,CAEV,OAAO,KAAK,eAAeA,CAAQ,EAAE,IAAG,CAC1C,CAEA,QAAQU,EAAe,GAAI,CACzB,OAAAnB,GAAMmB,EAAc,cAAc,EAClC,KAAK,eAAc,EACZsB,EAAYe,EAAO,KAAMrC,CAAY,CAC9C,CAEA,MAAMA,EAAe,GAAI,CACvB,OAAO8F,GAAW,KAAK,QAAQ9F,CAAY,CAAC,CAC9C,CAEA,UAAQ,CACN,MAAO,UAAU,KAAK,IAAG,EAAK,OAAS,KAAK,MAAK,CAAE,GACrD,EAEF,IAAM+F,EAAO3G,EAAG,KACVuE,EAAO,IAAIqC,GAAK3D,EAAOrD,EAAU,KAAO,KAAK,KAAK+G,EAAO,CAAC,EAAIA,CAAI,EACxE,OAAA1D,EAAM,KAAK,WAAW,CAAC,EAChBA,CACT,CAqBA,SAAShC,GAAQF,EAAiB,CAChC,OAAO,WAAW,GAAGA,EAAW,EAAO,CAAI,CAC7C,CAWM,SAAU8F,GACd9G,EACA0D,EAAI,CAGJ,IAAMqD,EAAI/G,EAAG,MACTgH,EAAInI,GACR,QAASoI,EAAIF,EAAI7H,GAAK+H,EAAIC,KAAQrI,GAAKoI,GAAKC,GAAKF,GAAK9H,GACtD,IAAMX,EAAKyI,EAGLG,EAAeD,IAAQ3I,EAAKW,GAAMA,GAClCkI,EAAaD,EAAeD,GAC5BzI,GAAMsI,EAAI7H,IAAOkI,EACjBC,GAAM5I,EAAKS,IAAOgI,GAClBI,EAAKF,EAAalI,GAClBqI,EAAKJ,EACLK,EAAKxH,EAAG,IAAI0D,EAAGjF,CAAE,EACjBgJ,EAAKzH,EAAG,IAAI0D,GAAIjF,EAAKS,IAAOgI,EAAG,EACjCQ,EAAY,CAACC,EAAMC,IAAwC,CAC7D,IAAIC,EAAML,EACNM,EAAM9H,EAAG,IAAI4H,EAAGN,CAAE,EAClBS,EAAM/H,EAAG,IAAI8H,CAAG,EACpBC,EAAM/H,EAAG,IAAI+H,EAAKH,CAAC,EACnB,IAAII,EAAMhI,EAAG,IAAI2H,EAAGI,CAAG,EACvBC,EAAMhI,EAAG,IAAIgI,EAAKX,CAAE,EACpBW,EAAMhI,EAAG,IAAIgI,EAAKF,CAAG,EACrBA,EAAM9H,EAAG,IAAIgI,EAAKJ,CAAC,EACnBG,EAAM/H,EAAG,IAAIgI,EAAKL,CAAC,EACnB,IAAIM,EAAMjI,EAAG,IAAI+H,EAAKD,CAAG,EACzBE,EAAMhI,EAAG,IAAIiI,EAAKV,CAAE,EACpB,IAAIW,EAAOlI,EAAG,IAAIgI,EAAKhI,EAAG,GAAG,EAC7B8H,EAAM9H,EAAG,IAAI+H,EAAKN,CAAE,EACpBO,EAAMhI,EAAG,IAAIiI,EAAKJ,CAAG,EACrBE,EAAM/H,EAAG,KAAK8H,EAAKC,EAAKG,CAAI,EAC5BD,EAAMjI,EAAG,KAAKgI,EAAKC,EAAKC,CAAI,EAE5B,QAASC,EAAI5J,EAAI4J,EAAIjJ,GAAKiJ,IAAK,CAC7B,IAAIH,EAAMG,EAAIjB,GACdc,EAAMd,IAAQc,EAAM9I,GACpB,IAAIkJ,EAAOpI,EAAG,IAAIiI,EAAKD,CAAG,EACpBK,EAAKrI,EAAG,IAAIoI,EAAMpI,EAAG,GAAG,EAC9B8H,EAAM9H,EAAG,IAAI+H,EAAKF,CAAG,EACrBA,EAAM7H,EAAG,IAAI6H,EAAKA,CAAG,EACrBO,EAAOpI,EAAG,IAAIiI,EAAKJ,CAAG,EACtBE,EAAM/H,EAAG,KAAK8H,EAAKC,EAAKM,CAAE,EAC1BJ,EAAMjI,EAAG,KAAKoI,EAAMH,EAAKI,CAAE,CAC7B,CACA,MAAO,CAAE,QAASH,EAAM,MAAOH,CAAG,CACpC,EACA,GAAI/H,EAAG,MAAQ2C,KAAQD,GAAK,CAE1B,IAAMnE,GAAMyB,EAAG,MAAQ0C,IAAOC,GACxBlE,EAAKuB,EAAG,KAAKA,EAAG,IAAI0D,CAAC,CAAC,EAC5BgE,EAAY,CAACC,EAAM,IAAQ,CACzB,IAAIE,EAAM7H,EAAG,IAAI,CAAC,EACZ8H,EAAM9H,EAAG,IAAI2H,EAAG,CAAC,EACvBE,EAAM7H,EAAG,IAAI6H,EAAKC,CAAG,EACrB,IAAIQ,EAAKtI,EAAG,IAAI6H,EAAKtJ,CAAE,EACvB+J,EAAKtI,EAAG,IAAIsI,EAAIR,CAAG,EACnB,IAAMlG,EAAK5B,EAAG,IAAIsI,EAAI7J,CAAE,EAClBsJ,EAAM/H,EAAG,IAAIA,EAAG,IAAIsI,CAAE,EAAG,CAAC,EAC1BJ,EAAOlI,EAAG,IAAI+H,EAAKJ,CAAC,EACtB7G,EAAId,EAAG,KAAK4B,EAAI0G,EAAIJ,CAAI,EAC5B,MAAO,CAAE,QAASA,EAAM,MAAOpH,CAAC,CAClC,CACF,CAGA,OAAO4G,CACT,CAKM,SAAUa,GACdvI,EACAV,EAIC,CAEDkJ,GAAcxI,CAAE,EAChB,GAAM,CAAE,EAAAyI,EAAG,EAAAC,EAAG,EAAAhF,CAAC,EAAKpE,EACpB,GAAI,CAACU,EAAG,QAAQyI,CAAC,GAAK,CAACzI,EAAG,QAAQ0I,CAAC,GAAK,CAAC1I,EAAG,QAAQ0D,CAAC,EACnD,MAAM,IAAI,MAAM,mCAAmC,EACrD,IAAMgE,EAAYZ,GAAe9G,EAAI0D,CAAC,EACtC,GAAI,CAAC1D,EAAG,MAAO,MAAM,IAAI,MAAM,8BAA8B,EAG7D,OAAQ2H,GAAwB,CAE9B,IAAIE,EAAKC,EAAKC,EAAKE,EAAKD,EAAKW,EAAKhH,EAAGb,EACrC+G,EAAM7H,EAAG,IAAI2H,CAAC,EACdE,EAAM7H,EAAG,IAAI6H,EAAKnE,CAAC,EACnBoE,EAAM9H,EAAG,IAAI6H,CAAG,EAChBC,EAAM9H,EAAG,IAAI8H,EAAKD,CAAG,EACrBE,EAAM/H,EAAG,IAAI8H,EAAK9H,EAAG,GAAG,EACxB+H,EAAM/H,EAAG,IAAI+H,EAAKW,CAAC,EACnBT,EAAMjI,EAAG,KAAK0D,EAAG1D,EAAG,IAAI8H,CAAG,EAAG,CAAC9H,EAAG,IAAI8H,EAAK9H,EAAG,IAAI,CAAC,EACnDiI,EAAMjI,EAAG,IAAIiI,EAAKQ,CAAC,EACnBX,EAAM9H,EAAG,IAAI+H,CAAG,EAChBY,EAAM3I,EAAG,IAAIiI,CAAG,EAChBD,EAAMhI,EAAG,IAAI2I,EAAKF,CAAC,EACnBX,EAAM9H,EAAG,IAAI8H,EAAKE,CAAG,EACrBF,EAAM9H,EAAG,IAAI8H,EAAKC,CAAG,EACrBY,EAAM3I,EAAG,IAAI2I,EAAKV,CAAG,EACrBD,EAAMhI,EAAG,IAAI2I,EAAKD,CAAC,EACnBZ,EAAM9H,EAAG,IAAI8H,EAAKE,CAAG,EACrBrG,EAAI3B,EAAG,IAAI6H,EAAKE,CAAG,EACnB,GAAM,CAAE,QAAAa,EAAS,MAAAC,CAAK,EAAKnB,EAAUI,EAAKa,CAAG,EAC7C7H,EAAId,EAAG,IAAI6H,EAAKF,CAAC,EACjB7G,EAAId,EAAG,IAAIc,EAAG+H,CAAK,EACnBlH,EAAI3B,EAAG,KAAK2B,EAAGoG,EAAKa,CAAO,EAC3B9H,EAAId,EAAG,KAAKc,EAAG+H,EAAOD,CAAO,EAC7B,IAAMP,EAAKrI,EAAG,MAAO2H,CAAC,IAAM3H,EAAG,MAAOc,CAAC,EACvCA,EAAId,EAAG,KAAKA,EAAG,IAAIc,CAAC,EAAGA,EAAGuH,CAAE,EAC5B,IAAMS,EAAUC,GAAc/I,EAAI,CAACiI,CAAG,EAAG,EAAI,EAAE,CAAC,EAChD,OAAAtG,EAAI3B,EAAG,IAAI2B,EAAGmH,CAAO,EACd,CAAE,EAAAnH,EAAG,EAAAb,CAAC,CACf,CACF,CAEA,SAASN,GAAeR,EAAeC,EAAkB,CACvD,MAAO,CACL,UAAWA,EAAG,MACd,UAAW,EAAID,EAAG,MAClB,sBAAuB,EAAI,EAAIA,EAAG,MAClC,mBAAoB,GACpB,UAAW,EAAIC,EAAG,MAEtB,CAMM,SAAU+I,GACd9F,EACA+F,EAAmE,CAAA,EAAE,CAErE,GAAM,CAAE,GAAAhJ,CAAE,EAAKiD,EACTgG,EAAeD,EAAS,aAAeE,GACvC5I,EAAU,OAAO,OAAOC,GAAY0C,EAAM,GAAIjD,CAAE,EAAG,CAAE,KAAMmJ,GAAiBnJ,EAAG,KAAK,CAAC,CAAE,EAE7F,SAASoJ,EAAiBC,EAAqB,CAC7C,GAAI,CACF,IAAMC,EAAMtJ,EAAG,UAAUqJ,CAAS,EAClC,OAAOrJ,EAAG,YAAYsJ,CAAG,CAC3B,MAAgB,CACd,MAAO,EACT,CACF,CAEA,SAASC,EAAiBC,EAAuB5I,EAAsB,CACrE,GAAM,CAAE,UAAWS,EAAM,sBAAAoI,CAAqB,EAAKnJ,EACnD,GAAI,CACF,IAAMyG,EAAIyC,EAAU,OAEpB,OADI5I,IAAiB,IAAQmG,IAAM1F,GAC/BT,IAAiB,IAASmG,IAAM0C,EAA8B,GAC3D,CAAC,CAACxG,EAAM,UAAUuG,CAAS,CACpC,MAAgB,CACd,MAAO,EACT,CACF,CAMA,SAASE,EAAgBC,EAAOV,EAAa3I,EAAQ,IAAI,EAAC,CACxD,OAAOsJ,GAAexI,EAAOuI,EAAMrJ,EAAQ,KAAM,MAAM,EAAGN,EAAG,KAAK,CACpE,CAOA,SAAS6J,EAAaR,EAAuBzI,EAAe,GAAI,CAC9D,OAAOqC,EAAM,KAAK,SAASjD,EAAG,UAAUqJ,CAAS,CAAC,EAAE,QAAQzI,CAAY,CAC1E,CAKA,SAASkJ,EAAUC,EAAgB,CACjC,GAAM,CAAE,UAAAV,EAAW,UAAAG,EAAW,sBAAAC,CAAqB,EAAKnJ,EAExD,GADI,CAAC0J,GAAQD,CAAI,GACZ,aAAc/J,GAAMA,EAAG,UAAaqJ,IAAcG,EAAW,OAClE,IAAMzC,EAAI3F,EAAO2I,EAAM,OAAW,KAAK,EAAE,OACzC,OAAOhD,IAAMyC,GAAazC,IAAM0C,CAClC,CAUA,SAASQ,EACPC,EACAC,EACAvJ,EAAe,GAAI,CAEnB,GAAIkJ,EAAUI,CAAU,IAAM,GAAM,MAAM,IAAI,MAAM,+BAA+B,EACnF,GAAIJ,EAAUK,CAAU,IAAM,GAAO,MAAM,IAAI,MAAM,+BAA+B,EACpF,IAAMC,EAAIpK,EAAG,UAAUkK,CAAU,EAEjC,OADUjH,EAAM,UAAUkH,CAAU,EAC3B,SAASC,CAAC,EAAE,QAAQxJ,CAAY,CAC3C,CAEA,IAAMyJ,EAAQ,CACZ,iBAAAjB,EACA,iBAAAG,EACA,gBAAAG,GAEIY,EAASC,GAAab,EAAiBG,CAAY,EAEzD,OAAO,OAAO,OAAO,CAAE,aAAAA,EAAc,gBAAAI,EAAiB,OAAAK,EAAQ,MAAArH,EAAO,MAAAoH,EAAO,QAAA/J,CAAO,CAAE,CACvF,CAiBM,SAAUkK,GACdvH,EACAwH,EACAC,EAAuB,CAAA,EAAE,CAEzBC,GAAMF,CAAI,EACVrK,GACEsK,EACA,CAAA,EACA,CACE,KAAM,WACN,KAAM,UACN,YAAa,WACb,SAAU,WACV,cAAe,WAChB,EAEHA,EAAY,OAAO,OAAO,CAAA,EAAIA,CAAS,EACvC,IAAMxB,EAAcwB,EAAU,aAAexB,GACvC0B,EAAOF,EAAU,OAAS,CAACG,EAAKC,IAAQF,GAAUH,EAAMI,EAAKC,CAAG,GAEhE,CAAE,GAAA/K,EAAI,GAAAC,CAAE,EAAKiD,EACb,CAAE,MAAO9C,EAAa,KAAM4K,CAAM,EAAK/K,EACvC,CAAE,OAAAsK,EAAQ,aAAAT,EAAc,gBAAAI,EAAiB,MAAAI,EAAO,QAAA/J,CAAO,EAAKyI,GAAK9F,EAAOyH,CAAS,EACjFM,EAA0C,CAC9C,QAAS,GACT,KAAM,OAAON,EAAU,MAAS,UAAYA,EAAU,KAAO,GAC7D,OAAQ,UACR,aAAc,IAEVO,EAAmB9K,EAAc8G,GAAMlH,EAAG,MAEhD,SAASmL,EAAsBC,EAAc,CAC3C,IAAMC,EAAOjL,GAAelB,GAC5B,OAAOkM,EAASC,CAClB,CACA,SAASC,EAAWxI,EAAeyG,EAAW,CAC5C,GAAI,CAACtJ,EAAG,YAAYsJ,CAAG,EACrB,MAAM,IAAI,MAAM,qBAAqBzG,CAAK,kCAAkC,EAC9E,OAAOyG,CACT,CACA,SAASgC,GAAmB,CAS1B,GAAIL,EACF,MAAM,IAAI,MAAM,8DAA8D,CAClF,CACA,SAASM,EAAkBpK,EAAmBhC,EAA4B,CACxED,GAAkBC,CAAM,EACxB,IAAMqM,EAAOlL,EAAQ,UACfmL,EAAQtM,IAAW,UAAYqM,EAAOrM,IAAW,YAAcqM,EAAO,EAAI,OAChF,OAAOpK,EAAOD,EAAOsK,CAAK,CAC5B,CAKA,MAAMC,CAAS,CACJ,EACA,EACA,SAET,YAAYC,EAAWvB,EAAWwB,EAAiB,CAGjD,GAFA,KAAK,EAAIP,EAAW,IAAKM,CAAC,EAC1B,KAAK,EAAIN,EAAW,IAAKjB,CAAC,EACtBwB,GAAY,KAAM,CAEpB,GADAN,EAAmB,EACf,CAAC,CAAC,EAAG,EAAG,EAAG,CAAC,EAAE,SAASM,CAAQ,EAAG,MAAM,IAAI,MAAM,qBAAqB,EAC3E,KAAK,SAAWA,CAClB,CACA,OAAO,OAAO,IAAI,CACpB,CAEA,OAAO,UACLzK,EACAhC,EAA+B6L,EAAe,OAAM,CAEpDO,EAAkBpK,EAAOhC,CAAM,EAC/B,IAAI0M,EACJ,GAAI1M,IAAW,MAAO,CACpB,GAAM,CAAE,EAAAwM,EAAG,EAAAvB,CAAC,EAAK0B,GAAI,MAAM1K,EAAOD,CAAK,CAAC,EACxC,OAAO,IAAIuK,EAAUC,EAAGvB,CAAC,CAC3B,CACIjL,IAAW,cACb0M,EAAQ1K,EAAM,CAAC,EACfhC,EAAS,UACTgC,EAAQA,EAAM,SAAS,CAAC,GAE1B,IAAMa,EAAI1B,EAAQ,UAAa,EACzBqL,EAAIxK,EAAM,SAAS,EAAGa,CAAC,EACvBoI,EAAIjJ,EAAM,SAASa,EAAGA,EAAI,CAAC,EACjC,OAAO,IAAI0J,EAAU1L,EAAG,UAAU2L,CAAC,EAAG3L,EAAG,UAAUoK,CAAC,EAAGyB,CAAK,CAC9D,CAEA,OAAO,QAAQ1H,EAAahF,EAA6B,CACvD,OAAO,KAAK,UAAUiF,GAAWD,CAAG,EAAGhF,CAAM,CAC/C,CAEQ,gBAAc,CACpB,GAAM,CAAE,SAAAyM,CAAQ,EAAK,KACrB,GAAIA,GAAY,KAAM,MAAM,IAAI,MAAM,sCAAsC,EAC5E,OAAOA,CACT,CAEA,eAAeA,EAAgB,CAC7B,OAAO,IAAIF,EAAU,KAAK,EAAG,KAAK,EAAGE,CAAQ,CAC/C,CAEA,iBAAiBG,EAAuB,CACtC,GAAM,CAAE,EAAAJ,EAAG,EAAAvB,CAAC,EAAK,KACXwB,EAAW,KAAK,eAAc,EAC9BI,EAAOJ,IAAa,GAAKA,IAAa,EAAID,EAAIxL,EAAcwL,EAClE,GAAI,CAAC5L,EAAG,QAAQiM,CAAI,EAAG,MAAM,IAAI,MAAM,2CAA2C,EAClF,IAAMtK,EAAI3B,EAAG,QAAQiM,CAAI,EACnBC,EAAIhJ,EAAM,UAAUjC,GAAYC,IAAS2K,EAAW,KAAO,CAAC,EAAGlK,CAAC,CAAC,EACjEwK,EAAKlM,EAAG,IAAIgM,CAAI,EAChBG,GAAIC,EAAchL,EAAO2K,EAAa,OAAW,SAAS,CAAC,EAC3DM,GAAKrM,EAAG,OAAO,CAACmM,GAAID,CAAE,EACtBI,GAAKtM,EAAG,OAAOoK,EAAI8B,CAAE,EAErBK,GAAItJ,EAAM,KAAK,eAAeoJ,EAAE,EAAE,IAAIJ,EAAE,eAAeK,EAAE,CAAC,EAChE,GAAIC,GAAE,IAAG,EAAI,MAAM,IAAI,MAAM,qCAAqC,EAClE,OAAAA,GAAE,eAAc,EACTA,EACT,CAGA,UAAQ,CACN,OAAOrB,EAAsB,KAAK,CAAC,CACrC,CAEA,QAAQ/L,EAA+B6L,EAAe,OAAM,CAE1D,GADA9L,GAAkBC,CAAM,EACpBA,IAAW,MAAO,OAAOiF,GAAW0H,GAAI,WAAW,IAAI,CAAC,EAC5D,GAAM,CAAE,EAAAH,EAAG,EAAAvB,CAAC,EAAK,KACXoC,EAAKxM,EAAG,QAAQ2L,CAAC,EACjBc,EAAKzM,EAAG,QAAQoK,CAAC,EACvB,OAAIjL,IAAW,aACbmM,EAAmB,EACZtK,GAAY,WAAW,GAAG,KAAK,eAAc,CAAE,EAAGwL,EAAIC,CAAE,GAE1DzL,GAAYwL,EAAIC,CAAE,CAC3B,CAEA,MAAMtN,EAA6B,CACjC,OAAOuH,GAAW,KAAK,QAAQvH,CAAM,CAAC,CACxC,EAQF,IAAMuN,EACJhC,EAAU,UACV,SAAsBvJ,EAAiB,CAErC,GAAIA,EAAM,OAAS,KAAM,MAAM,IAAI,MAAM,oBAAoB,EAG7D,IAAMmI,EAAMqD,GAAgBxL,CAAK,EAC3ByL,EAAQzL,EAAM,OAAS,EAAI4J,EACjC,OAAO6B,EAAQ,EAAItD,GAAO,OAAOsD,CAAK,EAAItD,CAC5C,EACI8C,EACJ1B,EAAU,eACV,SAA2BvJ,EAAiB,CAC1C,OAAOnB,EAAG,OAAO0M,EAASvL,CAAK,CAAC,CAClC,EAEI0L,EAAa9N,GAAQgM,CAAM,EAEjC,SAAS+B,EAAWxD,EAAW,CAE7B,OAAAyD,GAAS,WAAahC,EAAQzB,EAAK1K,GAAKiO,CAAU,EAC3C7M,EAAG,QAAQsJ,CAAG,CACvB,CAEA,SAAS0D,EAAmBC,EAAqBC,EAAgB,CAC/D,OAAA9L,EAAO6L,EAAS,OAAW,SAAS,EAC7BC,EAAU9L,EAAOqJ,EAAKwC,CAAO,EAAG,OAAW,mBAAmB,EAAIA,CAC3E,CAUA,SAASE,EAAQF,EAAqB5D,EAAuBhK,EAAmB,CAC9E,GAAM,CAAE,KAAA+N,EAAM,QAAAF,EAAS,aAAAG,CAAY,EAAKjO,GAAgBC,EAAM2L,CAAc,EAC5EiC,EAAUD,EAAmBC,EAASC,CAAO,EAI7C,IAAMI,EAAQlB,EAAca,CAAO,EAC7BM,EAAIvN,EAAG,UAAUqJ,CAAS,EAChC,GAAI,CAACrJ,EAAG,YAAYuN,CAAC,EAAG,MAAM,IAAI,MAAM,qBAAqB,EAC7D,IAAMC,EAAW,CAACV,EAAWS,CAAC,EAAGT,EAAWQ,CAAK,CAAC,EAElD,GAAID,GAAgB,MAAQA,IAAiB,GAAO,CAGlD,IAAMI,GAAIJ,IAAiB,GAAOnE,EAAY5I,EAAQ,SAAS,EAAI+M,EACnEG,EAAS,KAAKpM,EAAOqM,GAAG,OAAW,cAAc,CAAC,CACpD,CACA,IAAM9D,GAAO3I,GAAY,GAAGwM,CAAQ,EAC9BE,GAAIJ,EASV,SAASK,GAAMC,GAAkB,CAG/B,IAAM7P,GAAI2O,EAASkB,EAAM,EACzB,GAAI,CAAC5N,EAAG,YAAYjC,EAAC,EAAG,OACxB,IAAM8P,GAAK7N,EAAG,IAAIjC,EAAC,EACb+I,GAAI7D,EAAM,KAAK,SAASlF,EAAC,EAAE,SAAQ,EACnC4N,GAAI3L,EAAG,OAAO8G,GAAE,CAAC,EACvB,GAAI6E,KAAM/M,GAAK,OACf,IAAMwL,GAAIpK,EAAG,OAAO6N,GAAK7N,EAAG,OAAO0N,GAAI/B,GAAI4B,CAAC,CAAC,EAC7C,GAAInD,KAAMxL,GAAK,OACf,IAAIgN,IAAY9E,GAAE,IAAM6E,GAAI,EAAI,GAAK,OAAO7E,GAAE,EAAI7H,EAAG,EACjD6O,GAAQ1D,GACZ,OAAIgD,GAAQlC,EAAsBd,EAAC,IACjC0D,GAAQ9N,EAAG,IAAIoK,EAAC,EAChBwB,IAAY,GAEP,IAAIF,EAAUC,GAAGmC,GAAO7C,EAAmB,OAAYW,EAAQ,CACxE,CACA,MAAO,CAAE,KAAAjC,GAAM,MAAAgE,EAAK,CACtB,CAaA,SAASI,EAAKd,EAAqB5D,EAAuBhK,EAAsB,CAAA,EAAE,CAChF,GAAM,CAAE,KAAAsK,EAAM,MAAAgE,CAAK,EAAKR,EAAQF,EAAS5D,EAAWhK,CAAI,EAGxD,OAFa2O,GAA0BvD,EAAK,UAAWzK,EAAG,MAAO4K,CAAI,EACpDjB,EAAMgE,CAAK,EACjB,QAAQtO,EAAK,MAAM,CAChC,CAeA,SAAS4O,EACPC,EACAjB,EACAzD,EACAnK,EAAwB,CAAA,EAAE,CAE1B,GAAM,CAAE,KAAA+N,EAAM,QAAAF,EAAS,OAAA/N,CAAM,EAAKC,GAAgBC,EAAM2L,CAAc,EAGtE,GAFAxB,EAAYpI,EAAOoI,EAAW,OAAW,WAAW,EACpDyD,EAAUD,EAAmBC,EAASC,CAAO,EACzC,CAAClD,GAAQkE,CAAgB,EAAG,CAC9B,IAAMC,EAAMD,aAAqBxC,EAAY,sBAAwB,GACrE,MAAM,IAAI,MAAM,sCAAwCyC,CAAG,CAC7D,CACA5C,EAAkB2C,EAAW/O,CAAM,EACnC,GAAI,CACF,IAAMiP,EAAM1C,EAAU,UAAUwC,EAAW/O,CAAM,EAC3C+E,EAAIjB,EAAM,UAAUuG,CAAS,EACnC,GAAI4D,GAAQgB,EAAI,SAAQ,EAAI,MAAO,GACnC,GAAM,CAAE,EAAAzC,GAAG,EAAAvB,EAAC,EAAKgE,EACXjC,GAAIC,EAAca,CAAO,EACzBoB,GAAKrO,EAAG,IAAIoK,EAAC,EACbiC,GAAKrM,EAAG,OAAOmM,GAAIkC,EAAE,EACrB/B,GAAKtM,EAAG,OAAO2L,GAAI0C,EAAE,EACrBpC,GAAIhJ,EAAM,KAAK,eAAeoJ,EAAE,EAAE,IAAInI,EAAE,eAAeoI,EAAE,CAAC,EAChE,OAAIL,GAAE,IAAG,EAAW,GACVjM,EAAG,OAAOiM,GAAE,CAAC,IACVN,EACf,MAAY,CACV,MAAO,EACT,CACF,CAEA,SAAS2C,EACPJ,EACAjB,EACA5N,EAAyB,CAAA,EAAE,CAE3B,GAAM,CAAE,QAAA6N,CAAO,EAAK9N,GAAgBC,EAAM2L,CAAc,EACxD,OAAAiC,EAAUD,EAAmBC,EAASC,CAAO,EACtCxB,EAAU,UAAUwC,EAAW,WAAW,EAAE,iBAAiBjB,CAAO,EAAE,QAAO,CACtF,CAEA,OAAO,OAAO,OAAO,CACnB,OAAA3C,EACA,aAAAT,EACA,gBAAAI,EACA,MAAAI,EACA,QAAA/J,EACA,MAAA2C,EACA,KAAA8K,EACA,OAAAE,EACA,iBAAAK,EACA,UAAA5C,EACA,KAAAjB,EACD,CACH,CAzhDA,IAoGMlM,GAoOOgQ,GAgCAzC,GAwFPlN,GAAiBK,GAAiBgI,GAAiBxE,GAAiBC,GAhc1E8L,GAAAC,GAAA,KA2BAC,KACAC,KACAA,KAmBAC,KAYAC,KAwCMtQ,GAAa,CAAC+K,EAAawF,KAAiBxF,GAAOA,GAAO,EAAIwF,EAAM,CAACA,GAAO7H,IAAO6H,EAoO5EP,GAAP,cAAsB,KAAK,CAC/B,YAAYb,EAAI,GAAE,CAChB,MAAMA,CAAC,CACT,GA6BW5B,GAAY,CAEvB,IAAKyC,GAEL,KAAM,CACJ,OAAQ,CAACQ,EAAaC,IAAwB,CAC5C,GAAM,CAAE,IAAKC,CAAC,EAAKnD,GACnB,GAAIiD,EAAM,GAAKA,EAAM,IAAK,MAAM,IAAIE,EAAE,uBAAuB,EAC7D,GAAID,EAAK,OAAS,EAAG,MAAM,IAAIC,EAAE,2BAA2B,EAC5D,IAAMC,EAAUF,EAAK,OAAS,EACxBG,EAAMC,GAAoBF,CAAO,EACvC,GAAKC,EAAI,OAAS,EAAK,IAAa,MAAM,IAAIF,EAAE,sCAAsC,EAEtF,IAAMI,EAASH,EAAU,IAAME,GAAqBD,EAAI,OAAS,EAAK,GAAW,EAAI,GAErF,OADUC,GAAoBL,CAAG,EACtBM,EAASF,EAAMH,CAC5B,EAEA,OAAOD,EAAaC,EAAgB,CAClC,GAAM,CAAE,IAAKC,CAAC,EAAKnD,GACfwD,EAAM,EACV,GAAIP,EAAM,GAAKA,EAAM,IAAK,MAAM,IAAIE,EAAE,uBAAuB,EAC7D,GAAID,EAAK,OAAS,GAAKA,EAAKM,GAAK,IAAMP,EAAK,MAAM,IAAIE,EAAE,uBAAuB,EAC/E,IAAMM,EAAQP,EAAKM,GAAK,EAClBE,EAAS,CAAC,EAAED,EAAQ,KACtBhO,EAAS,EACb,GAAI,CAACiO,EAAQjO,EAASgO,MACjB,CAEH,IAAMF,EAASE,EAAQ,IACvB,GAAI,CAACF,EAAQ,MAAM,IAAIJ,EAAE,mDAAmD,EAC5E,GAAII,EAAS,EAAG,MAAM,IAAIJ,EAAE,0CAA0C,EACtE,IAAMQ,EAAcT,EAAK,SAASM,EAAKA,EAAMD,CAAM,EACnD,GAAII,EAAY,SAAWJ,EAAQ,MAAM,IAAIJ,EAAE,uCAAuC,EACtF,GAAIQ,EAAY,CAAC,IAAM,EAAG,MAAM,IAAIR,EAAE,sCAAsC,EAC5E,QAAWhK,KAAKwK,EAAalO,EAAUA,GAAU,EAAK0D,EAEtD,GADAqK,GAAOD,EACH9N,EAAS,IAAK,MAAM,IAAI0N,EAAE,wCAAwC,CACxE,CACA,IAAMtH,EAAIqH,EAAK,SAASM,EAAKA,EAAM/N,CAAM,EACzC,GAAIoG,EAAE,SAAWpG,EAAQ,MAAM,IAAI0N,EAAE,gCAAgC,EACrE,MAAO,CAAE,EAAAtH,EAAG,EAAGqH,EAAK,SAASM,EAAM/N,CAAM,CAAC,CAC5C,GAMF,KAAM,CACJ,OAAO+H,EAAW,CAChB,GAAM,CAAE,IAAK2F,CAAC,EAAKnD,GACnB,GAAIxC,EAAM1K,GAAK,MAAM,IAAIqQ,EAAE,4CAA4C,EACvE,IAAI9K,EAAMiL,GAAoB9F,CAAG,EAGjC,GADI,OAAO,SAASnF,EAAI,CAAC,EAAG,EAAE,EAAI,IAAQA,EAAM,KAAOA,GACnDA,EAAI,OAAS,EAAG,MAAM,IAAI8K,EAAE,gDAAgD,EAChF,OAAO9K,CACT,EACA,OAAO6K,EAAgB,CACrB,GAAM,CAAE,IAAKC,CAAC,EAAKnD,GACnB,GAAIkD,EAAK,CAAC,EAAI,IAAa,MAAM,IAAIC,EAAE,qCAAqC,EAC5E,GAAID,EAAK,CAAC,IAAM,GAAQ,EAAEA,EAAK,CAAC,EAAI,KAClC,MAAM,IAAIC,EAAE,qDAAqD,EACnE,OAAOtC,GAAgBqC,CAAI,CAC7B,GAEF,MAAM7N,EAAiB,CAErB,GAAM,CAAE,IAAK8N,EAAG,KAAMS,EAAK,KAAMC,CAAG,EAAK7D,GACnCkD,EAAO5N,EAAOD,EAAO,OAAW,WAAW,EAC3C,CAAE,EAAGyO,EAAU,EAAGC,CAAY,EAAKF,EAAI,OAAO,GAAMX,CAAI,EAC9D,GAAIa,EAAa,OAAQ,MAAM,IAAIZ,EAAE,6CAA6C,EAClF,GAAM,CAAE,EAAGa,EAAQ,EAAGC,CAAU,EAAKJ,EAAI,OAAO,EAAMC,CAAQ,EACxD,CAAE,EAAGI,EAAQC,CAAa,EAAKN,EAAI,OAAO,EAAMI,CAAU,EAChE,GAAIE,EAAW,OAAQ,MAAM,IAAIhB,EAAE,6CAA6C,EAChF,MAAO,CAAE,EAAGS,EAAI,OAAOI,CAAM,EAAG,EAAGJ,EAAI,OAAOM,CAAM,CAAC,CACvD,EACA,WAAW5B,EAA6B,CACtC,GAAM,CAAE,KAAMuB,EAAK,KAAMD,CAAG,EAAK5D,GAC3BoE,EAAKP,EAAI,OAAO,EAAMD,EAAI,OAAOtB,EAAI,CAAC,CAAC,EACvC+B,EAAKR,EAAI,OAAO,EAAMD,EAAI,OAAOtB,EAAI,CAAC,CAAC,EACvCgC,EAAMF,EAAKC,EACjB,OAAOR,EAAI,OAAO,GAAMS,CAAG,CAC7B,GAKIxR,GAAM,OAAO,CAAC,EAAGK,GAAM,OAAO,CAAC,EAAGgI,GAAM,OAAO,CAAC,EAAGxE,GAAM,OAAO,CAAC,EAAGC,GAAM,OAAO,CAAC,IChcxF,IAAA2N,GAAA,GAAAC,GAAAD,GAAA,UAAAE,GAAA,gBAAAC,GAAA,cAAAC,GAAA,SAAAC,GAAA,gBAAAC,GAAA,cAAAC,GAAA,SAAAC,GAAA,gBAAAC,GAAA,cAAAC,KAmFA,SAASC,GAAUC,EAAqCC,EAAa,CACnE,IAAMC,EAAMC,GAAoBH,EAAM,GAAIC,CAAI,EAC9C,OAAQG,GAAsBF,EAAIE,EAAQ,CAAC,CAAC,CAC9C,CAtFA,IAqBMC,GAWAC,GAuBAC,GAkCAC,GAgBOlB,GAEAC,GAoBAC,GAUPiB,GAEOhB,GAEAC,GAoBAC,GAUPe,GACAC,GAEOf,GAEAC,GAoBAC,GApMbc,GAAAC,GAAA,KAMAC,KACAC,KACAC,KACAC,KACAC,KAWMb,GAA8D,CAClE,EAAG,OAAO,oEAAoE,EAC9E,EAAG,OAAO,oEAAoE,EAC9E,EAAG,OAAO,CAAC,EACX,EAAG,OAAO,oEAAoE,EAC9E,EAAG,OAAO,oEAAoE,EAC9E,GAAI,OAAO,oEAAoE,EAC/E,GAAI,OAAO,oEAAoE,GAI3EC,GAA8D,CAClE,EAAG,OACD,oGAAoG,EAEtG,EAAG,OACD,oGAAoG,EAEtG,EAAG,OAAO,CAAC,EACX,EAAG,OACD,oGAAoG,EAEtG,EAAG,OACD,oGAAoG,EAEtG,GAAI,OACF,oGAAoG,EAEtG,GAAI,OACF,oGAAoG,GAKlGC,GAA8D,CAClE,EAAG,OACD,uIAAuI,EAEzI,EAAG,OACD,wIAAwI,EAE1I,EAAG,OAAO,CAAC,EACX,EAAG,OACD,uIAAuI,EAEzI,EAAG,OACD,wIAAwI,EAE1I,GAAI,OACF,wIAAwI,EAE1I,GAAI,OACF,wIAAwI,GAgBtIC,GAA6BW,GAAYd,EAAU,EAgB5Cf,GAA8B8B,GAAMZ,GAAYa,EAAM,EAEtD9B,GACJ+B,GACLd,GACAT,GAAUS,GAAY,CACpB,EAAGH,GAAW,EACd,EAAGA,GAAW,EACd,EAAGG,GAAW,GAAG,OAAO,OAAO,KAAK,CAAC,EACtC,EACD,CACE,IAAK,4BACL,UAAW,4BACX,EAAGH,GAAW,EACd,EAAG,EACH,EAAG,IACH,OAAQ,MACR,KAAMgB,GACP,EAIQ7B,GACX+B,GAAW,CACT,KAAM,cACN,MAAOf,GACP,KAAMa,GACN,YAAa9B,GAAY,YACzB,aAAcA,GAAY,aAC3B,EAGGkB,GAA6BU,GAAYb,EAAU,EAE5Cb,GAA8B2B,GAAMX,GAAYe,EAAM,EAEtD9B,GACJ4B,GACLb,GACAV,GAAUU,GAAY,CACpB,EAAGH,GAAW,EACd,EAAGA,GAAW,EACd,EAAGG,GAAW,GAAG,OAAO,OAAO,KAAK,CAAC,EACtC,EACD,CACE,IAAK,4BACL,UAAW,4BACX,EAAGH,GAAW,EACd,EAAG,EACH,EAAG,IACH,OAAQ,MACR,KAAMkB,GACP,EAIQ7B,GACX4B,GAAW,CACT,KAAM,cACN,MAAOd,GACP,KAAMe,GACN,YAAa9B,GAAY,YACzB,aAAcA,GAAY,aAC3B,EAGGgB,GAA+Be,GAAMlB,GAAW,EAAG,CAAE,eAAgB,CAAC,GAAI,EAAE,CAAC,CAAE,EAC/EI,GAA6BQ,GAAYZ,GAAY,CAAE,GAAIG,EAAK,CAAE,EAE3Dd,GAA8BwB,GAAMT,GAAYe,EAAM,EAEtD7B,GACJyB,GACLX,GACAZ,GAAUY,GAAY,CACpB,EAAGJ,GAAW,EACd,EAAGA,GAAW,EACd,EAAGI,GAAW,GAAG,OAAO,OAAO,IAAI,CAAC,EACrC,EACD,CACE,IAAK,4BACL,UAAW,4BACX,EAAGJ,GAAW,EACd,EAAG,EACH,EAAG,IACH,OAAQ,MACR,KAAMmB,GACP,EAIQ5B,GACXyB,GAAW,CACT,KAAM,cACN,MAAOZ,GACP,KAAMe,GACN,YAAa7B,GAAY,YACzB,aAAcA,GAAY,aAC3B,IC3MH,IAAA8B,GAAc,WCCP,IAAMC,GAAN,KAAyB,CAG/BC,GAAmB,GAEnB,MAAM,MAAMC,EAAiB,CAC5B,KAAKD,GAAWC,CACjB,CAEA,MAAM,aAAgBC,EAAiC,CAEtD,GAAM,CAACC,EAAQC,CAAG,EAAI,MAAM,KAAK,aAAa,CAC7C,WAAY,GACZ,GAAM,GACN,KAAQ,SACR,MAAS,KAAKJ,GACd,OAAUE,CACX,CAAC,EAED,MAAO,CAAIC,EAAQC,CAAG,CACvB,CAEA,MAAM,aAAaC,EAAmC,CAErD,GAAM,CAACC,EAASF,CAAG,EAAI,MAAM,KAAK,aAAa,CAC9C,WAAY,GACZ,GAAM,GACN,KAAQ,SACR,MAAS,KAAKJ,GACd,OAAUK,CACX,CAAC,EAED,OAAOD,CACR,CAEA,MAAM,aAAgBG,EAAwC,CAE7D,GAAI,CAWH,MAAO,CAFc,MANN,MAAM,MAAM,8BAA+B,CACzD,OAAQ,OACR,KAAM,KAAK,UAAUA,CAAQ,EAC7B,YAAa,SACd,CAAC,GAEiC,KAAK,EAEjB,EAAE,CAEzB,OAASH,EAAK,CACb,MAAO,CAAI,CAAC,EAAG,OAAOA,CAAG,CAAC,CAC3B,CACD,CACD,ECvDA,IAAMI,GAAgB,CAACC,EAAQC,IAAiBA,EAAa,KAAMC,GAAMF,aAAkBE,CAAC,EAExFC,GACAC,GAEJ,SAASC,IAAuB,CAC5B,OAAQF,KACHA,GAAoB,CACjB,YACA,eACA,SACA,UACA,cACJ,EACR,CAEA,SAASG,IAA0B,CAC/B,OAAQF,KACHA,GAAuB,CACpB,UAAU,UAAU,QACpB,UAAU,UAAU,SACpB,UAAU,UAAU,kBACxB,EACR,CACA,IAAMG,GAAqB,IAAI,QACzBC,GAAiB,IAAI,QACrBC,GAAwB,IAAI,QAClC,SAASC,GAAiBC,EAAS,CAC/B,IAAMC,EAAU,IAAI,QAAQ,CAACC,EAASC,IAAW,CAC7C,IAAMC,EAAW,IAAM,CACnBJ,EAAQ,oBAAoB,UAAWK,CAAO,EAC9CL,EAAQ,oBAAoB,QAASM,CAAK,CAC9C,EACMD,EAAU,IAAM,CAClBH,EAAQK,GAAKP,EAAQ,MAAM,CAAC,EAC5BI,EAAS,CACb,EACME,EAAQ,IAAM,CAChBH,EAAOH,EAAQ,KAAK,EACpBI,EAAS,CACb,EACAJ,EAAQ,iBAAiB,UAAWK,CAAO,EAC3CL,EAAQ,iBAAiB,QAASM,CAAK,CAC3C,CAAC,EAGD,OAAAR,GAAsB,IAAIG,EAASD,CAAO,EACnCC,CACX,CACA,SAASO,GAA+BC,EAAI,CAExC,GAAIb,GAAmB,IAAIa,CAAE,EACzB,OACJ,IAAMC,EAAO,IAAI,QAAQ,CAACR,EAASC,IAAW,CAC1C,IAAMC,EAAW,IAAM,CACnBK,EAAG,oBAAoB,WAAYE,CAAQ,EAC3CF,EAAG,oBAAoB,QAASH,CAAK,EACrCG,EAAG,oBAAoB,QAASH,CAAK,CACzC,EACMK,EAAW,IAAM,CACnBT,EAAQ,EACRE,EAAS,CACb,EACME,EAAQ,IAAM,CAChBH,EAAOM,EAAG,OAAS,IAAI,aAAa,aAAc,YAAY,CAAC,EAC/DL,EAAS,CACb,EACAK,EAAG,iBAAiB,WAAYE,CAAQ,EACxCF,EAAG,iBAAiB,QAASH,CAAK,EAClCG,EAAG,iBAAiB,QAASH,CAAK,CACtC,CAAC,EAEDV,GAAmB,IAAIa,EAAIC,CAAI,CACnC,CACA,IAAIE,GAAgB,CAChB,IAAIC,EAAQC,EAAMC,EAAU,CACxB,GAAIF,aAAkB,eAAgB,CAElC,GAAIC,IAAS,OACT,OAAOlB,GAAmB,IAAIiB,CAAM,EAExC,GAAIC,IAAS,QACT,OAAOC,EAAS,iBAAiB,CAAC,EAC5B,OACAA,EAAS,YAAYA,EAAS,iBAAiB,CAAC,CAAC,CAE/D,CAEA,OAAOR,GAAKM,EAAOC,CAAI,CAAC,CAC5B,EACA,IAAID,EAAQC,EAAME,EAAO,CACrB,OAAAH,EAAOC,CAAI,EAAIE,EACR,EACX,EACA,IAAIH,EAAQC,EAAM,CACd,OAAID,aAAkB,iBACjBC,IAAS,QAAUA,IAAS,SACtB,GAEJA,KAAQD,CACnB,CACJ,EACA,SAASI,GAAaC,EAAU,CAC5BN,GAAgBM,EAASN,EAAa,CAC1C,CACA,SAASO,GAAaC,EAAM,CAQxB,OAAIzB,GAAwB,EAAE,SAASyB,CAAI,EAChC,YAAaC,EAAM,CAGtB,OAAAD,EAAK,MAAME,GAAO,IAAI,EAAGD,CAAI,EACtBd,GAAK,KAAK,OAAO,CAC5B,EAEG,YAAac,EAAM,CAGtB,OAAOd,GAAKa,EAAK,MAAME,GAAO,IAAI,EAAGD,CAAI,CAAC,CAC9C,CACJ,CACA,SAASE,GAAuBP,EAAO,CACnC,OAAI,OAAOA,GAAU,WACVG,GAAaH,CAAK,GAGzBA,aAAiB,gBACjBR,GAA+BQ,CAAK,EACpC5B,GAAc4B,EAAOtB,GAAqB,CAAC,EACpC,IAAI,MAAMsB,EAAOJ,EAAa,EAElCI,EACX,CACA,SAAST,GAAKS,EAAO,CAGjB,GAAIA,aAAiB,WACjB,OAAOjB,GAAiBiB,CAAK,EAGjC,GAAInB,GAAe,IAAImB,CAAK,EACxB,OAAOnB,GAAe,IAAImB,CAAK,EACnC,IAAMQ,EAAWD,GAAuBP,CAAK,EAG7C,OAAIQ,IAAaR,IACbnB,GAAe,IAAImB,EAAOQ,CAAQ,EAClC1B,GAAsB,IAAI0B,EAAUR,CAAK,GAEtCQ,CACX,CACA,IAAMF,GAAUN,GAAUlB,GAAsB,IAAIkB,CAAK,EASzD,SAASS,GAAOC,EAAMC,EAAS,CAAE,QAAAC,EAAS,QAAAC,EAAS,SAAAC,EAAU,WAAAC,CAAW,EAAI,CAAC,EAAG,CAC5E,IAAM/B,EAAU,UAAU,KAAK0B,EAAMC,CAAO,EACtCK,EAAczB,GAAKP,CAAO,EAChC,OAAI6B,GACA7B,EAAQ,iBAAiB,gBAAkBiC,GAAU,CACjDJ,EAAQtB,GAAKP,EAAQ,MAAM,EAAGiC,EAAM,WAAYA,EAAM,WAAY1B,GAAKP,EAAQ,WAAW,EAAGiC,CAAK,CACtG,CAAC,EAEDL,GACA5B,EAAQ,iBAAiB,UAAYiC,GAAUL,EAE/CK,EAAM,WAAYA,EAAM,WAAYA,CAAK,CAAC,EAE9CD,EACK,KAAME,GAAO,CACVH,GACAG,EAAG,iBAAiB,QAAS,IAAMH,EAAW,CAAC,EAC/CD,GACAI,EAAG,iBAAiB,gBAAkBD,GAAUH,EAASG,EAAM,WAAYA,EAAM,WAAYA,CAAK,CAAC,CAE3G,CAAC,EACI,MAAM,IAAM,CAAE,CAAC,EACbD,CACX,CAgBA,IAAMG,GAAc,CAAC,MAAO,SAAU,SAAU,aAAc,OAAO,EAC/DC,GAAe,CAAC,MAAO,MAAO,SAAU,OAAO,EAC/CC,GAAgB,IAAI,IAC1B,SAASC,GAAUC,EAAQC,EAAM,CAC7B,GAAI,EAAED,aAAkB,aACpB,EAAEC,KAAQD,IACV,OAAOC,GAAS,UAChB,OAEJ,GAAIH,GAAc,IAAIG,CAAI,EACtB,OAAOH,GAAc,IAAIG,CAAI,EACjC,IAAMC,EAAiBD,EAAK,QAAQ,aAAc,EAAE,EAC9CE,EAAWF,IAASC,EACpBE,EAAUP,GAAa,SAASK,CAAc,EACpD,GAEA,EAAEA,KAAmBC,EAAW,SAAW,gBAAgB,YACvD,EAAEC,GAAWR,GAAY,SAASM,CAAc,GAChD,OAEJ,IAAMG,EAAS,eAAgBC,KAAcC,EAAM,CAE/C,IAAMC,EAAK,KAAK,YAAYF,EAAWF,EAAU,YAAc,UAAU,EACrEJ,EAASQ,EAAG,MAChB,OAAIL,IACAH,EAASA,EAAO,MAAMO,EAAK,MAAM,CAAC,IAM9B,MAAM,QAAQ,IAAI,CACtBP,EAAOE,CAAc,EAAE,GAAGK,CAAI,EAC9BH,GAAWI,EAAG,IAClB,CAAC,GAAG,CAAC,CACT,EACA,OAAAV,GAAc,IAAIG,EAAMI,CAAM,EACvBA,CACX,CACAI,GAAcC,IAAc,CACxB,GAAGA,EACH,IAAK,CAACV,EAAQC,EAAMU,IAAaZ,GAAUC,EAAQC,CAAI,GAAKS,EAAS,IAAIV,EAAQC,EAAMU,CAAQ,EAC/F,IAAK,CAACX,EAAQC,IAAS,CAAC,CAACF,GAAUC,EAAQC,CAAI,GAAKS,EAAS,IAAIV,EAAQC,CAAI,CACjF,EAAE,EAEF,IAAMW,GAAqB,CAAC,WAAY,qBAAsB,SAAS,EACjEC,GAAY,CAAC,EACbC,GAAiB,IAAI,QACrBC,GAAmC,IAAI,QACvCC,GAAsB,CACxB,IAAIhB,EAAQC,EAAM,CACd,GAAI,CAACW,GAAmB,SAASX,CAAI,EACjC,OAAOD,EAAOC,CAAI,EACtB,IAAIgB,EAAaJ,GAAUZ,CAAI,EAC/B,OAAKgB,IACDA,EAAaJ,GAAUZ,CAAI,EAAI,YAAaM,EAAM,CAC9CO,GAAe,IAAI,KAAMC,GAAiC,IAAI,IAAI,EAAEd,CAAI,EAAE,GAAGM,CAAI,CAAC,CACtF,GAEGU,CACX,CACJ,EACA,eAAgBC,MAAWX,EAAM,CAE7B,IAAIY,EAAS,KAIb,GAHMA,aAAkB,YACpBA,EAAS,MAAMA,EAAO,WAAW,GAAGZ,CAAI,GAExC,CAACY,EACD,OACJA,EAASA,EACT,IAAMC,EAAgB,IAAI,MAAMD,EAAQH,EAAmB,EAI3D,IAHAD,GAAiC,IAAIK,EAAeD,CAAM,EAE1DE,GAAsB,IAAID,EAAeE,GAAOH,CAAM,CAAC,EAChDA,GACH,MAAMC,EAEND,EAAS,MAAOL,GAAe,IAAIM,CAAa,GAAKD,EAAO,SAAS,GACrEL,GAAe,OAAOM,CAAa,CAE3C,CACA,SAASG,GAAevB,EAAQC,EAAM,CAClC,OAASA,IAAS,OAAO,eACrBuB,GAAcxB,EAAQ,CAAC,SAAU,eAAgB,SAAS,CAAC,GAC1DC,IAAS,WAAauB,GAAcxB,EAAQ,CAAC,SAAU,cAAc,CAAC,CAC/E,CACAS,GAAcC,IAAc,CACxB,GAAGA,EACH,IAAIV,EAAQC,EAAMU,EAAU,CACxB,OAAIY,GAAevB,EAAQC,CAAI,EACpBiB,GACJR,EAAS,IAAIV,EAAQC,EAAMU,CAAQ,CAC9C,EACA,IAAIX,EAAQC,EAAM,CACd,OAAOsB,GAAevB,EAAQC,CAAI,GAAKS,EAAS,IAAIV,EAAQC,CAAI,CACpE,CACJ,EAAE,EC1RK,SAASwB,GAAgBC,EAAgBC,EAAwC,CACvF,MAAO,CACN,GAAG,GAEH,KAAM,aACN,GAAI,YACJ,aAAcD,EACd,UAAW,cACX,SAAU,SACV,QAAS,GACT,UAAW,eACX,QAAS,KAAKC,EAAc,UAAU,SAAS,CAAC,CACjD,CACD,CC7BM,SAAUC,EAAUC,EAAqB,CAC7C,OAAQ,GAAQ,CACd,GAAM,CAACC,EAAKC,CAAK,EAAIF,EAAI,CAAC,EACpBG,EAAM,IAAI,YAAYF,CAAG,EAC/B,OAAAC,EAAM,EAAGC,CAAG,EACL,IAAI,WAAWA,CAAG,CAC3B,CACF,CAiBM,SAAUC,GAA6BC,EAAuBC,EAAwB,CAC1F,OAAQC,GAASF,EAAIC,EAAEC,CAAC,CAAC,CAC3B,CAEM,SAAUC,EACdC,EACAC,EAAwB,CAExB,OAAQC,GAAY,CAClB,IAAMC,EAASF,EAAQC,CAAK,EACxBE,EAAc,EACdC,EAAa,CAACC,EAAiBC,IAAwB,CAAE,EAC7D,QAASC,EAAI,EAAGA,EAAIR,EAAS,OAAQQ,IAAK,CACxC,GAAM,CAACC,EAAKC,CAAK,EAAIV,EAASQ,CAAC,EAAGL,EAAOK,CAAC,CAAC,EACrCG,EAAUN,EACVO,EAAaR,EACnBC,EAAa,CAACQ,EAAgBC,IAAuB,CACnDH,EAAQE,EAAQC,CAAM,EACtBJ,EAAMG,EAASD,EAAYE,CAAM,CACnC,EACAV,GAAeK,CACjB,CACA,MAAO,CAACL,EAAaC,CAAU,CACjC,CACF,CAEM,SAAUU,GAA2Cf,EAE1D,CACC,OAAQG,GAAcJ,EAAwBC,EAAWgB,GAAMA,CAAM,EAAEb,CAAM,CAC/E,CAEO,IAAMc,GAAmE,CAAC,EAAG,IAAK,CAAE,CAAC,ECzDrF,IAAMC,GAAuCC,GAAM,CACxD,EACA,CAACC,EAAQC,IAAU,CACJ,IAAI,SAASA,CAAM,EAC3B,SAASD,EAAQD,CAAC,CACzB,GAGWG,GAA+BC,EAAOL,EAAY,EAElDM,GAA+B,CAACC,EAAGL,IAAU,CACxD,IAAMM,EAAQD,EAAE,GAAGL,CAAM,EACzB,OAAOM,IAAU,OAAY,CAACA,EAAO,CAAC,EAAI,MAC5C,EAEaC,GAAwCR,GAAM,CACzD,EACA,CAACC,EAAQC,IAAU,CACJ,IAAI,SAASA,CAAM,EAC3B,UAAUD,EAAQD,CAAC,CAC1B,GAGWS,GAAgCL,EAAOI,EAAa,EAEpDE,GAAgC,CAACJ,EAAGL,IAAU,CACzD,IAAMU,EAAO,IAAI,SAASL,EAAE,OAAQA,EAAE,WAAYA,EAAE,UAAU,EAC9D,GAAI,CACF,MAAO,CAACK,EAAK,UAAUV,CAAM,EAAG,CAAC,CACnC,MAAY,CACV,MACF,CACF,EAEaW,GAAwCZ,GAAM,CACzD,EACA,CAACC,EAAQC,IAAU,CACJ,IAAI,SAASA,CAAM,EAC3B,UAAUD,EAAQD,CAAC,CAC1B,GAGWa,GAAgCT,EAAOQ,EAAa,EAEpDE,GAAgC,CAACR,EAAGL,IAAU,CACzD,IAAMU,EAAO,IAAI,SAASL,EAAE,OAAQA,EAAE,WAAYA,EAAE,UAAU,EAC9D,GAAI,CACF,MAAO,CAACK,EAAK,UAAUV,CAAM,EAAG,CAAC,CACnC,MAAY,CACV,MACF,CACF,EAEac,GAAwCf,GAAM,CACzD,EACA,CAACC,EAAQC,IAAU,CACJ,IAAI,SAASA,CAAM,EAC3B,aAAaD,EAAQD,CAAC,CAC7B,GAGWgB,GAAgCZ,EAAOW,EAAa,EAEpDE,GAAgC,CAACX,EAAGL,IAAU,CACzD,IAAMU,EAAO,IAAI,SAASL,EAAE,OAAQA,EAAE,WAAYA,EAAE,UAAU,EAC9D,GAAI,CACF,MAAO,CAACK,EAAK,aAAaV,CAAM,EAAG,CAAC,CACtC,MAAY,CACV,MACF,CACF,ECvEM,SAAUiB,GAAiBC,EAAiBC,EAAc,CAC9D,MAAO,CAACC,EAAGC,IAAU,CACnB,IAAMC,EAAIJ,EAAIE,EAAGC,CAAM,EACvB,GAAIC,IAAM,OAAW,CACnB,GAAM,CAACC,EAAGC,CAAC,EAAIF,EACf,MAAO,CAACH,EAAEI,CAAC,EAAGC,CAAC,CACjB,CACF,CACF,CAEM,SAAUC,GACdC,EACAP,EAAgC,CAEhC,MAAO,CAACC,EAAGC,IAAU,CACnB,IAAMM,EAAUC,EAAYF,EAAUP,CAAC,EAAEC,EAAGC,CAAM,EAClD,GAAIM,IAAY,OACX,CACH,GAAM,CAACE,EAAGC,CAAG,EAAIH,EACjB,OAAOE,IAAM,OAAY,CAACA,EAAGC,CAAG,EAAI,MACtC,CACF,CACF,CAEM,SAAUF,EACdF,EACAP,EAAoB,CAEpB,MAAO,CAACC,EAAGC,IAAU,CACnB,IAAMU,EAASL,EAAS,OAQtB,CAACM,EAAKC,IAAW,CACf,GAAI,CAACD,EAAK,OAEV,IAAME,EAAUD,EAAQb,EAAGY,EAAI,MAAM,EACrC,GAAI,CAACE,EAAS,OAEd,GAAM,CAACC,EAAOC,CAAM,EAAIF,EACxB,MAAO,CACL,OAAQ,CAAC,GAAGF,EAAI,OAAQG,CAAK,EAC7B,OAAQH,EAAI,OAASI,EACrB,YAAaJ,EAAI,YAAcI,EAEnC,EACA,CAAE,OAAQ,CAAA,EAAI,OAAAf,EAAQ,YAAa,CAAC,CAAE,EAGxC,GAAKU,EACL,MAAO,CAACZ,EAAE,GAAIY,EAAO,MAAY,EAAGA,EAAO,WAAW,CACxD,CACF,CAEM,SAAUM,GAAuBnB,EAAiBC,EAA0B,CAChF,MAAO,CAACC,EAAGC,IAAU,CACnB,IAAMC,EAAIJ,EAAIE,EAAGC,CAAM,EACvB,GAAIC,IAAM,OAAW,CACnB,GAAM,CAACC,EAAGC,CAAC,EAAIF,EACTgB,EAAInB,EAAEI,CAAC,EACb,OAAOe,IAAM,OAAY,CAACA,EAAGd,CAAC,EAAI,MACpC,CACF,CACF,CAEM,SAAUe,GAAqBrB,EAAiBC,EAAuB,CAC3E,OAAOqB,GAAqBtB,EAAKC,EAAG,CAACsB,EAAIH,IAAMA,CAAC,CAClD,CAEM,SAAUI,GAAgBC,EAAkBC,EAAgB,CAChE,MAAO,CAACxB,EAAGC,IAAU,CACnB,IAAME,EAAIoB,EAAKvB,EAAGC,CAAM,EACxB,OAAOE,GAAQqB,EAAKxB,EAAGC,CAAM,CAC/B,CACF,CAEM,SAAUmB,GACdtB,EACAC,EACA0B,EAAoB,CAEpB,MAAO,CAACzB,EAAGC,IAAU,CACnB,IAAMyB,EAAW5B,EAAIE,EAAGC,CAAM,EAC9B,GAAIyB,IAAa,OAAW,CAC1B,GAAM,CAACvB,EAAGO,CAAG,EAAIgB,EAEXC,EADW5B,EAAEI,CAAC,EACMH,EAAGC,EAASS,CAAG,EACzC,GAAIiB,IAAa,OAAW,CAC1B,GAAM,CAACT,EAAGU,CAAI,EAAID,EAClB,MAAO,CAACF,EAAEtB,EAAGe,CAAC,EAAGR,EAAMkB,CAAI,CAC7B,CACF,CACF,CACF,CAEM,SAAUC,GAAkB1B,EAAI,CACpC,MAAO,IAAM,CAACA,EAAG,CAAC,CACpB,CCvGM,SAAU2B,GAAkCC,EAAoB,CACpE,OAAQC,GAAO,OAAO,OAAOD,CAAC,EAAE,SAASC,CAAC,EAAKC,GAAWF,CAAC,EAAEC,CAAC,EAAU,MAC1E,CAEM,SAAUC,GAA6CC,EAAM,CACjE,OAAO,OAAO,QAAQA,CAAG,EAAE,OACzB,CAACC,EAAK,CAACC,EAAKC,CAAK,KAAO,CACtB,GAAGF,EACH,CAACE,CAAK,EAAGD,IAEX,CAAA,CAAE,CAEN,CACM,SAAUE,GAAsCC,EAAsB,CAC1E,OAAQP,GAAK,CACX,IAAMQ,EAAUV,GAAgBS,CAAG,EAAEP,CAAC,EACtC,OAAIQ,IAAY,OAAkBR,EAAE,SAAQ,EAChCQ,CACd,CACF,CAEM,SAAUC,GAAwCF,EAAsB,CAC5E,OAAQG,GAAK,CACX,IAAMC,EAAIJ,EAAIG,CAAC,EACf,OAAIC,IAAM,OAAkB,OAAOD,CAAC,EACxBC,CACd,CACF,CCtBO,IAAMC,GAAuB,CAClC,IAAK,EACL,OAAQ,EACR,OAAQ,EACR,IAAK,EACL,OAAQ,EACR,cAAe,EACf,yBAA0B,GAMfC,GAAqEC,GAChFC,GACCC,GAAMJ,GAAqBI,CAAC,CAAC,EAGnBC,GAA8DC,EAAOL,EAA0B,EAE/FM,GAA8DC,GACzEC,GACAC,GAAgBV,EAAoB,CAAC,ECtBhC,IAAMW,GAAwB,CACnC,eAAgB,EAChB,aAAc,EACd,sBAAuB,EACvB,aAAc,EACd,iBAAkB,GAMPC,GAAuEC,GAClFC,GACCC,GAAMJ,GAAsBI,CAAC,CAAC,EAGpBC,GAAgEC,EAAOL,EAA2B,EAElGM,GAAgEC,GAC3EC,GACAC,GAAgBV,EAAqB,CAAC,ECzBlC,IAAOW,GAAP,cAAwB,KAAK,CACjC,YAAYC,EAAe,CACzB,MAAMA,CAAO,EACb,KAAK,KAAO,UACd,GAUI,IAAOC,GAAP,cAA0BC,EAAQ,CACtC,YAAYC,EAAe,CACzB,MAAMA,CAAO,EACb,KAAK,KAAO,YACd,GAUI,IAAOC,GAAP,cAA+BC,EAAQ,CAC3C,YAAYC,EAAe,CACzB,MAAMA,CAAO,EACb,KAAK,KAAO,iBACd,GAUI,IAAOC,GAAP,cAA2BC,EAAQ,CACvC,YAAYC,EAAe,CACzB,MAAMA,CAAO,EACb,KAAK,KAAO,aACd,GAGWC,GAAP,cAA6BF,EAAQ,CACzC,YAAYC,EAAe,CACzB,MAAM,uFAAuFA,CAAO,EAAE,EACtG,KAAK,KAAO,eACd,GCjDK,IAAME,EAAgDC,GAAQ,CACnE,GAAM,CAACC,EAAKC,CAAK,EAAIC,GAAcH,EAAK,MAAM,EAE9C,MAAO,CACLC,EAAMD,EAAK,OACX,CAACI,EAAQC,IAAU,CACjBH,EAAME,EAAQC,CAAM,EACP,IAAI,WAAWA,CAAM,EAC7B,IAAIL,EAAMI,EAASH,CAAG,CAC7B,EAEJ,EAEM,SAAUE,GAAcF,EAAW,CACvC,GAAIA,EAAM,GACR,MAAO,CACL,EACA,CAACG,EAAQC,IAAU,CAEJ,IAAI,SAASA,CAAM,EAC3B,SAASD,EAAQH,EAAM,EAAU,CACxC,GAEG,GAAIA,EAAM,MACf,MAAO,CACL,EACA,CAACG,EAAQC,IAAU,CAEjB,IAAMC,EAAO,IAAI,SAASD,CAAM,EAChCC,EAAK,SAASF,EAAUH,GAAO,EAAK,GAAc,EAAU,EAC5DK,EAAK,SAASF,EAAS,EAAGH,EAAM,GAAI,CACtC,GAEG,GAAIA,EAAM,WACf,MAAO,CACL,EACA,CAACG,EAAQC,IAAU,CAEjB,IAAMC,EAAO,IAAI,SAASD,CAAM,EAChCC,EAAK,SAASF,EAAUH,GAAO,GAAM,GAAc,GAAU,EAC7DK,EAAK,SAASF,EAAS,EAAIH,GAAO,GAAM,GAAI,EAC5CK,EAAK,SAASF,EAAS,EAAIH,GAAO,EAAK,GAAI,EAC3CK,EAAK,SAASF,EAAS,EAAGH,EAAM,GAAI,CACtC,GAGF,MAAM,IAAIM,GAAW,8CAA8C,CAEvE,CAEM,SAAUC,GAAgBR,EAAkBI,EAAiB,EAAC,CAClE,GAAIA,GAAUJ,EAAK,OACjB,MAAM,IAAIO,GAAW,sBAAsB,EAG7C,IAAME,EAAYT,EAAKI,CAAM,EACvBM,EAASD,GAAa,EAE5B,GAAIC,IAAW,EACb,MAAO,CAAE,OAAQD,EAAY,GAAY,gBAAiB,CAAC,EACtD,GAAIC,IAAW,EAAG,CACvB,GAAIN,EAAS,EAAIJ,EAAK,OAAQ,MAAM,IAAIO,GAAW,0BAA0B,EAC7E,MAAO,CAAE,QAAUE,EAAY,KAAe,EAAMT,EAAKI,EAAS,CAAC,EAAc,gBAAiB,CAAC,CACrG,SAAWM,IAAW,EAAG,CACvB,GAAIN,EAAS,EAAIJ,EAAK,OAAQ,MAAM,IAAIO,GAAW,0BAA0B,EAC7E,MAAO,CACL,QACIE,EAAY,KAAe,GAC3BT,EAAKI,EAAS,CAAC,GAAgB,GAC/BJ,EAAKI,EAAS,CAAC,GAAgB,EAChCJ,EAAKI,EAAS,CAAC,EAClB,gBAAiB,EAErB,KACE,OAAM,IAAIG,GAAW,oDAAoD,CAE7E,CAEO,IAAMI,EAAwC,CAACC,EAAKR,IAAU,CACnE,GAAIA,GAAUQ,EAAI,OAChB,MAAM,IAAIL,GAAW,sBAAsB,EAG7C,GAAM,CAAE,OAAAM,EAAQ,gBAAAC,CAAe,EAAKN,GAAgBI,EAAKR,CAAM,EAEzDW,EAAaD,EAAkBD,EACrC,GAAIT,EAASW,EAAaH,EAAI,OAC5B,MAAM,IAAIL,GAAW,4BAA4B,EAInD,MAAO,CADMK,EAAI,SAASR,EAASU,EAAiBV,EAASW,CAAU,EACzDA,CAAU,CAC1B,EAEM,SAAUC,GAAqBC,EAAqB,CACxD,OAAQjB,GAAQ,CACd,IAAIkB,EAAc,EACdC,EAAa,CAACC,EAAiBC,IAAwB,CAAE,EAC7D,QAASC,EAAI,EAAGA,EAAItB,EAAK,OAAQsB,IAAK,CACpC,GAAM,CAACrB,EAAKC,CAAK,EAAIe,EAAIjB,EAAKsB,CAAC,CAAE,EAC3BC,EAAUJ,EACVK,EAAaN,EACnBC,EAAa,CAACf,EAAgBC,IAAuB,CACnDkB,EAAQnB,EAAQC,CAAM,EACtBH,EAAME,EAASoB,EAAYnB,CAAM,CACnC,EACAa,GAAejB,CACjB,CACA,GAAM,CAACwB,EAAcC,CAAW,EAAIvB,GAAce,CAAW,EAC7D,MAAO,CACLO,EAAeP,EACf,CAACd,EAAQC,IAAU,CACjBqB,EAAYtB,EAAQC,CAAM,EAC1Bc,EAAWf,EAASqB,EAAcpB,CAAM,CAC1C,EAEJ,CACF,CAEM,SAAUsB,GAAoBC,EAAe,CACjD,MAAO,CAACC,EAAGzB,IAAU,CACnB,IAAM0B,EAAInB,EAAiBkB,EAAGzB,CAAM,EACpC,GAAI0B,IAAM,OAAW,OAErB,GAAM,CAACf,EAAYG,CAAW,EAAIY,EAE9BC,EAAS,EACPC,EAAc,CAAA,EAEpB,KAAOD,EAAShB,EAAW,QAAQ,CACjC,IAAMkB,EAAOL,EAAIb,EAAYgB,CAAM,EACnC,GAAIE,IAAS,OAAW,OAExB,GAAM,CAACC,EAAOjC,CAAG,EAAIgC,EACrBD,EAAO,KAAKE,CAAK,EACjBH,GAAU9B,CACZ,CAEA,MAAO,CAAC+B,EAAQd,CAAW,CAC7B,CACF,CClIO,IAAMiB,GAAsDC,GACjE,OAAOA,GAAM,SAAWC,GAAcD,CAAC,EAAIE,GAA4BF,CAAC,EAE7DG,GAA8CC,EAAOL,EAAoB,EAEzEM,GAA8CC,GAAUC,GAA4BC,EAAY,EAOhGC,GAA6CC,EACxD,CAACX,GAAsBY,CAAiB,EACvC,GAAM,CAAC,EAAE,cAAe,EAAE,aAAa,CAAU,EAGvCC,GAAsCR,EAAOK,EAAgB,EAE7DI,GAAsCC,EACjD,CAACT,GAAqBU,CAAgB,EACtC,CAACC,EAAeC,KAAmB,CAAE,cAAAD,EAAe,cAAAC,CAAa,EAAG,EC9BtE,IAAMC,GAAkB,CACtB,MAAO,EACP,KAAM,GAMKC,GAA2DC,GACtEC,GACAC,GAAsBJ,EAAe,CAAC,EAG3BK,GAAoDC,EAAOL,EAAqB,EAEhFM,GAAoDC,GAC/DC,GACAC,GAAoBV,EAAe,CAAC,ECD/B,IAAMW,GAAyDC,EACpE,CAACC,GAAuBC,CAAiB,EACxCC,GAAM,CAACA,EAAE,eAAgBA,EAAE,QAAQ,CAAU,EAGnCC,GAAkDC,EAAON,EAAsB,EAE/EO,GAAuDN,EAClE,CAACC,GAAuBM,GAAkBL,CAAiB,CAAC,EAC3DC,GAAM,CAACA,EAAE,eAAgBA,EAAE,YAAY,CAAU,EAGvCK,GAAgDH,EAAOC,EAAqB,EAE5EG,GAA2DT,EACtE,CAACC,GAAuBC,CAAiB,EACxCC,GAAM,CAACA,EAAE,eAAgBA,EAAE,IAAI,CAAU,EAG/BO,GAAoDL,EAAOI,EAAuB,EAElFE,GAAgDR,GAAK,CAChE,OAAQA,EAAE,eAAgB,CACxB,IAAK,QACH,OAAOJ,GAAuBI,CAAC,EACjC,IAAK,OACH,OAAOG,GAAsBH,CAAC,EAChC,QACE,OAAOM,GAAwBN,CAAqB,CACxD,CACF,EAEaS,GAAwCP,EAAOM,EAAiB,EAEvEE,GAAkDC,GAAWC,EAAmBC,IAAc,CAClG,eAAgB,QAChB,SAAAA,GACA,EAEIC,GAAgDH,GACpDI,GAAiBH,CAAgB,EAChCI,IAAkB,CAAE,eAAgB,OAAQ,aAAAA,CAAY,EAAG,EAGjDC,GAAwCC,GACnDC,GACCC,GAAuC,CACtC,OAAQA,EAAgB,CACtB,IAAK,QACH,OAAOV,GACT,IAAK,OACH,OAAOI,EACX,CACF,CAAC,EChEI,IAAMO,GAAuDC,EAClE,CAACC,EAAmBC,EAAiB,EACpC,GAAM,CAAC,EAAE,mBAAoB,EAAE,UAAU,CAAU,EAGzCC,GAAgDC,EAAOL,EAAqB,EAE5EM,GAAgDC,EAC3D,CAACC,EAAkBC,EAAgB,EACnC,CAACC,EAAoBC,KAAgB,CAAE,mBAAAD,EAAoB,WAAAC,CAAU,EAAG,ECfpE,SAAUC,GAAmBC,EAAyB,CAC1D,OAAQ,GAAK,CACX,GAAI,EAAG,CACL,GAAM,CAACC,EAAKC,CAAK,EAAIF,EAAQ,CAAC,EAC9B,MAAO,CACLC,EAAM,EACN,CAACE,EAAQC,IAAU,CACJ,IAAI,SAASA,CAAM,EAC3B,SAASD,EAAQ,CAAG,EACzBD,EAAMC,EAAS,EAAGC,CAAM,CAC1B,EAEJ,KACE,OAAO,CACL,EACA,CAACD,EAAQC,IAAU,CACJ,IAAI,SAASA,CAAM,EAC3B,SAASD,EAAQ,CAAG,CAC3B,EAGN,CACF,CAEM,SAAUE,GAAkBC,EAAmB,CACnD,MAAO,CAACC,EAAGJ,IAAU,CAEnB,GADsBK,GAAYD,EAAGJ,CAAM,IAAI,CAAC,GAC3B,EAAG,CACtB,IAAMM,EAASH,EAAQC,EAAGJ,EAAS,CAAC,EACpC,OAAOM,IAAW,OAAY,OAAY,CAACA,EAAO,CAAC,EAAGA,EAAO,CAAC,EAAI,CAAC,CACrE,KACE,OAAO,CAAC,OAAW,CAAC,CAExB,CACF,CCnBO,IAAMC,GAAe,CAC1B,6CAA8C,EAC9C,wCAAyC,EACzC,oDAAqD,EACrD,yCAA0C,EAC1C,wCAAyC,EACzC,gDAAiD,EACjD,wCAAyC,EACzC,0CAA2C,GAC3C,iDAAkD,GAClD,0CAA2C,GAC3C,iDAAkD,GAClD,2CAA4C,GAC5C,kDAAmD,GACnD,uCAAwC,GACxC,8CAA+C,GAC/C,2CAA4C,GAC5C,kDAAmD,GACnD,uCAAwC,GACxC,8CAA+C,IAMpCC,GAAqDC,GAChEC,GACAC,GAAsBJ,EAAY,CAAC,EAGxBK,GAA8CC,EAAOL,EAAkB,EAEvEM,GAA8CC,GACzDC,GACAC,GAAoBV,EAAY,CAAC,EAW7B,SAAUW,GAAuBC,EAAqB,CAC1D,OAAOC,GAAkBC,GAAaF,CAAI,CAAC,CAC7C,CAEA,IAAMC,GAAwD,CAC5D,EAAG,CACD,KAAM,UACN,KAAM,CACJ,IAAK,2BACL,KAAM,YACN,IAAK,eAEP,UAAW,UACX,KAAM,gDAER,EAAG,CACD,KAAM,UACN,KAAM,CACJ,IAAK,yBACL,KAAM,YACN,IAAK,eAEP,UAAW,OACX,KAAM,2CAER,EAAG,CACD,KAAM,UACN,KAAM,CACJ,IAAK,2BACL,KAAM,mBACN,IAAK,eAEP,UAAW,UACX,KAAM,uDAER,EAAG,CACD,KAAM,UACN,KAAM,CACJ,IAAK,yBACL,KAAM,YACN,IAAK,eAEP,UAAW,QACX,KAAM,4CAER,EAAG,CACD,KAAM,UACN,KAAM,CACJ,IAAK,yBACL,KAAM,YACN,IAAK,eAEP,UAAW,OACX,KAAM,2CAER,EAAG,CACD,KAAM,UACN,KAAM,CACJ,IAAK,yBACL,KAAM,mBACN,IAAK,eAEP,UAAW,QACX,KAAM,mDAER,EAAG,CACD,KAAM,UACN,KAAM,CACJ,IAAK,yBACL,KAAM,YACN,IAAK,eAEP,UAAW,OACX,KAAM,2CAGR,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,aACL,KAAM,YACN,IAAK,eAEP,UAAW,UACX,KAAM,6CAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,aACL,KAAM,mBACN,IAAK,eAEP,UAAW,UACX,KAAM,oDAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,aACL,KAAM,YACN,IAAK,eAEP,UAAW,UACX,KAAM,6CAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,aACL,KAAM,mBACN,IAAK,eAEP,UAAW,UACX,KAAM,oDAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,cACL,KAAM,YACN,IAAK,eAEP,UAAW,UACX,KAAM,8CAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,cACL,KAAM,mBACN,IAAK,eAEP,UAAW,UACX,KAAM,qDAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,SACL,KAAM,YACN,IAAK,eAEP,UAAW,UACX,KAAM,0CAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,SACL,KAAM,mBACN,IAAK,eAEP,UAAW,UACX,KAAM,iDAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,cACL,KAAM,YACN,IAAK,eAEP,UAAW,YACX,KAAM,8CAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,cACL,KAAM,mBACN,IAAK,eAEP,UAAW,YACX,KAAM,qDAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,SACL,KAAM,YACN,IAAK,eAEP,UAAW,YACX,KAAM,0CAER,GAAI,CACF,KAAM,UACN,KAAM,CACJ,IAAK,SACL,KAAM,mBACN,IAAK,eAEP,UAAW,YACX,KAAM,kDCvPV,eAAsBE,GACpBC,EACAC,EACAC,EACAC,EAAY,CAEZ,OAAOA,EAAE,KACPH,EACAI,EAAOC,GAAsB,CAACC,EAAmBA,CAAiB,CAAC,CAAC,EAAE,CACpE,IAAI,YAAW,EAAG,OAAO,WAAWL,CAAK,EAAE,EAC3CC,EACD,CAAC,CAEN,CCnBO,IAAMK,GAAmB,CAC9B,MAAO,GAMIC,GAA6DC,GACxEC,GACCC,GAAMJ,GAAiBI,CAAC,CAAC,EAGfC,GAAsDC,EAAOL,EAAsB,EAEnFM,GAAsDC,GACjEC,GACAC,GAAgBV,EAAgB,CAAC,ECL5B,IAAMW,GAAmDC,EAC9D,CACEC,GAAkBC,EAAsB,EACxCD,GAAkBE,EAAkB,EACpCF,GAAkBG,EAAa,EAC/BH,GAAkBG,EAAa,EAC/BH,GAAkBI,EAAqB,GAExCC,GAAQ,CAACA,EAAI,SAAUA,EAAI,aAAcA,EAAI,WAAYA,EAAI,UAAWA,EAAI,WAAW,CAAU,EAGvFC,GAA4CC,EAAOT,EAAmB,EAEtEU,GAA4CC,EACvD,CACEC,GAAiBC,EAAqB,EACtCD,GAAiBE,EAAiB,EAClCF,GAAiBG,EAAY,EAC7BH,GAAiBG,EAAY,EAC7BH,GAAiBI,EAAoB,GAEvC,CAACC,EAAUC,EAAcC,EAAYC,EAAWC,KAAiB,CAC/D,SAAAJ,EACA,aAAAC,EACA,WAAAC,EACA,UAAAC,EACA,YAAAC,GACA,ECtCJ,IAAMC,GAAkB,CACtB,YAAa,EACb,OAAQ,EACR,OAAQ,GAMGC,GAA2DC,GACtEC,GACCC,GAAMJ,GAAgBI,CAAC,CAAC,EAGdC,GAAoDC,EAAOL,EAAqB,EAEhFM,GAAoDC,GAC/DC,GACAC,GAAgBV,EAAe,CAAC,ECd3B,IAAMW,GAA2CC,EACtD,CAACC,GAAeA,EAAa,EAC5BC,GAAO,CAACA,EAAG,UAAWA,EAAG,QAAQ,CAAU,EAGjCC,GAAoCC,EAAOL,EAAe,EAE1DM,GAAoCC,EAAY,CAACC,GAAcA,EAAY,EAAG,CAACC,EAAWC,KAAc,CACnH,UAAAD,EACA,SAAAC,GACA,EAEWC,GAA4B,CACvC,UAAW,GACX,SAAU,sBCSL,IAAMC,GAAmDC,EAC9D,CAACC,EAAmBA,EAAmBC,GAAmBC,EAAmB,EAC5EC,GAAS,CAACA,EAAK,cAAeA,EAAK,mBAAoBA,EAAK,WAAYA,EAAK,YAAY,CAAU,EAGzFC,GAA4CC,EAAOP,EAAmB,EAEtEQ,GAA4CC,EACvD,CAACC,EAAkBA,EAAkBC,GAAkBC,EAAkB,EACzE,CAACC,EAAeC,EAAoBC,EAAYC,KAAkB,CAChE,cAAAH,EACA,mBAAAC,EACA,WAAAC,EACA,aAAAC,GACA,EAgBSC,GAAqEhB,EAChF,CAACiB,GAAuBC,EAAe,EACtCC,GAAS,CAAC,cAAeA,EAAK,QAAQ,CAAU,EAGtCC,GAA8Dd,EAAOU,EAA2B,EAEhGK,GAA+DC,GAC1EL,GACCM,GAAMA,EAAE,cAAc,EAGZC,GAAwDlB,EAAOe,EAAyB,EAExFI,GAA+DzB,EAC1E,CAACiB,GAAuBhB,CAAiB,EACxCkB,GAAS,CAAC,SAAUA,EAAK,UAAU,CAAU,EAGnCO,GAAwDpB,EAAOmB,EAAyB,EAExFE,GAAoDR,GAAQ,CACvE,OAAQA,EAAK,eAAgB,CAC3B,IAAK,cACH,OAAOH,GAA4BG,CAAI,EACzC,IAAK,SACH,OAAOE,GAA0BF,CAAI,EACvC,IAAK,SACH,OAAOM,GAA0BN,CAAI,CACzC,CACF,EAEaS,GAA4CtB,EAAOqB,EAAmB,EAEtEE,GAA8DC,GAAWC,GAAiBC,IAAc,CACnH,eAAgB,cAChB,SAAAA,GACA,EAEWC,GAAwDzB,EAAY,CAACC,CAAgB,EAAIyB,IAAgB,CACpH,eAAgB,SAChB,WAAAA,GACA,EAEWC,GAA4CC,GACvDC,GACCC,GAAyC,CACxC,OAAQA,EAAgB,CACtB,IAAK,cACH,OAAOT,GACT,IAAK,SACH,OAAOU,GAAe,CAAE,eAAAD,CAAc,CAAE,EAC1C,IAAK,SACH,OAAOL,EACX,CACF,CAAC,EAOUO,GAA+DlB,GAC1EmB,GAAkBC,EAAgB,EACjCC,GAAQA,EAAI,UAAU,EAGZC,GAAwDtC,EAAOkC,EAAyB,EAExFK,GAAwDf,GACnEgB,GAAiBC,EAAe,EAC/BC,IAAgB,CAAE,WAAAA,CAAU,EAAG,EASrBC,GAA2DjD,EACtE,CAACC,EAAmBiD,EAAa,EAChCC,GAAM,CAACA,EAAE,QAASA,EAAE,SAAS,CAAU,EAG7BC,GAAoD9C,EAAO2C,EAAuB,EAIlFI,GAA8DlC,GAAQ,CACjF,OAAQA,EAAK,eAAgB,CAC3B,IAAK,cACH,OAAOmC,GACT,IAAK,SACL,IAAK,SACH,OAAOL,GAAwB9B,CAAI,CACvC,CACF,EAEaoC,GAAsDjD,EAAO+C,EAAwB,EAUrFG,GAAiDxD,EAC5D,CAACD,GAAqB4B,GAAqBa,GAA2Ba,EAAwB,EAC7FI,GAAQ,CAACA,EAAKA,EAAKA,EAAKA,EAAI,IAAI,CAAU,EAGhCC,GAA0CpD,EAAOkD,EAAkB,EAInEG,GAA2C3D,EACtD,CAACD,GAAqB4B,GAAqBa,GAA2BvC,CAAiB,EACtF2D,GAAa,CAACA,EAAUA,EAAUA,EAAUA,EAAS,SAAS,CAAU,EAG9DC,GAAoCvD,EAAOqD,EAAe,EAE1DG,GAAoCtD,EAC/C,CAACD,GAAoB4B,GAAoBU,GAA0BpC,CAAgB,EACnF,CAACL,EAAMe,EAAM6B,EAAYe,KAAe,CACtC,GAAG3D,EACH,GAAGe,EACH,GAAG6B,EACH,UAAAe,GACA,EAKSC,GAAwDC,GAAiBH,GAAiBI,GACrGA,EAAG,iBAAmB,cAAgBA,EAAK,MAAS,EAKzCC,GAAgDF,GAAiBH,GAAiBI,GAC7FA,EAAG,iBAAmB,SAAWA,EAAK,MAAS,EAKpCE,GAAgDH,GAAiBH,GAAiBI,GAC7FA,EAAG,iBAAmB,SAAWA,EAAK,MAAS,EAkBjD,eAAsBG,GACpBC,EACAC,EACAC,EAAc,CAEd,MAAO,CACL,GAAGF,EACH,UAAW,MAAMG,GAAcF,EAAqB,cAAeG,EAAOC,EAAkB,EAAEL,CAAG,EAAGE,CAAG,EAE3G,CCpNO,IAAMI,GAAqDC,EAChE,CAACC,GAAwBC,GAAoBC,EAAmBC,GAAiBC,GAAkBC,EAAgB,CAAC,EACnHC,GACC,CACEA,EAAc,QACdA,EAAc,YACdA,EAAc,QACdA,EAAc,SACdA,EAAc,WACN,EAGDC,GAA8CC,EAAOV,EAAoB,EAEzEW,GAA8CC,EACzD,CACEC,GACAC,GACAC,EACAC,GACAC,GAAiBC,EAAe,GAElC,CAACC,EAASC,EAAaC,EAASC,EAAUC,KAAgB,CACxD,QAAAJ,EACA,YAAAC,EACA,QAAAC,EACA,SAAAC,EACA,WAAAC,GACA,EAKSC,GAA+CvB,EAC1D,CAACD,GAAsBI,CAAiB,EACvCqB,GAAe,CAACA,EAAYA,EAAW,SAAS,CAAU,EAGhDC,GAAwChB,EAAOc,EAAiB,EAEhEG,GAAwCf,EACnD,CAACD,GAAqBI,CAAgB,EACtC,CAACP,EAAeoB,KAAe,CAC7B,GAAGpB,EACH,UAAAoB,GACA,EAGJ,eAAsBC,GAAeC,EAAoBC,EAAqBC,EAAY,CACxF,MAAO,CAAE,GAAGF,EAAK,UAAW,MAAMG,GAAcF,EAAS,gBAAiBrB,EAAOV,EAAoB,EAAE8B,CAAG,EAAGE,CAAC,CAAC,CACjH,CAsBA,eAAsBE,GACpBC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAAgC,CAEhC,IAAMC,EAAW,MAAMF,EAAG,KAAK,gBAAe,EACxCG,EAAW,MAAMH,EAAG,KAAK,gBAAe,EAExCI,EAAiB,CACrB,eAAgB,MAAMJ,EAAG,KAAK,iBAAiBE,EAAS,UAAU,EAClE,eAAgB,MAAMF,EAAG,KAAK,iBAAiBG,EAAS,UAAU,EAClE,oBAAqBJ,EAAiB,SAGlCM,EAAqC,CACzC,eAAgB,cAChB,cAAe,MAAML,EAAG,KAAK,gBAAgBG,EAAS,SAAS,EAC/D,mBAAoBJ,EAAiB,UACrC,KAAM,CAAE,eAAgB,aAAa,EACrC,WAAYE,GAAsB,CAAA,EAClC,WAAAN,EACA,aAAAC,EACA,SAAAC,GAGIS,EAAqB,CACzB,QAAS,QACT,YAAaN,EAAG,KAChB,QAAS,MAAMA,EAAG,KAAK,gBAAgBE,EAAS,SAAS,EACzD,SAAU,MAAMK,GAAuBF,EAAaN,EAAiB,QAASC,EAAG,SAAS,EAC1F,WAAAF,GAGF,MAAO,CAAE,cAAe,MAAMU,GAAeF,EAAKP,EAAiB,QAASC,EAAG,SAAS,EAAG,eAAAI,CAAc,CAC3G,CAEA,eAAsBK,GACpBd,EACAC,EACAC,EACAC,EACAE,EACAC,EAAgC,CAEhC,IAAMS,EAAU,MAAMV,EAAG,UAAU,OAAM,EACzC,OAAON,GAA0BC,EAAYC,EAAcC,EAAUC,EAAYY,EAASV,EAAIC,CAAkB,CAClH,CC5IO,IAAMU,GAAW,CACtB,SAAU,EACV,WAAY,GAMDC,GAA6CC,GAAuBC,GAAeC,GAAMJ,GAASI,CAAC,CAAC,EAEpGC,GAAsCC,EAAOL,EAAc,EAC3DM,GAAsCC,GAAiBC,GAAaC,GAAgBV,EAAQ,CAAC,EAEpGW,GAAsB,CAC1B,YAAa,EACb,OAAQ,EACR,OAAQ,GAMGC,GAAmEV,GAC9EC,GACCU,GAAMF,GAAoBE,CAAC,CAAC,EAGlBC,GAA4DR,EAAOM,EAAyB,EAE5FG,GAA4DP,GACvEC,GACAC,GAAgBC,EAAmB,CAAC,EAehCK,GAAwDC,EAC5D,CAAChB,GAAgBiB,CAAiB,EACjCC,GAAM,CAACA,EAAE,QAASA,EAAE,KAAK,CAAU,EAGhCC,GAA4DH,EAChE,CAAChB,GAAgBW,GAA2BM,EAAmBG,EAAa,EAC3EC,GAAS,CAACA,EAAK,QAASA,EAAK,MAAOA,EAAK,WAAYA,EAAK,QAAQ,CAAU,EAGzEC,GAA0BC,EAC9B,CAACT,GAA0BU,EAAkBC,EAAY,EACzD,CAACC,EAAOC,EAAYC,KACX,CAAE,MAAAF,EAAO,WAAAC,EAAY,SAAAC,CAAQ,EACrC,EAGUC,GAA0CR,GAAQ,CAC7D,OAAQA,EAAK,QAAS,CACpB,IAAK,WACH,OAAON,GAAsBM,CAAI,EACnC,IAAK,aACH,OAAOF,GAAwBE,CAAI,CACvC,CACF,EAEaS,GAAkCzB,EAAOwB,EAAc,EAEvDE,GAAkCC,GAAe1B,GAAgB2B,GAA6B,CACzG,OAAQA,EAAS,CACf,IAAK,WACH,OAAOC,GAAWV,EAAmBW,IAAW,CAC9C,QAAAF,EACA,MAAAE,GACA,EACJ,IAAK,aACH,OAAOD,GAAWZ,GAA0Bc,IAAgB,CAC1D,QAAAH,EACA,GAAGG,GACH,CACN,CACF,CAAC,EAMYC,GAA8CrB,EACzD,CAACa,GAAgBZ,CAAiB,EACjCqB,GAAU,CAACA,EAAOA,EAAM,QAAQ,CAAU,EAGhCC,GAAuClC,EAAOgC,EAAY,EAE1DG,GAAuCjB,EAClD,CAACQ,GAAeP,CAAgB,EAChC,CAACH,EAAMoB,KAAc,CAAE,GAAGpB,EAAM,SAAAoB,CAAQ,EAAG,EAShCC,GAA2C1B,EACtD,CAACqB,GAAcM,GAAeA,EAAa,EAC1CC,GAAU,CAACA,EAAM,GAAIA,EAAM,MAAOA,EAAM,KAAK,CAAU,EAG7CC,GAAoCxC,EAAOqC,EAAe,EAE1DI,GAAoCvB,EAC/C,CAACiB,GAAaO,GAAcA,EAAY,EACxC,CAACC,EAAIC,EAAOC,KAAW,CAAE,GAAAF,EAAI,MAAAC,EAAO,MAAAC,CAAK,EAAG,ECjHvC,IAAMC,GAAiCC,GAAuBC,GAAoBC,GAAMA,EAAE,UAAU,EAE9FC,GAA0BC,EAAOL,EAAU,EAC3CM,GAA0BC,GAAWC,GAAmBC,IAAgB,CAAE,WAAAA,CAAU,EAAG,EAMvFC,GAAuCT,GAAuBU,GAAkBC,GAAMA,EAAE,QAAQ,EAEhGC,GAAgCR,EAAOK,EAAa,EACpDI,GAAgCP,GAAWQ,GAAuBC,IAAc,CAAE,SAAAA,CAAQ,EAAG,EAM7FC,GAAuChB,GAAuBiB,GAAgBC,GAAMA,EAAE,OAAO,EAE7FC,GAAgCf,EAAOY,EAAa,EACpDI,GAAgCd,GAAWe,GAAeC,IAAa,CAAE,QAAAA,CAAO,EAAG,EAMnFC,GAAiCvB,GAAuBwB,GAAeC,GAAMA,EAAE,cAAc,EAE7FC,GAA0BtB,EAAOmB,EAAU,EAC3CI,GAA0BrB,GAAWsB,GAAcC,IAAoB,CAAE,eAAAA,CAAc,EAAG,EAS1FC,GAAuCC,EAClD,CAACC,EAAmBC,GAAwBC,GAAoBC,GAAkBC,EAAgB,CAAC,EAClGlB,GAAM,CAACA,EAAE,QAASA,EAAE,QAASA,EAAE,YAAaA,EAAE,UAAU,CAAU,EAGxDmB,GAAgCjC,EAAO0B,EAAa,EAEpDQ,GAAgCC,EAC3C,CAACC,EAAkBC,GAAuBC,GAAmBC,GAAiBC,EAAe,CAAC,EAC9F,CAACC,EAASC,EAASC,EAAaC,KAAgB,CAAE,QAAAH,EAAS,QAAAC,EAAS,YAAAC,EAAa,WAAAC,CAAU,EAAG,EAOnFC,GAAmDjD,GAC9DgC,EACC,GAAM,EAAE,SAAS,EAGPkB,GAA4C9C,EAAO6C,EAAmB,EACtEE,GAA4C7C,GAAWkC,EAAmBY,IAAe,CAAE,UAAAA,CAAS,EAAG,EAMvGC,GAAuErD,GAClFmC,GAAkBC,EAAgB,EACjCkB,GAAMA,EAAE,UAAU,EAGRC,GAAgEnD,EAAOiD,EAA6B,EAEpGG,GAAgElD,GAC3EqC,GAAiBC,EAAe,EAC/BI,IAAgB,CAAE,WAAAA,CAAU,EAAG,EAqDrBS,GAAiD1B,EAC5D,CAAC2B,GAA4B3D,EAAU,EACtC0B,GAAM,CAACA,EAAE,aAAcA,EAAE,GAAG,CAAU,EAG5BkC,GAA0CvD,EAAOqD,EAAkB,EAEnEG,GAAuD7B,EAClE,CAAC2B,GAA4BjD,EAAa,EACzCgB,GAAM,CAACA,EAAE,aAAcA,EAAE,MAAM,CAAU,EAG/BoC,GAAgDzD,EAAOwD,EAAqB,EAE5EE,GAAuD/B,EAClE,CAAC2B,GAA4B1C,EAAa,EACzCS,GAAM,CAACA,EAAE,aAAcA,EAAE,MAAM,CAAU,EAG/BsC,GAAgD3D,EAAO0D,EAAqB,EAE5EE,GAAiDjC,EAC5D,CAAC2B,GAA4BnC,EAAU,EACtCE,GAAM,CAACA,EAAE,aAAcA,EAAE,GAAG,CAAU,EAG5BwC,GAA0C7D,EAAO4D,EAAkB,EAEnEE,GAAuDnC,EAClE,CAAC2B,GAA4B5B,EAAa,EACzCL,GAAM,CAACA,EAAE,aAAcA,EAAE,MAAM,CAAU,EAG/B0C,GAAgD/D,EAAO8D,EAAqB,EAE5EE,GAAmErC,EAC9E,CAAC2B,GAA4BT,EAAmB,EAC/CxB,GAAM,CAACA,EAAE,aAAcA,EAAE,YAAY,CAAU,EAGrC4C,GAA4DjE,EAAOgE,EAA2B,EAE9FE,GACXvC,EACE,CAAC2B,GAA4BL,EAA6B,EACzD5B,GAAM,CAACA,EAAE,aAAcA,EAAE,sBAAsB,CAAU,EAGjD8C,GAAgFnE,EAC3FkE,EAAqC,EAG1BE,GAAuDzC,EAClE,CAAC0C,GAAezC,CAAiB,EAChCP,GAAM,CAACA,EAAE,aAAcA,EAAE,YAAY,CAAU,EAGrCiD,GAAgDtE,EAAOoE,EAAqB,EAE5EG,GAA4ClD,GAAK,CAC5D,OAAQA,EAAE,aAAc,CACtB,IAAK,MACH,OAAOgC,GAAmBhC,CAAC,EAC7B,IAAK,SACH,OAAOmC,GAAsBnC,CAAC,EAChC,IAAK,SACH,OAAOqC,GAAsBrC,CAAC,EAChC,IAAK,MACH,OAAOuC,GAAmBvC,CAAC,EAC7B,IAAK,SACH,OAAOyC,GAAsBzC,CAAC,EAChC,IAAK,gBACH,OAAO2C,GAA4B3C,CAAC,EACtC,IAAK,2BACH,OAAO6C,GAAsC7C,CAAC,EAChD,QACE,OAAO+C,GAAsB/C,CAAC,CAClC,CACF,EAEamD,GAAoCxE,EAAOuE,EAAe,EAE1DE,GAA0CvE,GAAWD,GAAYyE,IAAS,CAAE,aAAc,MAAO,IAAAA,CAAG,EAAG,EAEvGC,GAAgDzE,GAAWO,GAAemE,IAAY,CACjG,aAAc,SACd,OAAAA,GACA,EAEWC,GAAgD3E,GAAWc,GAAe8D,IAAY,CACjG,aAAc,SACd,OAAAA,GACA,EAEWC,GAA0C7E,GAAWqB,GAAYyD,IAAS,CAAE,aAAc,MAAO,IAAAA,CAAG,EAAG,EAEvGC,GAAgD/E,GAAWgC,GAAegD,IAAY,CACjG,aAAc,SACd,OAAAA,GACA,EAEWC,GAA4DjF,GACvE6C,GACCqC,IAAkB,CAAE,aAAc,gBAAiB,aAAAA,CAAY,EAAG,EAGxDC,GAAgFnF,GAC3FkD,GACCkC,IAA4B,CAAE,aAAc,2BAA4B,uBAAAA,CAAsB,EAAG,EAG9F,SAAUC,GAAqBC,EAAoB,CACvD,OAAOtF,GAAWkC,EAAmBqD,IAAkB,CAAE,aAAAD,EAAc,aAAAC,CAAY,EAAG,CACxF,CAEO,IAAMC,GAAoCC,GAC/CC,GAAeC,GAA4BL,GAAmC,CAC5E,OAAQA,EAAc,CACpB,IAAK,MACH,OAAOf,GACT,IAAK,SACH,OAAOE,GACT,IAAK,SACH,OAAOE,GACT,IAAK,MACH,OAAOE,GACT,IAAK,SACH,OAAOE,GACT,IAAK,gBACH,OAAOE,GACT,IAAK,2BACH,OAAOE,EACX,CACF,CAAC,EACDO,GAAeE,GAAeC,GAAMR,GAAqBQ,CAAC,CAAC,CAAC,EChR9D,IAAMC,GAAqB,CACzB,SAAU,EACV,UAAW,GAMAC,GAAiEC,GAC5EC,GACCC,GAAMJ,GAAmBI,CAAC,CAAC,EAGjBC,GAA0DC,EAAOL,EAAwB,EAEzFM,GAA0DC,GACrEC,GACAC,GAAgBV,EAAkB,CAAC,EAcxBW,GAAqEC,EAChF,CAACX,GAA0BY,EAAe,EACzCC,GAAM,CAACA,EAAE,kBAAmBA,EAAE,QAAQ,CAAU,EAGtCC,GAA8DT,EAAOK,EAA4B,EAEjGK,GAA2EJ,EACtF,CAACX,GAA0BgB,CAAiB,EAC3CC,GAAM,CAACA,EAAE,kBAAmBA,EAAE,SAAS,CAAU,EAGvCC,GAAoEb,EAAOU,EAA+B,EAE1GI,GAAsDC,GAAS,CAC1E,OAAQA,EAAM,kBAAmB,CAC/B,IAAK,WACH,OAAOV,GAA6BU,CAAK,EAC3C,IAAK,YACH,OAAOL,GAAgCK,CAAK,CAChD,CACF,EAEaC,GAA8ChB,EAAOc,EAAoB,EAEzEG,GAA8CC,GACzDjB,GACCkB,GAA6C,CAC5C,OAAQA,EAAmB,CACzB,IAAK,WACH,OAAOC,GAAWC,GAAiBC,IAAc,CAAE,kBAAAH,EAAmB,SAAAG,CAAQ,EAAG,EACnF,IAAK,YACH,OAAOF,GAAWG,EAAmBC,IAAe,CAAE,kBAAAL,EAAmB,UAAAK,CAAS,EAAG,CACzF,CACF,CAAC,ECnDI,IAAMC,GAAmDC,EAC9D,CACEC,GACAC,GACAC,EACAC,GACAD,EACAA,EACAE,GAAkBC,EAAgB,GAEnCC,GACC,CAACA,EAAG,QAASA,EAAG,YAAaA,EAAG,QAASA,EAAG,MAAOA,EAAG,SAAUA,EAAG,wBAAyBA,EAAG,UAAU,CAAU,EAG1GC,GAA4CC,EAAOV,EAAmB,EAEtEW,GAA4CC,EACvD,CACEC,GACAC,GACAC,EACAC,GACAD,EACAA,EACAE,GAAiBC,EAAe,GAElC,CAACC,EAASC,EAAaC,EAASC,EAAOC,EAAUC,EAAyBC,KAAgB,CACxF,QAAAN,EACA,YAAAC,EACA,QAAAC,EACA,MAAAC,EACA,SAAAC,EACA,wBAAAC,EACA,WAAAC,GACA,EClDJ,IAAMC,GAAY,CAChB,KAAM,EACN,OAAQ,GAMGC,GAA+CC,GAAuBC,GAAeC,GAAMJ,GAAUI,CAAC,CAAC,EAEvGC,GAAwCC,EAAOL,EAAe,EAE9DM,GAAwCC,GAAiBC,GAAaC,GAAgBV,EAAS,CAAC,ECNtG,IAAMW,GAA+CC,EAC1D,CAACC,EAAmBA,EAAmBC,GAAkBC,EAAa,CAAC,EACtEC,GAAS,CAACA,EAAK,cAAeA,EAAK,WAAYA,EAAK,cAAc,CAAU,EAGlEC,GAAwCC,EAAOP,EAAiB,EAEhEQ,GAAwCC,EACnD,CAACC,EAAkBA,EAAkBC,GAAiBC,EAAY,CAAC,EACnE,CAACC,EAAeC,EAAYC,KAAoB,CAC9C,cAAAF,EACA,WAAAC,EACA,eAAAC,GACA,ECOG,IAAMC,GAAoCC,GAAQ,CACvD,OAAQA,EAAK,SAAU,CACrB,IAAK,SACH,OAAOC,EACL,CAACC,GAAiBC,EAAiB,EAClCC,GAAkB,CAACA,EAAE,SAAUA,EAAE,MAAM,CAAU,EAClDJ,CAAI,EACR,IAAK,OACH,OAAOC,EACL,CAACC,GAAiBG,EAAe,EAChCD,GAAgB,CAACA,EAAE,SAAUA,EAAE,IAAI,CAAU,EAC9CJ,CAAI,CACV,CACF,EAEaM,GAA4BC,EAAOR,EAAW,EAE9CS,GAA4BC,GAAeC,GAAiBC,GAA2B,CAClG,OAAQA,EAAU,CAChB,IAAK,SACH,OAAOC,GAAWC,GAAmBC,IAAY,CAC/C,SAAAH,EACA,OAAAG,GACA,EACJ,IAAK,OACH,OAAOF,GAAWG,GAAiBC,IAAU,CAC3C,SAAAL,EACA,KAAAK,GACA,CACN,CACF,CAAC,EAaK,SAAUC,GAAkBC,EAAiB,CACjD,IAAMC,EAAYD,EAAK,OAAS,EAEhC,GAAIA,EAAKC,CAAS,IAAM,OACtB,MAAM,IAAIC,GAAc,sDAAsD,EAIhF,IAAMC,EAAaC,GAAuBJ,EAAK,MAAM,EAG/CK,EAAOL,EAAK,MAAK,EACvB,KAAOK,EAAK,OAASF,GACnBE,EAAK,KAAK,MAAS,EAGrB,OAAOA,CACT,CAGA,SAASD,GAAuBE,EAAS,CACvC,IAAIC,EAAI,EACR,MAAQ,GAAMA,EAAI,GAAM,EAAID,GAC1BC,IAEF,OAAQ,GAAMA,EAAI,GAAM,CAC1B,CAQM,SAAUC,GAAgBR,EAAiB,CAC/C,IAAIS,EAAeT,EAAK,OAAS,EACjC,KAAOS,GAAgB,GAAKT,EAAKS,CAAY,IAAM,QACjDA,IAGF,OAAOT,EAAK,MAAM,EAAGS,EAAe,CAAC,CACvC,CAEO,IAAMC,GAAiDC,GAC5DC,GAAkBC,GAAgBC,EAAW,CAAC,EAC9CN,EAAe,EAGJO,GAA0CC,EAAON,EAAkB,EAEnEO,GAA0CC,GACrDC,GAAiBC,GAAeC,EAAU,CAAC,EAC3CtB,EAAiB,ECpGZ,IAAMuB,GAA6DC,EACxE,CAACC,GAAiBC,GAAeC,GAAgBC,EAAe,CAAC,EAChEC,GAAU,CAACA,EAAM,SAAUA,EAAM,UAAWA,EAAM,QAAQ,CAAU,EAG1DC,GAAsDC,EAAOR,EAAwB,EAErFS,GAAsDC,EACjE,CAACC,GAAcC,GAAeC,EAAc,CAAC,EAC7C,CAACC,EAAWC,KAAc,CACxB,SAAU,OACV,UAAAD,EACA,SAAAC,GACA,EAGSC,GAAiEf,EAC5E,CAACC,GAAiBE,GAAgBa,EAAiB,EAAGC,EAAmBA,CAAiB,EACzFZ,GAAU,CAACA,EAAM,SAAUA,EAAM,WAAYA,EAAM,SAAUA,EAAM,SAAS,CAAU,EAG5Ea,GAA0DX,EAAOQ,EAA0B,EAE3FI,GAA0DV,EACrE,CAACE,GAAeS,EAAgB,EAAGC,EAAkBA,CAAgB,EACrE,CAACC,EAAYC,EAAUC,KAAe,CACpC,SAAU,SACV,WAAAF,EACA,SAAAC,EACA,UAAAC,GACA,EAGSC,GAAsDpB,GAAS,CAC1E,OAAQA,EAAM,SAAU,CACtB,IAAK,OACH,OAAON,GAAyBM,CAAK,EACvC,IAAK,SACH,OAAOU,GAA2BV,CAAK,CAC3C,CACF,EAEaqB,GAA8CnB,EAAOkB,EAAoB,EAEzEE,GAA8CC,GACzDC,GACCC,GAAoC,CACnC,OAAQA,EAAU,CAChB,IAAK,OACH,OAAOtB,GACT,IAAK,SACH,OAAOW,EACX,CACF,CAAC,ECnDI,IAAMY,GAAyDC,EACpE,CAACC,EAAmBA,EAAmBA,CAAiB,EACvDC,GAAM,CAACA,EAAE,cAAeA,EAAE,WAAYA,EAAE,uBAAuB,CAAU,EAG/DC,GAAkDC,EAAOL,EAAsB,EAE/EM,GAAkDC,EAC7D,CAACC,EAAkBA,EAAkBA,CAAgB,EACrD,CAACC,EAAeC,EAAYC,KAA6B,CACvD,cAAAF,EACA,WAAAC,EACA,wBAAAC,GACA,EChCG,IAAMC,GAAuDC,EAClE,CAACC,EAAmBA,CAAiB,EACpCC,GAAQ,CAACA,EAAI,UAAWA,EAAI,UAAU,CAAU,EAGtCC,GAAgDC,EAAOL,EAAqB,EAE5EM,GAAgDC,EAC3D,CAACC,EAAkBA,CAAgB,EACnC,CAACC,EAAWC,KAAgB,CAAE,UAAAD,EAAW,WAAAC,CAAU,EAAG,ECiBjD,IAAMC,GAAuDC,EAClE,CAACC,EAAmBC,GAAkBC,EAAqB,CAAC,EAC3DC,GAAS,CAACA,EAAK,cAAeA,EAAK,mBAAmB,CAAU,EAGtDC,GAAgDC,EAAOP,EAAqB,EAE5EQ,GAAgDC,EAC3D,CAACC,EAAkBC,GAAiBC,EAAoB,CAAC,EACzD,CAACC,EAAeC,KAAyB,CAAE,cAAAD,EAAe,oBAAAC,CAAmB,EAAG,EAQrEC,GAA+Cd,EAC1D,CAACe,GAAiBb,GAAkBH,EAAqB,CAAC,EACzDiB,GAAS,CAACA,EAAK,SAAUA,EAAK,KAAK,CAAU,EAGnCC,GAAwCX,EAAOQ,EAAiB,EAEhEI,GAAwCV,EACnD,CAACW,GAAsBT,GAAiBH,EAAoB,CAAC,EAC7D,CAACa,EAAUC,KAAW,CAAE,SAAAD,EAAU,MAAAC,CAAK,EAAG,ECjDrC,IAAMC,GAAuCC,EAClD,CAACC,GAAkBC,EAAoB,EAAGC,GAAgBC,EAAiB,CAAC,EAC3EC,GAAW,CAACA,EAAO,UAAWA,EAAO,IAAI,CAAU,EAGzCC,GAAgCC,EAAOR,EAAa,EAEpDS,GAAgCC,EAC3C,CAACC,GAAiBC,EAAmB,EAAGC,GAAeC,EAAgB,CAAC,EACxE,CAACC,EAAWC,KAAU,CAAE,UAAAD,EAAW,KAAAC,CAAI,EAAG,EChB5C,IAAMC,GAAe,CACnB,YAAa,EACb,SAAU,EACV,OAAQ,GAMGC,GAAqDC,GAChEC,GACCC,GAAMJ,GAAaI,CAAC,CAAC,EAGXC,GAA8CC,EAAOL,EAAkB,EAEvEM,GAA8CC,GAAiBC,GAAaC,GAAgBV,EAAY,CAAC,EChB/G,IAAMW,GAAc,CACzB,mBAAoB,EACpB,oBAAqB,EACrB,YAAa,EACb,eAAgB,EAChB,gBAAiB,GAMNC,GAAoDC,GAC/DC,GAAuBC,GAAgB,GAAsBJ,GAAY,CAAC,CAAC,EAAEE,CAAC,EAEnEG,GAA4CC,EAAOL,EAAiB,EAEpEM,GAA4CC,GAAiBC,GAAcC,GAAgBV,EAAW,CAAC,ECZpH,IAAMW,GAAc,CAClB,OAAQ,EACR,SAAU,EACV,oBAAqB,EACrB,kBAAmB,GAMRC,GAAmDC,GAC9DC,GACCC,GAAMJ,GAAYI,CAAC,CAAC,EAGVC,GAA4CC,EAAOL,EAAiB,EAEpEM,GAA4CC,GAAiBC,GAAaC,GAAgBV,EAAW,CAAC,EAsBtGW,GAAwCC,GAAK,CACxD,OAAQA,EAAE,WAAY,CACpB,IAAK,SACH,OAAOC,EACL,CAACZ,GAAmBa,EAAa,EAChCF,GAAoB,CAACA,EAAE,WAAYA,EAAE,SAAS,CAAU,EACzDA,CAAC,EACL,IAAK,WACH,OAAOC,EACL,CAACZ,GAAmBa,EAAa,EAChCF,GAAsB,CAACA,EAAE,WAAYA,EAAE,WAAW,CAAU,EAC7DA,CAAC,EACL,IAAK,sBACL,IAAK,oBACH,OAAOX,GAAkBW,EAAE,UAAU,CACzC,CACF,EAEaG,GAAgCT,EAAOK,EAAa,EAEpDK,GAAgCC,GAAeV,GAAmBW,GAA+B,CAC5G,OAAQA,EAAY,CAClB,IAAK,SACH,OAAOC,GAAWC,GAAeC,IAAe,CAC9C,WAAAH,EACA,UAAAG,GACA,EACJ,IAAK,WACH,OAAOF,GAAWC,GAAeE,IAAiB,CAChD,WAAAJ,EACA,YAAAI,GACA,EACJ,IAAK,sBACH,OAAOH,GACL,IAAM,CAAC,OAAW,CAAC,EACnB,KAAO,CACL,WAAAD,GACA,EAEN,IAAK,oBACH,OAAOC,GACL,IAAM,CAAC,OAAW,CAAC,EACnB,KAAO,CACL,WAAAD,GACA,CAER,CACF,CAAC,EAcM,IAAMK,GAAgDC,GAAM,CACjE,EACA,CAACC,EAAQC,IAAU,CACJ,IAAI,WAAWA,EAAQD,EAAQ,CAAC,EACxC,IAAID,EAAG,CAAC,CACf,GAGWG,GAAwCC,EAAOL,EAAiB,EAEhEM,GAAwC,CAACC,EAAGL,IAChD,CAACK,EAAE,SAASL,EAAQA,EAAS,CAAC,EAAiB,CAAC,EAG5CM,GAA+CC,EAC1D,CAACC,GAAeA,GAAeV,EAAiB,EAC/CW,GAAM,CAACA,EAAE,UAAWA,EAAE,WAAYA,EAAE,UAAU,CAAU,EAG9CC,GAAwCP,EAAOG,EAAiB,EAEhEK,GAAwCC,EACnD,CAACC,GAAcA,GAAcT,EAAgB,EAC7C,CAACU,EAAWC,EAAYC,KAAgB,CACtC,UAAAF,EACA,WAAAC,EACA,WAAAC,GACA,EASSC,GAAqDV,EAChE,CAACW,EAAmBC,GAAeC,EAAkB,EACpDC,GAAQ,CAACA,EAAI,QAASA,EAAI,MAAOA,EAAI,WAAW,CAAU,EAGhDC,GAA8CnB,EAAOc,EAAoB,EAEzEM,GAA8CX,EACzD,CAACY,EAAkBC,GAAcC,EAAiB,EAClD,CAACC,EAASC,EAAOC,KAAiB,CAChC,QAAAF,EACA,MAAAC,EACA,YAAAC,GACA,ECjHG,IAAMC,GAAmFC,EAC9F,CAACC,GAAoBC,CAAiB,EACrCC,GAAM,CAACA,EAAE,YAAaA,EAAE,eAAe,CAAU,EAGvCC,GAA4EC,EACvFN,EAAmC,EAGxBO,GAA6EN,EACxF,CAACC,GAAoBM,EAAe,EACnCJ,GAAM,CAACA,EAAE,YAAaA,EAAE,QAAQ,CAAU,EAGhCK,GAAsEH,EACjFC,EAAgC,EAGrBG,GAAyET,EACpF,CAACC,GAAoBS,EAAa,EACjCP,GAAM,CAACA,EAAE,YAAaA,EAAE,MAAM,CAAU,EAG9BQ,GAAkEN,EAAOI,EAA8B,EAEvGG,GAA8DC,GAAM,CAC/E,OAAQA,EAAG,YAAa,CACtB,IAAK,cACH,OAAOd,GAAoCc,CAAE,EAC/C,IAAK,WACH,OAAOP,GAAiCO,CAAE,EAC5C,IAAK,SACH,OAAOJ,GAA+BI,CAAE,CAC5C,CACF,EAEaC,GAAsDT,EAAOO,EAAwB,EAErFG,GAA4EC,GACvFC,EACCC,IAAqB,CAAE,YAAa,cAAe,gBAAAA,CAAe,EAAG,EAG3DC,GAAsEH,GACjFI,GACCC,IAAc,CAAE,YAAa,WAAY,SAAAA,CAAQ,EAAG,EAG1CC,GAAkEN,GAAWO,GAAeC,IAAY,CACnH,YAAa,SACb,OAAAA,GACA,EAEWC,GAAsDC,GACjEC,GACCC,GAA2C,CAC1C,OAAQA,EAAa,CACnB,IAAK,cACH,OAAOb,GACT,IAAK,WACH,OAAOI,GACT,IAAK,SACH,OAAOG,EACX,CACF,CAAC,EAyBI,IAAMO,GAAqDC,EAChE,CAACC,EAAmBC,GAAeC,GAAeF,EAAmBG,EAAwB,EAC5FC,GAAO,CAACA,EAAG,QAASA,EAAG,MAAOA,EAAG,OAAQA,EAAG,kBAAmBA,CAAE,CAAU,EAGjEC,GAA8CC,EAAOR,EAAoB,EAEzES,GAA8CC,EACzD,CAACC,EAAkBC,GAAcC,GAAcF,EAAkBG,EAAuB,EACxF,CAACC,EAASC,EAAOC,EAAQC,EAAmBC,KAAU,CACpD,QAAAJ,EACA,MAAAC,EACA,OAAAC,EACA,kBAAAC,EACA,GAAGC,GACH,EASSC,GAAgDD,GAAQ,CACnE,OAAQA,EAAK,WAAY,CACvB,IAAK,SACL,IAAK,oBACH,OAAOE,GAAoBF,EAAK,OAAO,EACzC,IAAK,WACL,IAAK,sBACH,OAAOG,EACX,CACF,EAEaC,GAAwCf,EAAOY,EAAiB,EAahEI,GAA2DvB,EACtE,CAACwB,GAAwBC,GAAmB1B,GAAsBoB,EAAiB,EAClFO,GAAM,CAACA,EAAE,gBAAiBA,EAAE,WAAYA,EAAE,QAASA,CAAC,CAAU,EAGpDC,GAAoDpB,EAAOgB,EAAuB,EAazFK,GAAmFC,GAAY,CACnG,OAAQA,EAAS,YAAa,CAC5B,IAAK,SACH,OAAOC,GAAkCD,CAAQ,EACnD,IAAK,cACL,IAAK,WACH,OAAOR,EACX,CACF,EAEMS,GAAuFC,GAC3F9B,EACC+B,GAASA,EAAK,eAAe,EAGnBC,GAAqEjC,EAChF,CAACC,EAAmB2B,EAAkC,EACrDM,GAAM,CAACA,EAAE,UAAWA,CAAC,CAAU,EAGrBC,GAA8D5B,EAAO0B,EAA4B,EAEjGG,GAAiFC,GAC5F3B,EACC4B,IAAqB,CACpB,YAAa,SACb,gBAAAA,GACA,EAGE,SAAUC,GAA4BC,EAA4B,CACtE,OAAQA,EAAa,CACnB,IAAK,SACH,OAAO/B,EAAY,CAACC,EAAkB0B,EAAiC,EAAG,CAACK,EAAWC,KAAgB,CACpG,UAAAD,EACA,GAAGC,GACH,EACJ,IAAK,cACL,IAAK,WACH,OAAOL,GAAW3B,EAAmB+B,IAAe,CAClD,UAAAA,EACA,YAAAD,GACA,CACN,CACF,CC5MO,IAAMG,GAAmEC,EAC9E,CAACC,GAAmBC,GAAsBC,EAA4B,EACrEC,GAAM,CAACA,EAAE,WAAYA,EAAE,QAASA,EAAE,IAAI,CAAU,EAGtCC,GAA4DC,EAAOP,EAA2B,EAE9FQ,GAA4DC,EACvE,CACEC,GACAC,GAAeC,GAAsBC,GAC5BC,GAAWC,GAA4BF,EAAQ,WAAW,EAAIG,IAAU,CAAE,QAAAH,EAAS,KAAAG,CAAI,EAAG,CAClG,GAEH,CAACC,EAAYC,KAAiB,CAC5B,WAAAD,EACA,GAAGC,GACH,EAQSC,GAAyElB,EACpF,CAACmB,GAAyBhB,EAA4B,EACrDiB,GAAM,CAACA,EAAE,WAAYA,EAAE,IAAI,CAAU,EAG3BC,GAAkEf,EAAOY,EAA8B,EC/C7G,IAAMI,GAA8DC,GAAQ,CACjF,OAAQA,EAAK,WAAY,CACvB,IAAK,SACH,OAAOC,EAAkBD,EAAK,aAAa,EAC7C,IAAK,WACL,IAAK,sBACL,IAAK,oBACH,OAAOE,EACX,CACF,EAEaC,GAAsDC,EAAOL,EAAwB,EAE5F,SAAUM,GAAwBC,EAA0B,CAChE,OAAQA,EAAY,CAClB,IAAK,SACH,OAAOC,GAAWC,EAAmBC,IAAmB,CACtD,WAAAH,EACA,cAAAG,GACA,EACJ,IAAK,WACL,IAAK,sBACL,IAAK,oBACH,OAAOC,GAAe,CAAE,WAAAJ,CAAU,CAAE,CACxC,CACF,CAMO,IAAMK,GAAqDC,EAChE,CAACC,GAAsBC,GAA8Bf,EAAwB,EAC5EgB,GAAQ,CAACA,EAAI,QAASA,EAAI,KAAMA,CAAG,CAAU,EAGnCC,GAA8CZ,EAAOO,EAAoB,EAEzEM,GAA8CC,GAAeC,GAAsBC,GAC9FC,EACE,CAACC,GAA4BF,EAAQ,WAAW,EAAGf,GAAwBe,EAAQ,OAAO,UAAU,CAAC,EACrG,CAACG,EAAMvB,KAAU,CACf,GAAGA,EACH,QAAAoB,EACA,KAAAG,GACA,CACH,ECzDI,IAAMC,GAAmEC,EAC9E,CAACC,GAAkBC,EAAa,EAAGD,GAAkBC,EAAa,EAAGD,GAAkBE,EAAqB,CAAC,EAC5GC,GAAO,CAACA,EAAG,eAAgBA,EAAG,cAAeA,EAAG,eAAe,CAAU,EAG/DC,GAA4DC,EAAOP,EAA2B,EAE9FQ,GAA4DC,EACvE,CAACC,GAAiBC,EAAY,EAAGD,GAAiBC,EAAY,EAAGD,GAAiBE,EAAoB,CAAC,EACvG,CAACC,EAAgBC,EAAeC,KAAqB,CAAE,eAAAF,EAAgB,cAAAC,EAAe,gBAAAC,CAAe,EAAG,ECFnG,IAAMC,GAAmDC,EAC9D,CAACC,GAAqBC,GAAkBC,EAAgB,EAAGC,EAAmBC,EAAa,EAC1FC,GAAM,CAACA,EAAE,aAAcA,EAAE,WAAYA,EAAE,gBAAiBA,EAAE,MAAM,CAAU,EAGhEC,GAA4CC,EAAOT,EAAmB,EAEtEU,GAA4CC,EACvD,CAACC,GAAoBC,GAAiBC,EAAe,EAAGC,EAAkBC,EAAY,EACtF,CAACC,EAAcC,EAAYC,EAAiBC,KAAY,CACtD,aAAAH,EACA,WAAAC,EACA,gBAAAC,EACA,OAAAC,GACA,EAOSC,GAA6CpB,EACxD,CAACD,GAAqBK,CAAiB,EACtCE,GAAM,CAACA,EAAGA,EAAE,SAAS,CAAU,EAGrBe,GAAsCb,EAAOY,EAAgB,EAE7DE,GAAsCZ,EACjD,CAACD,GAAoBK,CAAgB,EACrC,CAACS,EAAKC,KAAe,CACnB,GAAGD,EACH,UAAAC,GACA,ECvCG,IAAMC,GAAmFC,EAC9F,CAACC,GAAmBC,GAAsBC,CAAiB,EAC1DC,GAAU,CAACA,EAAM,WAAYA,EAAM,QAASA,EAAM,SAAS,CAAU,EAG3DC,GAA4EC,EACvFP,EAAmC,EAGxBQ,GAA4EC,GACvF,CAACC,GAAkBC,GAAqBC,CAAgB,EACxD,CAACC,EAAYC,EAASC,IAAa,CACjC,GAAID,EAAQ,cAAgB,SAC1B,MAAO,CACL,WAAAD,EACA,QAAAC,EACA,UAAAC,EAGN,CAAC,EChCG,SAAUC,GAAmBC,EAAa,CAC9C,GAAIA,EAAE,kBAAkB,YACtB,OAAIA,EAAE,aAAe,GAAKA,EAAE,aAAeA,EAAE,OAAO,WAC3CA,EAAE,OAEJA,EAAE,OAAO,MAAMA,EAAE,WAAYA,EAAE,WAAaA,EAAE,UAAU,EAC1D,CACL,IAAMC,EAAK,IAAI,YAAYD,EAAE,UAAU,EAEvC,OADY,IAAI,WAAWC,CAAE,EACzB,IAAID,EAAG,CAAC,EACLC,CACT,CACF,CAEM,SAAUC,GAAeF,EAAa,CAC1C,GAAIA,EAAE,kBAAkB,YAAa,OAAOA,EAC5C,IAAMC,EAAK,IAAI,YAAYD,EAAE,UAAU,EAEvC,OADY,IAAI,WAAWC,CAAE,EACzB,IAAID,EAAG,CAAC,EACLC,CACT,CAyBM,SAAUE,GAAkBC,EAAeC,EAAa,CAC5D,IAAMC,EAAS,IAAI,WAAWF,EAAE,OAASC,EAAE,MAAM,EACjD,OAAAC,EAAO,IAAIF,EAAG,CAAC,EACfE,EAAO,IAAID,EAAGD,EAAE,MAAM,EACfE,CACT,CCtCO,IAAMC,GAAmDC,EAC9D,CAACC,EAAmBC,GAAgBD,CAAiB,EAAGE,GAAkBC,EAAY,CAAC,EACtFC,GAAO,CAACA,EAAG,aAAcA,EAAG,WAAYA,EAAG,IAAI,CAAU,EAG/CC,GAA4CC,EAAOR,EAAmB,EAEtES,GAA4CC,EACvD,CAACC,EAAkBC,GAAeD,CAAgB,EAAGE,GAAiBC,EAAW,CAAC,EAClF,CAACC,EAAcC,EAAYC,KAAU,CAAE,aAAAF,EAAc,WAAAC,EAAY,KAAAC,CAAI,EAAG,ECJnE,IAAMC,GAAqEC,EAChF,CAACC,EAAmBC,EAAqB,EACxCC,GAAQ,CAACA,EAAI,UAAWA,EAAI,qBAAqB,CAAU,EAGjDC,GAA8DC,EAAON,EAA4B,EAEjGO,GAA8DC,EACzE,CAACC,EAAkBC,EAAoB,EACvC,CAACC,EAAWC,KAA2B,CAAE,UAAAD,EAAW,sBAAAC,CAAqB,EAAG,EASjEC,GAAyCZ,EACpD,CAACa,GAAoBC,GAAkBf,EAA4B,EAAGE,CAAiB,EACtFc,GAAY,CAACA,EAAQ,YAAaA,EAAQ,QAASA,EAAQ,kBAAkB,CAAU,EAG7EC,GAAkCX,EAAOO,EAAc,EAEvDK,GAAkCV,EAC7C,CAACW,GAAmBC,GAAiBb,EAA2B,EAAGE,CAAgB,EACnF,CAACY,EAAaC,EAASC,KAAwB,CAAE,YAAAF,EAAa,QAAAC,EAAS,mBAAAC,CAAkB,EAAG,ECNvF,IAAMC,GAAuDC,EAClE,CAACC,EAAmBC,GAAeC,GAAoBF,EAAmBA,EAAmBA,CAAiB,EAC7GG,GACC,CAACA,EAAI,QAASA,EAAI,MAAOA,EAAI,YAAaA,EAAI,kBAAmBA,EAAI,oBAAqBA,EAAI,UAAU,CAAU,EAGzGC,GAAgDC,EAAOP,EAAqB,EAE5EQ,GAAgDC,EAC3D,CAACC,EAAkBC,GAAcC,GAAmBF,EAAkBA,EAAkBA,CAAgB,EACxG,CAACG,EAASC,EAAOC,EAAaC,EAAmBC,EAAqBC,KAAgB,CACpF,QAAAL,EACA,MAAAC,EACA,YAAAC,EACA,kBAAAC,EACA,oBAAAC,EACA,WAAAC,GACA,EAUSC,GAA6DlB,EACxE,CAACC,EAAmBC,GAAeC,GAAoBF,CAAiB,EACvEkB,GAAQ,CAACA,EAAI,QAASA,EAAI,MAAOA,EAAI,YAAaA,EAAI,iBAAiB,CAAU,EAGvEC,GAAsDd,EAAOY,EAAwB,EAErFG,GAAsDb,EACjE,CAACC,EAAkBC,GAAcC,GAAmBF,CAAgB,EACpE,CAACG,EAASC,EAAOC,EAAaC,KAAuB,CACnD,QAAAH,EACA,MAAAC,EACA,YAAAC,EACA,kBAAAC,GACA,EC5EE,SAAUO,GAAaC,EAAkBC,EAAgB,CAC7D,MAAO,CACL,MAAM,OAAOC,EAAI,CACf,IAAMC,EAAS,MAAMH,EAAG,OAAOC,EAAGG,GAAeF,CAAI,CAAC,EACtD,OAAO,IAAI,WAAWC,CAAM,CAC9B,EACA,MAAM,IAAIE,EAAKH,EAAI,CACjB,IAAMC,EAAS,MAAMH,EAAG,KAAK,OAAQ,MAAMM,GAAaD,EAAKJ,CAAC,EAAGG,GAAeF,CAAI,CAAC,EACrF,OAAO,IAAI,WAAWC,CAAM,CAC9B,EACA,MAAM,UAAUE,EAAKE,EAAKL,EAAI,CAC5B,OAAOF,EAAG,OAAO,OAAQ,MAAMM,GAAaD,EAAKJ,CAAC,EAAGG,GAAeG,CAAG,EAAGH,GAAeF,CAAI,CAAC,CAChG,EAEJ,CACA,SAASI,GAAaE,EAAoBP,EAAgB,CACxD,OAAO,OAAO,OAAO,UACnB,MACAG,GAAeI,CAAM,EACrB,CACE,KAAM,OACN,KAAM,CAAE,KAAMP,CAAC,GAEjB,GACA,CAAC,OAAQ,QAAQ,CAAC,CAEtB,CCzBO,IAAMQ,GAAN,cAAwB,KAAM,CACjC,YAAYC,EAAG,CACX,IAAIC,EACAD,aAAa,MACbC,EAAUD,EAAE,QAEP,OAAOA,GAAM,SAClBC,EAAUD,EAGVC,EAAU,GAEd,MAAMA,CAAO,EACb,KAAK,KAAO,KAAK,YAAY,IACjC,CACJ,EAKaC,GAAN,cAAgCH,EAAU,CACjD,EAWO,IAAMI,GAAN,cAA6BC,EAAU,CAC9C,EAKaC,GAAN,cAA+BD,EAAU,CAChD,EAKaE,GAAN,cAAyBF,EAAU,CAC1C,EAKaG,GAAN,cAAyBH,EAAU,CAC1C,EAKaI,GAAN,cAA0BJ,EAAU,CAC3C,EAKaK,GAAN,cAAwBL,EAAU,CACzC,EAKaM,GAAN,cAAwBN,EAAU,CACzC,EAKaO,GAAN,cAAuCP,EAAU,CACxD,EAKaQ,GAAN,cAAiCR,EAAU,CAClD,EAKaS,GAAN,cAAgCT,EAAU,CACjD,EC3FA,IAAMU,GAAa,CAAC,EACPC,GAAgBC,GAAiB,WAAYF,EAAU,EACpE,SAASE,GAAiBC,EAASC,EAAQ,CACvC,OAAO,IAAI,MAAMD,EAAS,CACtB,IAAIE,EAASC,EAAMC,EAAW,CAC1B,OAAID,KAAQF,EACDA,EAAOE,CAAI,EAGXH,EAAQG,CAAI,CAE3B,EACA,IAAID,EAASC,EAAME,EAAO,CACtB,OAAIF,KAAQF,GACR,OAAOA,EAAOE,CAAI,EAEtBH,EAAQG,CAAI,EAAIE,EACT,EACX,EACA,eAAeH,EAASC,EAAM,CAC1B,IAAIG,EAAU,GACd,OAAIH,KAAQF,IACR,OAAOA,EAAOE,CAAI,EAClBG,EAAU,IAEVH,KAAQH,IACR,OAAOA,EAAQG,CAAI,EACnBG,EAAU,IAEPA,CACX,EACA,QAAQJ,EAAS,CACb,IAAMK,EAAW,QAAQ,QAAQP,CAAO,EAClCQ,EAAU,QAAQ,QAAQP,CAAM,EAChCQ,EAAa,IAAI,IAAID,CAAO,EAClC,MAAO,CAAC,GAAGD,EAAS,OAAQG,GAAM,CAACD,EAAW,IAAIC,CAAC,CAAC,EAAG,GAAGF,CAAO,CACrE,EACA,eAAeN,EAASC,EAAMQ,EAAM,CAChC,OAAIR,KAAQF,GACR,OAAOA,EAAOE,CAAI,EAEtB,QAAQ,eAAeH,EAASG,EAAMQ,CAAI,EACnC,EACX,EACA,yBAAyBT,EAASC,EAAM,CACpC,OAAIA,KAAQF,EACD,QAAQ,yBAAyBA,EAAQE,CAAI,EAG7C,QAAQ,yBAAyBH,EAASG,CAAI,CAE7D,EACA,IAAID,EAASC,EAAM,CACf,OAAOA,KAAQF,GAAUE,KAAQH,CACrC,CACJ,CAAC,CACL,CCtDA,eAAeY,IAAmB,CAC9B,GAAYC,KAAkB,QAAa,WAAW,SAAW,OAE7D,OAAO,WAAW,OAAO,OAG7B,GAAI,CAEA,GAAM,CAAE,UAAAC,CAAU,EAAI,KAAM,QAAO,QAAQ,EAC3C,OAAOA,EAAU,MACrB,OACO,EAAG,CACN,MAAM,IAAIC,GAAkB,CAAC,CACjC,CACJ,CACO,IAAMC,GAAN,KAAsB,CACzB,aAAc,CACV,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,CACL,CACA,MAAM,QAAS,CACP,KAAK,OAAS,SAGlB,KAAK,KAAO,MAAMJ,GAAiB,EACvC,CACJ,EC7BO,IAAMK,GAAO,CAChB,KAAM,EACN,IAAK,EACL,KAAM,EACN,QAAS,CACb,EAIaC,GAAQ,CACjB,YAAa,EACb,oBAAqB,GACrB,oBAAqB,GACrB,oBAAqB,GACrB,yBAA0B,GAC1B,sBAAuB,GACvB,oBAAqB,GACrB,wBAAyB,GACzB,SAAU,GACV,SAAU,GACV,UAAW,GACX,MAAO,KACX,EAIaC,GAAQ,CACjB,WAAY,EACZ,WAAY,EACZ,WAAY,CAChB,EAIaC,GAAS,CAClB,UAAW,EACX,UAAW,EACX,iBAAkB,EAClB,WAAY,KAChB,ECpCO,IAAMC,GAAQ,IAAI,WAAW,CAAC,ECL9B,IAAMC,GAAsB,IAAI,WAAW,CAC9C,GACA,GACA,GACA,EACA,CACJ,CAAC,ECaM,IAAMC,GAAmBC,GAAM,OAAOA,GAAM,UAC/CA,IAAM,MACN,OAAOA,EAAE,YAAe,UACxB,OAAOA,EAAE,WAAc,SAIpB,SAASC,GAAMC,EAAGC,EAAG,CACxB,GAAIA,GAAK,EACL,MAAM,IAAI,MAAM,uBAAuB,EAE3C,GAAID,GAAK,KAAOC,EACZ,MAAM,IAAI,MAAM,0BAA0B,EAE9C,IAAMC,EAAM,IAAI,WAAWD,CAAC,EAC5B,QAASE,EAAI,EAAGA,EAAIF,GAAKD,EAAGG,IACxBD,EAAID,GAAKE,EAAI,EAAE,EAAIH,EAAI,IACvBA,EAAIA,GAAK,EAEb,OAAOE,CACX,CAOO,SAASE,GAAOC,EAAGC,EAAG,CACzB,IAAMJ,EAAM,IAAI,WAAWG,EAAE,OAASC,EAAE,MAAM,EAC9C,OAAAJ,EAAI,IAAIG,EAAG,CAAC,EACZH,EAAI,IAAII,EAAGD,EAAE,MAAM,EACZH,CACX,CAMO,SAASK,GAAiBC,EAAG,CAChC,IAAMC,EAASD,EAAE,QAAQ,KAAM,GAAG,EAAE,QAAQ,KAAM,GAAG,EAC/CE,EAAa,KAAKD,CAAM,EACxBP,EAAM,IAAI,WAAWQ,EAAW,MAAM,EAC5C,QAASP,EAAI,EAAGA,EAAIO,EAAW,OAAQP,IACnCD,EAAIC,CAAC,EAAIO,EAAW,WAAWP,CAAC,EAEpC,OAAOD,CACX,CAoGO,SAASS,GAAIC,EAAGC,EAAG,CACtB,GAAID,EAAE,aAAeC,EAAE,WACnB,MAAM,IAAI,MAAM,8BAA8B,EAElD,IAAMC,EAAM,IAAI,WAAWF,EAAE,UAAU,EACvC,QAASG,EAAI,EAAGA,EAAIH,EAAE,WAAYG,IAC9BD,EAAIC,CAAC,EAAIH,EAAEG,CAAC,EAAIF,EAAEE,CAAC,EAEvB,OAAOD,CACX,CC1KA,IAAME,GAAgB,IAAI,WAAW,CAAC,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,GAAG,CAAC,EAGhEC,GAAsB,IAAI,WAAW,CACvC,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,GAC3C,IAAK,IAAK,GACd,CAAC,EACD,SAASC,GAAQC,EAAGC,EAAGC,EAAG,CACtB,IAAMC,EAAM,IAAI,WAAWH,EAAE,OAASC,EAAE,OAASC,EAAE,MAAM,EACzD,OAAAC,EAAI,IAAIH,EAAG,CAAC,EACZG,EAAI,IAAIF,EAAGD,EAAE,MAAM,EACnBG,EAAI,IAAID,EAAGF,EAAE,OAASC,EAAE,MAAM,EACvBE,CACX,CACO,IAAMC,GAAN,KAAY,CACf,YAAYC,EAAIC,EAAMC,EAAK,CACvB,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,aAAc,CACtC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,CACX,CAAC,EACD,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,CACX,CAAC,EACD,OAAO,eAAe,KAAM,gBAAiB,CACzC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,CACX,CAAC,EACD,OAAO,eAAe,KAAM,iBAAkB,CAC1C,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,CACX,CAAC,EACD,OAAO,eAAe,KAAM,QAAS,CACjC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,KAAK,GAAKF,EACV,KAAK,MAAQC,EACb,KAAK,KAAOC,EACZ,IAAMC,EAAU,IAAI,WAAWC,EAAmB,EAClDD,EAAQ,IAAIE,GAAM,KAAK,GAAI,CAAC,EAAG,CAAC,EAChC,KAAK,KAAK,KAAKF,CAAO,CAC1B,CACA,MAAM,mBAAmBG,EAAK,CAC1B,OAAO,MAAM,KAAK,MAAM,mBAAmBA,CAAG,CAClD,CACA,MAAM,qBAAqBA,EAAK,CAC5B,OAAO,MAAM,KAAK,MAAM,qBAAqBA,CAAG,CACpD,CACA,MAAM,oBAAoBA,EAAK,CAC3B,OAAO,MAAM,KAAK,MAAM,oBAAoBA,CAAG,CACnD,CACA,MAAM,sBAAsBA,EAAK,CAC7B,OAAO,MAAM,KAAK,MAAM,sBAAsBA,CAAG,CACrD,CACA,MAAM,UAAUC,EAAQD,EAAKE,EAAW,GAAM,CAC1C,OAAO,MAAM,KAAK,MAAM,UAAUD,EAAQD,EAAKE,CAAQ,CAC3D,CACA,MAAM,iBAAkB,CACpB,OAAO,MAAM,KAAK,MAAM,gBAAgB,CAC5C,CACA,MAAM,cAAcC,EAAK,CACrB,GAAIA,EAAI,WAAa,KACjB,MAAM,IAAIC,GAAkB,cAAc,EAE9C,OAAO,MAAM,KAAK,MAAM,cAAcD,CAAG,CAC7C,CACA,MAAM,MAAME,EAAQ,CAChB,IAAIC,EACAD,EAAO,MAAQ,OACfC,EAAK,MAAM,KAAK,gBAAgB,EAE3BC,GAAgBF,EAAO,GAAG,EAE/BC,EAAKD,EAAO,IAIZC,EAAK,MAAM,KAAK,cAAcD,EAAO,GAAG,EAE5C,IAAMG,EAAM,MAAM,KAAK,MAAM,mBAAmBF,EAAG,SAAS,EACtDG,EAAO,MAAM,KAAK,MAAM,mBAAmBJ,EAAO,kBAAkB,EAC1E,GAAI,CACA,IAAIK,EACJ,GAAIL,EAAO,YAAc,OACrBK,EAAK,IAAI,WAAW,MAAM,KAAK,MAAM,GAAGJ,EAAG,WAAYD,EAAO,kBAAkB,CAAC,MAEhF,CACD,IAAMM,EAAMJ,GAAgBF,EAAO,SAAS,EACtCA,EAAO,UAAU,WACjBA,EAAO,UACPO,EAAM,IAAI,WAAW,MAAM,KAAK,MAAM,GAAGN,EAAG,WAAYD,EAAO,kBAAkB,CAAC,EAClFQ,EAAM,IAAI,WAAW,MAAM,KAAK,MAAM,GAAGF,EAAKN,EAAO,kBAAkB,CAAC,EAC9EK,EAAKI,GAAOF,EAAKC,CAAG,CACxB,CACA,IAAIE,EACJ,GAAIV,EAAO,YAAc,OACrBU,EAAaD,GAAO,IAAI,WAAWN,CAAG,EAAG,IAAI,WAAWC,CAAI,CAAC,MAE5D,CACD,IAAMO,EAAMT,GAAgBF,EAAO,SAAS,EACtCA,EAAO,UAAU,UACjB,MAAM,KAAK,MAAM,gBAAgBA,EAAO,SAAS,EACjDY,EAAO,MAAM,KAAK,MAAM,mBAAmBD,CAAG,EACpDD,EAAa3B,GAAQ,IAAI,WAAWoB,CAAG,EAAG,IAAI,WAAWC,CAAI,EAAG,IAAI,WAAWQ,CAAI,CAAC,CACxF,CACA,IAAMC,EAAe,MAAM,KAAK,sBAAsBR,EAAIK,CAAU,EACpE,MAAO,CACH,IAAKP,EACL,aAAcU,CAClB,CACJ,OACOC,EAAG,CACN,MAAM,IAAIC,GAAWD,CAAC,CAC1B,CACJ,CACA,MAAM,MAAMd,EAAQ,CAChB,IAAMgB,EAAM,MAAM,KAAK,MAAM,qBAAqBhB,EAAO,GAAG,EACtDiB,EAAMf,GAAgBF,EAAO,YAAY,EACzCA,EAAO,aAAa,WACpBA,EAAO,aACPkB,EAAMhB,GAAgBF,EAAO,YAAY,EACzCA,EAAO,aAAa,UACpB,MAAM,KAAK,MAAM,gBAAgBA,EAAO,YAAY,EACpDI,EAAO,MAAM,KAAK,MAAM,mBAAmBc,CAAG,EACpD,GAAI,CACA,IAAIb,EACJ,GAAIL,EAAO,kBAAoB,OAC3BK,EAAK,IAAI,WAAW,MAAM,KAAK,MAAM,GAAGY,EAAKD,CAAG,CAAC,MAEhD,CACD,IAAMT,EAAM,IAAI,WAAW,MAAM,KAAK,MAAM,GAAGU,EAAKD,CAAG,CAAC,EAClDR,EAAM,IAAI,WAAW,MAAM,KAAK,MAAM,GAAGS,EAAKjB,EAAO,eAAe,CAAC,EAC3EK,EAAKI,GAAOF,EAAKC,CAAG,CACxB,CACA,IAAIE,EACJ,GAAIV,EAAO,kBAAoB,OAC3BU,EAAaD,GAAO,IAAI,WAAWT,EAAO,GAAG,EAAG,IAAI,WAAWI,CAAI,CAAC,MAEnE,CACD,IAAMQ,EAAO,MAAM,KAAK,MAAM,mBAAmBZ,EAAO,eAAe,EACvEU,EAAa,IAAI,WAAWV,EAAO,IAAI,WAAaI,EAAK,WAAaQ,EAAK,UAAU,EACrFF,EAAW,IAAI,IAAI,WAAWV,EAAO,GAAG,EAAG,CAAC,EAC5CU,EAAW,IAAI,IAAI,WAAWN,CAAI,EAAGJ,EAAO,IAAI,UAAU,EAC1DU,EAAW,IAAI,IAAI,WAAWE,CAAI,EAAGZ,EAAO,IAAI,WAAaI,EAAK,UAAU,CAChF,CACA,OAAO,MAAM,KAAK,sBAAsBC,EAAIK,CAAU,CAC1D,OACOI,EAAG,CACN,MAAM,IAAIK,GAAWL,CAAC,CAC1B,CACJ,CACA,MAAM,sBAAsBT,EAAIK,EAAY,CACxC,IAAMU,EAAa,KAAK,KAAK,gBAAgBvC,GAAewB,CAAE,EACxDgB,EAAc,KAAK,KAAK,iBAAiBvC,GAAqB4B,EAAY,KAAK,UAAU,EAC/F,OAAO,MAAM,KAAK,KAAK,iBAAiBY,GAAM,OAAQF,EAAW,OAAQC,EAAY,OAAQ,KAAK,UAAU,CAChH,CACJ,ECvLO,IAAME,GAAa,CAAC,YAAY,EAE1BC,GAAgB,IAAI,WAAW,CACxC,IACA,IACA,IACA,GACA,IACA,IACA,GACJ,CAAC,EAEYC,GAAW,IAAI,WAAW,CAAC,IAAK,GAAG,CAAC,ECV1C,IAAMC,GAAN,KAAa,CAChB,YAAYC,EAAM,CACd,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,KAAK,KAAO,IAAI,WAAWA,CAAI,CACnC,CACA,KAAM,CACF,OAAO,KAAK,IAChB,CACA,OAAQ,CACJ,KAAK,KAAK,KAAK,CAAC,CACpB,CACA,IAAIC,EAAK,CACL,GAAIA,EAAI,SAAW,KAAK,KAAK,OACzB,MAAM,IAAI,MAAM,8BAA8B,EAElD,KAAK,KAAK,IAAIA,CAAG,CACrB,CACA,QAAS,CACL,QAASC,EAAI,EAAGA,EAAI,KAAK,KAAK,OAAQA,IAClC,GAAI,KAAK,KAAKA,CAAC,IAAM,EACjB,MAAO,GAGf,MAAO,EACX,CACA,SAASC,EAAG,CACR,GAAIA,EAAE,SAAW,KAAK,KAAK,OACvB,MAAM,IAAI,MAAM,mCAAmC,EAEvD,QAASD,EAAI,EAAGA,EAAI,KAAK,KAAK,OAAQA,IAAK,CACvC,GAAI,KAAK,KAAKA,CAAC,EAAIC,EAAED,CAAC,EAClB,MAAO,GAEX,GAAI,KAAK,KAAKA,CAAC,EAAIC,EAAED,CAAC,EAClB,MAAO,EAEf,CACA,MAAO,EACX,CACJ,ECtCA,IAAME,GAAkB,IAAI,WAAW,CACnC,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,GACzC,CAAC,EAGKC,GAAc,IAAI,WAAW,CAC/B,IAAM,IAAM,IAAM,IAAM,EAAM,EAAM,EAAM,EAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,EAC9C,CAAC,EAEKC,GAAc,IAAI,WAAW,CAC/B,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,GAAM,IAC1C,GAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,GAC9C,CAAC,EAEKC,GAAc,IAAI,WAAW,CAC/B,EAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAC1C,IAAM,IAAM,IAAM,IAAM,EAAM,GAAM,IAAM,EAC1C,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAC1C,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAC1C,IAAM,CACV,CAAC,EAEKC,GAAqB,IAAI,WAAW,CACtC,GAAI,GAAI,EAAG,EAAG,EAAG,GAAI,GAAI,EAAG,EAAG,GAC/B,IAAK,GAAI,IAAK,GAAI,EAAG,EAAG,EAAG,EAAG,GAAI,IAClC,GAAI,IAAK,GAAI,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GACjC,EAAG,EAAG,EAAG,EAAG,EAChB,CAAC,EAEKC,GAAqB,IAAI,WAAW,CACtC,GAAI,GAAI,EAAG,EAAG,EAAG,GAAI,GAAI,EAAG,EAAG,GAC/B,IAAK,GAAI,IAAK,GAAI,EAAG,EAAG,EAAG,EAAG,GAAI,IAClC,EAAG,EAAG,GAAI,EAAG,GAAI,GAAI,GAAI,EAAG,EAAG,EAC/B,EAAG,EACP,CAAC,EAEKC,GAAqB,IAAI,WAAW,CACtC,GAAI,GAAI,EAAG,EAAG,EAAG,GAAI,GAAI,EAAG,EAAG,GAC/B,IAAK,GAAI,IAAK,GAAI,EAAG,EAAG,EAAG,EAAG,GAAI,IAClC,EAAG,EAAG,GAAI,EAAG,GAAI,GAAI,GAAI,EAAG,EAAG,EAC/B,EAAG,EACP,CAAC,EACYC,GAAN,cAAiBC,EAAgB,CACpC,YAAYC,EAAKC,EAAM,CAoDnB,OAnDA,MAAM,EACN,OAAO,eAAe,KAAM,QAAS,CACjC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EAED,OAAO,eAAe,KAAM,SAAU,CAClC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,WAAY,CACpC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,cAAe,CACvC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,KAAK,MAAQA,EACLD,EAAK,CACT,KAAKE,GAAM,oBACP,KAAK,KAAO,CAAE,KAAM,OAAQ,WAAY,OAAQ,EAChD,KAAK,KAAO,GACZ,KAAK,KAAO,GACZ,KAAK,KAAO,GACZ,KAAK,OAASV,GACd,KAAK,SAAW,IAChB,KAAK,YAAcG,GACnB,MACJ,KAAKO,GAAM,oBACP,KAAK,KAAO,CAAE,KAAM,OAAQ,WAAY,OAAQ,EAChD,KAAK,KAAO,GACZ,KAAK,KAAO,GACZ,KAAK,KAAO,GACZ,KAAK,OAAST,GACd,KAAK,SAAW,IAChB,KAAK,YAAcG,GACnB,MACJ,QAEI,KAAK,KAAO,CAAE,KAAM,OAAQ,WAAY,OAAQ,EAChD,KAAK,KAAO,IACZ,KAAK,KAAO,GACZ,KAAK,KAAO,GACZ,KAAK,OAASF,GACd,KAAK,SAAW,EAChB,KAAK,YAAcG,GACnB,KACR,CACJ,CACA,MAAM,mBAAmBM,EAAK,CAC1B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,KAAK,UAAU,MAAOA,CAAG,CAC/C,OACOC,EAAG,CACN,MAAM,IAAIC,GAAeD,CAAC,CAC9B,CACJ,CACA,MAAM,qBAAqBD,EAAK,CAC5B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,cAAcA,EAAK,EAAI,CAC7C,OACOC,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,oBAAoBD,EAAK,CAC3B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,IAAMI,EAAM,MAAM,KAAK,KAAK,UAAU,MAAOJ,CAAG,EAChD,GAAI,EAAE,MAAOI,GACT,MAAM,IAAI,MAAM,iBAAiB,EAErC,OAAOC,GAAiBD,EAAI,CAAI,EAAE,MACtC,OACOH,EAAG,CACN,MAAM,IAAIC,GAAeD,CAAC,CAC9B,CACJ,CACA,MAAM,sBAAsBD,EAAK,CAC7B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,cAAcA,EAAK,EAAK,CAC9C,OACOC,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,UAAUK,EAAQN,EAAKO,EAAU,CACnC,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,GAAID,IAAW,MACX,OAAO,MAAM,KAAK,cAAcN,EAAKO,CAAQ,EAGjD,GAAIP,aAAe,YACf,MAAM,IAAI,MAAM,wBAAwB,EAE5C,OAAO,MAAM,KAAK,WAAWA,EAAKO,CAAQ,CAC9C,OACON,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,iBAAkB,CACpB,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,KAAK,YAAY,KAAK,KAAM,GAAMO,EAAU,CAClE,OACOP,EAAG,CACN,MAAM,IAAIQ,GAAkBR,CAAC,CACjC,CACJ,CACA,MAAM,cAAcS,EAAK,CACrB,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,IAAMC,EAAS,MAAM,KAAK,MAAM,eAAeC,GAAM,OAAQC,GAAe,IAAI,WAAWH,CAAG,CAAC,EACzFI,EAAK,IAAIC,GAAO,KAAK,IAAI,EAC/B,QAASC,EAAU,EAAGF,EAAG,OAAO,GAAK,CAACA,EAAG,SAAS,KAAK,MAAM,EAAGE,IAAW,CACvE,GAAIA,EAAU,IACV,MAAM,IAAI,MAAM,4BAA4B,EAEhD,IAAMC,EAAQ,IAAI,WAAW,MAAM,KAAK,MAAM,cAAcN,EAAQvB,GAAiB8B,GAAMF,EAAS,CAAC,EAAG,KAAK,IAAI,CAAC,EAClHC,EAAM,CAAC,EAAIA,EAAM,CAAC,EAAI,KAAK,SAC3BH,EAAG,IAAIG,CAAK,CAChB,CACA,IAAME,EAAK,MAAM,KAAK,qBAAqBL,EAAG,IAAI,CAAC,EACnD,OAAAA,EAAG,MAAM,EACF,CACH,WAAYK,EACZ,UAAW,MAAM,KAAK,gBAAgBA,CAAE,CAC5C,CACJ,OACOlB,EAAG,CACN,MAAM,IAAImB,GAAmBnB,CAAC,CAClC,CACJ,CACA,MAAM,gBAAgBD,EAAK,CACvB,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,IAAMI,EAAM,MAAM,KAAK,KAAK,UAAU,MAAOJ,CAAG,EAChD,cAAOI,EAAI,EACX,OAAOA,EAAI,QACJ,MAAM,KAAK,KAAK,UAAU,MAAOA,EAAK,KAAK,KAAM,GAAM,CAAC,CAAC,CACpE,OACOH,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,GAAGkB,EAAIE,EAAI,CACb,GAAI,CACA,aAAM,KAAK,OAAO,EACL,MAAM,KAAK,KAAK,WAAW,CACpC,KAAM,OACN,OAAQA,CACZ,EAAGF,EAAI,KAAK,KAAO,CAAC,CAExB,OACOlB,EAAG,CACN,MAAM,IAAIC,GAAeD,CAAC,CAC9B,CACJ,CACA,MAAM,cAAcD,EAAKO,EAAU,CAC/B,GAAIA,GAAYP,EAAI,aAAe,KAAK,KACpC,MAAM,IAAI,MAAM,wCAAwC,EAE5D,GAAI,CAACO,GAAYP,EAAI,aAAe,KAAK,KACrC,MAAM,IAAI,MAAM,yCAAyC,EAE7D,OAAIO,EACO,MAAM,KAAK,KAAK,UAAU,MAAOP,EAAK,KAAK,KAAM,GAAM,CAAC,CAAC,EAE7D,MAAM,KAAK,qBAAqB,IAAI,WAAWA,CAAG,CAAC,CAC9D,CACA,MAAM,WAAWA,EAAKO,EAAU,CAC5B,GAAI,OAAOP,EAAI,IAAQ,KAAeA,EAAI,MAAQ,KAAK,KAAK,WACxD,MAAM,IAAI,MAAM,gBAAgBA,EAAI,GAAG,EAAE,EAE7C,GAAIO,EAAU,CACV,GAAI,OAAOP,EAAI,EAAM,IACjB,MAAM,IAAI,MAAM,oCAAoC,EAExD,OAAO,MAAM,KAAK,KAAK,UAAU,MAAOA,EAAK,KAAK,KAAM,GAAM,CAAC,CAAC,CACpE,CACA,GAAI,OAAOA,EAAI,EAAM,IACjB,MAAM,IAAI,MAAM,4BAA4B,EAEhD,OAAO,MAAM,KAAK,KAAK,UAAU,MAAOA,EAAK,KAAK,KAAM,GAAMQ,EAAU,CAC5E,CACA,MAAM,qBAAqBc,EAAG,CAC1B,IAAMC,EAAW,IAAI,WAAW,KAAK,YAAY,OAASD,EAAE,MAAM,EAClE,OAAAC,EAAS,IAAI,KAAK,YAAa,CAAC,EAChCA,EAAS,IAAID,EAAG,KAAK,YAAY,MAAM,EAChC,MAAM,KAAK,KAAK,UAAU,QAASC,EAAU,KAAK,KAAM,GAAMf,EAAU,CACnF,CACJ,EChSA,IAAMgB,GAAe,IAAI,WAAW,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IAAK,EAAE,CAAC,EACpDC,GAAN,cAAyBC,EAAgB,CAC5C,aAAc,CACV,MAAM,EACN,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOC,GAAM,UACjB,CAAC,EACD,OAAO,eAAe,KAAM,WAAY,CACpC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,CACX,CAAC,EACD,OAAO,eAAe,KAAM,WAAY,CACpC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOC,EACX,CAAC,EACD,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,CACH,KAAM,OACN,KAAM,UACN,OAAQ,GACZ,CACJ,CAAC,CACL,CACA,KAAKC,EAAS,CACV,KAAK,SAAWA,CACpB,CACA,gBAAgBC,EAAOC,EAAK,CACxB,KAAK,WAAW,EAChB,IAAMC,EAAM,IAAI,WAAW,EAAI,KAAK,SAAS,WAAaF,EAAM,WAAaC,EAAI,UAAU,EAC3F,OAAAC,EAAI,IAAIR,GAAc,CAAC,EACvBQ,EAAI,IAAI,KAAK,SAAU,CAAC,EACxBA,EAAI,IAAIF,EAAO,EAAI,KAAK,SAAS,UAAU,EAC3CE,EAAI,IAAID,EAAK,EAAI,KAAK,SAAS,WAAaD,EAAM,UAAU,EACrDE,CACX,CACA,iBAAiBF,EAAOG,EAAMC,EAAK,CAC/B,KAAK,WAAW,EAChB,IAAMF,EAAM,IAAI,WAAW,EAAI,KAAK,SAAS,WAAaF,EAAM,WAAaG,EAAK,UAAU,EAC5F,OAAAD,EAAI,IAAI,IAAI,WAAW,CAAC,EAAGE,CAAG,CAAC,EAAG,CAAC,EACnCF,EAAI,IAAIR,GAAc,CAAC,EACvBQ,EAAI,IAAI,KAAK,SAAU,CAAC,EACxBA,EAAI,IAAIF,EAAO,EAAI,KAAK,SAAS,UAAU,EAC3CE,EAAI,IAAIC,EAAM,EAAI,KAAK,SAAS,WAAaH,EAAM,UAAU,EACtDE,CACX,CACA,MAAM,QAAQG,EAAMJ,EAAK,CAKrB,GAJA,MAAM,KAAK,OAAO,EACdI,EAAK,aAAe,IACpBA,EAAO,IAAI,YAAY,KAAK,QAAQ,GAEpCA,EAAK,aAAe,KAAK,SACzB,MAAM,IAAIC,GAAkB,kDAAkD,EAElF,IAAMC,EAAM,MAAM,KAAK,KAAK,UAAU,MAAOF,EAAM,KAAK,QAAS,GAAO,CACpE,MACJ,CAAC,EACD,OAAO,MAAM,KAAK,KAAK,KAAK,OAAQE,EAAKN,CAAG,CAChD,CACA,MAAM,OAAOO,EAAKL,EAAMC,EAAK,CACzB,MAAM,KAAK,OAAO,EAClB,IAAMG,EAAM,MAAM,KAAK,KAAK,UAAU,MAAOC,EAAK,KAAK,QAAS,GAAO,CACnE,MACJ,CAAC,EACKC,EAAM,IAAI,YAAYL,CAAG,EACzBM,EAAI,IAAI,WAAWD,CAAG,EACxBE,EAAOb,GACLc,EAAM,IAAI,WAAWT,CAAI,EACzBU,EAAO,IAAI,WAAW,CAAC,EAC7B,GAAIT,EAAM,IAAM,KAAK,SACjB,MAAM,IAAI,MAAM,uBAAuB,EAE3C,IAAMU,EAAM,IAAI,WAAW,KAAK,SAAWF,EAAI,OAAS,CAAC,EACzD,QAASG,EAAI,EAAGC,EAAM,EAAGA,EAAMN,EAAE,OAAQK,IACrCF,EAAK,CAAC,EAAIE,EACVD,EAAI,IAAIH,EAAM,CAAC,EACfG,EAAI,IAAIF,EAAKD,EAAK,MAAM,EACxBG,EAAI,IAAID,EAAMF,EAAK,OAASC,EAAI,MAAM,EACtCD,EAAO,IAAI,WAAW,MAAM,KAAK,KAAK,KAAK,OAAQJ,EAAKO,EAAI,MAAM,EAAGH,EAAK,OAASC,EAAI,OAAS,CAAC,CAAC,CAAC,EAC/FF,EAAE,OAASM,GAAOL,EAAK,QACvBD,EAAE,IAAIC,EAAMK,CAAG,EACfA,GAAOL,EAAK,SAGZD,EAAE,IAAIC,EAAK,MAAM,EAAGD,EAAE,OAASM,CAAG,EAAGA,CAAG,EACxCA,GAAON,EAAE,OAASM,GAG1B,OAAOP,CACX,CACA,MAAM,iBAAiBJ,EAAMJ,EAAKE,EAAMC,EAAK,CACzC,MAAM,KAAK,OAAO,EAClB,IAAMa,EAAU,MAAM,KAAK,KAAK,UAAU,MAAOhB,EAAK,OAAQ,GAAO,CAAC,YAAY,CAAC,EACnF,OAAO,MAAM,KAAK,KAAK,WAAW,CAC9B,KAAM,OACN,KAAM,KAAK,QAAQ,KACnB,KAAMI,EACN,KAAMF,CACV,EAAGc,EAASb,EAAM,CAAC,CACvB,CACA,MAAM,eAAeC,EAAML,EAAOC,EAAK,CACnC,OAAO,MAAM,KAAK,QAAQI,EAAM,KAAK,gBAAgBL,EAAOC,CAAG,EAAE,MAAM,CAC3E,CACA,MAAM,cAAcO,EAAKR,EAAOG,EAAMC,EAAK,CACvC,OAAO,MAAM,KAAK,OAAOI,EAAK,KAAK,iBAAiBR,EAAOG,EAAMC,CAAG,EAAE,OAAQA,CAAG,CACrF,CACA,YAAa,CACT,GAAI,KAAK,WAAaN,GAClB,MAAM,IAAI,MAAM,8BAA8B,CAEtD,CACJ,EACaoB,GAAN,cAA+BvB,EAAW,CAC7C,aAAc,CACV,MAAM,GAAG,SAAS,EAElB,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOE,GAAM,UACjB,CAAC,EAED,OAAO,eAAe,KAAM,WAAY,CACpC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,CACH,KAAM,OACN,KAAM,UACN,OAAQ,GACZ,CACJ,CAAC,CACL,CACJ,EACasB,GAAN,cAA+BxB,EAAW,CAC7C,aAAc,CACV,MAAM,GAAG,SAAS,EAElB,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOE,GAAM,UACjB,CAAC,EAED,OAAO,eAAe,KAAM,WAAY,CACpC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,CACH,KAAM,OACN,KAAM,UACN,OAAQ,GACZ,CACJ,CAAC,CACL,CACJ,EACauB,GAAN,cAA+BzB,EAAW,CAC7C,aAAc,CACV,MAAM,GAAG,SAAS,EAElB,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOE,GAAM,UACjB,CAAC,EAED,OAAO,eAAe,KAAM,WAAY,CACpC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,CACH,KAAM,OACN,KAAM,UACN,OAAQ,GACZ,CACJ,CAAC,CACL,CACJ,ECtNO,IAAMwB,GAAc,CAAC,UAAW,SAAS,ECezC,SAASC,GAAQC,EAAG,CACvB,OAAOA,aAAa,YACf,YAAY,OAAOA,CAAC,GAAKA,EAAE,YAAY,OAAS,YACzD,CAEO,SAASC,GAAOC,EAAOC,EAAQC,EAAQ,GAAI,CAC9C,IAAMC,EAAQN,GAAQG,CAAK,EACrBI,EAAMJ,GAAO,OACbK,EAAWJ,IAAW,OAC5B,GAAI,CAACE,GAAUE,GAAYD,IAAQH,EAAS,CACxC,IAAMK,EAASJ,GAAS,IAAIA,CAAK,KAC3BK,EAAQF,EAAW,cAAcJ,CAAM,GAAK,GAC5CO,EAAML,EAAQ,UAAUC,CAAG,GAAK,QAAQ,OAAOJ,CAAK,GAC1D,MAAM,IAAI,MAAMM,EAAS,sBAAwBC,EAAQ,SAAWC,CAAG,CAC3E,CACA,OAAOR,CACX,CAEO,SAASS,GAAMC,EAAG,CACrB,GAAI,OAAOA,GAAM,YAAc,OAAOA,EAAE,QAAW,WAC/C,MAAM,IAAI,MAAM,yCAAyC,EAE7DC,GAAQD,EAAE,SAAS,EACnBC,GAAQD,EAAE,QAAQ,CACtB,CAEO,SAASE,GAAQC,EAAUC,EAAgB,GAAM,CACpD,GAAID,EAAS,UACT,MAAM,IAAI,MAAM,kCAAkC,EACtD,GAAIC,GAAiBD,EAAS,SAC1B,MAAM,IAAI,MAAM,uCAAuC,CAE/D,CAUO,SAASE,GAAQC,EAAG,CACvB,GAAI,CAAC,OAAO,cAAcA,CAAC,GAAKA,EAAI,EAChC,MAAM,IAAI,MAAM,kCAAoCA,CAAC,CAE7D,CAYO,SAASC,MAASC,EAAQ,CAC7B,QAASC,EAAI,EAAGA,EAAID,EAAO,OAAQC,IAC/BD,EAAOC,CAAC,EAAE,KAAK,CAAC,CAExB,CChEO,IAAMC,GAAN,KAAY,CACf,YAAYC,EAAMC,EAAK,CAwCnB,GAvCA,OAAO,eAAe,KAAM,QAAS,CACjC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,QAAS,CACjC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,WAAY,CACpC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,YAAa,CACrC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,WAAY,CACpC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EACD,OAAO,eAAe,KAAM,YAAa,CACrC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EACDC,GAAMF,CAAI,EACVG,GAAOF,EAAK,OAAW,KAAK,EAC5B,KAAK,MAAQD,EAAK,OAAO,EACrB,OAAO,KAAK,MAAM,QAAW,WAC7B,MAAM,IAAI,MAAM,qDAAqD,EAEzE,KAAK,SAAW,KAAK,MAAM,SAC3B,KAAK,UAAY,KAAK,MAAM,UAC5B,IAAMI,EAAW,KAAK,SAChBC,EAAM,IAAI,WAAWD,CAAQ,EAEnCC,EAAI,IAAIJ,EAAI,OAASG,EAAWJ,EAAK,OAAO,EAAE,OAAOC,CAAG,EAAE,OAAO,EAAIA,CAAG,EACxE,QAAS,EAAI,EAAG,EAAII,EAAI,OAAQ,IAC5BA,EAAI,CAAC,GAAK,GACd,KAAK,MAAM,OAAOA,CAAG,EAErB,KAAK,MAAQL,EAAK,OAAO,EAEzB,QAAS,EAAI,EAAG,EAAIK,EAAI,OAAQ,IAC5BA,EAAI,CAAC,GAAK,IACd,KAAK,MAAM,OAAOA,CAAG,EACrBC,GAAMD,CAAG,CACb,CACA,OAAOE,EAAK,CACR,OAAAC,GAAQ,IAAI,EACZ,KAAK,MAAM,OAAOD,CAAG,EACd,IACX,CACA,WAAWE,EAAK,CACZD,GAAQ,IAAI,EACZL,GAAOM,EAAK,KAAK,UAAW,QAAQ,EACpC,KAAK,SAAW,GAChB,KAAK,MAAM,WAAWA,CAAG,EACzB,KAAK,MAAM,OAAOA,CAAG,EACrB,KAAK,MAAM,WAAWA,CAAG,EACzB,KAAK,QAAQ,CACjB,CACA,QAAS,CACL,IAAMA,EAAM,IAAI,WAAW,KAAK,MAAM,SAAS,EAC/C,YAAK,WAAWA,CAAG,EACZA,CACX,CACA,WAAWC,EAAI,CAEXA,IAAO,OAAO,OAAO,OAAO,eAAe,IAAI,EAAG,CAAC,CAAC,EACpD,GAAM,CAAE,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,EAAW,SAAAV,EAAU,UAAAW,CAAU,EAAI,KACnE,OAAAL,EAAKA,EACLA,EAAG,SAAWG,EACdH,EAAG,UAAYI,EACfJ,EAAG,SAAWN,EACdM,EAAG,UAAYK,EACfL,EAAG,MAAQC,EAAM,WAAWD,EAAG,KAAK,EACpCA,EAAG,MAAQE,EAAM,WAAWF,EAAG,KAAK,EAC7BA,CACX,CACA,OAAQ,CACJ,OAAO,KAAK,WAAW,CAC3B,CACA,SAAU,CACN,KAAK,UAAY,GACjB,KAAK,MAAM,QAAQ,EACnB,KAAK,MAAM,QAAQ,CACvB,CACJ,EAWaM,GAAO,CAAChB,EAAMC,EAAKgB,IAAY,IAAIlB,GAAMC,EAAMC,CAAG,EAAE,OAAOgB,CAAO,EAAE,OAAO,EACxFD,GAAK,OAAS,CAAChB,EAAMC,IAAQ,IAAIF,GAAMC,EAAMC,CAAG,EC7GhD,IAAMiB,GAAM,OAAO,CAAC,EACdC,GAAM,OAAO,CAAC,EACdC,GAAM,OAAO,CAAC,ECnBb,IAAMC,GAAN,cAA4BC,EAAgB,CAC/C,YAAYC,EAAK,CACb,MAAM,EACN,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,KAAK,QAAUA,CACnB,CACA,MAAM,KAAKC,EAAIC,EAAMC,EAAK,CACtB,MAAM,KAAK,UAAU,EACrB,IAAMC,EAAM,CACR,KAAM,UACN,GAAIH,EACJ,eAAgBE,CACpB,EAEA,OADW,MAAM,KAAK,KAAK,QAAQC,EAAK,KAAK,KAAMF,CAAI,CAE3D,CACA,MAAM,KAAKD,EAAIC,EAAMC,EAAK,CACtB,MAAM,KAAK,UAAU,EACrB,IAAMC,EAAM,CACR,KAAM,UACN,GAAIH,EACJ,eAAgBE,CACpB,EAEA,OADW,MAAM,KAAK,KAAK,QAAQC,EAAK,KAAK,KAAMF,CAAI,CAE3D,CACA,MAAM,WAAY,CACd,GAAI,KAAK,OAAS,OACd,OAEJ,MAAM,KAAK,OAAO,EAClB,IAAMF,EAAM,MAAM,KAAK,WAAW,KAAK,OAAO,EAC7C,IAAI,WAAW,KAAK,OAAO,EAAG,KAAK,CAAC,EACrC,KAAK,KAAOA,CAEhB,CACA,MAAM,WAAWA,EAAK,CAClB,OAAO,MAAM,KAAK,KAAK,UAAU,MAAOA,EAAK,CAAE,KAAM,SAAU,EAAG,GAAMK,EAAW,CACvF,CACJ,EAwBaC,GAAN,KAAgB,CACnB,aAAc,CAEV,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOC,GAAO,SAClB,CAAC,EAED,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,YAAa,CACrC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,CACL,CACA,wBAAwBP,EAAK,CACzB,OAAO,IAAIF,GAAcE,CAAG,CAChC,CACJ,EAyBaQ,GAAN,cAAwBF,EAAU,CACrC,aAAc,CACV,MAAM,GAAG,SAAS,EAElB,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOC,GAAO,SAClB,CAAC,EAED,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,YAAa,CACrC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,CACL,CACJ,ECrKO,SAASE,IAAmB,CAC/B,OAAO,IAAI,QAAQ,CAACC,EAAUC,IAAW,CACrCA,EAAO,IAAIC,GAAkB,eAAe,CAAC,CACjD,CAAC,CACL,CCFA,IAAMC,GAAY,IAAI,WAAW,CAAC,IAAK,IAAK,EAAE,CAAC,EAClCC,GAAN,KAA0B,CAC7B,YAAYC,EAAKC,EAAKC,EAAgB,CAClC,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,iBAAkB,CAC1C,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,KAAK,KAAOF,EACZ,KAAK,KAAOC,EACZ,KAAK,eAAiBC,CAC1B,CACA,MAAM,KAAKC,EAAOC,EAAM,CACpB,OAAO,MAAMC,GAAiB,CAClC,CACA,MAAM,KAAKF,EAAOC,EAAM,CACpB,OAAO,MAAMC,GAAiB,CAClC,CACA,MAAM,OAAOC,EAAiBC,EAAK,CAC/B,GAAID,EAAgB,WAAa,KAC7B,MAAM,IAAIE,GAAkB,2BAA2B,EAE3D,GAAI,CACA,OAAO,MAAM,KAAK,KAAK,cAAc,KAAK,eAAgBV,GAAW,IAAI,WAAWQ,CAAe,EAAGC,CAAG,CAC7G,OACOE,EAAG,CACN,MAAM,IAAIC,GAAYD,CAAC,CAC3B,CACJ,CACJ,EACaE,GAAN,cAA2CZ,EAAoB,CACtE,EACaa,GAAN,cAAwCb,EAAoB,CAC/D,YAAYC,EAAKC,EAAKC,EAAgBW,EAAK,CACvC,MAAMb,EAAKC,EAAKC,CAAc,EAC9B,OAAO,eAAe,KAAM,MAAO,CAC/B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,KAAK,IAAMW,CAEf,CACJ,EC1DO,IAAMC,GAAN,cAAoCC,EAAoB,CAC3D,YAAYC,EAAKC,EAAKC,EAAQ,CAqC1B,GApCA,MAAMF,EAAKC,EAAKC,EAAO,cAAc,EAErC,OAAO,eAAe,KAAM,QAAS,CACjC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EAED,OAAO,eAAe,KAAM,MAAO,CAC/B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EAED,OAAO,eAAe,KAAM,MAAO,CAC/B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EAED,OAAO,eAAe,KAAM,MAAO,CAC/B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EAED,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACGA,EAAO,MAAQ,QAAaA,EAAO,YAAc,QACjDA,EAAO,MAAQ,OACf,MAAM,IAAI,MAAM,iCAAiC,EAErD,KAAK,MAAQA,EAAO,KACpB,KAAK,IAAM,KAAK,MAAM,QACtB,KAAK,IAAM,KAAK,MAAM,UACtB,KAAK,IAAM,KAAK,MAAM,QACtB,IAAMC,EAAM,KAAK,MAAM,wBAAwBD,EAAO,GAAG,EACzD,KAAK,KAAO,CACR,IAAKC,EACL,UAAWD,EAAO,UAClB,IAAKA,EAAO,GAChB,CACJ,CACA,aAAaE,EAAG,CACZ,IAAMC,EAAWC,GAAMF,EAAE,IAAKA,EAAE,UAAU,UAAU,EACpD,OAAOG,GAAIH,EAAE,UAAWC,CAAQ,EAAE,MACtC,CACA,aAAaD,EAAG,CAEZ,GAAIA,EAAE,IAAM,OAAO,iBACf,MAAM,IAAII,GAAyB,uBAAuB,EAE9DJ,EAAE,KAAO,CAEb,CACJ,ECnEA,IAAIK,GAAkE,SAAUC,EAAUC,EAAOC,EAAMC,EAAG,CACtG,GAAID,IAAS,KAAO,CAACC,EAAG,MAAM,IAAI,UAAU,+CAA+C,EAC3F,GAAI,OAAOF,GAAU,WAAaD,IAAaC,GAAS,CAACE,EAAI,CAACF,EAAM,IAAID,CAAQ,EAAG,MAAM,IAAI,UAAU,0EAA0E,EACjL,OAAOE,IAAS,IAAMC,EAAID,IAAS,IAAMC,EAAE,KAAKH,CAAQ,EAAIG,EAAIA,EAAE,MAAQF,EAAM,IAAID,CAAQ,CAChG,EACII,GAAkE,SAAUJ,EAAUC,EAAOI,EAAOH,EAAMC,EAAG,CAC7G,GAAID,IAAS,IAAK,MAAM,IAAI,UAAU,gCAAgC,EACtE,GAAIA,IAAS,KAAO,CAACC,EAAG,MAAM,IAAI,UAAU,+CAA+C,EAC3F,GAAI,OAAOF,GAAU,WAAaD,IAAaC,GAAS,CAACE,EAAI,CAACF,EAAM,IAAID,CAAQ,EAAG,MAAM,IAAI,UAAU,yEAAyE,EAChL,OAAQE,IAAS,IAAMC,EAAE,KAAKH,EAAUK,CAAK,EAAIF,EAAIA,EAAE,MAAQE,EAAQJ,EAAM,IAAID,EAAUK,CAAK,EAAIA,CACxG,EACIC,GACSC,GAAN,KAAY,CACf,aAAc,CACVD,GAAc,IAAI,KAAM,QAAQ,QAAQ,CAAC,CAC7C,CACA,MAAM,MAAO,CACT,IAAIE,EACEC,EAAW,IAAI,QAASC,GAAY,CACtCF,EAAcE,CAClB,CAAC,EACKC,EAAeZ,GAAuB,KAAMO,GAAe,GAAG,EACpE,OAAAF,GAAuB,KAAME,GAAeG,EAAU,GAAG,EACzD,MAAME,EACCH,CACX,CACJ,EACAF,GAAgB,IAAI,QC3BpB,IAAIM,GAAkE,SAAUC,EAAUC,EAAOC,EAAMC,EAAG,CACtG,GAAID,IAAS,KAAO,CAACC,EAAG,MAAM,IAAI,UAAU,+CAA+C,EAC3F,GAAI,OAAOF,GAAU,WAAaD,IAAaC,GAAS,CAACE,EAAI,CAACF,EAAM,IAAID,CAAQ,EAAG,MAAM,IAAI,UAAU,0EAA0E,EACjL,OAAOE,IAAS,IAAMC,EAAID,IAAS,IAAMC,EAAE,KAAKH,CAAQ,EAAIG,EAAIA,EAAE,MAAQF,EAAM,IAAID,CAAQ,CAChG,EACII,GAAkE,SAAUJ,EAAUC,EAAOI,EAAOH,EAAMC,EAAG,CAC7G,GAAID,IAAS,IAAK,MAAM,IAAI,UAAU,gCAAgC,EACtE,GAAIA,IAAS,KAAO,CAACC,EAAG,MAAM,IAAI,UAAU,+CAA+C,EAC3F,GAAI,OAAOF,GAAU,WAAaD,IAAaC,GAAS,CAACE,EAAI,CAACF,EAAM,IAAID,CAAQ,EAAG,MAAM,IAAI,UAAU,yEAAyE,EAChL,OAAQE,IAAS,IAAMC,EAAE,KAAKH,EAAUK,CAAK,EAAIF,EAAIA,EAAE,MAAQE,EAAQJ,EAAM,IAAID,EAAUK,CAAK,EAAIA,CACxG,EACIC,GAISC,GAAN,cAAmCC,EAAsB,CAC5D,aAAc,CACV,MAAM,GAAG,SAAS,EAClBF,GAA4B,IAAI,KAAM,MAAM,CAChD,CACA,MAAM,KAAKG,EAAMC,EAAMC,GAAM,OAAQ,CACjCP,GAAuB,KAAME,GAA6BP,GAAuB,KAAMO,GAA6B,GAAG,GAAK,IAAIM,GAAS,GAAG,EAC5I,IAAMC,EAAU,MAAMd,GAAuB,KAAMO,GAA6B,GAAG,EAAE,KAAK,EACtFQ,EACJ,GAAI,CACAA,EAAK,MAAM,KAAK,KAAK,IAAI,KAAK,KAAK,aAAa,KAAK,IAAI,EAAGL,EAAMC,CAAG,CACzE,OACOK,EAAG,CACN,MAAM,IAAIC,GAAUD,CAAC,CACzB,QACA,CACIF,EAAQ,CACZ,CACA,YAAK,aAAa,KAAK,IAAI,EACpBC,CACX,CACJ,EACAR,GAA8B,IAAI,QCrClC,IAAIW,GAAkE,SAAUC,EAAUC,EAAOC,EAAMC,EAAG,CACtG,GAAID,IAAS,KAAO,CAACC,EAAG,MAAM,IAAI,UAAU,+CAA+C,EAC3F,GAAI,OAAOF,GAAU,WAAaD,IAAaC,GAAS,CAACE,EAAI,CAACF,EAAM,IAAID,CAAQ,EAAG,MAAM,IAAI,UAAU,0EAA0E,EACjL,OAAOE,IAAS,IAAMC,EAAID,IAAS,IAAMC,EAAE,KAAKH,CAAQ,EAAIG,EAAIA,EAAE,MAAQF,EAAM,IAAID,CAAQ,CAChG,EACII,GAAkE,SAAUJ,EAAUC,EAAOI,EAAOH,EAAMC,EAAG,CAC7G,GAAID,IAAS,IAAK,MAAM,IAAI,UAAU,gCAAgC,EACtE,GAAIA,IAAS,KAAO,CAACC,EAAG,MAAM,IAAI,UAAU,+CAA+C,EAC3F,GAAI,OAAOF,GAAU,WAAaD,IAAaC,GAAS,CAACE,EAAI,CAACF,EAAM,IAAID,CAAQ,EAAG,MAAM,IAAI,UAAU,yEAAyE,EAChL,OAAQE,IAAS,IAAMC,EAAE,KAAKH,EAAUK,CAAK,EAAIF,EAAIA,EAAE,MAAQE,EAAQJ,EAAM,IAAID,EAAUK,CAAK,EAAIA,CACxG,EACIC,GAISC,GAAN,cAAgCC,EAAsB,CACzD,YAAYC,EAAKC,EAAKC,EAAQC,EAAK,CAC/B,MAAMH,EAAKC,EAAKC,CAAM,EACtB,OAAO,eAAe,KAAM,MAAO,CAC/B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACDL,GAAyB,IAAI,KAAM,MAAM,EACzC,KAAK,IAAMM,CACf,CACA,MAAM,KAAKC,EAAMC,EAAMC,GAAM,OAAQ,CACjCX,GAAuB,KAAME,GAA0BP,GAAuB,KAAMO,GAA0B,GAAG,GAAK,IAAIU,GAAS,GAAG,EACtI,IAAMC,EAAU,MAAMlB,GAAuB,KAAMO,GAA0B,GAAG,EAAE,KAAK,EACnFY,EACJ,GAAI,CACAA,EAAK,MAAM,KAAK,KAAK,IAAI,KAAK,KAAK,aAAa,KAAK,IAAI,EAAGL,EAAMC,CAAG,CACzE,OACOK,EAAG,CACN,MAAM,IAAIC,GAAUD,CAAC,CACzB,QACA,CACIF,EAAQ,CACZ,CACA,YAAK,aAAa,KAAK,IAAI,EACpBC,CACX,CACJ,EACAZ,GAA2B,IAAI,QCtC/B,IAAMe,GAAmB,IAAI,WAAW,CACpC,GAAI,GAAI,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAAI,GAC7C,CAAC,EAEKC,GAAY,IAAI,WAAW,CAAC,IAAK,IAAK,GAAG,CAAC,EAG1CC,GAAkB,IAAI,WAAW,CACnC,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,GAAI,IAAK,GAC1C,CAAC,EAEKC,GAAY,IAAI,WAAW,CAAC,IAAK,IAAK,GAAG,CAAC,EAG1CC,GAAoB,IAAI,WAAW,CACrC,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,GAAI,IAAK,GAAI,IAAK,GACnD,CAAC,EAEKC,GAAe,IAAI,WAAW,CAAC,IAAK,IAAK,GAAI,IAAK,IAAK,GAAG,CAAC,EAG3DC,GAAuB,IAAI,WAAW,CACxC,GAAI,GAAI,GAAI,GAAI,EAAG,EAAG,EAAG,EAAG,EAAG,CACnC,CAAC,EAiEYC,GAAN,cAAgCC,EAAgB,CAQnD,YAAYC,EAAQ,CA2BhB,GA1BA,MAAM,EACN,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,QAAS,CACjC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,WAAY,CACpC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EAEG,OAAOA,EAAO,KAAQ,SACtB,MAAM,IAAIC,GAAkB,sBAAsB,EAItD,GAFA,KAAK,KAAOD,EAAO,IAEf,OAAOA,EAAO,KAAQ,SACtB,MAAM,IAAIC,GAAkB,sBAAsB,EAItD,GAFA,KAAK,KAAOD,EAAO,IAEf,OAAOA,EAAO,MAAS,SACvB,MAAM,IAAIC,GAAkB,uBAAuB,EAEvD,KAAK,MAAQD,EAAO,KACpB,KAAK,SAAW,IAAI,WAAWH,EAAoB,EACnD,KAAK,SAAS,IAAIK,GAAM,KAAK,KAAK,GAAI,CAAC,EAAG,CAAC,EAC3C,KAAK,SAAS,IAAIA,GAAM,KAAK,KAAK,GAAI,CAAC,EAAG,CAAC,EAC3C,KAAK,SAAS,IAAIA,GAAM,KAAK,MAAM,GAAI,CAAC,EAAG,CAAC,EAC5C,KAAK,KAAK,KAAK,KAAK,QAAQ,CAChC,CAIA,IAAI,KAAM,CACN,OAAO,KAAK,IAChB,CAIA,IAAI,KAAM,CACN,OAAO,KAAK,IAChB,CAIA,IAAI,MAAO,CACP,OAAO,KAAK,KAChB,CAUA,MAAM,oBAAoBF,EAAQ,CAC9B,KAAK,qBAAqBA,CAAM,EAChC,MAAM,KAAK,OAAO,EAClB,IAAMG,EAAK,MAAM,KAAK,KAAK,MAAMH,CAAM,EACnCI,EACJ,OAAIJ,EAAO,MAAQ,OACfI,EAAOJ,EAAO,YAAc,OAAYK,GAAK,QAAUA,GAAK,IAG5DD,EAAOJ,EAAO,YAAc,OAAYK,GAAK,KAAOA,GAAK,KAEtD,MAAM,KAAK,cAAcD,EAAMD,EAAG,aAAcA,EAAG,IAAKH,CAAM,CACzE,CAWA,MAAM,uBAAuBA,EAAQ,CACjC,KAAK,qBAAqBA,CAAM,EAChC,MAAM,KAAK,OAAO,EAClB,IAAMM,EAAe,MAAM,KAAK,KAAK,MAAMN,CAAM,EAC7CI,EACJ,OAAIJ,EAAO,MAAQ,OACfI,EAAOJ,EAAO,kBAAoB,OAAYK,GAAK,QAAUA,GAAK,IAGlED,EAAOJ,EAAO,kBAAoB,OAAYK,GAAK,KAAOA,GAAK,KAE5D,MAAM,KAAK,cAAcD,EAAME,EAAcN,CAAM,CAC9D,CAYA,MAAM,KAAKA,EAAQO,EAAIC,EAAMC,GAAM,OAAQ,CACvC,IAAMC,EAAM,MAAM,KAAK,oBAAoBV,CAAM,EACjD,MAAO,CACH,GAAI,MAAMU,EAAI,KAAKH,EAAIC,CAAG,EAC1B,IAAKE,EAAI,GACb,CACJ,CAYA,MAAM,KAAKV,EAAQW,EAAIH,EAAMC,GAAM,OAAQ,CAEvC,OAAO,MADK,MAAM,KAAK,uBAAuBT,CAAM,GACnC,KAAKW,EAAIH,CAAG,CACjC,CAeA,MAAM,aAAaJ,EAAME,EAAcN,EAAQ,CAK3C,IAAMY,EAAQZ,EAAO,MAAQ,OACvBS,GACA,IAAI,WAAWT,EAAO,IAAI,EAAE,EAC5Ba,EAAY,MAAM,KAAK,KAAK,eAAeJ,GAAM,OAAQd,GAAmBiB,CAAK,EACjFE,EAAOd,EAAO,OAAS,OACvBS,GACA,IAAI,WAAWT,EAAO,IAAI,EAC1Be,EAAW,MAAM,KAAK,KAAK,eAAeN,GAAM,OAAQhB,GAAiBqB,CAAI,EAC7EE,EAAqB,IAAI,WAAW,EAAIH,EAAU,WAAaE,EAAS,UAAU,EACxFC,EAAmB,IAAI,IAAI,WAAW,CAACZ,CAAI,CAAC,EAAG,CAAC,EAChDY,EAAmB,IAAI,IAAI,WAAWH,CAAS,EAAG,CAAC,EACnDG,EAAmB,IAAI,IAAI,WAAWD,CAAQ,EAAG,EAAIF,EAAU,UAAU,EACzE,IAAMI,EAAMjB,EAAO,MAAQ,OACrBS,GACA,IAAI,WAAWT,EAAO,IAAI,GAAG,EAC7BkB,EAAM,KAAK,KAAK,gBAAgBtB,GAAcqB,CAAG,EAClD,OACCE,EAAqB,KAAK,KAAK,iBAAiB3B,GAAWwB,EAAoB,KAAK,KAAK,QAAQ,EAAE,OACnGI,EAAiB,MAAM,KAAK,KAAK,iBAAiBd,EAAcY,EAAKC,EAAoB,KAAK,KAAK,QAAQ,EACjH,GAAI,KAAK,MAAM,KAAOE,GAAO,WACzB,MAAO,CAAE,KAAM,KAAK,MAAO,eAAgBD,CAAe,EAE9D,IAAME,EAAU,KAAK,KAAK,iBAAiB5B,GAAWsB,EAAoB,KAAK,MAAM,OAAO,EAAE,OACxFO,EAAM,MAAM,KAAK,KAAK,iBAAiBjB,EAAcY,EAAKI,EAAS,KAAK,MAAM,OAAO,EACrFE,EAAgB,KAAK,KAAK,iBAAiBjC,GAAkByB,EAAoB,KAAK,MAAM,SAAS,EAAE,OACvGS,EAAY,MAAM,KAAK,KAAK,iBAAiBnB,EAAcY,EAAKM,EAAe,KAAK,MAAM,SAAS,EACzG,MAAO,CACH,KAAM,KAAK,MACX,eAAgBJ,EAChB,IAAKG,EACL,UAAW,IAAI,WAAWE,CAAS,EACnC,IAAK,CACT,CACJ,CACA,MAAM,cAAcrB,EAAME,EAAcoB,EAAK1B,EAAQ,CACjD,IAAM2B,EAAM,MAAM,KAAK,aAAavB,EAAME,EAAcN,CAAM,EAC9D,OAAI2B,EAAI,MAAQ,OACL,IAAIC,GAA0B,KAAK,KAAM,KAAK,KAAMD,EAAI,eAAgBD,CAAG,EAE/E,IAAIG,GAAkB,KAAK,KAAM,KAAK,KAAMF,EAAKD,CAAG,CAC/D,CACA,MAAM,cAActB,EAAME,EAAcN,EAAQ,CAC5C,IAAM2B,EAAM,MAAM,KAAK,aAAavB,EAAME,EAAcN,CAAM,EAC9D,OAAI2B,EAAI,MAAQ,OACL,IAAIG,GAA6B,KAAK,KAAM,KAAK,KAAMH,EAAI,cAAc,EAE7E,IAAII,GAAqB,KAAK,KAAM,KAAK,KAAMJ,CAAG,CAC7D,CACA,qBAAqB3B,EAAQ,CACzB,GAAIA,EAAO,OAAS,QAChBA,EAAO,KAAK,WAAa,MACzB,MAAM,IAAIC,GAAkB,eAAe,EAE/C,GAAID,EAAO,MAAQ,OAAW,CAC1B,GAAIA,EAAO,IAAI,IAAI,WAAa,GAC5B,MAAM,IAAIC,GAAkB,0BAA0B,EAAkB,QAAQ,EAEpF,GAAID,EAAO,IAAI,IAAI,WAAa,KAC5B,MAAM,IAAIC,GAAkB,kBAAkB,EAElD,GAAID,EAAO,IAAI,GAAG,WAAa,KAC3B,MAAM,IAAIC,GAAkB,iBAAiB,CAErD,CAEJ,CACJ,ECzUO,IAAM+B,GAAN,cAAwCC,EAAM,CACjD,aAAc,CACV,IAAMC,EAAM,IAAIC,GACVC,EAAO,IAAIC,GAAGC,GAAM,oBAAqBJ,CAAG,EAClD,MAAMI,GAAM,oBAAqBF,EAAMF,CAAG,EAC1C,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOI,GAAM,mBACjB,CAAC,EACD,OAAO,eAAe,KAAM,aAAc,CACtC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EACD,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EACD,OAAO,eAAe,KAAM,gBAAiB,CACzC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EACD,OAAO,eAAe,KAAM,iBAAkB,CAC1C,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,CACL,CACJ,EACaC,GAAN,cAAwCN,EAAM,CACjD,aAAc,CACV,IAAMC,EAAM,IAAIM,GACVJ,EAAO,IAAIC,GAAGC,GAAM,oBAAqBJ,CAAG,EAClD,MAAMI,GAAM,oBAAqBF,EAAMF,CAAG,EAC1C,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOI,GAAM,mBACjB,CAAC,EACD,OAAO,eAAe,KAAM,aAAc,CACtC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EACD,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EACD,OAAO,eAAe,KAAM,gBAAiB,CACzC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EACD,OAAO,eAAe,KAAM,iBAAkB,CAC1C,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,CACL,CACJ,EACaG,GAAN,cAAwCR,EAAM,CACjD,aAAc,CACV,IAAMC,EAAM,IAAIQ,GACVN,EAAO,IAAIC,GAAGC,GAAM,oBAAqBJ,CAAG,EAClD,MAAMI,GAAM,oBAAqBF,EAAMF,CAAG,EAC1C,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOI,GAAM,mBACjB,CAAC,EACD,OAAO,eAAe,KAAM,aAAc,CACtC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EACD,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,GACX,CAAC,EACD,OAAO,eAAe,KAAM,gBAAiB,CACzC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,GACX,CAAC,EACD,OAAO,eAAe,KAAM,iBAAkB,CAC1C,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,CACL,CACJ,EC9CO,IAAMK,GAAN,cAA0BC,EAAkB,CACnD,EAyBaC,GAAN,cAAkCC,EAA0B,CACnE,EAyBaC,GAAN,cAAkCC,EAA0B,CACnE,EAyBaC,GAAN,cAAkCC,EAA0B,CACnE,EA4BaC,GAAN,cAAyBC,EAAiB,CACjD,EA4BaC,GAAN,cAAyBC,EAAiB,CACjD,EA4BaC,GAAN,cAAyBC,EAAiB,CACjD,ECtOA,IAAMC,GAAW,SAEXC,GAAsB,IAAI,WAAW,CACvC,GAAM,GAAM,EAAM,EAAM,EAAM,GAAM,EAAM,EAC1C,EAAM,GAAM,IAAM,IAAM,EAAM,GAAM,EAAM,EAC9C,CAAC,EACYC,GAAN,cAAqBC,EAAgB,CACxC,YAAYC,EAAM,CACd,MAAM,EACN,OAAO,eAAe,KAAM,QAAS,CACjC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,cAAe,CACvC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,KAAK,KAAO,CAAE,KAAMJ,EAAS,EAC7B,KAAK,MAAQI,EACb,KAAK,KAAO,GACZ,KAAK,KAAO,GACZ,KAAK,KAAO,GACZ,KAAK,YAAcH,EACvB,CACA,MAAM,mBAAmBI,EAAK,CAC1B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,KAAK,UAAU,MAAOA,CAAG,CAC/C,OACOC,EAAG,CACN,MAAM,IAAIC,GAAeD,CAAC,CAC9B,CACJ,CACA,MAAM,qBAAqBD,EAAK,CAC5B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,cAAcA,EAAK,EAAI,CAC7C,OACOC,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,oBAAoBD,EAAK,CAC3B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,IAAMI,EAAM,MAAM,KAAK,KAAK,UAAU,MAAOJ,CAAG,EAChD,GAAI,EAAE,MAAOI,GACT,MAAM,IAAI,MAAM,iBAAiB,EAErC,OAAOC,GAAiBD,EAAI,CAAI,EAAE,MACtC,OACOH,EAAG,CACN,MAAM,IAAIC,GAAeD,CAAC,CAC9B,CACJ,CACA,MAAM,sBAAsBD,EAAK,CAC7B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,cAAcA,EAAK,EAAK,CAC9C,OACOC,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,UAAUK,EAAQN,EAAKO,EAAU,CACnC,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,GAAID,IAAW,MACX,OAAO,MAAM,KAAK,cAAcN,EAAKO,CAAQ,EAGjD,GAAIP,aAAe,YACf,MAAM,IAAI,MAAM,wBAAwB,EAE5C,OAAO,MAAM,KAAK,WAAWA,EAAKO,CAAQ,CAC9C,OACON,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,iBAAkB,CACpB,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,KAAK,YAAYN,GAAU,GAAMa,EAAU,CACjE,OACOP,EAAG,CACN,MAAM,IAAIQ,GAAkBR,CAAC,CACjC,CACJ,CACA,MAAM,cAAcS,EAAK,CACrB,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,IAAMC,EAAS,MAAM,KAAK,MAAM,eAAeC,GAAM,OAAQC,GAAe,IAAI,WAAWH,CAAG,CAAC,EACzFI,EAAQ,MAAM,KAAK,MAAM,cAAcH,EAAQI,GAAUH,GAAO,KAAK,IAAI,EACzEI,EAAa,IAAI,WAAWF,CAAK,EACjCG,EAAK,MAAM,KAAK,qBAAqBD,CAAU,EACrD,OAAAA,EAAW,KAAK,CAAC,EACV,CACH,WAAYC,EACZ,UAAW,MAAM,KAAK,gBAAgBA,CAAE,CAC5C,CACJ,OACOhB,EAAG,CACN,MAAM,IAAIiB,GAAmBjB,CAAC,CAClC,CACJ,CACA,MAAM,gBAAgBD,EAAK,CACvB,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,IAAMI,EAAM,MAAM,KAAK,KAAK,UAAU,MAAOJ,CAAG,EAChD,cAAOI,EAAI,EACX,OAAOA,EAAI,QACJ,MAAM,KAAK,KAAK,UAAU,MAAOA,EAAK,KAAK,KAAM,GAAM,CAAC,CAAC,CACpE,OACOH,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,GAAGgB,EAAIE,EAAI,CACb,MAAM,KAAK,OAAO,EAClB,GAAI,CAKA,OAJa,MAAM,KAAK,KAAK,WAAW,CACpC,KAAMxB,GACN,OAAQwB,CACZ,EAAGF,EAAI,KAAK,KAAO,CAAC,CAExB,OACOhB,EAAG,CACN,MAAM,IAAIC,GAAeD,CAAC,CAC9B,CACJ,CACA,MAAM,cAAcD,EAAKO,EAAU,CAC/B,GAAIA,GAAYP,EAAI,aAAe,KAAK,KACpC,MAAM,IAAI,MAAM,wCAAwC,EAE5D,GAAI,CAACO,GAAYP,EAAI,aAAe,KAAK,KACrC,MAAM,IAAI,MAAM,yCAAyC,EAE7D,OAAIO,EACO,MAAM,KAAK,KAAK,UAAU,MAAOP,EAAK,KAAK,KAAM,GAAM,CAAC,CAAC,EAE7D,MAAM,KAAK,qBAAqB,IAAI,WAAWA,CAAG,CAAC,CAC9D,CACA,MAAM,WAAWA,EAAKO,EAAU,CAC5B,GAAI,OAAOP,EAAI,IAAQ,KAAeA,EAAI,MAAQ,MAC9C,MAAM,IAAI,MAAM,gBAAgBA,EAAI,GAAG,EAAE,EAE7C,GAAI,OAAOA,EAAI,IAAQ,KAAeA,EAAI,MAAQL,GAC9C,MAAM,IAAI,MAAM,gBAAgBK,EAAI,GAAG,EAAE,EAE7C,GAAIO,EAAU,CACV,GAAI,OAAOP,EAAI,EAAM,IACjB,MAAM,IAAI,MAAM,oCAAoC,EAExD,OAAO,MAAM,KAAK,KAAK,UAAU,MAAOA,EAAK,KAAK,KAAM,GAAM,CAAC,CAAC,CACpE,CACA,GAAI,OAAOA,EAAI,EAAM,IACjB,MAAM,IAAI,MAAM,4BAA4B,EAEhD,OAAO,MAAM,KAAK,KAAK,UAAU,MAAOA,EAAK,KAAK,KAAM,GAAMQ,EAAU,CAC5E,CACA,MAAM,qBAAqBY,EAAG,CAC1B,IAAMC,EAAW,IAAI,WAAW,KAAK,YAAY,OAASD,EAAE,MAAM,EAClE,OAAAC,EAAS,IAAI,KAAK,YAAa,CAAC,EAChCA,EAAS,IAAID,EAAG,KAAK,YAAY,MAAM,EAChC,MAAM,KAAK,KAAK,UAAU,QAASC,EAAU,KAAK,KAAM,GAAMb,EAAU,CACnF,CACJ,EC3KO,IAAMc,GAAN,cAAoCC,EAAM,CAC7C,aAAc,CACV,IAAMC,EAAM,IAAIC,GAChB,MAAMC,GAAM,sBAAuB,IAAIC,GAAOH,CAAG,EAAGA,CAAG,EAEvD,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOE,GAAM,qBACjB,CAAC,EAED,OAAO,eAAe,KAAM,aAAc,CACtC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,gBAAiB,CACzC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,iBAAkB,CAC1C,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,CACL,CACJ,EChEA,IAAME,GAAW,OAEXC,GAAoB,IAAI,WAAW,CACrC,GAAM,GAAM,EAAM,EAAM,EAAM,GAAM,EAAM,EAC1C,EAAM,GAAM,IAAM,IAAM,EAAM,GAAM,EAAM,EAC9C,CAAC,EACYC,GAAN,cAAmBC,EAAgB,CACtC,YAAYC,EAAM,CACd,MAAM,EACN,OAAO,eAAe,KAAM,QAAS,CACjC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,OAAQ,CAChC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,OAAO,eAAe,KAAM,cAAe,CACvC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,MACX,CAAC,EACD,KAAK,KAAO,CAAE,KAAMJ,EAAS,EAC7B,KAAK,MAAQI,EACb,KAAK,KAAO,GACZ,KAAK,KAAO,GACZ,KAAK,KAAO,GACZ,KAAK,YAAcH,EACvB,CACA,MAAM,mBAAmBI,EAAK,CAC1B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,KAAK,UAAU,MAAOA,CAAG,CAC/C,OACOC,EAAG,CACN,MAAM,IAAIC,GAAeD,CAAC,CAC9B,CACJ,CACA,MAAM,qBAAqBD,EAAK,CAC5B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,cAAcA,EAAK,EAAI,CAC7C,OACOC,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,oBAAoBD,EAAK,CAC3B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,IAAMI,EAAM,MAAM,KAAK,KAAK,UAAU,MAAOJ,CAAG,EAChD,GAAI,EAAE,MAAOI,GACT,MAAM,IAAI,MAAM,iBAAiB,EAErC,OAAOC,GAAiBD,EAAI,CAAI,EAAE,MACtC,OACOH,EAAG,CACN,MAAM,IAAIC,GAAeD,CAAC,CAC9B,CACJ,CACA,MAAM,sBAAsBD,EAAK,CAC7B,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,cAAcA,EAAK,EAAK,CAC9C,OACOC,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,UAAUK,EAAQN,EAAKO,EAAU,CACnC,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,GAAID,IAAW,MACX,OAAO,MAAM,KAAK,cAAcN,EAAKO,CAAQ,EAGjD,GAAIP,aAAe,YACf,MAAM,IAAI,MAAM,wBAAwB,EAE5C,OAAO,MAAM,KAAK,WAAWA,EAAKO,CAAQ,CAC9C,OACON,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,iBAAkB,CACpB,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,OAAO,MAAM,KAAK,KAAK,YAAYN,GAAU,GAAMa,EAAU,CACjE,OACOP,EAAG,CACN,MAAM,IAAIQ,GAAkBR,CAAC,CACjC,CACJ,CACA,MAAM,cAAcS,EAAK,CACrB,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,IAAMC,EAAS,MAAM,KAAK,MAAM,eAAeC,GAAM,OAAQC,GAAe,IAAI,WAAWH,CAAG,CAAC,EACzFI,EAAQ,MAAM,KAAK,MAAM,cAAcH,EAAQI,GAAUH,GAAO,KAAK,IAAI,EACzEI,EAAa,IAAI,WAAWF,CAAK,EACjCG,EAAK,MAAM,KAAK,qBAAqBD,CAAU,EACrD,OAAAA,EAAW,KAAK,CAAC,EACV,CACH,WAAYC,EACZ,UAAW,MAAM,KAAK,gBAAgBA,CAAE,CAC5C,CACJ,OACOhB,EAAG,CACN,MAAM,IAAIiB,GAAmBjB,CAAC,CAClC,CACJ,CACA,MAAM,gBAAgBD,EAAK,CACvB,MAAM,KAAK,OAAO,EAClB,GAAI,CACA,IAAMI,EAAM,MAAM,KAAK,KAAK,UAAU,MAAOJ,CAAG,EAChD,cAAOI,EAAI,EACX,OAAOA,EAAI,QACJ,MAAM,KAAK,KAAK,UAAU,MAAOA,EAAK,KAAK,KAAM,GAAM,CAAC,CAAC,CACpE,OACOH,EAAG,CACN,MAAM,IAAIE,GAAiBF,CAAC,CAChC,CACJ,CACA,MAAM,GAAGgB,EAAIE,EAAI,CACb,MAAM,KAAK,OAAO,EAClB,GAAI,CAKA,OAJa,MAAM,KAAK,KAAK,WAAW,CACpC,KAAMxB,GACN,OAAQwB,CACZ,EAAGF,EAAI,KAAK,KAAO,CAAC,CAExB,OACOhB,EAAG,CACN,MAAM,IAAIC,GAAeD,CAAC,CAC9B,CACJ,CACA,MAAM,cAAcD,EAAKO,EAAU,CAC/B,GAAIA,GAAYP,EAAI,aAAe,KAAK,KACpC,MAAM,IAAI,MAAM,wCAAwC,EAE5D,GAAI,CAACO,GAAYP,EAAI,aAAe,KAAK,KACrC,MAAM,IAAI,MAAM,yCAAyC,EAE7D,OAAIO,EACO,MAAM,KAAK,KAAK,UAAU,MAAOP,EAAK,KAAK,KAAM,GAAM,CAAC,CAAC,EAE7D,MAAM,KAAK,qBAAqB,IAAI,WAAWA,CAAG,CAAC,CAC9D,CACA,MAAM,WAAWA,EAAKO,EAAU,CAC5B,GAAI,OAAOP,EAAI,IAAQ,KAAeA,EAAI,MAAQ,MAC9C,MAAM,IAAI,MAAM,gBAAgBA,EAAI,GAAG,EAAE,EAE7C,GAAI,OAAOA,EAAI,IAAQ,KAAeA,EAAI,MAAQL,GAC9C,MAAM,IAAI,MAAM,gBAAgBK,EAAI,GAAG,EAAE,EAE7C,GAAIO,EAAU,CACV,GAAI,OAAOP,EAAI,EAAM,IACjB,MAAM,IAAI,MAAM,oCAAoC,EAExD,OAAO,MAAM,KAAK,KAAK,UAAU,MAAOA,EAAK,KAAK,KAAM,GAAM,CAAC,CAAC,CACpE,CACA,GAAI,OAAOA,EAAI,EAAM,IACjB,MAAM,IAAI,MAAM,4BAA4B,EAEhD,OAAO,MAAM,KAAK,KAAK,UAAU,MAAOA,EAAK,KAAK,KAAM,GAAMQ,EAAU,CAC5E,CACA,MAAM,qBAAqBY,EAAG,CAC1B,IAAMC,EAAW,IAAI,WAAW,KAAK,YAAY,OAASD,EAAE,MAAM,EAClE,OAAAC,EAAS,IAAI,KAAK,YAAa,CAAC,EAChCA,EAAS,IAAID,EAAG,KAAK,YAAY,MAAM,EAChC,MAAM,KAAK,KAAK,UAAU,QAASC,EAAU,KAAK,KAAM,GAAMb,EAAU,CACnF,CACJ,EC3KO,IAAMc,GAAN,cAAkCC,EAAM,CAC3C,aAAc,CACV,IAAMC,EAAM,IAAIC,GAChB,MAAMC,GAAM,oBAAqB,IAAIC,GAAKH,CAAG,EAAGA,CAAG,EAEnD,OAAO,eAAe,KAAM,KAAM,CAC9B,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAOE,GAAM,mBACjB,CAAC,EAED,OAAO,eAAe,KAAM,aAAc,CACtC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,UAAW,CACnC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,gBAAiB,CACzC,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,EAED,OAAO,eAAe,KAAM,iBAAkB,CAC1C,WAAY,GACZ,aAAc,GACd,SAAU,GACV,MAAO,EACX,CAAC,CACL,CACJ,EC3DA,eAAsBE,GAAgBC,EAAwBC,EAAYC,EAAe,CACvF,MAAO,CACL,MAAM,KAAKC,EAAYC,EAAWC,EAAYC,EAAMC,EAAG,CACrD,GAAI,CACF,IAAMC,EAAS,MAAMN,EAAG,KACtB,CAAE,aAAcC,EAAY,IAAKM,GAAmBL,CAAS,EAAG,KAAMK,GAAmBH,CAAI,CAAC,EAC9FG,GAAmBJ,CAAU,EAC7BE,EAAME,GAAmBF,CAAG,EAAI,IAAI,WAAa,EAEnD,OAAO,IAAI,WAAWC,CAAM,CAC9B,OAASE,EAAG,CACV,MAAM,IAAIC,GAAY,GAAGD,CAAC,EAAE,CAC9B,CACF,EACA,MAAM,KAAKE,EAAWC,EAAWP,EAAMC,EAAG,CACxC,IAAMC,EAAS,MAAMN,EAAG,KACtB,CAAE,mBAAoBU,EAAW,KAAMH,GAAmBH,CAAI,CAAC,EAC/DG,GAAmBI,CAAS,EAC5BN,EAAME,GAAmBF,CAAG,EAAI,IAAI,WAAa,EAEnD,MAAO,CACL,GAAI,IAAI,WAAWC,EAAO,EAAE,EAC5B,IAAK,IAAI,WAAWA,EAAO,GAAG,EAElC,EACA,MAAM,aAAaI,EAAWE,EAAiBC,EAAQT,EAAI,CACzD,IAAMU,EAAU,MAAMd,EAAG,oBAAoB,CAAE,mBAAoBU,EAAW,KAAMH,GAAmBH,CAAI,CAAC,CAAE,EAC9G,MAAO,CACL,IAAK,IAAI,WAAWU,EAAQ,GAAG,EAC/B,OAAQ,IAAI,WAAW,MAAMA,EAAQ,OAAOP,GAAmBK,CAAe,EAAGC,CAAM,CAAC,EAE5F,EACA,MAAM,aAAaZ,EAAYW,EAAiBV,EAAWW,EAAQT,EAAI,CACrE,GAAI,CACF,IAAMU,EAAU,MAAMd,EAAG,uBAAuB,CAC9C,aAAcC,EACd,KAAMM,GAAmBH,CAAI,EAC7B,IAAKG,GAAmBL,CAAS,EAClC,EACD,OAAO,IAAI,WAAW,MAAMY,EAAQ,OAAOP,GAAmBK,CAAe,EAAGC,CAAM,CAAC,CACzF,OAASL,EAAG,CACV,MAAM,IAAIC,GAAY,GAAGD,CAAC,EAAE,CAC9B,CACF,EACA,MAAM,iBAAiBO,EAAC,CACtB,GAAI,CAEF,IAAMC,EAAMlB,EAAQ,MAAQ,yBAA2BmB,GAAqBF,CAAC,EAAIA,EACjF,OAAQ,MAAMf,EAAG,IAAI,sBAAsBO,GAAmBS,CAAG,CAAC,CACpE,OAASR,EAAG,CACV,MAAM,IAAIC,GAAY,GAAGD,CAAC,EAAE,CAC9B,CACF,EACA,MAAM,gBAAgBO,EAAC,CACrB,GAAI,CACF,OAAQ,MAAMf,EAAG,IAAI,qBAAqBO,GAAmBQ,CAAC,CAAC,CACjE,OAASP,EAAG,CACV,MAAM,IAAIC,GAAY,GAAGD,CAAC,EAAE,CAC9B,CACF,EACA,MAAM,gBAAgBO,EAAC,CACrB,OAAO,IAAI,WAAW,MAAMf,EAAG,IAAI,mBAAmBe,CAAC,CAAC,CAC1D,EACA,MAAM,iBAAiBA,EAAC,CACtB,OAAO,IAAI,WAAW,MAAMf,EAAG,IAAI,oBAAoBe,CAAC,CAAC,CAC3D,EACA,MAAM,YAAYC,EAAKE,EAAOb,EAAKM,EAAS,CAC1C,OAAOZ,EAAK,QAAQiB,EAAKE,EAAOb,GAAY,IAAI,WAAcM,CAAS,CACzE,EACA,MAAM,YAAYK,EAAKE,EAAOb,EAAKF,EAAU,CAC3C,GAAI,CACF,OAAO,MAAMJ,EAAK,QAAQiB,EAAKE,EAAOb,GAAY,IAAI,WAAcF,CAAU,CAChF,OAASK,EAAG,CACV,MAAM,IAAIC,GAAY,GAAGD,CAAC,EAAE,CAC9B,CACF,EACA,MAAM,cAAcW,EAAG,CACrB,IAAMC,EAAK,MAAMpB,EAAG,IAAI,cAAcO,GAAmBY,CAAG,CAAC,EAC7D,MAAO,CAAE,WAAYC,EAAG,WAA0B,UAAWA,EAAG,SAAsB,CACxF,EACA,MAAM,iBAAe,CACnB,IAAMA,EAAK,MAAMpB,EAAG,IAAI,gBAAe,EACvC,MAAO,CAAE,WAAYoB,EAAG,WAA0B,UAAWA,EAAG,SAAsB,CACxF,EACA,UAAWpB,EAAG,KAAK,QACnB,YAAaA,EAAG,KAAK,UAEzB,CAEA,SAASiB,GAAqBF,EAAa,CACzC,IAAMM,EAAmB,GAAKN,EAAE,WAChC,OAAOO,GAAkB,IAAI,WAAWD,CAAgB,EAAGN,CAAC,CAC9D,CC7FA,eAAsBQ,GAASC,EAAsB,CACnD,OAAQA,EAAS,CACf,IAAK,YACH,MAAO,CACL,CACE,QAAQC,EAAKC,EAAOC,EAAKC,EAAS,CAChC,OAAOC,GAAcJ,EAAKC,EAAOC,EAAKC,CAAS,CACjD,EACA,QAAQH,EAAKC,EAAOC,EAAKG,EAAU,CACjC,OAAOC,GAAcN,EAAKC,EAAOC,EAAKG,CAAU,CAClD,GAEF,IAAIE,IAER,IAAK,YACH,MAAO,CACL,CACE,QAAQP,EAAKC,EAAOC,EAAKC,EAAS,CAChC,OAAOC,GAAcJ,EAAKC,EAAOC,EAAKC,CAAS,CACjD,EACA,QAAQH,EAAKC,EAAOC,EAAKG,EAAU,CACjC,OAAOC,GAAcN,EAAKC,EAAOC,EAAKG,CAAU,CAClD,GAEF,IAAIG,IAER,IAAK,mBACH,GAAI,CACF,GAAM,CAAE,iBAAAC,CAAgB,EAAK,KAAM,QAAO,wBAAwB,EAC5D,CAAE,iBAAAC,CAAgB,EAAK,KAAM,uCACnC,MAAO,CACL,CACE,MAAM,QAAQV,EAAKC,EAAOC,EAAKC,EAAS,CACtC,OAAOO,EAAiBV,EAAKC,EAAOC,CAAG,EAAE,QAAQC,CAAS,CAC5D,EACA,MAAM,QAAQH,EAAKC,EAAOC,EAAKG,EAAU,CACvC,OAAOK,EAAiBV,EAAKC,EAAOC,CAAG,EAAE,QAAQG,CAAU,CAC7D,GAEF,IAAII,EAER,MAAc,CACZ,MAAM,IAAIE,GACR,uGAAuG,CAE3G,CACJ,CACF,CAEA,eAAeP,GACbJ,EACAC,EACAC,EACAC,EAAqB,CAErB,IAAMS,EAAY,MAAM,OAAO,OAAO,UAAU,MAAOC,GAAeb,CAAG,EAAG,CAAE,KAAM,SAAS,EAAI,GAAO,CAAC,SAAS,CAAC,EAC7Gc,EAAS,MAAM,OAAO,OAAO,QACjC,CACE,KAAM,UACN,GAAID,GAAeZ,CAAK,EACxB,eAAgBC,EAAI,OAAS,EAAIW,GAAeX,CAAG,EAAI,QAEzDU,EACAC,GAAeV,CAAS,CAAC,EAE3B,OAAO,IAAI,WAAWW,CAAM,CAC9B,CAEA,eAAeR,GACbN,EACAC,EACAC,EACAG,EAAsB,CAEtB,IAAMO,EAAY,MAAM,OAAO,OAAO,UAAU,MAAOC,GAAeb,CAAG,EAAG,CAAE,KAAM,SAAS,EAAI,GAAO,CAAC,SAAS,CAAC,EAC7Gc,EAAS,MAAM,OAAO,OAAO,QACjC,CACE,KAAM,UACN,GAAID,GAAeZ,CAAK,EACxB,eAAgBC,EAAI,OAAS,EAAIW,GAAeX,CAAG,EAAI,QAEzDU,EACAC,GAAeR,CAAU,CAAC,EAE5B,OAAO,IAAI,WAAWS,CAAM,CAC9B,CCtFM,SAAUC,GAAYC,EAAe,CACzC,MAAO,CACL,MAAM,QAAQC,EAAkBC,EAAe,CAC7C,IAAMC,EAAS,MAAMH,EAAE,QAAQI,GAAmBH,CAAI,EAAGG,GAAmBF,CAAG,CAAC,EAChF,OAAO,IAAI,WAAWC,CAAM,CAC9B,EACA,MAAM,OAAOE,EAAiBC,EAAkBC,EAAW,CACzD,IAAMJ,EAAS,MAAMH,EAAE,OAAOI,GAAmBC,CAAG,EAAGD,GAAmBE,CAAI,EAAGC,CAAG,EACpF,OAAO,IAAI,WAAWJ,CAAM,CAC9B,EACA,KAAMH,EAAE,SAEZ,CAEM,SAAUQ,GAAQC,EAAoB,CAC1C,OAAQA,EAAQ,CACd,IAAK,cACH,OAAO,IAAIC,GACb,IAAK,cACH,OAAO,IAAIC,GACb,IAAK,cACH,OAAO,IAAIC,EACf,CACF,CChBA,eAAsBC,GAAUC,EAAoB,CAClD,OAAQA,EAAQ,CACd,IAAK,yBACH,OAAO,IAAIC,GACb,IAAK,2BACH,OAAO,IAAIC,GACb,IAAK,yBACH,OAAO,IAAIC,GACb,IAAK,yBACH,OAAO,IAAIC,GACb,IAAK,yBACH,OAAO,IAAIC,GACb,IAAK,aACH,GAAI,CACF,GAAM,CAAE,SAAAC,CAAQ,EAAK,KAAM,QAAO,cAAc,EAChD,OAAO,IAAIA,CACb,MAAc,CACZ,MAAM,IAAIC,GACR,6FAA6F,CAEjG,CAEF,IAAK,aACH,GAAI,CACF,GAAM,CAAE,SAAAC,CAAQ,EAAK,KAAM,QAAO,cAAc,EAChD,OAAO,IAAIA,CACb,MAAc,CACZ,MAAM,IAAID,GACR,6FAA6F,CAEjG,CACF,IAAK,cACH,GAAI,CACF,GAAM,CAAE,UAAAE,CAAS,EAAK,KAAM,QAAO,cAAc,EACjD,OAAO,IAAIA,CACb,MAAc,CACZ,MAAM,IAAIF,GACR,6FAA6F,CAEjG,CACF,IAAK,SACH,GAAI,CACF,GAAM,CAAE,MAAAG,CAAK,EAAK,KAAM,QAAO,wBAAwB,EACvD,OAAO,IAAIA,CACb,MAAc,CACZ,MAAM,IAAIH,GACR,uGAAuG,CAE3G,CACJ,CACF,CCtDA,eAAsBI,GAASC,EAAsB,CACnD,GAAM,CAACC,EAAMC,CAAa,EAAI,MAAMC,GAASH,EAAQ,IAAI,EACnDI,EAAK,IAAIC,GAAY,CACzB,IAAK,MAAMC,GAAUN,EAAQ,GAAG,EAChC,IAAKO,GAAQP,EAAQ,GAAG,EACxB,KAAME,EACP,EAED,OAAOM,GAAgBR,EAASC,EAAMG,CAAE,CAC1C,CCdO,IAAMK,GAAkB,CAC7B,YAAYC,EAAC,CACX,OAAO,OAAO,gBAAgB,IAAI,WAAWA,CAAC,CAAC,CACjD,GCFF,eAAsBC,GAAuBC,EAAuB,CAClE,OAAQA,EAAK,CACX,IAAK,UACH,GAAI,CACF,GAAM,CAAE,QAAAC,CAAO,EAAK,KAAM,uCAC1B,MAAO,CACL,MAAM,KAAKC,EAASC,EAAO,CACzB,OAAOF,EAAQ,KAAKE,EAASD,CAAO,CACtC,EACA,MAAM,OAAOE,EAAWD,EAASE,EAAS,CACxC,OAAOJ,EAAQ,OAAOI,EAAWF,EAASC,CAAS,CACrD,EACA,MAAM,QAAM,CACV,IAAMF,EAAUD,EAAQ,MAAM,gBAAe,EAC7C,MAAO,CAAE,QAAAC,EAAS,UAAWD,EAAQ,aAAaC,CAAO,CAAC,CAC5D,EAEJ,MAAc,CACZ,MAAM,IAAII,GACR,8FAA8F,CAElG,CAEF,IAAK,QACH,GAAI,CACF,GAAM,CAAE,MAAAC,CAAK,EAAK,KAAM,uCACxB,MAAO,CACL,MAAM,KAAKL,EAASC,EAAO,CACzB,OAAOI,EAAM,KAAKJ,EAASD,CAAO,CACpC,EACA,MAAM,OAAOE,EAAWD,EAASE,EAAS,CACxC,OAAOE,EAAM,OAAOF,EAAWF,EAASC,CAAS,CACnD,EACA,MAAM,QAAM,CACV,IAAMF,EAAUK,EAAM,MAAM,gBAAe,EAC3C,MAAO,CAAE,QAAAL,EAAS,UAAWK,EAAM,aAAaL,CAAO,CAAC,CAC1D,EAEJ,MAAc,CACZ,MAAM,IAAII,GACR,8FAA8F,CAElG,CAEF,IAAK,OACH,GAAI,CACF,GAAM,CAAE,KAAAE,CAAI,EAAK,KAAM,uCACvB,MAAO,CACL,MAAM,KAAKN,EAASC,EAAO,CACzB,OAAOK,EAAK,KAAKL,EAASD,EAAS,CAAE,QAAS,GAAM,OAAQ,MAAO,KAAM,EAAK,CAAE,CAClF,EACA,MAAM,OAAOE,EAAWD,EAASE,EAAS,CACxC,OAAOG,EAAK,OAAOH,EAAWF,EAASC,EAAW,CAAE,QAAS,GAAM,OAAQ,MAAO,KAAM,EAAK,CAAE,CACjG,EACA,MAAM,QAAM,CACV,IAAMF,EAAUM,EAAK,MAAM,gBAAe,EAC1C,MAAO,CAAE,QAAAN,EAAS,UAAWM,EAAK,aAAaN,CAAO,CAAC,CACzD,EAEJ,MAAc,CACZ,MAAM,IAAII,GACR,8FAA8F,CAElG,CACF,IAAK,OACH,GAAI,CACF,GAAM,CAAE,KAAAG,CAAI,EAAK,KAAM,uCACvB,MAAO,CACL,MAAM,KAAKP,EAASC,EAAO,CACzB,OAAOM,EAAK,KAAKN,EAASD,EAAS,CAAE,QAAS,GAAM,OAAQ,MAAO,KAAM,EAAK,CAAE,CAClF,EACA,MAAM,OAAOE,EAAWD,EAASE,EAAS,CACxC,OAAOI,EAAK,OAAOJ,EAAWF,EAASC,EAAW,CAAE,QAAS,GAAM,OAAQ,MAAO,KAAM,EAAK,CAAE,CACjG,EACA,MAAM,QAAM,CACV,IAAMF,EAAUO,EAAK,MAAM,gBAAe,EAC1C,MAAO,CAAE,QAAAP,EAAS,UAAWO,EAAK,aAAaP,CAAO,CAAC,CACzD,EAEJ,MAAc,CACZ,MAAM,IAAII,GACR,8FAA8F,CAElG,CACF,IAAK,OACH,GAAI,CACF,GAAM,CAAE,KAAAI,CAAI,EAAK,KAAM,uCACvB,MAAO,CACL,MAAM,KAAKR,EAASC,EAAO,CACzB,OAAOO,EAAK,KAAKP,EAASD,EAAS,CAAE,QAAS,GAAM,OAAQ,MAAO,KAAM,EAAK,CAAE,CAClF,EACA,MAAM,OAAOE,EAAWD,EAASE,EAAS,CACxC,OAAOK,EAAK,OAAOL,EAAWF,EAASC,EAAW,CAAE,QAAS,GAAM,OAAQ,MAAO,KAAM,EAAK,CAAE,CACjG,EACA,MAAM,QAAM,CACV,IAAMF,EAAUQ,EAAK,MAAM,gBAAe,EAC1C,MAAO,CAAE,QAAAR,EAAS,UAAWQ,EAAK,aAAaR,CAAO,CAAC,CACzD,EAEJ,MAAc,CACZ,MAAM,IAAII,GACR,8FAA8F,CAElG,CACF,IAAK,YACH,GAAI,CACF,GAAM,CAAE,SAAAK,CAAQ,EAAK,KAAM,QAAO,+BAA+B,EACjE,MAAO,CACL,MAAM,KAAKT,EAASC,EAAO,CACzB,OAAOQ,EAAS,KAAKR,EAASD,CAAO,CACvC,EACA,MAAM,OAAOE,EAAWD,EAASE,EAAS,CACxC,OAAOM,EAAS,OAAON,EAAWF,EAASC,CAAS,CACtD,EACA,MAAM,QAAM,CACV,IAAMQ,EAAOD,EAAS,OAAO,OAAO,gBAAgB,IAAI,WAAW,EAAE,CAAC,CAAC,EACvE,MAAO,CAAE,QAASC,EAAK,UAAW,UAAWA,EAAK,SAAS,CAC7D,EAEJ,MAAc,CACZ,MAAM,IAAIN,GACR,oGAAoG,CAExG,CACJ,CACF,CCvHO,IAAMO,GAAwB,CACnC,MAAM,mBAAmBC,EAAe,CACtC,IAAMC,EAAK,OAAO,OAClB,MAAO,CACL,IAAKC,GAAYC,GAAQH,EAAG,KAAK,GAAG,CAAC,EACrC,KAAMI,GAAaH,EAAID,EAAG,IAAI,EAC9B,UAAW,MAAMK,GAAuBL,EAAG,SAAS,EACpD,KAAM,MAAMM,GAASN,EAAG,IAAI,EAC5B,IAAKO,GACL,KAAMP,EAAG,KAEb,GChBF,eAAsBQ,GACpBC,EACAC,EAA2BC,GAAqB,CAEhD,OAAOD,EAAS,mBAAmBD,CAAE,CACvC,CC6BO,IAAMG,GAA2DC,EACtE,CAACC,GAAmBC,EAAoB,EACvCC,GAAQ,CAACA,EAAI,WAAYA,EAAI,aAAa,CAAU,EAG1CC,GAAoDC,EAAON,EAAuB,EAElFO,GAA+CN,EAC1D,CAACC,GAAmBM,EAAc,EACjCC,GAAO,CAACA,EAAG,WAAYA,EAAG,OAAO,CAAU,EAGjCC,GAAwCJ,EAAOC,EAAiB,EAEhEI,GAA6DV,EACxE,CAACC,GAAmBU,EAAqB,EACxCC,GAAO,CAACA,EAAG,WAAYA,EAAG,cAAc,CAAU,EAGxCC,GAAsDR,EAAOK,EAAwB,EAErFI,GAAmDd,EAC9D,CAACC,GAAmBc,EAAgB,EACnCC,GAAO,CAACA,EAAG,WAAYA,EAAG,SAAS,CAAU,EAGnCC,GAA4CZ,EAAOS,EAAmB,EAEtEI,GAAqDlB,EAChE,CAACC,GAAmBkB,EAAiB,EACpCC,GAAO,CAACA,EAAG,WAAYA,EAAG,UAAU,CAAU,EAGpCC,GAA8ChB,EAAOa,EAAoB,EAEzEI,GAA8DC,GAAM,CAC/E,OAAQA,EAAG,WAAY,CACrB,IAAK,qBACH,OAAOxB,GAAwBwB,CAAE,EACnC,IAAK,cACH,OAAOjB,GAAkBiB,CAAE,EAC7B,IAAK,sBACH,OAAOb,GAAyBa,CAAE,EACpC,IAAK,iBACH,OAAOT,GAAoBS,CAAE,EAC/B,IAAK,kBACH,OAAOL,GAAqBK,CAAE,CAClC,CACF,EAEaC,GAAsDnB,EAAOiB,EAAwB,EAErFG,GAAsDC,GACjEC,GACCC,GAA0C,CACzC,OAAQA,EAAY,CAClB,IAAK,qBACH,OAAOC,GAAWC,GAAsBC,IAAmB,CAAE,WAAAH,EAAY,cAAAG,CAAa,EAAG,EAC3F,IAAK,cACH,OAAOF,GAAWG,GAAgBC,IAAa,CAAE,WAAAL,EAAY,QAAAK,CAAO,EAAG,EACzE,IAAK,sBACH,OAAOJ,GAAWK,GAAuBC,IAAoB,CAAE,WAAAP,EAAY,eAAAO,CAAc,EAAG,EAC9F,IAAK,iBACH,OAAON,GAAWO,GAAkBC,IAAe,CAAE,WAAAT,EAAY,UAAAS,CAAS,EAAG,EAC/E,IAAK,kBACH,OAAOR,GAAWS,GAAmBC,IAAgB,CAAE,WAAAX,EAAY,WAAAW,CAAU,EAAG,CACpF,CACF,CAAC,EAGUC,GAA+CxC,EAC1D,CAACyC,GAAwBnB,EAAwB,EAChDoB,GAAM,CAACA,EAAE,QAASA,CAAC,CAAU,EAGnBC,GAAwCtC,EAAOmC,EAAiB,EAEhEI,GAAwCC,EACnD,CAACC,GAAuBrB,EAAuB,EAC/C,CAACsB,EAASxB,KAAQ,CAAE,GAAGA,EAAI,QAAAwB,CAAO,EAAG,EChHhC,IAAMC,GAAe,CAC1B,KAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxG,OAOWC,GAAsB,CACjC,0BAA2B,IAGvB,SAAUC,GAAOC,EAA0B,CAC/C,OAAOH,GAAa,OAAO,IAAMG,EAAa,0BAA4B,KAAK,OAAM,CAAE,CACzF,CAEM,SAAUC,GAAmBD,EAA0B,CAC3D,OAAOD,GAAOC,CAAY,EAAE,IAAKE,GAAMA,EAAE,SAAQ,CAAqB,CACxE,CAEM,SAAUC,GAAkBH,EAA0B,CAC1D,OAAOD,GAAOC,CAAY,EAAE,IAAKE,GAAMA,EAAE,SAAQ,CAAwB,CAC3E,CAMM,SAAUE,GAAmBC,EAAsBC,EAA0B,CACjF,MAAO,CACL,aAAc,CAAC,GAAGA,EAAa,aAAc,GAAGC,GAAmBF,CAAM,CAAC,EAC1E,YAAa,CAAC,GAAGC,EAAa,YAAa,GAAGE,GAAkBH,CAAM,CAAC,EACvE,WAAY,CAAC,GAAGC,EAAa,WAAY,GAAGG,GAAOJ,CAAM,CAAC,EAC1D,UAAW,CAAC,GAAGC,EAAa,UAAW,GAAGG,GAAOJ,CAAM,CAAC,EACxD,SAAUC,EAAa,SAE3B,CCtCM,SAAUI,IAAmB,CACjC,OAAOC,GAAmBC,GAAqB,CAC7C,SAAU,CAAC,OAAO,EAClB,aAAc,OAAO,KAAKC,EAAY,EACtC,WAAY,CAAA,EACZ,UAAW,CAAA,EACX,YAAa,CAAC,QAAS,MAAM,EAC9B,CACH,CCMO,IAAMC,GAAN,KAAwB,CAG9BC,GACAC,GACAC,GAAgC,CAAC,EACjCC,GAAmB,GAEnB,YAAYC,EAAiC,CAC5C,KAAKJ,GAAeI,CACrB,CAEA,MAAM,MAAMC,EAAiB,CAE5B,KAAKF,GAAWE,EAGhB,KAAKJ,GAAY,MAAMK,GAAO,aAAc,EAAG,CAC9C,QAAS,CAACC,EAAIC,EAAYC,EAAaC,EAAaC,IAAU,CAE7D,GAAIH,GAAc,EAAG,CACpB,IAAII,EAAcL,EAAG,kBAAkB,YAAY,EACnDK,EAAY,YAAY,gBAAiB,CAAC,IAAI,CAAC,CAChD,CACD,CACD,CAAC,EAGD,IAAMF,EAAc,KAAKT,GAAU,YAAY,aAAc,WAAW,EACxE,KAAKC,GAAe,MAAMQ,EAAY,MAAM,OAAO,EAG/C,KAAKR,GAAa,QAAU,GAC/B,KAAK,iBAAiB,CAExB,CAIA,MAAc,kBAAmB,CAEhC,GAAI,KAAKD,IAAa,KACrB,OAID,IAAMY,EAAiB,MAAMC,GAAmBC,GAAuB,8CAA8C,CAAC,EAEhHC,EAAyB,CAC9B,eAAgB,QAChB,SAAU,IAAI,YAAY,EAAE,OAAO,OAAO,CAC3C,EAEA,IAAIC,EAAa,MAAMC,GACtBF,EACAG,GAAoB,EACpBC,GACA,CAAC,EACDP,CACD,EAGIQ,EAAgBC,GAAgB,KAAKnB,GAAUc,EAAW,aAAa,EACvE,CAACI,EAAeE,CAAG,EAAI,MAAM,KAAKvB,GAAa,aAAaqB,CAAa,EAE7E,GAAIE,GAAO,GAAI,CACd,QAAQ,IAAIA,CAAG,EACf,MACD,CAEA,QAAQ,IAAIF,CAAa,EAGzB,IAAMG,EAA8B,CACnC,GAAIH,EAAc,GAClB,eAAgBJ,EAAW,eAC3B,cAAeA,EAAW,aAC3B,EAEA,QAAQ,IAAIO,CAAY,EAGxB,KAAKvB,GAAU,IAAI,aAAcuB,EAAcA,EAAa,EAAE,CAC/D,CACD,EClGO,IAAMC,GAAN,KAAqB,CAG3BC,GAAuB,CAAC,EACxBC,GACAC,GAEA,aAAc,CACb,KAAKD,GAAe,IAAIE,GACxB,KAAKD,GAAc,IAAIE,GAAkB,KAAKH,EAAY,CAC3D,CAEA,MAAM,OAAQ,CACb,IAAMI,EAAQ,MAAM,KAAK,UAAU,EACnC,KAAKL,GAASK,EAEd,MAAM,KAAKJ,GAAa,MAAMI,EAAM,EAAE,EACtC,MAAM,KAAKH,GAAY,MAAMG,EAAM,EAAE,CACtC,CAEA,MAAM,WAA8B,CAOnC,IAAMC,EAAS,MALE,MAAM,MAAM,uBAAwB,CACpD,QAAS,CAAC,CAAC,SAAU,kBAAkB,CAAC,EACxC,YAAa,aACd,CAAC,GAE6B,KAAK,EAEnC,OAAI,OAAOA,GAAU,SACbA,EAGD,CACN,GAAG,GACH,KAAK,GACL,MAAM,GACN,YAAa,CACZ,KAAK,aACL,GAAG,GACH,MAAM,CAAC,CACR,CACD,CACD,CACD,EChDA,IAAAC,GAAc,WAGP,IAAMC,GAAN,KAAoB,CAG1BC,GAEA,YAAYC,EAAwB,CACnC,QAAQ,IAAIA,CAAO,EACnB,KAAKD,GAAWC,CACjB,CAEO,MAAO,CACb,SAAO,GAAAC,SAAC,OAAI,MAAM,eACjB,GAAAA,SAAC,OAAI,MAAM,8DAA8D,MAAM,2EAE9E,GAAAA,SAAC,OACA,KAAK,SACL,MAAM,+FAEN,GAAAA,SAAC,OAAI,MAAM,yCACV,GAAAA,SAAC,OAAI,MAAM,4CAA4C,MAAM,qEAAoE,GAAC,CACnI,KACA,GAAAA,SAAC,OAAI,MAAM,iBAAiB,MAAM,mBAAkB,kBAAgB,CACrE,KAEA,GAAAA,SAAC,WAAI,SAAO,KACZ,GAAAA,SAAC,WAAI,SAAO,KACZ,GAAAA,SAAC,WAAI,SAAO,CACb,KACA,GAAAA,SAAC,OAAI,MAAM,aAAY,oBAEvB,CACD,CACD,CACD,E/F/BA,IAAMC,GAAN,KAAkB,CAEjB,YAAYC,EAAkB,CAC7B,KAAK,MAAMA,CAAI,CAChB,CAEA,MAAc,MAAMA,EAAkB,CAErC,IAAIC,EAAU,IAAIC,GAClB,MAAMD,EAAQ,MAAM,EAEpB,IAAIE,EAAgB,IAAIC,GAAcH,CAAO,EAC7C,GAAAI,QAAE,MAAML,EAAMG,CAAa,CAC5B,CACD,EAIA,IAAIG,GAAO,SAAS,eAAe,KAAK,EAExC,GAAIA,IAAQ,KAAW,CACtB,IAAMC,EAAM,IAAIC,GAAYF,EAAI,CACjC,MACC,QAAQ,IAAI,kEAAkE",
  "names": ["require_vnode", "__commonJSMin", "exports", "module", "Vnode", "tag", "key", "attrs", "children", "text", "dom", "node", "input", "numKeyed", "i", "require_hyperscriptVnode", "__commonJSMin", "exports", "module", "Vnode", "attrs", "children", "require_hasOwn", "__commonJSMin", "exports", "module", "require_emptyAttrs", "__commonJSMin", "exports", "module", "require_cachedAttrsIsStaticMap", "__commonJSMin", "exports", "module", "emptyAttrs", "require_hyperscript", "__commonJSMin", "exports", "module", "Vnode", "hyperscriptVnode", "hasOwn", "emptyAttrs", "cachedAttrsIsStaticMap", "selectorParser", "selectorCache", "isEmpty", "object", "key", "isFormAttributeKey", "compileSelector", "selector", "match", "tag", "classes", "attrs", "isStatic", "type", "value", "attrValue", "execSelector", "state", "vnode", "className", "hyperscript", "children", "require_trust", "__commonJSMin", "exports", "module", "Vnode", "html", "require_fragment", "__commonJSMin", "exports", "module", "Vnode", "hyperscriptVnode", "attrs", "children", "vnode", "require_hyperscript", "__commonJSMin", "exports", "module", "hyperscript", "require_delayedRemoval", "__commonJSMin", "exports", "module", "require_domFor", "__commonJSMin", "exports", "module", "delayedRemoval", "domFor", "vnode", "dom", "domSize", "generation", "nextSibling", "require_render", "__commonJSMin", "exports", "module", "Vnode", "delayedRemoval", "domFor", "cachedAttrsIsStaticMap", "nameSpace", "currentRedraw", "currentRender", "getDocument", "dom", "getNameSpace", "vnode", "checkState", "original", "callHook", "activeElement", "createNodes", "parent", "vnodes", "start", "end", "hooks", "nextSibling", "ns", "i", "createNode", "tag", "initLifecycle", "createText", "createHTML", "createFragment", "createElement", "createComponent", "insertDOM", "possibleParents", "match", "temp", "fragment", "child", "children", "attrs", "is", "element", "setAttrs", "maybeSetContentEditable", "setLateSelectAttrs", "initComponent", "sentinel", "updateNodes", "old", "removeNodes", "isOldKeyed", "isKeyed", "oldStart", "oldEnd", "map", "o", "v", "oe", "ve", "topSibling", "updateNode", "getNextSibling", "moveDOM", "originalNextSibling", "vnodesLength", "oldIndices", "li", "pos", "matched", "lisIndices", "getKeyMap", "oldIndex", "makeLisIndices", "commonLength", "removeNode", "oldTag", "shouldNotUpdate", "updateLifecycle", "updateText", "updateHTML", "updateFragment", "updateElement", "updateComponent", "removeDOM", "domSize", "updateAttrs", "key", "lisTemp", "a", "result", "u", "il", "j", "c", "target", "content", "tryBlockRemove", "source", "counter", "generation", "tryResumeRemove", "onremove", "setAttr", "value", "isLifecycleMethod", "isFormAttribute", "updateEvent", "updateStyle", "hasPropertyKey", "removeAttr", "nsLastIndex", "normalized", "val", "attr", "style", "EventDict", "ev", "handler", "self", "force", "currentDOM", "redraw", "prevRedraw", "prevDOM", "active", "namespace", "require_render", "__commonJSMin", "exports", "module", "require_mount_redraw", "__commonJSMin", "exports", "module", "Vnode", "render", "schedule", "console", "subscriptions", "pending", "offset", "sync", "redraw", "e", "mount", "root", "component", "index", "require_mount_redraw", "__commonJSMin", "exports", "module", "render", "require_build", "__commonJSMin", "exports", "module", "object", "args", "key", "destructure", "value", "i", "require_build", "__commonJSMin", "exports", "module", "buildQueryString", "template", "params", "queryIndex", "hashIndex", "queryEnd", "pathEnd", "path", "query", "resolved", "m", "key", "variadic", "newQueryIndex", "newHashIndex", "newQueryEnd", "newPathEnd", "result", "querystring", "require_request", "__commonJSMin", "exports", "module", "buildPathname", "hasOwn", "$window", "oncompletion", "PromiseProxy", "executor", "makeRequest", "url", "args", "resolve", "reject", "method", "body", "assumeJSON", "responseType", "xhr", "aborted", "isTimeout", "original", "replacedAbort", "abort", "hasHeader", "key", "ev", "success", "response", "message", "i", "completeErrorResponse", "error", "e", "name", "promise", "count", "complete", "wrap", "then", "next", "require_request", "__commonJSMin", "exports", "module", "mountRedraw", "require_decodeURIComponentSafe", "__commonJSMin", "exports", "module", "validUtf8Encodings", "str", "require_parse", "__commonJSMin", "exports", "module", "decodeURIComponentSafe", "string", "entries", "counters", "data", "i", "entry", "key", "value", "levels", "cursor", "j", "level", "nextLevel", "isNumber", "desc", "require_parse", "__commonJSMin", "exports", "module", "parseQueryString", "url", "queryIndex", "hashIndex", "queryEnd", "pathEnd", "path", "require_compileTemplate", "__commonJSMin", "exports", "module", "parsePathname", "template", "templateData", "templateKeys", "keys", "regexp", "m", "key", "extra", "data", "i", "values", "require_censor", "__commonJSMin", "exports", "module", "hasOwn", "magic", "attrs", "extras", "result", "key", "require_router", "__commonJSMin", "exports", "module", "Vnode", "hyperscript", "decodeURIComponentSafe", "buildPathname", "parsePathname", "compileTemplate", "censor", "$window", "mountRedraw", "p", "scheduled", "ready", "hasBeenResolved", "dom", "compiled", "fallbackRoute", "currentResolver", "component", "attrs", "currentPath", "lastUpdate", "RouterRoot", "fireAsync", "vnode", "SKIP", "route", "resolveRoute", "prefix", "path", "data", "reject", "e", "loop", "i", "payload", "matchedRoute", "localComp", "update", "comp", "root", "defaultRoute", "routes", "defaultData", "options", "state", "title", "child", "onclick", "href", "result", "key", "require_route", "__commonJSMin", "exports", "module", "mountRedraw", "require_mithril", "__commonJSMin", "exports", "module", "hyperscript", "mountRedraw", "request", "router", "m", "isBytes", "a", "abool", "b", "anumber", "n", "abytes", "value", "length", "title", "bytes", "len", "needsLen", "prefix", "ofLen", "got", "aexists", "instance", "checkFinished", "aoutput", "out", "min", "u32", "arr", "clean", "arrays", "i", "createView", "checkOpts", "defaults", "opts", "equalBytes", "diff", "getOutput", "expectedLength", "onlyAligned", "isAligned32", "u64Lengths", "dataLength", "aadLength", "isLE", "num", "view", "copyBytes", "randomBytes", "bytesLength", "cr", "wrapCipher", "init_utils", "__esmMin", "params", "constructor", "wrappedCipher", "key", "args", "nonce", "tagl", "cipher", "checkOutput", "fnLength", "output", "called", "data", "rotl", "a", "b", "isAligned32", "runCipher", "core", "sigma", "key", "nonce", "data", "output", "counter", "rounds", "len", "block", "BLOCK_LEN", "b32", "u32", "isAligned", "d32", "U32_EMPTY", "o32", "pos", "MAX_COUNTER", "take", "pos32", "j", "posj", "BLOCK_LEN32", "createCipher", "opts", "allowShortKeys", "extendNonceFn", "counterLength", "counterRight", "checkOpts", "anumber", "abool", "abytes", "toClean", "l", "k", "copyBytes", "sigma32_32", "sigma16_32", "k32", "nonceNcLen", "nc", "n32", "clean", "encodeStr", "sigma16", "sigma32", "_XorStreamPRG", "createPRG", "init_arx", "__esmMin", "init_utils", "str", "c", "__XorStreamPRG", "cipher", "blockLen", "keyLen", "nonceLen", "seed", "i", "out", "outPos", "blocks", "blockBytes", "left", "randomBytes", "u8to16", "a", "i", "wrapConstructorWithKey", "hashCons", "hashC", "msg", "key", "tmp", "Poly1305", "poly1305", "init_poly1305", "__esmMin", "init_utils", "copyBytes", "abytes", "t0", "t1", "t2", "t3", "t4", "t5", "t6", "t7", "data", "offset", "isLast", "hibit", "h", "r", "r0", "r1", "r2", "r3", "r4", "r5", "r6", "r7", "r8", "r9", "h0", "h1", "h2", "h3", "h4", "h5", "h6", "h7", "h8", "h9", "c", "d0", "d1", "d2", "d3", "d4", "d5", "d6", "d7", "d8", "d9", "pad", "g", "mask", "f", "clean", "aexists", "buffer", "blockLen", "len", "pos", "take", "out", "aoutput", "opos", "outputLen", "res", "chacha_exports", "__export", "_poly1305_aead", "chacha12", "chacha20", "chacha20orig", "chacha20poly1305", "chacha8", "hchacha", "rngChacha20", "rngChacha8", "xchacha20", "xchacha20poly1305", "chachaCore", "s", "k", "n", "out", "cnt", "rounds", "y00", "y01", "y02", "y03", "y04", "y05", "y06", "y07", "y08", "y09", "y10", "y11", "y12", "y13", "y14", "y15", "x00", "x01", "x02", "x03", "x04", "x05", "x06", "x07", "x08", "x09", "x10", "x11", "x12", "x13", "x14", "x15", "r", "rotl", "oi", "i", "computeTag", "fn", "key", "nonce", "ciphertext", "AAD", "abytes", "authKey", "ZEROS32", "lengths", "u64Lengths", "h", "poly1305", "updatePadded", "res", "clean", "ZEROS16", "init_chacha", "__esmMin", "init_arx", "init_poly1305", "init_utils", "createCipher", "msg", "leftover", "xorStream", "plaintext", "output", "plength", "getOutput", "oPlain", "tag", "data", "passedTag", "equalBytes", "wrapCipher", "createPRG", "isBytes", "a", "anumber", "n", "title", "prefix", "abytes", "value", "length", "bytes", "len", "needsLen", "ofLen", "got", "ahash", "h", "aexists", "instance", "checkFinished", "aoutput", "out", "min", "u32", "arr", "clean", "arrays", "i", "createView", "rotr", "word", "shift", "byteSwap", "byteSwap32", "bytesToHex", "hasHexBuiltin", "hex", "hexes", "asciiToBase16", "ch", "asciis", "hexToBytes", "hl", "al", "array", "ai", "hi", "n1", "n2", "char", "concatBytes", "sum", "res", "pad", "createHasher", "hashCons", "info", "hashC", "msg", "opts", "tmp", "randomBytes", "bytesLength", "cr", "isLE", "swap32IfBE", "oidNist", "init_utils", "__esmMin", "u", "_", "suffix", "Chi", "a", "b", "c", "Maj", "HashMD", "SHA256_IV", "SHA384_IV", "SHA512_IV", "init_md", "__esmMin", "init_utils", "blockLen", "outputLen", "padOffset", "isLE", "createView", "data", "aexists", "abytes", "view", "buffer", "len", "pos", "take", "dataView", "out", "aoutput", "clean", "i", "oview", "outLen", "state", "res", "to", "length", "finished", "destroyed", "fromBig", "n", "le", "U32_MASK64", "_32n", "split", "lst", "len", "Ah", "Al", "h", "l", "add", "Bh", "Bl", "shrSH", "shrSL", "rotrSH", "rotrSL", "rotrBH", "rotrBL", "rotlSH", "rotlSL", "rotlBH", "rotlBL", "add3L", "add3H", "add4L", "add4H", "add5L", "add5H", "init_u64", "__esmMin", "_l", "s", "Cl", "low", "Ch", "Dl", "Dh", "El", "Eh", "SHA256_K", "SHA256_W", "SHA2_32B", "_SHA256", "K512", "SHA512_Kh", "SHA512_Kl", "SHA512_W_H", "SHA512_W_L", "SHA2_64B", "_SHA512", "_SHA384", "sha256", "sha512", "sha384", "init_sha2", "__esmMin", "init_md", "init_u64", "init_utils", "HashMD", "outputLen", "A", "B", "C", "D", "E", "F", "G", "H", "view", "offset", "i", "W15", "W2", "s0", "rotr", "s1", "sigma1", "T1", "Chi", "T2", "Maj", "clean", "SHA256_IV", "split", "n", "Ah", "Al", "Bh", "Bl", "Ch", "Cl", "Dh", "Dl", "Eh", "El", "Fh", "Fl", "Gh", "Gl", "Hh", "Hl", "W15h", "W15l", "s0h", "rotrSH", "shrSH", "s0l", "rotrSL", "shrSL", "W2h", "W2l", "s1h", "rotrBH", "s1l", "rotrBL", "SUMl", "add4L", "SUMh", "add4H", "sigma1h", "sigma1l", "CHIh", "CHIl", "T1ll", "add5L", "T1h", "add5H", "T1l", "sigma0h", "sigma0l", "MAJh", "MAJl", "add", "All", "add3L", "add3H", "SHA512_IV", "SHA384_IV", "createHasher", "oidNist", "abool", "value", "title", "prefix", "abignumber", "n", "isPosBig", "anumber", "asafenumber", "numberToHexUnpadded", "num", "hex", "hexToNumber", "_0n", "bytesToNumberBE", "bytes", "bytesToHex", "bytesToNumberLE", "copyBytes", "abytes", "numberToBytesBE", "len", "res", "hexToBytes", "numberToBytesLE", "equalBytes", "a", "b", "diff", "i", "asciiToBytes", "ascii", "c", "charCode", "inRange", "min", "max", "aInRange", "bitLen", "_1n", "createHmacDrbg", "hashLen", "qByteLen", "hmacFn", "u8n", "NULL", "byte0", "byte1", "_maxDrbgIters", "v", "k", "reset", "h", "msgs", "concatBytes", "reseed", "seed", "gen", "out", "sl", "pred", "validateObject", "object", "fields", "optFields", "checkField", "fieldName", "expectedType", "isOpt", "val", "current", "iter", "f", "memoized", "fn", "map", "arg", "args", "computed", "bitMask", "notImplemented", "init_utils", "__esmMin", "mod", "a", "b", "result", "_0n", "pow2", "x", "power", "modulo", "res", "invert", "number", "y", "_1n", "u", "v", "q", "r", "m", "n", "assertIsSquare", "Fp", "root", "sqrt3mod4", "p1div4", "_4n", "sqrt5mod8", "p5div8", "_5n", "_8n", "n2", "_2n", "nv", "i", "sqrt9mod16", "P", "Fp_", "Field", "tn", "tonelliShanks", "c1", "c2", "c3", "c4", "_7n", "_16n", "tv1", "tv2", "tv3", "tv4", "e1", "e2", "e3", "_3n", "Q", "S", "Z", "_Fp", "FpLegendre", "cc", "Q1div2", "M", "c", "t", "R", "t_tmp", "exponent", "FpSqrt", "_9n", "validateField", "field", "initial", "opts", "FIELD_FIELDS", "map", "val", "validateObject", "FpPow", "num", "p", "d", "FpInvertBatch", "nums", "passZero", "inverted", "multipliedAcc", "acc", "invertedAcc", "p1mod2", "powered", "yes", "zero", "no", "nLength", "nBitLength", "anumber", "_nBitLength", "nByteLength", "ORDER", "_Field", "FpSqrtEven", "elm", "getFieldBytesLength", "fieldOrder", "bitLength", "getMinHashLength", "length", "mapHashToField", "key", "isLE", "abytes", "len", "fieldLen", "minLen", "bytesToNumberLE", "bytesToNumberBE", "reduced", "numberToBytesLE", "numberToBytesBE", "isNegativeLE", "init_modular", "__esmMin", "init_utils", "_nbitLength", "lhs", "rhs", "bytes", "skipValidation", "allowedLengths", "BYTES", "modFromBytes", "padded", "scalar", "lst", "condition", "negateCt", "condition", "item", "neg", "normalizeZ", "c", "points", "invertedZs", "FpInvertBatch", "p", "i", "validateW", "W", "bits", "calcWOpts", "scalarBits", "windows", "windowSize", "maxNumber", "mask", "bitMask", "shiftBy", "calcOffsets", "n", "window", "wOpts", "wbits", "nextN", "_1n", "offsetStart", "offset", "isZero", "isNeg", "isNegF", "validateMSMPoints", "validateMSMScalars", "scalars", "field", "s", "getW", "P", "pointWindowSizes", "assert0", "_0n", "mulEndoUnsafe", "Point", "point", "k1", "k2", "acc", "p1", "p2", "pippenger", "fieldN", "plength", "slength", "zero", "bitLen", "MASK", "buckets", "lastBits", "sum", "j", "scalar", "resI", "sumI", "createField", "order", "isLE", "validateField", "Field", "createCurveFields", "type", "CURVE", "curveOpts", "FpFnLE", "val", "Fp", "Fn", "params", "createKeygen", "randomSecretKey", "getPublicKey", "seed", "secretKey", "pointPrecomputes", "wNAF", "init_curve", "__esmMin", "init_utils", "init_modular", "elm", "d", "base", "precomputes", "f", "wo", "offsetF", "transform", "comp", "prev", "isEdValidXY", "Fp", "CURVE", "x", "y", "x2", "y2", "left", "right", "edwards", "params", "extraOpts", "validated", "createCurveFields", "Fn", "cofactor", "validateObject", "MASK", "_2n", "_1n", "modP", "n", "uvRatio", "u", "_0n", "acoord", "title", "banZero", "min", "aInRange", "aedpoint", "other", "Point", "toAffineMemo", "memoized", "p", "iz", "X", "Y", "Z", "is0", "_8n", "zz", "assertValidMemo", "a", "d", "T", "X2", "Y2", "Z2", "Z4", "aX2", "XY", "ZT", "bytes", "zip215", "len", "copyBytes", "abytes", "abool", "normed", "lastByte", "bytesToNumberLE", "max", "v", "isValid", "isXOdd", "isLastByteOdd", "hex", "hexToBytes", "windowSize", "isLazy", "wnaf", "X1", "Y1", "Z1", "X1Z2", "X2Z1", "Y1Z2", "Y2Z1", "A", "B", "C", "D", "x1y1", "E", "G", "F", "H", "X3", "Y3", "T3", "Z3", "T1", "T2", "scalar", "f", "normalizeZ", "acc", "invertedZ", "bytesToHex", "wNAF", "eddsa", "cHash", "eddsaOpts", "prehash", "BASE", "randomBytes", "adjustScalarBytes", "domain", "data", "ctx", "phflag", "modN_LE", "hash", "getPrivateScalar", "key", "lengths", "hashed", "head", "prefix", "getExtendedPublicKey", "secretKey", "point", "pointBytes", "getPublicKey", "hashDomainToScalar", "context", "msgs", "msg", "concatBytes", "sign", "options", "r", "R", "k", "s", "rs", "verifyOpts", "verify", "sig", "publicKey", "mid", "SB", "_size", "randomSecretKey", "seed", "isValidSecretKey", "isBytes", "isValidPublicKey", "utils", "size", "is25519", "createKeygen", "PrimeEdwardsPoint", "init_edwards", "__esmMin", "init_utils", "init_curve", "ep", "_bytes", "notImplemented", "_hex", "i2osp", "value", "length", "asafenumber", "res", "i", "strxor", "a", "b", "arr", "normDST", "DST", "isBytes", "asciiToBytes", "expand_message_xmd", "msg", "lenInBytes", "H", "abytes", "concatBytes", "b_in_bytes", "r_in_bytes", "ell", "DST_prime", "Z_pad", "l_i_b_str", "b_0", "args", "expand_message_xof", "k", "dkLen", "hash_to_field", "count", "options", "validateObject", "p", "m", "hash", "expand", "log2p", "L", "len_in_bytes", "prb", "u", "e", "j", "elm_offset", "tv", "mod", "os2ip", "createHasher", "Point", "mapToCurve", "defaults", "map", "num", "clear", "initial", "P", "opts", "u0", "u1", "optsDst", "scalars", "N", "_DST_scalar", "init_hash_to_curve", "__esmMin", "init_utils", "init_modular", "bytesToNumberBE", "validateOpts", "curve", "validateObject", "montgomery", "curveDef", "CURVE", "P", "type", "adjustScalarBytes", "powPminus2", "rand", "is25519", "randomBytes_", "randomBytes", "montgomeryBits", "fieldLen", "Gu", "a24", "minScalar", "_2n", "maxAdded", "_1n", "maxScalar", "modP", "n", "mod", "GuBytes", "encodeU", "u", "numberToBytesLE", "decodeU", "_u", "copyBytes", "abytes", "bytesToNumberLE", "decodeScalar", "scalar", "scalarMult", "pu", "montgomeryLadder", "_0n", "scalarMultBase", "getPublicKey", "getSharedSecret", "cswap", "swap", "x_2", "x_3", "dummy", "aInRange", "k", "x_1", "z_2", "z_3", "t", "k_t", "A", "AA", "B", "BB", "E", "C", "D", "DA", "CB", "dacb", "da_cb", "z2", "lengths", "randomSecretKey", "seed", "utils", "createKeygen", "init_montgomery", "__esmMin", "init_utils", "init_curve", "init_modular", "createORPF", "opts", "validateObject", "name", "Point", "hash", "Fn", "hashToGroup", "msg", "ctx", "concatBytes", "asciiToBytes", "hashToScalarPrefixed", "_DST_scalar", "randomScalar", "rng", "randomBytes", "t", "mapHashToField", "getMinHashLength", "bytesToNumberLE", "bytesToNumberBE", "msm", "points", "scalars", "pippenger", "getCtx", "mode", "ctxOPRF", "ctxVOPRF", "ctxPOPRF", "encode", "args", "res", "a", "numberToBytesBE", "abytes", "hashInput", "bytes", "getTranscripts", "B", "C", "D", "Bm", "seed", "i", "Ci", "Di", "di", "computeComposites", "T", "M", "Z", "computeCompositesFast", "k", "challengeTranscript", "t2", "t3", "a0", "a1", "a2", "a3", "generateProof", "r", "c", "s", "verifyProof", "proof", "f", "expectedC", "generateKeyPair", "skS", "pkS", "deriveKeyPair", "info", "dst", "counter", "blind", "input", "inputPoint", "blinded", "evaluate", "secretKey", "unblinded", "oprf", "keyInfo", "blindedPoint", "blindBytes", "evaluatedBytes", "publicKey", "blindedPoints", "evaluated", "items", "evalPoints", "m", "tweakedKey", "invT", "j", "point", "init_oprf", "__esmMin", "init_utils", "init_curve", "init_hash_to_curve", "init_modular", "ed25519_exports", "__export", "ED25519_TORSION_SUBGROUP", "_map_to_curve_elligator2_curve25519", "ed25519", "ed25519_hasher", "ed25519ctx", "ed25519ph", "ristretto255", "ristretto255_hasher", "ristretto255_oprf", "x25519", "ed25519_pow_2_252_3", "x", "_10n", "_20n", "_40n", "_80n", "P", "ed25519_CURVE_p", "b2", "b4", "pow2", "_2n", "b5", "_1n", "b10", "_5n", "b20", "b40", "b80", "b160", "b240", "b250", "adjustScalarBytes", "bytes", "uvRatio", "u", "v", "v3", "mod", "v7", "pow", "vx2", "root1", "root2", "ED25519_SQRT_M1", "useRoot1", "useRoot2", "noRoot", "isNegativeLE", "ed25519_domain", "data", "ctx", "phflag", "concatBytes", "asciiToBytes", "ed", "opts", "eddsa", "ed25519_Point", "sha512", "ELL2_C4", "_8n", "ELL2_J", "tv1", "Fp", "xd", "x1n", "tv2", "gxd", "gx1", "tv3", "y11", "y12", "ELL2_C3", "e1", "y1", "x2n", "y21", "ELL2_C2", "y22", "gx2", "e2", "y2", "e3", "xn", "y", "e4", "map_to_curve_elligator2_edwards25519", "xMn", "xMd", "yMn", "yMd", "ELL2_C1_EDWARDS", "yn", "yd", "e", "xd_inv", "yd_inv", "FpInvertBatch", "calcElligatorRistrettoMap", "r0", "d", "ed25519_CURVE", "n", "r", "SQRT_M1", "Ns", "ONE_MINUS_D_SQ", "c", "D", "Ns_D_is_sq", "s", "s_", "Nt", "D_MINUS_ONE_SQ", "s2", "W0", "W1", "SQRT_AD_MINUS_ONE", "W2", "W3", "_0n", "_3n", "Fn", "ELL2_C1", "INVSQRT_A_MINUS_D", "invertSqrt", "MAX_255B", "bytes255ToNumberLE", "_RistrettoPoint", "init_ed25519", "__esmMin", "init_sha2", "init_utils", "init_edwards", "init_hash_to_curve", "init_modular", "init_montgomery", "init_oprf", "edwards", "montgomery", "pow_p_5_8", "FpSqrtEven", "createHasher", "scalars", "number", "bytesToNumberLE", "__RistrettoPoint", "PrimeEdwardsPoint", "ep", "ap", "other", "abytes", "a", "equalBytes", "u1", "u2", "u1_2", "u2_2", "isValid", "I", "Dx", "Dy", "t", "hex", "hexToBytes", "X", "Y", "Z", "T", "u2sq", "invsqrt", "D1", "D2", "zInv", "_x", "_y", "X1", "Y1", "X2", "Y2", "one", "two", "msg", "options", "DST", "xmd", "expand_message_xmd", "_DST_scalar", "r1", "R1", "r2", "R2", "createORPF", "keccakP", "s", "rounds", "B", "round", "x", "idx1", "idx0", "B0", "B1", "Th", "rotlH", "Tl", "rotlL", "y", "curH", "curL", "t", "shift", "SHA3_ROTL", "PI", "SHA3_PI", "SHA3_IOTA_H", "SHA3_IOTA_L", "clean", "_0n", "_1n", "_2n", "_7n", "_256n", "_0x71n", "_SHA3_IOTA", "IOTAS", "Keccak", "genShake", "shake256", "init_sha3", "__esmMin", "init_u64", "init_utils", "R", "j", "split", "h", "l", "rotlBH", "rotlSH", "rotlBL", "rotlSL", "_Keccak", "blockLen", "suffix", "outputLen", "enableXOF", "anumber", "u32", "swap32IfBE", "data", "aexists", "abytes", "state", "len", "pos", "take", "i", "out", "bufferOut", "bytes", "aoutput", "to", "info", "createHasher", "opts", "oidNist", "ed448_exports", "__export", "E448", "ED448_TORSION_SUBGROUP", "decaf448", "decaf448_hasher", "decaf448_oprf", "ed448", "ed448_hasher", "ed448ph", "x448", "ed448_pow_Pminus3div4", "x", "P", "ed448_CURVE_p", "b2", "b3", "b6", "pow2", "_3n", "b9", "b11", "_2n", "b22", "_11n", "b44", "_22n", "b88", "_44n", "b176", "_88n", "b220", "b222", "b223", "_1n", "_223n", "adjustScalarBytes", "bytes", "uvRatio", "u", "v", "u2v", "mod", "u3v", "u5v3", "root", "x2", "dom4", "data", "ctx", "phflag", "concatBytes", "asciiToBytes", "ed4", "opts", "eddsa", "ed448_Point", "shake256_114", "map_to_curve_elligator2_curve448", "tv1", "Fp", "e1", "xd", "x1n", "ELL2_J", "tv2", "gxd", "gx1", "tv3", "y1", "ELL2_C1", "x2n", "y2", "e2", "xn", "y", "e3", "map_to_curve_elligator2_edwards448", "yn", "yd", "xn2", "xd2", "xd4", "yn2", "yd2", "xEn", "_4n", "xEd", "tv4", "yEn", "yEd", "e", "inv", "FpInvertBatch", "calcElligatorDecafMap", "r0", "d", "ed448_CURVE", "n", "Fp448", "r", "u0", "u1", "was_square", "ONE_MINUS_TWO_D", "v_prime", "sgn", "s", "s_abs", "isNegativeLE", "s2", "W0", "W1", "W2", "W3", "E448_CURVE", "shake256_64", "Fn", "Fn448", "ONE_MINUS_D", "SQRT_MINUS_D", "INVSQRT_MINUS_D", "invertSqrt", "_DecafPoint", "init_ed448", "__esmMin", "init_sha3", "init_utils", "init_edwards", "init_hash_to_curve", "init_modular", "init_montgomery", "init_oprf", "createHasher", "shake256", "Field", "edwards", "montgomery", "Pminus3div4", "Pminus3", "scalars", "number", "__DecafPoint", "PrimeEdwardsPoint", "ep", "ap", "other", "abytes", "equalBytes", "u1sq", "u2", "isValid", "invsqrt", "u3", "t", "hex", "hexToBytes", "X", "Z", "T", "ratio", "X1", "Y1", "X2", "Y2", "msg", "options", "DST", "expand_message_xof", "_DST_scalar", "xof", "bytesToNumberLE", "skipValidation", "r1", "R1", "r2", "R2", "createORPF", "_HMAC", "hmac", "init_hmac", "__esmMin", "init_utils", "hash", "key", "ahash", "abytes", "blockLen", "pad", "clean", "buf", "aexists", "out", "to", "oHash", "iHash", "finished", "destroyed", "outputLen", "message", "_splitEndoScalar", "k", "basis", "n", "a1", "b1", "a2", "b2", "c1", "divNearest", "c2", "k1", "k2", "k1neg", "_0n", "k2neg", "MAX_NUM", "bitMask", "bitLen", "_1n", "validateSigFormat", "format", "validateSigOpts", "opts", "def", "optsn", "optName", "abool", "weierstrass", "params", "extraOpts", "validated", "createCurveFields", "Fp", "Fn", "CURVE", "cofactor", "CURVE_ORDER", "validateObject", "endo", "lengths", "getWLengths", "assertCompressionIsSupported", "pointToBytes", "_c", "point", "isCompressed", "y", "bx", "hasEvenY", "concatBytes", "pprefix", "pointFromBytes", "bytes", "abytes", "comp", "uncomp", "length", "head", "tail", "x", "y2", "weierstrassEquation", "sqrtError", "err", "evenY", "L", "isValidXY", "encodePoint", "decodePoint", "x2", "x3", "left", "right", "_4a3", "_3n", "_4n", "_27b2", "acoord", "title", "banZero", "aprjpoint", "other", "Point", "splitEndoScalarN", "toAffineMemo", "memoized", "p", "iz", "X", "Y", "Z", "is0", "zz", "assertValidMemo", "finishEndo", "endoBeta", "k1p", "k2p", "negateCt", "P", "hex", "hexToBytes", "windowSize", "isLazy", "wnaf", "X1", "Y1", "Z1", "X2", "Y2", "Z2", "U1", "U2", "a", "b", "b3", "X3", "Y3", "Z3", "t0", "t1", "t2", "t3", "t4", "t5", "scalar", "fake", "mul", "normalizeZ", "k1f", "k2f", "f", "sc", "p1", "p2", "mulEndoUnsafe", "invertedZ", "isTorsionFree", "clearCofactor", "bytesToHex", "bits", "wNAF", "SWUFpSqrtRatio", "q", "l", "o", "_2n", "_2n_pow_c1_1", "_2n_pow_c1", "c3", "c4", "c5", "c6", "c7", "sqrtRatio", "u", "v", "tv1", "tv2", "tv3", "tv5", "tv4", "isQR", "i", "tvv5", "e1", "y1", "mapToCurveSimpleSWU", "validateField", "A", "B", "tv6", "isValid", "value", "tv4_inv", "FpInvertBatch", "ecdh", "ecdhOpts", "randomBytes_", "randomBytes", "getMinHashLength", "isValidSecretKey", "secretKey", "num", "isValidPublicKey", "publicKey", "publicKeyUncompressed", "randomSecretKey", "seed", "mapHashToField", "getPublicKey", "isProbPub", "item", "isBytes", "getSharedSecret", "secretKeyA", "publicKeyB", "s", "utils", "keygen", "createKeygen", "ecdsa", "hash", "ecdsaOpts", "ahash", "hmac", "key", "msg", "fnBits", "defaultSigOpts", "hasLargeCofactor", "isBiggerThanHalfOrder", "number", "HALF", "validateRS", "assertSmallCofactor", "validateSigLength", "size", "sizer", "Signature", "r", "recovery", "recid", "DER", "messageHash", "radj", "R", "ir", "h", "bits2int_modN", "u1", "u2", "Q", "rb", "sb", "bits2int", "bytesToNumberBE", "delta", "ORDER_MASK", "int2octets", "aInRange", "validateMsgAndHash", "message", "prehash", "prepSig", "lowS", "extraEntropy", "h1int", "d", "seedArgs", "e", "m", "k2sig", "kBytes", "ik", "normS", "sign", "createHmacDrbg", "verify", "signature", "end", "sig", "is", "recoverPublicKey", "DERErr", "init_weierstrass", "__esmMin", "init_hmac", "init_utils", "init_curve", "init_modular", "den", "tag", "data", "E", "dataLen", "len", "numberToHexUnpadded", "lenLen", "pos", "first", "isLong", "lengthBytes", "int", "tlv", "seqBytes", "seqLeftBytes", "rBytes", "rLeftBytes", "sBytes", "sLeftBytes", "rs", "ss", "seq", "nist_exports", "__export", "p256", "p256_hasher", "p256_oprf", "p384", "p384_hasher", "p384_oprf", "p521", "p521_hasher", "p521_oprf", "createSWU", "Point", "opts", "map", "mapToCurveSimpleSWU", "scalars", "p256_CURVE", "p384_CURVE", "p521_CURVE", "p256_Point", "p384_Point", "Fn521", "p521_Point", "init_nist", "__esmMin", "init_sha2", "init_hash_to_curve", "init_modular", "init_oprf", "init_weierstrass", "weierstrass", "ecdsa", "sha256", "createHasher", "createORPF", "sha384", "Field", "sha512", "import_mithril", "ActivityPubService", "#actorID", "actorID", "object", "result", "err", "objectId", "_result", "activity", "instanceOfAny", "object", "constructors", "c", "idbProxyableTypes", "cursorAdvanceMethods", "getIdbProxyableTypes", "getCursorAdvanceMethods", "transactionDoneMap", "transformCache", "reverseTransformCache", "promisifyRequest", "request", "promise", "resolve", "reject", "unlisten", "success", "error", "wrap", "cacheDonePromiseForTransaction", "tx", "done", "complete", "idbProxyTraps", "target", "prop", "receiver", "value", "replaceTraps", "callback", "wrapFunction", "func", "args", "unwrap", "transformCachableValue", "newValue", "openDB", "name", "version", "blocked", "upgrade", "blocking", "terminated", "openPromise", "event", "db", "readMethods", "writeMethods", "cachedMethods", "getMethod", "target", "prop", "targetFuncName", "useIndex", "isWrite", "method", "storeName", "args", "tx", "replaceTraps", "oldTraps", "receiver", "advanceMethodProps", "methodMap", "advanceResults", "ittrProxiedCursorToOriginalProxy", "cursorIteratorTraps", "cachedFunc", "iterate", "cursor", "proxiedCursor", "reverseTransformCache", "unwrap", "isIteratorProp", "instanceOfAny", "NewAPKeyPackage", "actorID", "publicPackage", "encode", "enc", "len", "write", "buf", "contramapBufferEncoder", "enc", "f", "u", "contramapBufferEncoders", "encoders", "toTuple", "value", "values", "totalLength", "writeTotal", "_offset", "_buffer", "i", "len", "write", "oldFunc", "currentLen", "offset", "buffer", "composeBufferEncoders", "t", "encVoid", "uint8Encoder", "n", "offset", "buffer", "encodeUint8", "encode", "decodeUint8", "b", "value", "uint16Encoder", "encodeUint16", "decodeUint16", "view", "uint32Encoder", "encodeUint32", "decodeUint32", "uint64Encoder", "encodeUint64", "decodeUint64", "mapDecoder", "dec", "f", "b", "offset", "x", "t", "l", "mapDecodersOption", "decoders", "initial", "mapDecoders", "r", "len", "result", "acc", "decoder", "decoded", "value", "length", "mapDecoderOption", "u", "flatMapDecoder", "flatMapDecoderAndMap", "_t", "orDecoder", "decT", "decU", "g", "decodedT", "decodedU", "len2", "succeedDecoder", "enumNumberToKey", "t", "n", "reverseMap", "obj", "acc", "key", "value", "openEnumNumberToKey", "rec", "decoded", "openEnumNumberEncoder", "s", "x", "defaultProposalTypes", "defaultProposalTypeEncoder", "contramapBufferEncoder", "uint16Encoder", "n", "encodeDefaultProposalType", "encode", "decodeDefaultProposalType", "mapDecoderOption", "decodeUint16", "enumNumberToKey", "defaultExtensionTypes", "defaultExtensionTypeEncoder", "contramapBufferEncoder", "uint16Encoder", "n", "encodeDefaultExtensionType", "encode", "decodeDefaultExtensionType", "mapDecoderOption", "decodeUint16", "enumNumberToKey", "MlsError", "message", "CodecError", "MlsError", "message", "DependencyError", "MlsError", "message", "CryptoError", "MlsError", "message", "InternalError", "varLenDataEncoder", "data", "len", "write", "lengthEncoder", "offset", "buffer", "view", "CodecError", "determineLength", "firstByte", "prefix", "decodeVarLenData", "buf", "length", "lengthFieldSize", "totalBytes", "varLenTypeEncoder", "enc", "totalLength", "writeTotal", "_offset", "_buffer", "i", "oldFunc", "currentLen", "headerLength", "writeLength", "decodeVarLenType", "dec", "b", "d", "cursor", "result", "item", "value", "extensionTypeEncoder", "t", "uint16Encoder", "defaultExtensionTypeEncoder", "encodeExtensionType", "encode", "decodeExtensionType", "orDecoder", "decodeDefaultExtensionType", "decodeUint16", "extensionEncoder", "contramapBufferEncoders", "varLenDataEncoder", "encodeExtension", "decodeExtension", "mapDecoders", "decodeVarLenData", "extensionType", "extensionData", "credentialTypes", "credentialTypeEncoder", "contramapBufferEncoder", "uint16Encoder", "openEnumNumberEncoder", "encodeCredentialType", "encode", "decodeCredentialType", "mapDecoderOption", "decodeUint16", "openEnumNumberToKey", "credentialBasicEncoder", "contramapBufferEncoders", "credentialTypeEncoder", "varLenDataEncoder", "c", "encodeCredentialBasic", "encode", "credentialX509Encoder", "varLenTypeEncoder", "encodeCredentialX509", "credentialCustomEncoder", "encodeCredentialCustom", "credentialEncoder", "encodeCredential", "decodeCredentialBasic", "mapDecoder", "decodeVarLenData", "identity", "decodeCredentialX509", "decodeVarLenType", "certificates", "decodeCredential", "flatMapDecoder", "decodeCredentialType", "credentialType", "externalSenderEncoder", "contramapBufferEncoders", "varLenDataEncoder", "credentialEncoder", "encodeExternalSender", "encode", "decodeExternalSender", "mapDecoders", "decodeVarLenData", "decodeCredential", "signaturePublicKey", "credential", "optionalEncoder", "encodeT", "len", "write", "offset", "buffer", "decodeOptional", "decodeT", "b", "decodeUint8", "result", "ciphersuites", "ciphersuiteEncoder", "contramapBufferEncoder", "uint16Encoder", "openEnumNumberEncoder", "encodeCiphersuite", "encode", "decodeCiphersuite", "mapDecoderOption", "decodeUint16", "openEnumNumberToKey", "getCiphersuiteFromName", "name", "ciphersuiteValues", "ciphersuites", "signWithLabel", "signKey", "label", "content", "s", "encode", "composeBufferEncoders", "varLenDataEncoder", "protocolVersions", "protocolVersionEncoder", "contramapBufferEncoder", "uint16Encoder", "t", "encodeProtocolVersion", "encode", "decodeProtocolVersion", "mapDecoderOption", "decodeUint16", "enumNumberToKey", "capabilitiesEncoder", "contramapBufferEncoders", "varLenTypeEncoder", "protocolVersionEncoder", "ciphersuiteEncoder", "uint16Encoder", "credentialTypeEncoder", "cap", "encodeCapabilities", "encode", "decodeCapabilities", "mapDecoders", "decodeVarLenType", "decodeProtocolVersion", "decodeCiphersuite", "decodeUint16", "decodeCredentialType", "versions", "ciphersuites", "extensions", "proposals", "credentials", "leafNodeSources", "leafNodeSourceEncoder", "contramapBufferEncoder", "uint8Encoder", "t", "encodeLeafNodeSource", "encode", "decodeLeafNodeSource", "mapDecoderOption", "decodeUint8", "enumNumberToKey", "lifetimeEncoder", "contramapBufferEncoders", "uint64Encoder", "lt", "encodeLifetime", "encode", "decodeLifetime", "mapDecoders", "decodeUint64", "notBefore", "notAfter", "defaultLifetime", "leafNodeDataEncoder", "contramapBufferEncoders", "varLenDataEncoder", "credentialEncoder", "capabilitiesEncoder", "data", "encodeLeafNodeData", "encode", "decodeLeafNodeData", "mapDecoders", "decodeVarLenData", "decodeCredential", "decodeCapabilities", "hpkePublicKey", "signaturePublicKey", "credential", "capabilities", "leafNodeInfoLifetimeEncoder", "leafNodeSourceEncoder", "lifetimeEncoder", "info", "encodeLeafNodeInfoLifetime", "leafNodeInfoUpdateEncoder", "contramapBufferEncoder", "i", "encodeLeafNodeInfoUpdate", "leafNodeInfoCommitEncoder", "encodeLeafNodeInfoCommit", "leafNodeInfoEncoder", "encodeLeafNodeInfo", "decodeLeafNodeInfoLifetime", "mapDecoder", "decodeLifetime", "lifetime", "decodeLeafNodeInfoCommit", "parentHash", "decodeLeafNodeInfo", "flatMapDecoder", "decodeLeafNodeSource", "leafNodeSource", "succeedDecoder", "leafNodeExtensionsEncoder", "varLenTypeEncoder", "extensionEncoder", "ext", "encodeLeafNodeExtensions", "decodeLeafNodeExtensions", "decodeVarLenType", "decodeExtension", "extensions", "groupIdLeafIndexEncoder", "uint32Encoder", "g", "encodeGroupIdLeafIndex", "leafNodeGroupInfoEncoder", "encVoid", "encodeLeafNodeGroupInfo", "leafNodeTBSEncoder", "tbs", "encodeLeafNodeTBS", "leafNodeEncoder", "leafNode", "encodeLeafNode", "decodeLeafNode", "signature", "decodeLeafNodeKeyPackage", "mapDecoderOption", "ln", "decodeLeafNodeCommit", "decodeLeafNodeUpdate", "signLeafNodeKeyPackage", "tbs", "signaturePrivateKey", "sig", "signWithLabel", "encode", "leafNodeTBSEncoder", "keyPackageTBSEncoder", "contramapBufferEncoders", "protocolVersionEncoder", "ciphersuiteEncoder", "varLenDataEncoder", "leafNodeEncoder", "varLenTypeEncoder", "extensionEncoder", "keyPackageTBS", "encodeKeyPackageTBS", "encode", "decodeKeyPackageTBS", "mapDecoders", "decodeProtocolVersion", "decodeCiphersuite", "decodeVarLenData", "decodeLeafNodeKeyPackage", "decodeVarLenType", "decodeExtension", "version", "cipherSuite", "initKey", "leafNode", "extensions", "keyPackageEncoder", "keyPackage", "encodeKeyPackage", "decodeKeyPackage", "signature", "signKeyPackage", "tbs", "signKey", "s", "signWithLabel", "generateKeyPackageWithKey", "credential", "capabilities", "lifetime", "extensions", "signatrueKeyPair", "cs", "leafNodeExtensions", "initKeys", "hpkeKeys", "privatePackage", "leafNodeTbs", "tbs", "signLeafNodeKeyPackage", "signKeyPackage", "generateKeyPackage", "sigKeys", "pskTypes", "pskTypeEncoder", "contramapBufferEncoder", "uint8Encoder", "t", "encodePskType", "encode", "decodePskType", "mapDecoderOption", "decodeUint8", "enumNumberToKey", "resumptionPSKUsages", "resumptionPSKUsageEncoder", "u", "encodeResumptionPSKUsage", "decodeResumptionPSKUsage", "encodePskInfoExternal", "contramapBufferEncoders", "varLenDataEncoder", "i", "encodePskInfoResumption", "uint64Encoder", "info", "decodePskInfoResumption", "mapDecoders", "decodeVarLenData", "decodeUint64", "usage", "pskGroupId", "pskEpoch", "pskInfoEncoder", "encodePskInfo", "decodePskInfo", "flatMapDecoder", "psktype", "mapDecoder", "pskId", "resumption", "pskIdEncoder", "pskid", "encodePskId", "decodePskId", "pskNonce", "pskLabelEncoder", "uint16Encoder", "label", "encodePskLabel", "decodePskLabel", "decodeUint16", "id", "index", "count", "addEncoder", "contramapBufferEncoder", "keyPackageEncoder", "a", "encodeAdd", "encode", "decodeAdd", "mapDecoder", "decodeKeyPackage", "keyPackage", "updateEncoder", "leafNodeEncoder", "u", "encodeUpdate", "decodeUpdate", "decodeLeafNodeUpdate", "leafNode", "removeEncoder", "uint32Encoder", "r", "encodeRemove", "decodeRemove", "decodeUint32", "removed", "pskEncoder", "pskIdEncoder", "p", "encodePSK", "decodePSK", "decodePskId", "preSharedKeyId", "reinitEncoder", "contramapBufferEncoders", "varLenDataEncoder", "protocolVersionEncoder", "ciphersuiteEncoder", "varLenTypeEncoder", "extensionEncoder", "encodeReinit", "decodeReinit", "mapDecoders", "decodeVarLenData", "decodeProtocolVersion", "decodeCiphersuite", "decodeVarLenType", "decodeExtension", "groupId", "version", "cipherSuite", "extensions", "externalInitEncoder", "encodeExternalInit", "decodeExternalInit", "kemOutput", "groupContextExtensionsEncoder", "g", "encodeGroupContextExtensions", "decodeGroupContextExtensions", "proposalAddEncoder", "defaultProposalTypeEncoder", "encodeProposalAdd", "proposalUpdateEncoder", "encodeProposalUpdate", "proposalRemoveEncoder", "encodeProposalRemove", "proposalPSKEncoder", "encodeProposalPSK", "proposalReinitEncoder", "encodeProposalReinit", "proposalExternalInitEncoder", "encodeProposalExternalInit", "proposalGroupContextExtensionsEncoder", "encodeProposalGroupContextExtensions", "proposalCustomEncoder", "uint16Encoder", "encodeProposalCustom", "proposalEncoder", "encodeProposal", "decodeProposalAdd", "add", "decodeProposalUpdate", "update", "decodeProposalRemove", "remove", "decodeProposalPSK", "psk", "decodeProposalReinit", "reinit", "decodeProposalExternalInit", "externalInit", "decodeProposalGroupContextExtensions", "groupContextExtensions", "decodeProposalCustom", "proposalType", "proposalData", "decodeProposal", "orDecoder", "flatMapDecoder", "decodeDefaultProposalType", "decodeUint16", "n", "proposalOrRefTypes", "proposalOrRefTypeEncoder", "contramapBufferEncoder", "uint8Encoder", "t", "encodeProposalOrRefType", "encode", "decodeProposalOrRefType", "mapDecoderOption", "decodeUint8", "enumNumberToKey", "proposalOrRefProposalEncoder", "contramapBufferEncoders", "proposalEncoder", "p", "encodeProposalOrRefProposal", "proposalOrRefProposalRefEncoder", "varLenDataEncoder", "r", "encodeProposalOrRefProposalRef", "proposalOrRefEncoder", "input", "encodeProposalOrRef", "decodeProposalOrRef", "flatMapDecoder", "proposalOrRefType", "mapDecoder", "decodeProposal", "proposal", "decodeVarLenData", "reference", "groupContextEncoder", "contramapBufferEncoders", "protocolVersionEncoder", "ciphersuiteEncoder", "varLenDataEncoder", "uint64Encoder", "varLenTypeEncoder", "extensionEncoder", "gc", "encodeGroupContext", "encode", "decodeGroupContext", "mapDecoders", "decodeProtocolVersion", "decodeCiphersuite", "decodeVarLenData", "decodeUint64", "decodeVarLenType", "decodeExtension", "version", "cipherSuite", "groupId", "epoch", "treeHash", "confirmedTranscriptHash", "extensions", "nodeTypes", "nodeTypeEncoder", "contramapBufferEncoder", "uint8Encoder", "t", "encodeNodeType", "encode", "decodeNodeType", "mapDecoderOption", "decodeUint8", "enumNumberToKey", "parentNodeEncoder", "contramapBufferEncoders", "varLenDataEncoder", "varLenTypeEncoder", "uint32Encoder", "node", "encodeParentNode", "encode", "decodeParentNode", "mapDecoders", "decodeVarLenData", "decodeVarLenType", "decodeUint32", "hpkePublicKey", "parentHash", "unmergedLeaves", "nodeEncoder", "node", "contramapBufferEncoders", "nodeTypeEncoder", "parentNodeEncoder", "n", "leafNodeEncoder", "encodeNode", "encode", "decodeNode", "flatMapDecoder", "decodeNodeType", "nodeType", "mapDecoder", "decodeParentNode", "parent", "decodeLeafNode", "leaf", "extendRatchetTree", "tree", "lastIndex", "InternalError", "neededSize", "nextFullBinaryTreeSize", "copy", "n", "d", "stripBlankNodes", "lastNonBlank", "ratchetTreeEncoder", "contramapBufferEncoder", "varLenTypeEncoder", "optionalEncoder", "nodeEncoder", "encodeRatchetTree", "encode", "decodeRatchetTree", "mapDecoder", "decodeVarLenType", "decodeOptional", "decodeNode", "leafNodeHashInputEncoder", "contramapBufferEncoders", "nodeTypeEncoder", "uint32Encoder", "optionalEncoder", "leafNodeEncoder", "input", "encodeLeafNodeHashInput", "encode", "decodeLeafNodeHashInput", "mapDecoders", "decodeUint32", "decodeOptional", "decodeLeafNode", "leafIndex", "leafNode", "parentNodeHashInputEncoder", "parentNodeEncoder", "varLenDataEncoder", "encodeParentNodeHashInput", "decodeParentNodeHashInput", "decodeParentNode", "decodeVarLenData", "parentNode", "leftHash", "rightHash", "treeHashInputEncoder", "encodeTreeHashInput", "decodeTreeHashInput", "flatMapDecoder", "decodeNodeType", "nodeType", "parentHashInputEncoder", "contramapBufferEncoders", "varLenDataEncoder", "i", "encodeParentHashInput", "encode", "decodeParentHashInput", "mapDecoders", "decodeVarLenData", "encryptionKey", "parentHash", "originalSiblingTreeHash", "hpkeCiphertextEncoder", "contramapBufferEncoders", "varLenDataEncoder", "egs", "encodeHpkeCiphertext", "encode", "decodeHpkeCiphertext", "mapDecoders", "decodeVarLenData", "kemOutput", "ciphertext", "updatePathNodeEncoder", "contramapBufferEncoders", "varLenDataEncoder", "varLenTypeEncoder", "hpkeCiphertextEncoder", "node", "encodeUpdatePathNode", "encode", "decodeUpdatePathNode", "mapDecoders", "decodeVarLenData", "decodeVarLenType", "decodeHpkeCiphertext", "hpkePublicKey", "encryptedPathSecret", "updatePathEncoder", "leafNodeEncoder", "path", "encodeUpdatePath", "decodeUpdatePath", "decodeLeafNodeCommit", "leafNode", "nodes", "commitEncoder", "contramapBufferEncoders", "varLenTypeEncoder", "proposalOrRefEncoder", "optionalEncoder", "updatePathEncoder", "commit", "encodeCommit", "encode", "decodeCommit", "mapDecoders", "decodeVarLenType", "decodeProposalOrRef", "decodeOptional", "decodeUpdatePath", "proposals", "path", "contentTypes", "contentTypeEncoder", "contramapBufferEncoder", "uint8Encoder", "t", "encodeContentType", "encode", "decodeContentType", "mapDecoderOption", "decodeUint8", "enumNumberToKey", "wireformats", "wireformatEncoder", "s", "contramapBufferEncoder", "uint16Encoder", "encodeWireformat", "encode", "decodeWireformat", "mapDecoderOption", "decodeUint16", "enumNumberToKey", "senderTypes", "senderTypeEncoder", "contramapBufferEncoder", "uint8Encoder", "t", "encodeSenderType", "encode", "decodeSenderType", "mapDecoderOption", "decodeUint8", "enumNumberToKey", "senderEncoder", "s", "contramapBufferEncoders", "uint32Encoder", "encodeSender", "decodeSender", "flatMapDecoder", "senderType", "mapDecoder", "decodeUint32", "leafIndex", "senderIndex", "reuseGuardEncoder", "g", "offset", "buffer", "encodeReuseGuard", "encode", "decodeReuseGuard", "b", "senderDataEncoder", "contramapBufferEncoders", "uint32Encoder", "s", "encodeSenderData", "decodeSenderData", "mapDecoders", "decodeUint32", "leafIndex", "generation", "reuseGuard", "senderDataAADEncoder", "varLenDataEncoder", "uint64Encoder", "contentTypeEncoder", "aad", "encodeSenderDataAAD", "decodeSenderDataAAD", "decodeVarLenData", "decodeUint64", "decodeContentType", "groupId", "epoch", "contentType", "framedContentApplicationDataEncoder", "contramapBufferEncoders", "contentTypeEncoder", "varLenDataEncoder", "f", "encodeFramedContentApplicationData", "encode", "framedContentProposalDataEncoder", "proposalEncoder", "encodeFramedContentProposalData", "framedContentCommitDataEncoder", "commitEncoder", "encodeFramedContentCommitData", "framedContentInfoEncoder", "fc", "encodeFramedContentInfo", "decodeFramedContentApplicationData", "mapDecoder", "decodeVarLenData", "applicationData", "decodeFramedContentProposalData", "decodeProposal", "proposal", "decodeFramedContentCommitData", "decodeCommit", "commit", "decodeFramedContentInfo", "flatMapDecoder", "decodeContentType", "contentType", "framedContentEncoder", "contramapBufferEncoders", "varLenDataEncoder", "uint64Encoder", "senderEncoder", "framedContentInfoEncoder", "fc", "encodeFramedContent", "encode", "decodeFramedContent", "mapDecoders", "decodeVarLenData", "decodeUint64", "decodeSender", "decodeFramedContentInfo", "groupId", "epoch", "sender", "authenticatedData", "info", "senderInfoEncoder", "groupContextEncoder", "encVoid", "encodeSenderInfo", "framedContentTBSEncoder", "protocolVersionEncoder", "wireformatEncoder", "f", "encodeFramedContentTBS", "encodeFramedContentAuthDataContent", "authData", "encodeFramedContentAuthDataCommit", "contramapBufferEncoder", "data", "framedContentAuthDataEncoder", "d", "encodeFramedContentAuthData", "decodeFramedContentAuthDataCommit", "mapDecoder", "confirmationTag", "decodeFramedContentAuthData", "contentType", "signature", "commitData", "authenticatedContentEncoder", "contramapBufferEncoders", "wireformatEncoder", "framedContentEncoder", "framedContentAuthDataEncoder", "a", "encodeAuthenticatedContent", "encode", "decodeAuthenticatedContent", "mapDecoders", "decodeWireformat", "flatMapDecoder", "decodeFramedContent", "content", "mapDecoder", "decodeFramedContentAuthData", "auth", "wireformat", "contentAuth", "authenticatedContentTBMEncoder", "framedContentTBSEncoder", "t", "encodeAuthenticatedContentTBM", "publicMessageInfoEncoder", "info", "varLenDataEncoder", "encVoid", "encodePublicMessageInfo", "encode", "decodePublicMessageInfo", "senderType", "mapDecoder", "decodeVarLenData", "membershipTag", "succeedDecoder", "publicMessageEncoder", "contramapBufferEncoders", "framedContentEncoder", "framedContentAuthDataEncoder", "msg", "encodePublicMessage", "decodePublicMessage", "flatMapDecoder", "decodeFramedContent", "content", "mapDecoders", "decodeFramedContentAuthData", "auth", "requiredCapabilitiesEncoder", "contramapBufferEncoders", "varLenTypeEncoder", "uint16Encoder", "credentialTypeEncoder", "rc", "encodeRequiredCapabilities", "encode", "decodeRequiredCapabilities", "mapDecoders", "decodeVarLenType", "decodeUint16", "decodeCredentialType", "extensionTypes", "proposalTypes", "credentialTypes", "groupInfoTBSEncoder", "contramapBufferEncoders", "groupContextEncoder", "varLenTypeEncoder", "extensionEncoder", "varLenDataEncoder", "uint32Encoder", "g", "encodeGroupInfoTBS", "encode", "decodeGroupInfoTBS", "mapDecoders", "decodeGroupContext", "decodeVarLenType", "decodeExtension", "decodeVarLenData", "decodeUint32", "groupContext", "extensions", "confirmationTag", "signer", "groupInfoEncoder", "encodeGroupInfo", "decodeGroupInfo", "tbs", "signature", "confirmedTranscriptHashInputEncoder", "contramapBufferEncoders", "wireformatEncoder", "framedContentEncoder", "varLenDataEncoder", "input", "encodeConfirmedTranscriptHashInput", "encode", "decodeConfirmedTranscriptHashInput", "mapDecodersOption", "decodeWireformat", "decodeFramedContent", "decodeVarLenData", "wireformat", "content", "signature", "bytesToArrayBuffer", "b", "ab", "toBufferSource", "concatUint8Arrays", "a", "b", "result", "groupSecretsEncoder", "contramapBufferEncoders", "varLenDataEncoder", "optionalEncoder", "varLenTypeEncoder", "pskIdEncoder", "gs", "encodeGroupSecrets", "encode", "decodeGroupSecrets", "mapDecoders", "decodeVarLenData", "decodeOptional", "decodeVarLenType", "decodePskId", "joinerSecret", "pathSecret", "psks", "encryptedGroupSecretsEncoder", "contramapBufferEncoders", "varLenDataEncoder", "hpkeCiphertextEncoder", "egs", "encodeEncryptedGroupSecrets", "encode", "decodeEncryptedGroupSecrets", "mapDecoders", "decodeVarLenData", "decodeHpkeCiphertext", "newMember", "encryptedGroupSecrets", "welcomeEncoder", "ciphersuiteEncoder", "varLenTypeEncoder", "welcome", "encodeWelcome", "decodeWelcome", "decodeCiphersuite", "decodeVarLenType", "cipherSuite", "secrets", "encryptedGroupInfo", "privateMessageEncoder", "contramapBufferEncoders", "varLenDataEncoder", "uint64Encoder", "contentTypeEncoder", "msg", "encodePrivateMessage", "encode", "decodePrivateMessage", "mapDecoders", "decodeVarLenData", "decodeUint64", "decodeContentType", "groupId", "epoch", "contentType", "authenticatedData", "encryptedSenderData", "ciphertext", "privateContentAADEncoder", "aad", "encodePrivateContentAAD", "decodePrivateContentAAD", "makeHashImpl", "sc", "h", "data", "result", "toBufferSource", "key", "importMacKey", "mac", "rawKey", "HpkeError", "e", "message", "InvalidParamError", "SerializeError", "HpkeError", "DeserializeError", "EncapError", "DecapError", "ExportError", "SealError", "OpenError", "MessageLimitReachedError", "DeriveKeyPairError", "NotSupportedError", "dntGlobals", "dntGlobalThis", "createMergeProxy", "baseObj", "extObj", "_target", "prop", "_receiver", "value", "success", "baseKeys", "extKeys", "extKeysSet", "k", "desc", "loadSubtleCrypto", "dntGlobalThis", "webcrypto", "NotSupportedError", "NativeAlgorithm", "Mode", "KemId", "KdfId", "AeadId", "EMPTY", "SUITE_ID_HEADER_KEM", "isCryptoKeyPair", "x", "i2Osp", "n", "w", "ret", "i", "concat", "a", "b", "base64UrlToBytes", "v", "base64", "byteString", "xor", "a", "b", "buf", "i", "LABEL_EAE_PRK", "LABEL_SHARED_SECRET", "concat3", "a", "b", "c", "ret", "Dhkem", "id", "prim", "kdf", "suiteId", "SUITE_ID_HEADER_KEM", "i2Osp", "key", "format", "isPublic", "ikm", "InvalidParamError", "params", "ke", "isCryptoKeyPair", "enc", "pkrm", "dh", "sks", "dh1", "dh2", "concat", "kemContext", "pks", "pksm", "sharedSecret", "e", "EncapError", "pke", "skr", "pkr", "DecapError", "labeledIkm", "labeledInfo", "EMPTY", "KEM_USAGES", "LABEL_DKP_PRK", "LABEL_SK", "Bignum", "size", "src", "i", "v", "LABEL_CANDIDATE", "ORDER_P_256", "ORDER_P_384", "ORDER_P_521", "PKCS8_ALG_ID_P_256", "PKCS8_ALG_ID_P_384", "PKCS8_ALG_ID_P_521", "Ec", "NativeAlgorithm", "kem", "hkdf", "KemId", "key", "e", "SerializeError", "DeserializeError", "jwk", "base64UrlToBytes", "format", "isPublic", "KEM_USAGES", "NotSupportedError", "ikm", "dkpPrk", "EMPTY", "LABEL_DKP_PRK", "bn", "Bignum", "counter", "bytes", "i2Osp", "sk", "DeriveKeyPairError", "pk", "k", "pkcs8Key", "HPKE_VERSION", "HkdfNative", "NativeAlgorithm", "KdfId", "EMPTY", "suiteId", "label", "ikm", "ret", "info", "len", "salt", "InvalidParamError", "key", "prk", "okm", "p", "prev", "mid", "tail", "tmp", "i", "cur", "baseKey", "HkdfSha256Native", "HkdfSha384Native", "HkdfSha512Native", "AEAD_USAGES", "isBytes", "a", "abytes", "value", "length", "title", "bytes", "len", "needsLen", "prefix", "ofLen", "got", "ahash", "h", "anumber", "aexists", "instance", "checkFinished", "anumber", "n", "clean", "arrays", "i", "_HMAC", "hash", "key", "ahash", "abytes", "blockLen", "pad", "clean", "buf", "aexists", "out", "to", "oHash", "iHash", "finished", "destroyed", "outputLen", "hmac", "message", "_0n", "_1n", "_2n", "AesGcmContext", "NativeAlgorithm", "key", "iv", "data", "aad", "alg", "AEAD_USAGES", "Aes128Gcm", "AeadId", "Aes256Gcm", "emitNotSupported", "_resolve", "reject", "NotSupportedError", "LABEL_SEC", "ExporterContextImpl", "api", "kdf", "exporterSecret", "_data", "_aad", "emitNotSupported", "exporterContext", "len", "InvalidParamError", "e", "ExportError", "RecipientExporterContextImpl", "SenderExporterContextImpl", "enc", "EncryptionContextImpl", "ExporterContextImpl", "api", "kdf", "params", "key", "k", "seqBytes", "i2Osp", "xor", "MessageLimitReachedError", "__classPrivateFieldGet", "receiver", "state", "kind", "f", "__classPrivateFieldSet", "value", "_Mutex_locked", "Mutex", "releaseLock", "nextLock", "resolve", "previousLock", "__classPrivateFieldGet", "receiver", "state", "kind", "f", "__classPrivateFieldSet", "value", "_RecipientContextImpl_mutex", "RecipientContextImpl", "EncryptionContextImpl", "data", "aad", "EMPTY", "Mutex", "release", "pt", "e", "OpenError", "__classPrivateFieldGet", "receiver", "state", "kind", "f", "__classPrivateFieldSet", "value", "_SenderContextImpl_mutex", "SenderContextImpl", "EncryptionContextImpl", "api", "kdf", "params", "enc", "data", "aad", "EMPTY", "Mutex", "release", "ct", "e", "SealError", "LABEL_BASE_NONCE", "LABEL_EXP", "LABEL_INFO_HASH", "LABEL_KEY", "LABEL_PSK_ID_HASH", "LABEL_SECRET", "SUITE_ID_HEADER_HPKE", "CipherSuiteNative", "NativeAlgorithm", "params", "InvalidParamError", "i2Osp", "dh", "mode", "Mode", "sharedSecret", "pt", "aad", "EMPTY", "ctx", "ct", "pskId", "pskIdHash", "info", "infoHash", "keyScheduleContext", "psk", "ikm", "exporterSecretInfo", "exporterSecret", "AeadId", "keyInfo", "key", "baseNonceInfo", "baseNonce", "enc", "res", "SenderExporterContextImpl", "SenderContextImpl", "RecipientExporterContextImpl", "RecipientContextImpl", "DhkemP256HkdfSha256Native", "Dhkem", "kdf", "HkdfSha256Native", "prim", "Ec", "KemId", "DhkemP384HkdfSha384Native", "HkdfSha384Native", "DhkemP521HkdfSha512Native", "HkdfSha512Native", "CipherSuite", "CipherSuiteNative", "DhkemP256HkdfSha256", "DhkemP256HkdfSha256Native", "DhkemP384HkdfSha384", "DhkemP384HkdfSha384Native", "DhkemP521HkdfSha512", "DhkemP521HkdfSha512Native", "HkdfSha256", "HkdfSha256Native", "HkdfSha384", "HkdfSha384Native", "HkdfSha512", "HkdfSha512Native", "ALG_NAME", "PKCS8_ALG_ID_X25519", "X25519", "NativeAlgorithm", "hkdf", "key", "e", "SerializeError", "DeserializeError", "jwk", "base64UrlToBytes", "format", "isPublic", "KEM_USAGES", "NotSupportedError", "ikm", "dkpPrk", "EMPTY", "LABEL_DKP_PRK", "rawSk", "LABEL_SK", "rawSkBytes", "sk", "DeriveKeyPairError", "pk", "k", "pkcs8Key", "DhkemX25519HkdfSha256", "Dhkem", "kdf", "HkdfSha256Native", "KemId", "X25519", "ALG_NAME", "PKCS8_ALG_ID_X448", "X448", "NativeAlgorithm", "hkdf", "key", "e", "SerializeError", "DeserializeError", "jwk", "base64UrlToBytes", "format", "isPublic", "KEM_USAGES", "NotSupportedError", "ikm", "dkpPrk", "EMPTY", "LABEL_DKP_PRK", "rawSk", "LABEL_SK", "rawSkBytes", "sk", "DeriveKeyPairError", "pk", "k", "pkcs8Key", "DhkemX448HkdfSha512", "Dhkem", "kdf", "HkdfSha512Native", "KemId", "X448", "makeGenericHpke", "hpkealg", "aead", "cs", "privateKey", "kemOutput", "ciphertext", "info", "aad", "result", "bytesToArrayBuffer", "e", "CryptoError", "publicKey", "plaintext", "exporterContext", "length", "context", "k", "key", "prepadPrivateKeyP521", "nonce", "ikm", "kp", "lengthDifference", "concatUint8Arrays", "makeAead", "aeadAlg", "key", "nonce", "aad", "plaintext", "encryptAesGcm", "ciphertext", "decryptAesGcm", "Aes128Gcm", "Aes256Gcm", "Chacha20Poly1305", "chacha20poly1305", "DependencyError", "cryptoKey", "toBufferSource", "result", "makeKdfImpl", "k", "salt", "ikm", "result", "bytesToArrayBuffer", "prk", "info", "len", "makeKdf", "kdfAlg", "HkdfSha256", "HkdfSha384", "HkdfSha512", "makeDhKem", "kemAlg", "DhkemP256HkdfSha256", "DhkemX25519HkdfSha256", "DhkemX448HkdfSha512", "DhkemP521HkdfSha512", "DhkemP384HkdfSha384", "MlKem512", "DependencyError", "MlKem768", "MlKem1024", "XWing", "makeHpke", "hpkealg", "aead", "aeadInterface", "makeAead", "cs", "CipherSuite", "makeDhKem", "makeKdf", "makeGenericHpke", "defaultRng", "n", "makeNobleSignatureImpl", "alg", "ed25519", "signKey", "message", "publicKey", "signature", "DependencyError", "ed448", "p256", "p384", "p521", "ml_dsa87", "keys", "defaultCryptoProvider", "cs", "sc", "makeKdfImpl", "makeKdf", "makeHashImpl", "makeNobleSignatureImpl", "makeHpke", "defaultRng", "getCiphersuiteImpl", "cs", "provider", "defaultCryptoProvider", "mlsPublicMessageEncoder", "contramapBufferEncoders", "wireformatEncoder", "publicMessageEncoder", "msg", "encodeMlsPublicMessage", "encode", "mlsWelcomeEncoder", "welcomeEncoder", "wm", "encodeMlsWelcome", "mlsPrivateMessageEncoder", "privateMessageEncoder", "pm", "encodeMlsPrivateMessage", "mlsGroupInfoEncoder", "groupInfoEncoder", "gi", "encodeMlsGroupInfo", "mlsKeyPackageEncoder", "keyPackageEncoder", "kp", "encodeMlsKeyPackage", "mlsMessageContentEncoder", "mc", "encodeMlsMessageContent", "decodeMlsMessageContent", "flatMapDecoder", "decodeWireformat", "wireformat", "mapDecoder", "decodePublicMessage", "publicMessage", "decodeWelcome", "welcome", "decodePrivateMessage", "privateMessage", "decodeGroupInfo", "groupInfo", "decodeKeyPackage", "keyPackage", "mlsMessageEncoder", "protocolVersionEncoder", "w", "encodeMlsMessage", "decodeMlsMessage", "mapDecoders", "decodeProtocolVersion", "version", "greaseValues", "defaultGreaseConfig", "grease", "greaseConfig", "greaseCiphersuites", "n", "greaseCredentials", "greaseCapabilities", "config", "capabilities", "greaseCiphersuites", "greaseCredentials", "grease", "defaultCapabilities", "greaseCapabilities", "defaultGreaseConfig", "ciphersuites", "KeyPackageService", "#activityPub", "#database", "#keyPackages", "#actorID", "activityPub", "actorID", "openDB", "db", "oldVersion", "_newVersion", "transaction", "event", "keyPackages", "implementation", "getCiphersuiteImpl", "getCiphersuiteFromName", "credential", "newPackage", "generateKeyPackage", "defaultCapabilities", "defaultLifetime", "remotePackage", "NewAPKeyPackage", "err", "localPackage", "ServiceFactory", "#actor", "#activityPub", "#keyPackage", "ActivityPubService", "KeyPackageService", "actor", "result", "import_mithril", "ViewContainer", "#factory", "factory", "m", "Application", "root", "factory", "ServiceFactory", "viewContainer", "ViewContainer", "m", "root", "app", "Application"]
}
