"use strict";(()=>{var Sp=Object.create;var ga=Object.defineProperty;var Pp=Object.getOwnPropertyDescriptor;var kp=Object.getOwnPropertyNames;var Ap=Object.getPrototypeOf,Tp=Object.prototype.hasOwnProperty;var Kr=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var Ke=(e,t)=>()=>(e&&(t=e(e=0)),t);var we=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ho=(e,t)=>{for(var r in t)ga(e,r,{get:t[r],enumerable:!0})},Lp=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of kp(t))!Tp.call(e,o)&&o!==r&&ga(e,o,{get:()=>t[o],enumerable:!(n=Pp(t,o))||n.enumerable});return e};var Wt=(e,t,r)=>(r=e!=null?Sp(Ap(e)):{},Lp(t||!e||!e.__esModule?ga(r,"default",{value:e,enumerable:!0}):r,e));var Zt=we((Wx,Sc)=>{"use strict";function Ir(e,t,r,n,o,i){return{tag:e,key:t,attrs:r,children:n,text:o,dom:i,is:void 0,domSize:void 0,state:void 0,events:void 0,instance:void 0}}Ir.normalize=function(e){return Array.isArray(e)?Ir("[",void 0,void 0,Ir.normalizeChildren(e),void 0,void 0):e==null||typeof e=="boolean"?null:typeof e=="object"?e:Ir("#",void 0,void 0,String(e),void 0,void 0)};Ir.normalizeChildren=function(e){for(var t=new Array(e.length),r=0,n=0;n<e.length;n++)t[n]=Ir.normalize(e[n]),t[n]!==null&&t[n].key!=null&&r++;if(r!==0&&r!==e.length)throw new TypeError(t.includes(null)?"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.":"In fragments, vnodes must either all have keys or none have keys.");return t};Sc.exports=Ir});var Ea=we((Zx,Pc)=>{"use strict";var Kp=Zt();Pc.exports=function(e,t){return e==null||typeof e=="object"&&e.tag==null&&!Array.isArray(e)?t.length===1&&Array.isArray(t[0])&&(t=t[0]):(t=t.length===0&&Array.isArray(e)?e:[e,...t],e=void 0),Kp("",e&&e.key,e,t)}});var Do=we((Xx,kc)=>{"use strict";kc.exports={}.hasOwnProperty});var va=we((Yx,Ac)=>{"use strict";Ac.exports={}});var _a=we(($x,Tc)=>{"use strict";var Ip=va();Tc.exports=new Map([[Ip,!0]])});var Pa=we((Qx,Ic)=>{"use strict";var Bp=Zt(),Cp=Ea(),Sa=Do(),Lc=va(),Hp=_a(),Dp=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,Kc=Object.create(null);function Op(e){for(var t in e)if(Sa.call(e,t))return!1;return!0}function Np(e){return e==="value"||e==="checked"||e==="selectedIndex"||e==="selected"}function Up(e){for(var t,r="div",n=[],o={},i=!0;t=Dp.exec(e);){var a=t[1],s=t[2];if(a===""&&s!=="")r=s;else if(a==="#")o.id=s;else if(a===".")n.push(s);else if(t[3][0]==="["){var c=t[6];c&&(c=c.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),t[4]==="class"?n.push(c):(o[t[4]]=c===""?c:c||!0,Np(t[4])&&(i=!1))}}return n.length>0&&(o.className=n.join(" ")),Op(o)?o=Lc:Hp.set(o,i),Kc[e]={tag:r,attrs:o,is:o.is}}function Mp(e,t){t.tag=e.tag;var r=t.attrs;if(r==null)return t.attrs=e.attrs,t.is=e.is,t;if(Sa.call(r,"class")&&(r.class!=null&&(r.className=r.class),r.class=null),e.attrs!==Lc){var n=r.className;r=Object.assign({},e.attrs,r),e.attrs.className!=null&&(r.className=n!=null?String(e.attrs.className)+" "+String(n):e.attrs.className)}return e.tag==="input"&&Sa.call(r,"type")&&(r=Object.assign({type:r.type},r)),t.is=r.is,t.attrs=r,t}function Rp(e,t,...r){if(e==null||typeof e!="string"&&typeof e!="function"&&typeof e.view!="function")throw Error("The selector must be either a string or a component.");var n=Cp(t,r);return typeof e=="string"&&(n.children=Bp.normalizeChildren(n.children),e!=="[")?Mp(Kc[e]||Up(e),n):(n.attrs==null&&(n.attrs={}),n.tag=e,n)}Ic.exports=Rp});var Cc=we((Jx,Bc)=>{"use strict";var jp=Zt();Bc.exports=function(e){return e==null&&(e=""),jp("<",void 0,void 0,e,void 0,void 0)}});var Dc=we((ew,Hc)=>{"use strict";var Gp=Zt(),zp=Ea();Hc.exports=function(e,...t){var r=zp(e,t);return r.attrs==null&&(r.attrs={}),r.tag="[",r.children=Gp.normalizeChildren(r.children),r}});var Nc=we((tw,Oc)=>{"use strict";var ka=Pa();ka.trust=Cc();ka.fragment=Dc();Oc.exports=ka});var Aa=we((rw,Uc)=>{"use strict";Uc.exports=new WeakMap});var Ta=we((nw,Rc)=>{"use strict";var Mc=Aa();function*qp(e){var t=e.dom,r=e.domSize,n=Mc.get(t);if(t!=null)do{var o=t.nextSibling;Mc.get(t)===n&&(yield t,r--),t=o}while(r)}Rc.exports=qp});var zc=we((ow,Gc)=>{"use strict";var La=Zt(),Vp=Aa(),Ka=Ta(),jc=_a();Gc.exports=function(){var e={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},t,r;function n(u){return u.ownerDocument}function o(u){return u.attrs&&u.attrs.xmlns||e[u.tag]}function i(u,f){if(u.state!==f)throw new Error("'vnode.state' must not be modified.")}function a(u){var f=u.state;try{return this.apply(f,arguments)}finally{i(u,f)}}function s(u){try{return n(u).activeElement}catch{return null}}function c(u,f,m,H,U,X,le){for(var he=m;he<H;he++){var re=f[he];re!=null&&d(u,re,U,le,X)}}function d(u,f,m,H,U){var X=f.tag;if(typeof X=="string")switch(f.state={},f.attrs!=null&&lr(f.attrs,f,m),X){case"#":l(u,f,U);break;case"<":w(u,f,H,U);break;case"[":h(u,f,m,H,U);break;default:b(u,f,m,H,U)}else E(u,f,m,H,U)}function l(u,f,m){f.dom=n(u).createTextNode(f.children),y(u,f.dom,m)}var p={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function w(u,f,m,H){var U=f.children.match(/^\s*?<(\w+)/im)||[],X=n(u).createElement(p[U[1]]||"div");m==="http://www.w3.org/2000/svg"?(X.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+f.children+"</svg>",X=X.firstChild):X.innerHTML=f.children,f.dom=X.firstChild,f.domSize=X.childNodes.length;for(var le=n(u).createDocumentFragment(),he;he=X.firstChild;)le.appendChild(he);y(u,le,H)}function h(u,f,m,H,U){var X=n(u).createDocumentFragment();if(f.children!=null){var le=f.children;c(X,le,0,le.length,m,null,H)}f.dom=X.firstChild,f.domSize=X.childNodes.length,y(u,X,U)}function b(u,f,m,H,U){var X=f.tag,le=f.attrs,he=f.is;H=o(f)||H;var re=H?he?n(u).createElementNS(H,X,{is:he}):n(u).createElementNS(H,X):he?n(u).createElement(X,{is:he}):n(u).createElement(X);if(f.dom=re,le!=null&&N(f,le,H),y(u,re,U),!g(f)&&f.children!=null){var me=f.children;c(re,me,0,me.length,m,null,H),f.tag==="select"&&le!=null&&oe(f,le)}}function L(u,f){var m;if(typeof u.tag.view=="function"){if(u.state=Object.create(u.tag),m=u.state.view,m.$$reentrantLock$$!=null)return;m.$$reentrantLock$$=!0}else{if(u.state=void 0,m=u.tag,m.$$reentrantLock$$!=null)return;m.$$reentrantLock$$=!0,u.state=u.tag.prototype!=null&&typeof u.tag.prototype.view=="function"?new u.tag(u):u.tag(u)}if(lr(u.state,u,f),u.attrs!=null&&lr(u.attrs,u,f),u.instance=La.normalize(a.call(u.state.view,u)),u.instance===u)throw Error("A view cannot return the vnode it received as argument");m.$$reentrantLock$$=null}function E(u,f,m,H,U){L(f,m),f.instance!=null?(d(u,f.instance,m,H,U),f.dom=f.instance.dom,f.domSize=f.instance.domSize):f.domSize=0}function v(u,f,m,H,U,X){if(!(f===m||f==null&&m==null))if(f==null||f.length===0)c(u,m,0,m.length,H,U,X);else if(m==null||m.length===0)x(u,f,0,f.length);else{var le=f[0]!=null&&f[0].key!=null,he=m[0]!=null&&m[0].key!=null,re=0,me=0;if(!le)for(;me<f.length&&f[me]==null;)me++;if(!he)for(;re<m.length&&m[re]==null;)re++;if(le!==he)x(u,f,me,f.length),c(u,m,re,m.length,H,U,X);else if(he){for(var Ye=f.length-1,He=m.length-1,Co,$e,Le,Fe,Se,ma;Ye>=me&&He>=re&&(Fe=f[Ye],Se=m[He],Fe.key===Se.key);)Fe!==Se&&T(u,Fe,Se,H,U,X),Se.dom!=null&&(U=Se.dom),Ye--,He--;for(;Ye>=me&&He>=re&&($e=f[me],Le=m[re],$e.key===Le.key);)me++,re++,$e!==Le&&T(u,$e,Le,H,Z(f,me,U),X);for(;Ye>=me&&He>=re&&!(re===He||$e.key!==Se.key||Fe.key!==Le.key);)ma=Z(f,me,U),P(u,Fe,ma),Fe!==Le&&T(u,Fe,Le,H,ma,X),++re<=--He&&P(u,$e,U),$e!==Se&&T(u,$e,Se,H,U,X),Se.dom!=null&&(U=Se.dom),me++,Ye--,Fe=f[Ye],Se=m[He],$e=f[me],Le=m[re];for(;Ye>=me&&He>=re&&Fe.key===Se.key;)Fe!==Se&&T(u,Fe,Se,H,U,X),Se.dom!=null&&(U=Se.dom),Ye--,He--,Fe=f[Ye],Se=m[He];if(re>He)x(u,f,me,Ye+1);else if(me>Ye)c(u,m,re,He+1,H,U,X);else{var _p=U,_c=He-re+1,Nn=new Array(_c),ya=0,Ae=0,xa=2147483647,wa=0,Co,ba;for(Ae=0;Ae<_c;Ae++)Nn[Ae]=-1;for(Ae=He;Ae>=re;Ae--){Co==null&&(Co=C(f,me,Ye+1)),Se=m[Ae];var cn=Co[Se.key];cn!=null&&(xa=cn<xa?cn:-1,Nn[Ae-re]=cn,Fe=f[cn],f[cn]=null,Fe!==Se&&T(u,Fe,Se,H,U,X),Se.dom!=null&&(U=Se.dom),wa++)}if(U=_p,wa!==Ye-me+1&&x(u,f,me,Ye+1),wa===0)c(u,m,re,He+1,H,U,X);else if(xa===-1)for(ba=z(Nn),ya=ba.length-1,Ae=He;Ae>=re;Ae--)Le=m[Ae],Nn[Ae-re]===-1?d(u,Le,H,X,U):ba[ya]===Ae-re?ya--:P(u,Le,U),Le.dom!=null&&(U=m[Ae].dom);else for(Ae=He;Ae>=re;Ae--)Le=m[Ae],Nn[Ae-re]===-1&&d(u,Le,H,X,U),Le.dom!=null&&(U=m[Ae].dom)}}else{var ha=f.length<m.length?f.length:m.length;for(re=re<me?re:me;re<ha;re++)$e=f[re],Le=m[re],!($e===Le||$e==null&&Le==null)&&($e==null?d(u,Le,H,X,Z(f,re+1,U)):Le==null?K(u,$e):T(u,$e,Le,H,Z(f,re+1,U),X));f.length>ha&&x(u,f,re,f.length),m.length>ha&&c(u,m,re,m.length,H,U,X)}}}function T(u,f,m,H,U,X){var le=f.tag,he=m.tag;if(le===he&&f.is===m.is){if(m.state=f.state,m.events=f.events,Bo(m,f))return;if(typeof le=="string")switch(m.attrs!=null&&Ft(m.attrs,m,H),le){case"#":S(f,m);break;case"<":D(u,f,m,X,U);break;case"[":G(u,f,m,H,U,X);break;default:R(f,m,H,X)}else q(u,f,m,H,U,X)}else K(u,f),d(u,m,H,X,U)}function S(u,f){u.children.toString()!==f.children.toString()&&(u.dom.nodeValue=f.children),f.dom=u.dom}function D(u,f,m,H,U){f.children!==m.children?(k(u,f),w(u,m,H,U)):(m.dom=f.dom,m.domSize=f.domSize)}function G(u,f,m,H,U,X){v(u,f.children,m.children,H,U,X);var le=0,he=m.children;if(m.dom=null,he!=null)for(var re=0;re<he.length;re++){var me=he[re];me!=null&&me.dom!=null&&(m.dom==null&&(m.dom=me.dom),le+=me.domSize||1)}m.domSize=le}function R(u,f,m,H){var U=f.dom=u.dom;H=o(f)||H,(u.attrs!=f.attrs||f.attrs!=null&&!jc.get(f.attrs))&&te(f,u.attrs,f.attrs,H),g(f)||v(U,u.children,f.children,m,null,H)}function q(u,f,m,H,U,X){if(m.instance=La.normalize(a.call(m.state.view,m)),m.instance===m)throw Error("A view cannot return the vnode it received as argument");Ft(m.state,m,H),m.attrs!=null&&Ft(m.attrs,m,H),m.instance!=null?(f.instance==null?d(u,m.instance,H,X,U):T(u,f.instance,m.instance,H,U,X),m.dom=m.instance.dom,m.domSize=m.instance.domSize):(f.instance!=null&&K(u,f.instance),m.domSize=0)}function C(u,f,m){for(var H=Object.create(null);f<m;f++){var U=u[f];if(U!=null){var X=U.key;X!=null&&(H[X]=f)}}return H}var I=[];function z(u){for(var f=[0],m=0,H=0,U=0,X=I.length=u.length,U=0;U<X;U++)I[U]=u[U];for(var U=0;U<X;++U)if(u[U]!==-1){var le=f[f.length-1];if(u[le]<u[U]){I[U]=le,f.push(U);continue}for(m=0,H=f.length-1;m<H;){var he=(m>>>1)+(H>>>1)+(m&H&1);u[f[he]]<u[U]?m=he+1:H=he}u[U]<u[f[m]]&&(m>0&&(I[U]=f[m-1]),f[m]=U)}for(m=f.length,H=f[m-1];m-- >0;)f[m]=H,H=I[H];return I.length=0,f}function Z(u,f,m){for(;f<u.length;f++)if(u[f]!=null&&u[f].dom!=null)return u[f].dom;return m}function P(u,f,m){if(f.dom!=null){var H;if(f.domSize==null||f.domSize===1)H=f.dom;else{H=n(u).createDocumentFragment();for(var U of Ka(f))H.appendChild(U)}y(u,H,m)}}function y(u,f,m){m!=null?u.insertBefore(f,m):u.appendChild(f)}function g(u){if(u.attrs==null||u.attrs.contenteditable==null&&u.attrs.contentEditable==null)return!1;var f=u.children;if(f!=null&&f.length===1&&f[0].tag==="<"){var m=f[0].children;u.dom.innerHTML!==m&&(u.dom.innerHTML=m)}else if(f!=null&&f.length!==0)throw new Error("Child node of a contenteditable must be trusted.");return!0}function x(u,f,m,H){for(var U=m;U<H;U++){var X=f[U];X!=null&&K(u,X)}}function _(u,f,m,H){var U=f.state,X=a.call(m.onbeforeremove,f);if(X!=null){var le=r;for(var he of Ka(f))Vp.set(he,le);H.v++,Promise.resolve(X).finally(function(){i(f,U),B(u,f,H)})}}function B(u,f,m){--m.v===0&&(O(f),k(u,f))}function K(u,f){var m={v:1};typeof f.tag!="string"&&typeof f.state.onbeforeremove=="function"&&_(u,f,f.state,m),f.attrs&&typeof f.attrs.onbeforeremove=="function"&&_(u,f,f.attrs,m),B(u,f,m)}function k(u,f){if(f.dom!=null)if(f.domSize==null||f.domSize===1)u.removeChild(f.dom);else for(var m of Ka(f))u.removeChild(m)}function O(u){if(typeof u.tag!="string"&&typeof u.state.onremove=="function"&&a.call(u.state.onremove,u),u.attrs&&typeof u.attrs.onremove=="function"&&a.call(u.attrs.onremove,u),typeof u.tag!="string")u.instance!=null&&O(u.instance);else{u.events!=null&&(u.events._=null);var f=u.children;if(Array.isArray(f))for(var m=0;m<f.length;m++){var H=f[m];H!=null&&O(H)}}}function N(u,f,m){for(var H in f)j(u,H,null,f[H],m)}function j(u,f,m,H,U){if(!(f==="key"||H==null||pe(f)||m===H&&!ce(u,f)&&typeof H!="object")){if(f[0]==="o"&&f[1]==="n")return Vt(u,f,H);if(f.slice(0,6)==="xlink:")u.dom.setAttributeNS("http://www.w3.org/1999/xlink",f.slice(6),H);else if(f==="style")fe(u.dom,m,H);else if(_e(u,f,U)){if(f==="value"){if((u.tag==="input"||u.tag==="textarea")&&u.dom.value===""+H||u.tag==="select"&&m!==null&&u.dom.value===""+H||u.tag==="option"&&m!==null&&u.dom.value===""+H)return;if(u.tag==="input"&&u.attrs.type==="file"&&""+H!=""){console.error("`value` is read-only on file inputs!");return}}u.tag==="input"&&f==="type"?u.dom.setAttribute(f,H):u.dom[f]=H}else typeof H=="boolean"?H?u.dom.setAttribute(f,""):u.dom.removeAttribute(f):u.dom.setAttribute(f==="className"?"class":f,H)}}function ne(u,f,m,H){if(!(f==="key"||m==null||pe(f)))if(f[0]==="o"&&f[1]==="n")Vt(u,f,void 0);else if(f==="style")fe(u.dom,m,null);else if(_e(u,f,H)&&f!=="className"&&f!=="title"&&!(f==="value"&&(u.tag==="option"||u.tag==="select"&&u.dom.selectedIndex===-1&&u.dom===s(u.dom)))&&!(u.tag==="input"&&f==="type"))u.dom[f]=null;else{var U=f.indexOf(":");U!==-1&&(f=f.slice(U+1)),m!==!1&&u.dom.removeAttribute(f==="className"?"class":f)}}function oe(u,f){if("value"in f)if(f.value===null)u.dom.selectedIndex!==-1&&(u.dom.value=null);else{var m=""+f.value;(u.dom.value!==m||u.dom.selectedIndex===-1)&&(u.dom.value=m)}"selectedIndex"in f&&j(u,"selectedIndex",null,f.selectedIndex,void 0)}function te(u,f,m,H){var U;if(f!=null){f===m&&!jc.has(m)&&console.warn("Don't reuse attrs object, use new object for every redraw, this will throw in next major");for(var X in f)(U=f[X])!=null&&(m==null||m[X]==null)&&ne(u,X,U,H)}if(m!=null)for(var X in m)j(u,X,f&&f[X],m[X],H)}function ce(u,f){return f==="value"||f==="checked"||f==="selectedIndex"||f==="selected"&&(u.dom===s(u.dom)||u.tag==="option"&&u.dom.parentNode===s(u.dom))}function pe(u){return u==="oninit"||u==="oncreate"||u==="onupdate"||u==="onremove"||u==="onbeforeremove"||u==="onbeforeupdate"}function _e(u,f,m){return m===void 0&&(u.tag.indexOf("-")>-1||u.is||f!=="href"&&f!=="list"&&f!=="form"&&f!=="width"&&f!=="height")&&f in u.dom}function fe(u,f,m){if(f!==m)if(m==null)u.style="";else if(typeof m!="object")u.style=m;else if(f==null||typeof f!="object"){u.style="";for(var H in m){var U=m[H];U!=null&&(H.includes("-")?u.style.setProperty(H,String(U)):u.style[H]=String(U))}}else{for(var H in f)f[H]!=null&&m[H]==null&&(H.includes("-")?u.style.removeProperty(H):u.style[H]="");for(var H in m){var U=m[H];U!=null&&(U=String(U))!==String(f[H])&&(H.includes("-")?u.style.setProperty(H,U):u.style[H]=U)}}}function Pe(){this._=t}Pe.prototype=Object.create(null),Pe.prototype.handleEvent=function(u){var f=this["on"+u.type],m;typeof f=="function"?m=f.call(u.currentTarget,u):typeof f.handleEvent=="function"&&f.handleEvent(u);var H=this;H._!=null&&(u.redraw!==!1&&(0,H._)(),m!=null&&typeof m.then=="function"&&Promise.resolve(m).then(function(){H._!=null&&u.redraw!==!1&&(0,H._)()})),m===!1&&(u.preventDefault(),u.stopPropagation())};function Vt(u,f,m){if(u.events!=null){if(u.events._=t,u.events[f]===m)return;m!=null&&(typeof m=="function"||typeof m=="object")?(u.events[f]==null&&u.dom.addEventListener(f.slice(2),u.events,!1),u.events[f]=m):(u.events[f]!=null&&u.dom.removeEventListener(f.slice(2),u.events,!1),u.events[f]=void 0)}else m!=null&&(typeof m=="function"||typeof m=="object")&&(u.events=new Pe,u.dom.addEventListener(f.slice(2),u.events,!1),u.events[f]=m)}function lr(u,f,m){typeof u.oninit=="function"&&a.call(u.oninit,f),typeof u.oncreate=="function"&&m.push(a.bind(u.oncreate,f))}function Ft(u,f,m){typeof u.onupdate=="function"&&m.push(a.bind(u.onupdate,f))}function Bo(u,f){do{if(u.attrs!=null&&typeof u.attrs.onbeforeupdate=="function"){var m=a.call(u.attrs.onbeforeupdate,u,f);if(m!==void 0&&!m)break}if(typeof u.tag!="string"&&typeof u.state.onbeforeupdate=="function"){var m=a.call(u.state.onbeforeupdate,u,f);if(m!==void 0&&!m)break}return!1}while(!1);return u.dom=f.dom,u.domSize=f.domSize,u.instance=f.instance,u.attrs=f.attrs,u.children=f.children,u.text=f.text,!0}var pr;return function(u,f,m){if(!u)throw new TypeError("DOM element being rendered to does not exist.");if(pr!=null&&u.contains(pr))throw new TypeError("Node is currently being rendered to and thus is locked.");var H=t,U=pr,X=[],le=s(u),he=u.namespaceURI;pr=u,t=typeof m=="function"?m:void 0,r={};try{u.vnodes==null&&(u.textContent=""),f=La.normalizeChildren(Array.isArray(f)?f:[f]),v(u,u.vnodes,f,X,null,he==="http://www.w3.org/1999/xhtml"?void 0:he),u.vnodes=f,le!=null&&s(u)!==le&&typeof le.focus=="function"&&le.focus();for(var re=0;re<X.length;re++)X[re]()}finally{t=H,pr=U}}}});var Ia=we((iw,qc)=>{"use strict";qc.exports=zc()()});var Wc=we((aw,Fc)=>{"use strict";var Vc=Zt();Fc.exports=function(e,t,r){var n=[],o=!1,i=-1;function a(){for(i=0;i<n.length;i+=2)try{e(n[i],Vc(n[i+1]),s)}catch(d){r.error(d)}i=-1}function s(){o||(o=!0,t(function(){o=!1,a()}))}s.sync=a;function c(d,l){if(l!=null&&l.view==null&&typeof l!="function")throw new TypeError("m.mount expects a component, not a vnode.");var p=n.indexOf(d);p>=0&&(n.splice(p,2),p<=i&&(i-=2),e(d,[])),l!=null&&(n.push(d,l),e(d,Vc(l),s))}return{mount:c,redraw:s}}});var Oo=we((sw,Zc)=>{"use strict";var Fp=Ia();Zc.exports=Wc()(Fp,typeof requestAnimationFrame<"u"?requestAnimationFrame:null,typeof console<"u"?console:null)});var Ba=we((cw,Xc)=>{"use strict";Xc.exports=function(e){if(Object.prototype.toString.call(e)!=="[object Object]")return"";var t=[];for(var r in e)n(r,e[r]);return t.join("&");function n(o,i){if(Array.isArray(i))for(var a=0;a<i.length;a++)n(o+"["+a+"]",i[a]);else if(Object.prototype.toString.call(i)==="[object Object]")for(var a in i)n(o+"["+a+"]",i[a]);else t.push(encodeURIComponent(o)+(i!=null&&i!==""?"="+encodeURIComponent(i):""))}}});var No=we((fw,Yc)=>{"use strict";var Wp=Ba();Yc.exports=function(e,t){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");if(t==null)return e;var r=e.indexOf("?"),n=e.indexOf("#"),o=n<0?e.length:n,i=r<0?o:r,a=e.slice(0,i),s={};Object.assign(s,t);var c=a.replace(/:([^\/\.-]+)(\.{3})?/g,function(L,E,v){return delete s[E],t[E]==null?L:v?t[E]:encodeURIComponent(String(t[E]))}),d=c.indexOf("?"),l=c.indexOf("#"),p=l<0?c.length:l,w=d<0?p:d,h=c.slice(0,w);r>=0&&(h+=e.slice(r,o)),d>=0&&(h+=(r<0?"?":"&")+c.slice(d,p));var b=Wp(s);return b&&(h+=(r<0&&d<0?"?":"&")+b),n>=0&&(h+=e.slice(n)),l>=0&&(h+=(n<0?"":"&")+c.slice(l)),h}});var Jc=we((uw,Qc)=>{"use strict";var Zp=No(),$c=Do();Qc.exports=function(e,t){function r(i){return new Promise(i)}function n(i,a){return new Promise(function(s,c){i=Zp(i,a.params);var d=a.method!=null?a.method.toUpperCase():"GET",l=a.body,p=(a.serialize==null||a.serialize===JSON.serialize)&&!(l instanceof e.FormData||l instanceof e.URLSearchParams),w=a.responseType||(typeof a.extract=="function"?"":"json"),h=new e.XMLHttpRequest,b=!1,L=!1,E=h,v,T=h.abort;h.abort=function(){b=!0,T.call(this)},h.open(d,i,a.async!==!1,typeof a.user=="string"?a.user:void 0,typeof a.password=="string"?a.password:void 0),p&&l!=null&&!o(a,"content-type")&&h.setRequestHeader("Content-Type","application/json; charset=utf-8"),typeof a.deserialize!="function"&&!o(a,"accept")&&h.setRequestHeader("Accept","application/json, text/*"),a.withCredentials&&(h.withCredentials=a.withCredentials),a.timeout&&(h.timeout=a.timeout),h.responseType=w;for(var S in a.headers)$c.call(a.headers,S)&&h.setRequestHeader(S,a.headers[S]);h.onreadystatechange=function(D){if(!b&&D.target.readyState===4)try{var G=D.target.status>=200&&D.target.status<300||D.target.status===304||/^file:\/\//i.test(i),R=D.target.response,q;if(w==="json"){if(!D.target.responseType&&typeof a.extract!="function")try{R=JSON.parse(D.target.responseText)}catch{R=null}}else(!w||w==="text")&&R==null&&(R=D.target.responseText);if(typeof a.extract=="function"?(R=a.extract(D.target,a),G=!0):typeof a.deserialize=="function"&&(R=a.deserialize(R)),G){if(typeof a.type=="function")if(Array.isArray(R))for(var C=0;C<R.length;C++)R[C]=new a.type(R[C]);else R=new a.type(R);s(R)}else{var I=function(){try{q=D.target.responseText}catch{q=R}var z=new Error(q);z.code=D.target.status,z.response=R,c(z)};h.status===0?setTimeout(function(){L||I()}):I()}}catch(z){c(z)}},h.ontimeout=function(D){L=!0;var G=new Error("Request timed out");G.code=D.target.status,c(G)},typeof a.config=="function"&&(h=a.config(h,a,i)||h,h!==E&&(v=h.abort,h.abort=function(){b=!0,v.call(this)})),l==null?h.send():typeof a.serialize=="function"?h.send(a.serialize(l)):l instanceof e.FormData||l instanceof e.URLSearchParams?h.send(l):h.send(JSON.stringify(l))})}r.prototype=Promise.prototype,r.__proto__=Promise;function o(i,a){for(var s in i.headers)if($c.call(i.headers,s)&&s.toLowerCase()===a)return!0;return!1}return{request:function(i,a){typeof i!="string"?(a=i,i=i.url):a==null&&(a={});var s=n(i,a);if(a.background===!0)return s;var c=0;function d(){--c===0&&typeof t=="function"&&t()}return l(s);function l(p){var w=p.then;return p.constructor=r,p.then=function(){c++;var h=w.apply(p,arguments);return h.then(d,function(b){if(d(),c===0)throw b}),l(h)},p}}}}});var tf=we((dw,ef)=>{"use strict";var Xp=Oo();ef.exports=Jc()(typeof window<"u"?window:null,Xp.redraw)});var Ca=we((lw,rf)=>{"use strict";var Yp=/%(?:[0-7]|(?!c[01]|e0%[89]|ed%[ab]|f0%8|f4%[9ab])(?:c|d|(?:e|f[0-4]%[89ab])[\da-f]%[89ab])[\da-f]%[89ab])[\da-f]/gi;rf.exports=function(e){return String(e).replace(Yp,decodeURIComponent)}});var Ha=we((pw,of)=>{"use strict";var nf=Ca();of.exports=function(e){if(e===""||e==null)return{};e.charAt(0)==="?"&&(e=e.slice(1));for(var t=e.split("&"),r={},n={},o=0;o<t.length;o++){var i=t[o].split("="),a=nf(i[0]),s=i.length===2?nf(i[1]):"";s==="true"?s=!0:s==="false"&&(s=!1);var c=a.split(/\]\[?|\[/),d=n;a.indexOf("[")>-1&&c.pop();for(var l=0;l<c.length;l++){var p=c[l],w=c[l+1],h=w==""||!isNaN(parseInt(w,10));if(p===""){var a=c.slice(0,l).join();r[a]==null&&(r[a]=Array.isArray(d)?d.length:0),p=r[a]++}else if(p==="__proto__")break;if(l===c.length-1)d[p]=s;else{var b=Object.getOwnPropertyDescriptor(d,p);b!=null&&(b=b.value),b==null&&(d[p]=b=h?[]:{}),d=b}}}return n}});var Uo=we((hw,af)=>{"use strict";var $p=Ha();af.exports=function(e){var t=e.indexOf("?"),r=e.indexOf("#"),n=r<0?e.length:r,o=t<0?n:t,i=e.slice(0,o).replace(/\/{2,}/g,"/");return i?i[0]!=="/"&&(i="/"+i):i="/",{path:i,params:t<0?{}:$p(e.slice(t+1,n))}}});var cf=we((mw,sf)=>{"use strict";var Qp=Uo();sf.exports=function(e){var t=Qp(e),r=Object.keys(t.params),n=[],o=new RegExp("^"+t.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(i,a,s){return a==null?"\\"+i:(n.push({k:a,r:s==="..."}),s==="..."?"(.*)":s==="."?"([^/]+)\\.":"([^/]+)"+(s||""))})+"\\/?$");return function(i){for(var a=0;a<r.length;a++)if(t.params[r[a]]!==i.params[r[a]])return!1;if(!n.length)return o.test(i.path);var s=o.exec(i.path);if(s==null)return!1;for(var a=0;a<n.length;a++)i.params[n[a].k]=n[a].r?s[a+1]:decodeURIComponent(s[a+1]);return!0}}});var Da=we((yw,df)=>{"use strict";var ff=Do(),uf=/^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$/;df.exports=function(e,t){var r={};if(t!=null)for(var n in e)ff.call(e,n)&&!uf.test(n)&&t.indexOf(n)<0&&(r[n]=e[n]);else for(var n in e)ff.call(e,n)&&!uf.test(n)&&(r[n]=e[n]);return r}});var mf=we((xw,hf)=>{"use strict";var Jp=Zt(),eh=Pa(),th=Ca(),lf=No(),pf=Uo(),rh=cf(),nh=Da();hf.exports=function(e,t){var r=Promise.resolve(),n=!1,o=!1,i=!1,a,s,c,d,l,p,w,h,b={onremove:function(){o=i=!1,e.removeEventListener("popstate",v,!1)},view:function(){var S=Jp(l,p.key,p);return d?d.render(S):[S]}},L=T.SKIP={};function E(){n=!1;var S=e.location.hash;T.prefix[0]!=="#"&&(S=e.location.search+S,T.prefix[0]!=="?"&&(S=e.location.pathname+S,S[0]!=="/"&&(S="/"+S)));var D=th(S).slice(T.prefix.length),G=pf(D);Object.assign(G.params,e.history.state);function R(C){console.error(C),T.set(c,null,{replace:!0})}q(0);function q(C){for(;C<s.length;C++)if(s[C].check(G)){var I=s[C].component,z=s[C].route,Z=I,P=h=function(y){if(P===h){if(y===L)return q(C+1);l=y!=null&&(typeof y.view=="function"||typeof y=="function")?y:"div",p=G.params,w=D,h=null,d=I.render?I:null,i?t.redraw():(i=!0,t.mount(a,b))}};I.view||typeof I=="function"?(I={},P(Z)):I.onmatch?r.then(function(){return I.onmatch(G.params,D,z)}).then(P,D===c?null:R):P();return}if(D===c)throw new Error("Could not resolve default route "+c+".");T.set(c,null,{replace:!0})}}function v(){n||(n=!0,setTimeout(E))}function T(S,D,G){if(!S)throw new TypeError("DOM element being rendered to does not exist.");if(s=Object.keys(G).map(function(q){if(q[0]!=="/")throw new SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(q))throw new SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:q,component:G[q],check:rh(q)}}),c=D,D!=null){var R=pf(D);if(!s.some(function(q){return q.check(R)}))throw new ReferenceError("Default route doesn't match any known routes.")}a=S,e.addEventListener("popstate",v,!1),o=!0,E()}return T.set=function(S,D,G){if(h!=null&&(G=G||{},G.replace=!0),h=null,S=lf(S,D),o){v();var R=G?G.state:null,q=G?G.title:null;G&&G.replace?e.history.replaceState(R,q,T.prefix+S):e.history.pushState(R,q,T.prefix+S)}else e.location.href=T.prefix+S},T.get=function(){return w},T.prefix="#!",T.Link={view:function(S){var D=eh(S.attrs.selector||"a",nh(S.attrs,["options","params","selector","onclick"]),S.children),G,R,q;return(D.attrs.disabled=!!D.attrs.disabled)?(D.attrs.href=null,D.attrs["aria-disabled"]="true"):(G=S.attrs.options,R=S.attrs.onclick,q=lf(D.attrs.href,S.attrs.params),D.attrs.href=T.prefix+q,D.attrs.onclick=function(C){var I;typeof R=="function"?I=R.call(C.currentTarget,C):R==null||typeof R!="object"||typeof R.handleEvent=="function"&&R.handleEvent(C),I!==!1&&!C.defaultPrevented&&(C.button===0||C.which===0||C.which===1)&&(!C.currentTarget.target||C.currentTarget.target==="_self")&&!C.ctrlKey&&!C.metaKey&&!C.shiftKey&&!C.altKey&&(C.preventDefault(),C.redraw=!1,T.set(q,null,G))}),D}},T.param=function(S){return p&&S!=null?p[S]:p},T}});var xf=we((ww,yf)=>{"use strict";var oh=Oo();yf.exports=mf()(typeof window<"u"?window:null,oh)});var Oa=we((bw,bf)=>{"use strict";var Mo=Nc(),wf=Oo(),ih=tf(),ah=xf(),Me=function(){return Mo.apply(this,arguments)};Me.m=Mo;Me.trust=Mo.trust;Me.fragment=Mo.fragment;Me.Fragment="[";Me.mount=wf.mount;Me.route=ah;Me.render=Ia();Me.redraw=wf.redraw;Me.request=ih.request;Me.parseQueryString=Ha();Me.buildQueryString=Ba();Me.parsePathname=Uo();Me.buildPathname=No();Me.vnode=Zt();Me.censor=Da();Me.domFor=Ta();bf.exports=Me});function q0(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ti(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function po(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Ce(e,t,r=""){let n=q0(e),o=e?.length,i=t!==void 0;if(!n||i&&o!==t){let a=r&&`"${r}" `,s=i?` of length ${t}`:"",c=n?`length=${o}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+s+", got "+c)}return e}function _s(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function wd(e,t){Ce(e,void 0,"output");let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function rr(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function nr(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function V0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function bd(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function gd(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}function Ps(e,t,r=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error('"output" expected Uint8Array of length '+e+", got: "+t.length);if(r&&!W0(t))throw new Error("invalid output, must be aligned");return t}function Ed(e,t,r){Ti(r);let n=new Uint8Array(16),o=V0(n);return o.setBigUint64(0,BigInt(t),r),o.setBigUint64(8,BigInt(e),r),n}function W0(e){return e.byteOffset%4===0}function _n(e){return Uint8Array.from(e)}function vd(e=32){let t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}var F0,Ss,Li=Ke(()=>{F0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;Ss=(e,t)=>{function r(n,...o){if(Ce(n,void 0,"key"),!F0)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){let l=o[0];Ce(l,e.varSizeNonce?void 0:e.nonceLength,"nonce")}let i=e.tagLength;i&&o[1]!==void 0&&Ce(o[1],void 0,"AAD");let a=t(n,...o),s=(l,p)=>{if(p!==void 0){if(l!==2)throw new Error("cipher output not supported");Ce(p,void 0,"output")}},c=!1;return{encrypt(l,p){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Ce(l),s(a.encrypt.length,p),a.encrypt(l,p)},decrypt(l,p){if(Ce(l),i&&l.length<i)throw new Error('"ciphertext" expected length bigger than tagLength='+i);return s(a.decrypt.length,p),a.decrypt(l,p)}}}return Object.assign(r,e),r}});function $(e,t){return e<<t|e>>>32-t}function ks(e){return e.byteOffset%4===0}function J0(e,t,r,n,o,i,a,s){let c=o.length,d=new Uint8Array(Ki),l=rr(d),p=ks(o)&&ks(i),w=p?rr(o):_d,h=p?rr(i):_d;for(let b=0;b<c;a++){if(e(t,r,n,l,a,s),a>=Pd)throw new Error("arx: counter overflow");let L=Math.min(Ki,c-b);if(p&&L===Ki){let E=b/4;if(b%4!==0)throw new Error("arx: invalid block position");for(let v=0,T;v<Q0;v++)T=E+v,h[T]=w[T]^l[v];b+=Ki;continue}for(let E=0,v;E<L;E++)v=b+E,i[v]=o[v]^d[E];b+=L}}function Sn(e,t){let{allowShortKeys:r,extendNonceFn:n,counterLength:o,counterRight:i,rounds:a}=bd({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return po(o),po(a),Ti(i),Ti(r),(s,c,d,l,p=0)=>{Ce(s,void 0,"key"),Ce(c,void 0,"nonce"),Ce(d,void 0,"data");let w=d.length;if(l===void 0&&(l=new Uint8Array(w)),Ce(l,void 0,"output"),po(p),p<0||p>=Pd)throw new Error("arx: counter overflow");if(l.length<w)throw new Error(`arx: output (${l.length}) is shorter than data (${w})`);let h=[],b=s.length,L,E;if(b===32)h.push(L=_n(s)),E=$0;else if(b===16&&r)L=new Uint8Array(32),L.set(s),L.set(s,16),E=Y0,h.push(L);else throw Ce(s,32,"arx key"),new Error("invalid key size");ks(c)||h.push(c=_n(c));let v=rr(L);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(E,v,rr(c.subarray(0,16)),v),c=c.subarray(16)}let T=16-o;if(T!==c.length)throw new Error(`arx: nonce must be ${T} or 16 bytes`);if(T!==12){let D=new Uint8Array(12);D.set(c,i?0:12-c.length),c=D,h.push(c)}let S=rr(c);return J0(e,E,v,S,d,l,p,a),nr(...h),l}}var Sd,Z0,X0,Y0,$0,Ki,Q0,Pd,_d,As,Ts,kd=Ke(()=>{Li();Sd=e=>Uint8Array.from(e.split(""),t=>t.charCodeAt(0)),Z0=Sd("expand 16-byte k"),X0=Sd("expand 32-byte k"),Y0=rr(Z0),$0=rr(X0);Ki=64,Q0=16,Pd=2**32-1,_d=Uint32Array.of();As=class e{blockLen;keyLen;nonceLen;state;buf;key;nonce;pos;ctr;cipher;constructor(t,r,n,o,i){this.cipher=t,this.blockLen=r,this.keyLen=n,this.nonceLen=o,this.state=new Uint8Array(this.keyLen+this.nonceLen),this.reseed(i),this.ctr=0,this.pos=this.blockLen,this.buf=new Uint8Array(this.blockLen),this.key=this.state.subarray(0,this.keyLen),this.nonce=this.state.subarray(this.keyLen)}reseed(t){if(Ce(t),!t||t.length===0)throw new Error("entropy required");for(let r=0;r<t.length;r++)this.state[r%this.state.length]^=t[r];this.ctr=0,this.pos=this.blockLen}addEntropy(t){this.state.set(this.randomBytes(this.state.length)),this.reseed(t)}randomBytes(t){if(po(t),t===0)return new Uint8Array(0);let r=new Uint8Array(t),n=0;if(this.pos<this.blockLen){let a=Math.min(t,this.blockLen-this.pos);if(r.set(this.buf.subarray(this.pos,this.pos+a),0),this.pos+=a,n+=a,n===t)return r}let o=Math.floor((t-n)/this.blockLen);if(o>0){let a=o*this.blockLen,s=r.subarray(n,n+a);this.cipher(this.key,this.nonce,s,s,this.ctr),this.ctr+=o,n+=a}let i=t-n;return i>0&&(this.buf.fill(0),this.cipher(this.key,this.nonce,this.buf,this.buf,this.ctr++),r.set(this.buf.subarray(0,i),n),this.pos=i),r}clone(){return new e(this.cipher,this.blockLen,this.keyLen,this.nonceLen,this.randomBytes(this.state.length))}clean(){this.pos=0,this.ctr=0,this.buf.fill(0),this.state.fill(0)}},Ts=(e,t,r,n)=>(o=vd(32))=>new As(e,t,r,n,o)});function Ge(e,t){return e[t++]&255|(e[t++]&255)<<8}function ey(e){let t=(n,o)=>e(o).update(n).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}var Ls,Ad,Td=Ke(()=>{Li();Ls=class{blockLen=16;outputLen=16;buffer=new Uint8Array(16);r=new Uint16Array(10);h=new Uint16Array(10);pad=new Uint16Array(8);pos=0;finished=!1;constructor(t){t=_n(Ce(t,32,"key"));let r=Ge(t,0),n=Ge(t,2),o=Ge(t,4),i=Ge(t,6),a=Ge(t,8),s=Ge(t,10),c=Ge(t,12),d=Ge(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|o<<6)&7939,this.r[3]=(o>>>7|i<<9)&8191,this.r[4]=(i>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|s<<2)&8191,this.r[7]=(s>>>11|c<<5)&8065,this.r[8]=(c>>>8|d<<8)&8191,this.r[9]=d>>>5&127;for(let l=0;l<8;l++)this.pad[l]=Ge(t,16+2*l)}process(t,r,n=!1){let o=n?0:2048,{h:i,r:a}=this,s=a[0],c=a[1],d=a[2],l=a[3],p=a[4],w=a[5],h=a[6],b=a[7],L=a[8],E=a[9],v=Ge(t,r+0),T=Ge(t,r+2),S=Ge(t,r+4),D=Ge(t,r+6),G=Ge(t,r+8),R=Ge(t,r+10),q=Ge(t,r+12),C=Ge(t,r+14),I=i[0]+(v&8191),z=i[1]+((v>>>13|T<<3)&8191),Z=i[2]+((T>>>10|S<<6)&8191),P=i[3]+((S>>>7|D<<9)&8191),y=i[4]+((D>>>4|G<<12)&8191),g=i[5]+(G>>>1&8191),x=i[6]+((G>>>14|R<<2)&8191),_=i[7]+((R>>>11|q<<5)&8191),B=i[8]+((q>>>8|C<<8)&8191),K=i[9]+(C>>>5|o),k=0,O=k+I*s+z*(5*E)+Z*(5*L)+P*(5*b)+y*(5*h);k=O>>>13,O&=8191,O+=g*(5*w)+x*(5*p)+_*(5*l)+B*(5*d)+K*(5*c),k+=O>>>13,O&=8191;let N=k+I*c+z*s+Z*(5*E)+P*(5*L)+y*(5*b);k=N>>>13,N&=8191,N+=g*(5*h)+x*(5*w)+_*(5*p)+B*(5*l)+K*(5*d),k+=N>>>13,N&=8191;let j=k+I*d+z*c+Z*s+P*(5*E)+y*(5*L);k=j>>>13,j&=8191,j+=g*(5*b)+x*(5*h)+_*(5*w)+B*(5*p)+K*(5*l),k+=j>>>13,j&=8191;let ne=k+I*l+z*d+Z*c+P*s+y*(5*E);k=ne>>>13,ne&=8191,ne+=g*(5*L)+x*(5*b)+_*(5*h)+B*(5*w)+K*(5*p),k+=ne>>>13,ne&=8191;let oe=k+I*p+z*l+Z*d+P*c+y*s;k=oe>>>13,oe&=8191,oe+=g*(5*E)+x*(5*L)+_*(5*b)+B*(5*h)+K*(5*w),k+=oe>>>13,oe&=8191;let te=k+I*w+z*p+Z*l+P*d+y*c;k=te>>>13,te&=8191,te+=g*s+x*(5*E)+_*(5*L)+B*(5*b)+K*(5*h),k+=te>>>13,te&=8191;let ce=k+I*h+z*w+Z*p+P*l+y*d;k=ce>>>13,ce&=8191,ce+=g*c+x*s+_*(5*E)+B*(5*L)+K*(5*b),k+=ce>>>13,ce&=8191;let pe=k+I*b+z*h+Z*w+P*p+y*l;k=pe>>>13,pe&=8191,pe+=g*d+x*c+_*s+B*(5*E)+K*(5*L),k+=pe>>>13,pe&=8191;let _e=k+I*L+z*b+Z*h+P*w+y*p;k=_e>>>13,_e&=8191,_e+=g*l+x*d+_*c+B*s+K*(5*E),k+=_e>>>13,_e&=8191;let fe=k+I*E+z*L+Z*b+P*h+y*w;k=fe>>>13,fe&=8191,fe+=g*p+x*l+_*d+B*c+K*s,k+=fe>>>13,fe&=8191,k=(k<<2)+k|0,k=k+O|0,O=k&8191,k=k>>>13,N+=k,i[0]=O,i[1]=N,i[2]=j,i[3]=ne,i[4]=oe,i[5]=te,i[6]=ce,i[7]=pe,i[8]=_e,i[9]=fe}finalize(){let{h:t,pad:r}=this,n=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let s=2;s<10;s++)t[s]+=o,o=t[s]>>>13,t[s]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,n[0]=t[0]+5,o=n[0]>>>13,n[0]&=8191;for(let s=1;s<10;s++)n[s]=t[s]+o,o=n[s]>>>13,n[s]&=8191;n[9]-=8192;let i=(o^1)-1;for(let s=0;s<10;s++)n[s]&=i;i=~i;for(let s=0;s<10;s++)t[s]=t[s]&i|n[s];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let a=t[0]+r[0];t[0]=a&65535;for(let s=1;s<8;s++)a=(t[s]+r[s]|0)+(a>>>16)|0,t[s]=a&65535;nr(n)}update(t){_s(this),Ce(t),t=_n(t);let{buffer:r,blockLen:n}=this,o=t.length;for(let i=0;i<o;){let a=Math.min(n-this.pos,o-i);if(a===n){for(;n<=o-i;i+=n)this.process(t,i);continue}r.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){nr(this.h,this.r,this.buffer,this.pad)}digestInto(t){_s(this),wd(t,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:o}=this;if(o){for(r[o++]=1;o<16;o++)r[o]=0;this.process(r,0,!0)}this.finalize();let i=0;for(let a=0;a<8;a++)t[i++]=n[a]>>>0,t[i++]=n[a]>>>8;return t}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}};Ad=ey(e=>new Ls(e))});var Od={};Ho(Od,{_poly1305_aead:()=>Ks,chacha12:()=>ty,chacha20:()=>Cd,chacha20orig:()=>Bd,chacha20poly1305:()=>oy,chacha8:()=>Dd,hchacha:()=>Id,rngChacha20:()=>ay,rngChacha8:()=>sy,xchacha20:()=>Hd,xchacha20poly1305:()=>iy});function ho(e,t,r,n,o,i=20){let a=e[0],s=e[1],c=e[2],d=e[3],l=t[0],p=t[1],w=t[2],h=t[3],b=t[4],L=t[5],E=t[6],v=t[7],T=o,S=r[0],D=r[1],G=r[2],R=a,q=s,C=c,I=d,z=l,Z=p,P=w,y=h,g=b,x=L,_=E,B=v,K=T,k=S,O=D,N=G;for(let ne=0;ne<i;ne+=2)R=R+z|0,K=$(K^R,16),g=g+K|0,z=$(z^g,12),R=R+z|0,K=$(K^R,8),g=g+K|0,z=$(z^g,7),q=q+Z|0,k=$(k^q,16),x=x+k|0,Z=$(Z^x,12),q=q+Z|0,k=$(k^q,8),x=x+k|0,Z=$(Z^x,7),C=C+P|0,O=$(O^C,16),_=_+O|0,P=$(P^_,12),C=C+P|0,O=$(O^C,8),_=_+O|0,P=$(P^_,7),I=I+y|0,N=$(N^I,16),B=B+N|0,y=$(y^B,12),I=I+y|0,N=$(N^I,8),B=B+N|0,y=$(y^B,7),R=R+Z|0,N=$(N^R,16),_=_+N|0,Z=$(Z^_,12),R=R+Z|0,N=$(N^R,8),_=_+N|0,Z=$(Z^_,7),q=q+P|0,K=$(K^q,16),B=B+K|0,P=$(P^B,12),q=q+P|0,K=$(K^q,8),B=B+K|0,P=$(P^B,7),C=C+y|0,k=$(k^C,16),g=g+k|0,y=$(y^g,12),C=C+y|0,k=$(k^C,8),g=g+k|0,y=$(y^g,7),I=I+z|0,O=$(O^I,16),x=x+O|0,z=$(z^x,12),I=I+z|0,O=$(O^I,8),x=x+O|0,z=$(z^x,7);let j=0;n[j++]=a+R|0,n[j++]=s+q|0,n[j++]=c+C|0,n[j++]=d+I|0,n[j++]=l+z|0,n[j++]=p+Z|0,n[j++]=w+P|0,n[j++]=h+y|0,n[j++]=b+g|0,n[j++]=L+x|0,n[j++]=E+_|0,n[j++]=v+B|0,n[j++]=T+K|0,n[j++]=S+k|0,n[j++]=D+O|0,n[j++]=G+N|0}function Id(e,t,r,n){let o=e[0],i=e[1],a=e[2],s=e[3],c=t[0],d=t[1],l=t[2],p=t[3],w=t[4],h=t[5],b=t[6],L=t[7],E=r[0],v=r[1],T=r[2],S=r[3];for(let G=0;G<20;G+=2)o=o+c|0,E=$(E^o,16),w=w+E|0,c=$(c^w,12),o=o+c|0,E=$(E^o,8),w=w+E|0,c=$(c^w,7),i=i+d|0,v=$(v^i,16),h=h+v|0,d=$(d^h,12),i=i+d|0,v=$(v^i,8),h=h+v|0,d=$(d^h,7),a=a+l|0,T=$(T^a,16),b=b+T|0,l=$(l^b,12),a=a+l|0,T=$(T^a,8),b=b+T|0,l=$(l^b,7),s=s+p|0,S=$(S^s,16),L=L+S|0,p=$(p^L,12),s=s+p|0,S=$(S^s,8),L=L+S|0,p=$(p^L,7),o=o+d|0,S=$(S^o,16),b=b+S|0,d=$(d^b,12),o=o+d|0,S=$(S^o,8),b=b+S|0,d=$(d^b,7),i=i+l|0,E=$(E^i,16),L=L+E|0,l=$(l^L,12),i=i+l|0,E=$(E^i,8),L=L+E|0,l=$(l^L,7),a=a+p|0,v=$(v^a,16),w=w+v|0,p=$(p^w,12),a=a+p|0,v=$(v^a,8),w=w+v|0,p=$(p^w,7),s=s+c|0,T=$(T^s,16),h=h+T|0,c=$(c^h,12),s=s+c|0,T=$(T^s,8),h=h+T|0,c=$(c^h,7);let D=0;n[D++]=o,n[D++]=i,n[D++]=a,n[D++]=s,n[D++]=E,n[D++]=v,n[D++]=T,n[D++]=S}function Kd(e,t,r,n,o){o!==void 0&&Ce(o,void 0,"AAD");let i=e(t,r,ny),a=Ed(n.length,o?o.length:0,!0),s=Ad.create(i);o&&Ld(s,o),Ld(s,n),s.update(a);let c=s.digest();return nr(i,a),c}var Bd,Cd,Hd,Dd,ty,ry,Ld,ny,Ks,oy,iy,ay,sy,Nd=Ke(()=>{kd();Td();Li();Bd=Sn(ho,{counterRight:!1,counterLength:8,allowShortKeys:!0}),Cd=Sn(ho,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Hd=Sn(ho,{counterRight:!1,counterLength:8,extendNonceFn:Id,allowShortKeys:!1}),Dd=Sn(ho,{counterRight:!1,counterLength:4,rounds:8}),ty=Sn(ho,{counterRight:!1,counterLength:4,rounds:12}),ry=new Uint8Array(16),Ld=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(ry.subarray(r))},ny=new Uint8Array(32);Ks=e=>(t,r,n)=>({encrypt(i,a){let s=i.length;a=Ps(s+16,a,!1),a.set(i);let c=a.subarray(0,-16);e(t,r,c,c,1);let d=Kd(e,t,r,c,n);return a.set(d,s),nr(d),a},decrypt(i,a){a=Ps(i.length-16,a,!1);let s=i.subarray(0,-16),c=i.subarray(-16),d=Kd(e,t,r,s,n);if(!gd(c,d))throw new Error("invalid tag");return a.set(i.subarray(0,-16)),e(t,r,a,a,1),nr(d),a}}),oy=Ss({blockSize:64,nonceLength:12,tagLength:16},Ks(Cd)),iy=Ss({blockSize:64,nonceLength:24,tagLength:16},Ks(Hd)),ay=Ts(Bd,64,32,8),sy=Ts(Dd,64,32,12)});function ir(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function yt(e,t=""){if(!Number.isSafeInteger(e)||e<0){let r=t&&`"${t}" `;throw new Error(`${r}expected integer >= 0, got ${e}`)}}function J(e,t,r=""){let n=ir(e),o=e?.length,i=t!==void 0;if(!n||i&&o!==t){let a=r&&`"${r}" `,s=i?` of length ${t}`:"",c=n?`length=${o}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+s+", got "+c)}return e}function Ii(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");yt(e.outputLen),yt(e.blockLen)}function ar(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Bi(e,t){J(e,void 0,"digestInto() output");let r=t.outputLen;if(e.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function zd(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function gt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Ci(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pt(e,t){return e<<32-t|e>>>t}function fy(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function uy(e){for(let t=0;t<e.length;t++)e[t]=fy(e[t]);return e}function Ot(e){if(J(e),qd)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=dy[e[r]];return t}function Gd(e){if(e>=or._0&&e<=or._9)return e-or._0;if(e>=or.A&&e<=or.F)return e-(or.A-10);if(e>=or.a&&e<=or.f)return e-(or.a-10)}function xt(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(qd)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,i=0;o<r;o++,i+=2){let a=Gd(e.charCodeAt(i)),s=Gd(e.charCodeAt(i+1));if(a===void 0||s===void 0){let c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[o]=a*16+s}return n}function ue(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];J(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let i=e[n];r.set(i,o),o+=i.length}return r}function sr(e,t={}){let r=(o,i)=>e(i).update(o).digest(),n=e(void 0);return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=o=>e(o),Object.assign(r,t),Object.freeze(r)}function Oe(e=32){let t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}var cy,Hs,qd,dy,or,kn,Nt=Ke(()=>{cy=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;Hs=cy?e=>e:uy,qd=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",dy=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));or={_0:48,_9:57,A:65,F:70,a:97,f:102};kn=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])})});function Vd(e,t,r){return e&t^~e&r}function Fd(e,t,r){return e&t^e&r^t&r}var mo,cr,ze,qe,Wd=Ke(()=>{Nt();mo=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,r,n,o){this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=Ci(this.buffer)}update(t){ar(this),J(t);let{view:r,buffer:n,blockLen:o}=this,i=t.length;for(let a=0;a<i;){let s=Math.min(o-this.pos,i-a);if(s===o){let c=Ci(t);for(;o<=i-a;a+=o)this.process(c,a);continue}n.set(t.subarray(a,a+s),this.pos),this.pos+=s,a+=s,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ar(this),Bi(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:i}=this,{pos:a}=this;r[a++]=128,gt(this.buffer.subarray(a)),this.padOffset>o-a&&(this.process(n,0),a=0);for(let p=a;p<o;p++)r[p]=0;n.setBigUint64(o-8,BigInt(this.length*8),i),this.process(n,0);let s=Ci(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen must be aligned to 32bit");let d=c/4,l=this.get();if(d>l.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<d;p++)s.setUint32(4*p,l[p],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||=new this.constructor,t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:i,destroyed:a,pos:s}=this;return t.destroyed=a,t.finished=i,t.length=o,t.pos=s,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}},cr=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ze=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),qe=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});function ly(e,t=!1){return t?{h:Number(e&Hi),l:Number(e>>Zd&Hi)}:{h:Number(e>>Zd&Hi)|0,l:Number(e&Hi)|0}}function Di(e,t=!1){let r=e.length,n=new Uint32Array(r),o=new Uint32Array(r);for(let i=0;i<r;i++){let{h:a,l:s}=ly(e[i],t);[n[i],o[i]]=[a,s]}return[n,o]}function Ut(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}var Hi,Zd,Ds,Os,Xr,Yr,yo,xo,Xd,Yd,$d,Qd,Jd,el,tl,rl,nl,ol,Ns=Ke(()=>{Hi=BigInt(4294967295),Zd=BigInt(32);Ds=(e,t,r)=>e>>>r,Os=(e,t,r)=>e<<32-r|t>>>r,Xr=(e,t,r)=>e>>>r|t<<32-r,Yr=(e,t,r)=>e<<32-r|t>>>r,yo=(e,t,r)=>e<<64-r|t>>>r-32,xo=(e,t,r)=>e>>>r-32|t<<64-r,Xd=(e,t,r)=>e<<r|t>>>32-r,Yd=(e,t,r)=>t<<r|e>>>32-r,$d=(e,t,r)=>t<<r-32|e>>>64-r,Qd=(e,t,r)=>e<<r-32|t>>>64-r;Jd=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),el=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,tl=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),rl=(e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,nl=(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),ol=(e,t,r,n,o,i)=>t+r+n+o+i+(e/2**32|0)|0});var hy,gr,Us,Ms,il,my,yy,Er,vr,Oi,Rs,js,Ni,kt,Ui,Gs=Ke(()=>{Wd();Ns();Nt();hy=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gr=new Uint32Array(64),Us=class extends mo{constructor(t){super(64,t,8,!1)}get(){let{A:t,B:r,C:n,D:o,E:i,F:a,G:s,H:c}=this;return[t,r,n,o,i,a,s,c]}set(t,r,n,o,i,a,s,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=i|0,this.F=a|0,this.G=s|0,this.H=c|0}process(t,r){for(let p=0;p<16;p++,r+=4)gr[p]=t.getUint32(r,!1);for(let p=16;p<64;p++){let w=gr[p-15],h=gr[p-2],b=Pt(w,7)^Pt(w,18)^w>>>3,L=Pt(h,17)^Pt(h,19)^h>>>10;gr[p]=L+gr[p-7]+b+gr[p-16]|0}let{A:n,B:o,C:i,D:a,E:s,F:c,G:d,H:l}=this;for(let p=0;p<64;p++){let w=Pt(s,6)^Pt(s,11)^Pt(s,25),h=l+w+Vd(s,c,d)+hy[p]+gr[p]|0,L=(Pt(n,2)^Pt(n,13)^Pt(n,22))+Fd(n,o,i)|0;l=d,d=c,c=s,s=a+h|0,a=i,i=o,o=n,n=h+L|0}n=n+this.A|0,o=o+this.B|0,i=i+this.C|0,a=a+this.D|0,s=s+this.E|0,c=c+this.F|0,d=d+this.G|0,l=l+this.H|0,this.set(n,o,i,a,s,c,d,l)}roundClean(){gt(gr)}destroy(){this.set(0,0,0,0,0,0,0,0),gt(this.buffer)}},Ms=class extends Us{A=cr[0]|0;B=cr[1]|0;C=cr[2]|0;D=cr[3]|0;E=cr[4]|0;F=cr[5]|0;G=cr[6]|0;H=cr[7]|0;constructor(){super(32)}},il=Di(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),my=il[0],yy=il[1],Er=new Uint32Array(80),vr=new Uint32Array(80),Oi=class extends mo{constructor(t){super(128,t,16,!1)}get(){let{Ah:t,Al:r,Bh:n,Bl:o,Ch:i,Cl:a,Dh:s,Dl:c,Eh:d,El:l,Fh:p,Fl:w,Gh:h,Gl:b,Hh:L,Hl:E}=this;return[t,r,n,o,i,a,s,c,d,l,p,w,h,b,L,E]}set(t,r,n,o,i,a,s,c,d,l,p,w,h,b,L,E){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=i|0,this.Cl=a|0,this.Dh=s|0,this.Dl=c|0,this.Eh=d|0,this.El=l|0,this.Fh=p|0,this.Fl=w|0,this.Gh=h|0,this.Gl=b|0,this.Hh=L|0,this.Hl=E|0}process(t,r){for(let S=0;S<16;S++,r+=4)Er[S]=t.getUint32(r),vr[S]=t.getUint32(r+=4);for(let S=16;S<80;S++){let D=Er[S-15]|0,G=vr[S-15]|0,R=Xr(D,G,1)^Xr(D,G,8)^Ds(D,G,7),q=Yr(D,G,1)^Yr(D,G,8)^Os(D,G,7),C=Er[S-2]|0,I=vr[S-2]|0,z=Xr(C,I,19)^yo(C,I,61)^Ds(C,I,6),Z=Yr(C,I,19)^xo(C,I,61)^Os(C,I,6),P=tl(q,Z,vr[S-7],vr[S-16]),y=rl(P,R,z,Er[S-7],Er[S-16]);Er[S]=y|0,vr[S]=P|0}let{Ah:n,Al:o,Bh:i,Bl:a,Ch:s,Cl:c,Dh:d,Dl:l,Eh:p,El:w,Fh:h,Fl:b,Gh:L,Gl:E,Hh:v,Hl:T}=this;for(let S=0;S<80;S++){let D=Xr(p,w,14)^Xr(p,w,18)^yo(p,w,41),G=Yr(p,w,14)^Yr(p,w,18)^xo(p,w,41),R=p&h^~p&L,q=w&b^~w&E,C=nl(T,G,q,yy[S],vr[S]),I=ol(C,v,D,R,my[S],Er[S]),z=C|0,Z=Xr(n,o,28)^yo(n,o,34)^yo(n,o,39),P=Yr(n,o,28)^xo(n,o,34)^xo(n,o,39),y=n&i^n&s^i&s,g=o&a^o&c^a&c;v=L|0,T=E|0,L=h|0,E=b|0,h=p|0,b=w|0,{h:p,l:w}=Ut(d|0,l|0,I|0,z|0),d=s|0,l=c|0,s=i|0,c=a|0,i=n|0,a=o|0;let x=Jd(z,P,g);n=el(x,I,Z,y),o=x|0}({h:n,l:o}=Ut(this.Ah|0,this.Al|0,n|0,o|0)),{h:i,l:a}=Ut(this.Bh|0,this.Bl|0,i|0,a|0),{h:s,l:c}=Ut(this.Ch|0,this.Cl|0,s|0,c|0),{h:d,l}=Ut(this.Dh|0,this.Dl|0,d|0,l|0),{h:p,l:w}=Ut(this.Eh|0,this.El|0,p|0,w|0),{h,l:b}=Ut(this.Fh|0,this.Fl|0,h|0,b|0),{h:L,l:E}=Ut(this.Gh|0,this.Gl|0,L|0,E|0),{h:v,l:T}=Ut(this.Hh|0,this.Hl|0,v|0,T|0),this.set(n,o,i,a,s,c,d,l,p,w,h,b,L,E,v,T)}roundClean(){gt(Er,vr)}destroy(){gt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Rs=class extends Oi{Ah=qe[0]|0;Al=qe[1]|0;Bh=qe[2]|0;Bl=qe[3]|0;Ch=qe[4]|0;Cl=qe[5]|0;Dh=qe[6]|0;Dl=qe[7]|0;Eh=qe[8]|0;El=qe[9]|0;Fh=qe[10]|0;Fl=qe[11]|0;Gh=qe[12]|0;Gl=qe[13]|0;Hh=qe[14]|0;Hl=qe[15]|0;constructor(){super(64)}},js=class extends Oi{Ah=ze[0]|0;Al=ze[1]|0;Bh=ze[2]|0;Bl=ze[3]|0;Ch=ze[4]|0;Cl=ze[5]|0;Dh=ze[6]|0;Dl=ze[7]|0;Eh=ze[8]|0;El=ze[9]|0;Fh=ze[10]|0;Fl=ze[11]|0;Gh=ze[12]|0;Gl=ze[13]|0;Hh=ze[14]|0;Hl=ze[15]|0;constructor(){super(48)}},Ni=sr(()=>new Ms,kn(1)),kt=sr(()=>new Rs,kn(3)),Ui=sr(()=>new js,kn(2))});function fr(e,t=""){if(typeof e!="boolean"){let r=t&&`"${t}" `;throw new Error(r+"expected boolean, got type="+typeof e)}return e}function al(e){if(typeof e=="bigint"){if(!Mi(e))throw new Error("positive bigint expected, got "+e)}else yt(e);return e}function $r(e,t=""){if(!Number.isSafeInteger(e)){let r=t&&`"${t}" `;throw new Error(r+"expected safe integer, got type="+typeof e)}}function wo(e){let t=al(e).toString(16);return t.length&1?"0"+t:t}function sl(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?qs:BigInt("0x"+e)}function Mt(e){return sl(Ot(e))}function Ve(e){return sl(Ot(Jr(J(e)).reverse()))}function Qr(e,t){yt(t),e=al(e);let r=xt(e.toString(16).padStart(t*2,"0"));if(r.length!==t)throw new Error("number too large");return r}function bo(e,t){return Qr(e,t).reverse()}function Ri(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}function Jr(e){return Uint8Array.from(e)}function Ze(e){return Uint8Array.from(e,(t,r)=>{let n=t.charCodeAt(0);if(t.length!==1||n>127)throw new Error(`string contains non-ASCII character "${e[r]}" with code ${n} at position ${r}`);return n})}function xy(e,t,r){return Mi(e)&&Mi(t)&&Mi(r)&&t<=e&&e<r}function _r(e,t,r,n){if(!xy(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function ji(e){let t;for(t=0;e>qs;e>>=zs,t+=1);return t}function cl(e,t,r){if(yt(e,"hashLen"),yt(t,"qByteLen"),typeof r!="function")throw new Error("hmacFn must be a function");let n=E=>new Uint8Array(E),o=Uint8Array.of(),i=Uint8Array.of(0),a=Uint8Array.of(1),s=1e3,c=n(e),d=n(e),l=0,p=()=>{c.fill(1),d.fill(0),l=0},w=(...E)=>r(d,ue(c,...E)),h=(E=o)=>{d=w(i,E),c=w(),E.length!==0&&(d=w(a,E),c=w())},b=()=>{if(l++>=s)throw new Error("drbg: tried max amount of iterations");let E=0,v=[];for(;E<t;){c=w();let T=c.slice();v.push(T),E+=c.length}return ue(...v)};return(E,v)=>{p(),h(E);let T;for(;!(T=v(b()));)h();return p(),T}}function ut(e,t={},r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(i,a,s){let c=e[i];if(s&&c===void 0)return;let d=typeof c;if(d!==a||c===null)throw new Error(`param "${i}" is invalid: expected ${a}, got ${d}`)}let o=(i,a)=>Object.entries(i).forEach(([s,c])=>n(s,c,a));o(t,!1),o(r,!0)}function Tn(e){let t=new WeakMap;return(r,...n)=>{let o=t.get(r);if(o!==void 0)return o;let i=e(r,...n);return t.set(r,i),i}}var qs,zs,Mi,An,Vs,Rt=Ke(()=>{Nt();Nt();qs=BigInt(0),zs=BigInt(1);Mi=e=>typeof e=="bigint"&&qs<=e;An=e=>(zs<<BigInt(e))-zs;Vs=()=>{throw new Error("not implemented")}});function de(e,t){let r=e%t;return r>=nt?r:t+r}function ve(e,t,r){let n=e;for(;t-- >nt;)n*=n,n%=r;return n}function fl(e,t){if(e===nt)throw new Error("invert: expected non-zero number");if(t<=nt)throw new Error("invert: expected positive modulus, got "+t);let r=de(e,t),n=t,o=nt,i=Ne,a=Ne,s=nt;for(;r!==nt;){let d=n/r,l=n%r,p=o-a*d,w=i-s*d;n=r,r=l,o=a,i=s,a=p,s=w}if(n!==Ne)throw new Error("invert: does not exist");return de(o,t)}function Ws(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function yl(e,t){let r=(e.ORDER+Ne)/ll,n=e.pow(t,r);return Ws(e,n,t),n}function gy(e,t){let r=(e.ORDER-pl)/hl,n=e.mul(t,en),o=e.pow(n,r),i=e.mul(t,o),a=e.mul(e.mul(i,en),o),s=e.mul(i,e.sub(a,e.ONE));return Ws(e,s,t),s}function Ey(e){let t=At(e),r=xl(e),n=r(t,t.neg(t.ONE)),o=r(t,n),i=r(t,t.neg(n)),a=(e+wy)/ml;return(s,c)=>{let d=s.pow(c,a),l=s.mul(d,n),p=s.mul(d,o),w=s.mul(d,i),h=s.eql(s.sqr(l),c),b=s.eql(s.sqr(p),c);d=s.cmov(d,l,h),l=s.cmov(w,p,b);let L=s.eql(s.sqr(l),c),E=s.cmov(d,l,L);return Ws(s,E,c),E}}function xl(e){if(e<dl)throw new Error("sqrt is not defined for small field");let t=e-Ne,r=0;for(;t%en===nt;)t/=en,r++;let n=en,o=At(e);for(;ul(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return yl;let i=o.pow(n,t),a=(t+Ne)/en;return function(c,d){if(c.is0(d))return d;if(ul(c,d)!==1)throw new Error("Cannot find square root");let l=r,p=c.mul(c.ONE,i),w=c.pow(d,t),h=c.pow(d,a);for(;!c.eql(w,c.ONE);){if(c.is0(w))return c.ZERO;let b=1,L=c.sqr(w);for(;!c.eql(L,c.ONE);)if(b++,L=c.sqr(L),b===l)throw new Error("Cannot find square root");let E=Ne<<BigInt(l-b-1),v=c.pow(p,E);l=b,p=c.sqr(v),w=c.mul(w,p),h=c.mul(h,v)}return h}}function vy(e){return e%ll===dl?yl:e%hl===pl?gy:e%ml===by?Ey(e):xl(e)}function Gi(e){let t={ORDER:"bigint",BYTES:"number",BITS:"number"},r=_y.reduce((n,o)=>(n[o]="function",n),t);return ut(e,r),e}function Sy(e,t,r){if(r<nt)throw new Error("invalid exponent, negatives unsupported");if(r===nt)return e.ONE;if(r===Ne)return t;let n=e.ONE,o=t;for(;r>nt;)r&Ne&&(n=e.mul(n,o)),o=e.sqr(o),r>>=Ne;return n}function jt(e,t,r=!1){let n=new Array(t.length).fill(r?e.ZERO:void 0),o=t.reduce((a,s,c)=>e.is0(s)?a:(n[c]=a,e.mul(a,s)),e.ONE),i=e.inv(o);return t.reduceRight((a,s,c)=>e.is0(s)?a:(n[c]=e.mul(a,n[c]),e.mul(a,s)),i),n}function ul(e,t){let r=(e.ORDER-Ne)/en,n=e.pow(t,r),o=e.eql(n,e.ONE),i=e.eql(n,e.ZERO),a=e.eql(n,e.neg(e.ONE));if(!o&&!i&&!a)throw new Error("invalid Legendre symbol result");return o?1:i?0:-1}function Py(e,t){t!==void 0&&yt(t);let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function At(e,t={}){return new Fs(e,t)}function wl(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}function bl(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function go(e){let t=bl(e);return t+Math.ceil(t/2)}function zi(e,t,r=!1){J(e);let n=e.length,o=bl(t),i=go(t);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);let a=r?Ve(e):Mt(e),s=de(a,t-Ne)+Ne;return r?bo(s,o):Qr(s,o)}var nt,Ne,en,dl,ll,pl,wy,hl,by,ml,ot,_y,Fs,ur=Ke(()=>{Rt();nt=BigInt(0),Ne=BigInt(1),en=BigInt(2),dl=BigInt(3),ll=BigInt(4),pl=BigInt(5),wy=BigInt(7),hl=BigInt(8),by=BigInt(9),ml=BigInt(16);ot=(e,t)=>(de(e,t)&Ne)===Ne,_y=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];Fs=class{ORDER;BITS;BYTES;isLE;ZERO=nt;ONE=Ne;_lengths;_sqrt;_mod;constructor(t,r={}){if(t<=nt)throw new Error("invalid field: expected ORDER > 0, got "+t);let n;this.isLE=!1,r!=null&&typeof r=="object"&&(typeof r.BITS=="number"&&(n=r.BITS),typeof r.sqrt=="function"&&(this.sqrt=r.sqrt),typeof r.isLE=="boolean"&&(this.isLE=r.isLE),r.allowedLengths&&(this._lengths=r.allowedLengths?.slice()),typeof r.modFromBytes=="boolean"&&(this._mod=r.modFromBytes));let{nBitLength:o,nByteLength:i}=Py(t,n);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=o,this.BYTES=i,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return de(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return nt<=t&&t<this.ORDER}is0(t){return t===nt}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&Ne)===Ne}neg(t){return de(-t,this.ORDER)}eql(t,r){return t===r}sqr(t){return de(t*t,this.ORDER)}add(t,r){return de(t+r,this.ORDER)}sub(t,r){return de(t-r,this.ORDER)}mul(t,r){return de(t*r,this.ORDER)}pow(t,r){return Sy(this,t,r)}div(t,r){return de(t*fl(r,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,r){return t+r}subN(t,r){return t-r}mulN(t,r){return t*r}inv(t){return fl(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=vy(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?bo(t,this.BYTES):Qr(t,this.BYTES)}fromBytes(t,r=!1){J(t);let{_lengths:n,BYTES:o,isLE:i,ORDER:a,_mod:s}=this;if(n){if(!n.includes(t.length)||t.length>o)throw new Error("Field.fromBytes: expected "+n+" bytes, got "+t.length);let d=new Uint8Array(o);d.set(t,i?0:d.length-t.length),t=d}if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);let c=i?Ve(t):Mt(t);if(s&&(c=de(c,a)),!r&&!this.isValid(c))throw new Error("invalid field element: outside of range 0..ORDER");return c}invertBatch(t){return jt(this,t)}cmov(t,r,n){return n?r:t}}});function Eo(e,t){let r=t.negate();return e?r:t}function rn(e,t){let r=jt(e.Fp,t.map(n=>n.Z));return t.map((n,o)=>e.fromAffine(n.toAffine(r[o])))}function _l(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Zs(e,t){_l(e,t);let r=Math.ceil(t/e)+1,n=2**(e-1),o=2**e,i=An(e),a=BigInt(e);return{windows:r,windowSize:n,mask:i,maxNumber:o,shiftBy:a}}function gl(e,t,r){let{windowSize:n,mask:o,maxNumber:i,shiftBy:a}=r,s=Number(e&o),c=e>>a;s>n&&(s-=i,c+=tn);let d=t*n,l=d+Math.abs(s)-1,p=s===0,w=s<0,h=t%2!==0;return{nextN:c,offset:l,isZero:p,isNeg:w,isNegF:h,offsetF:d}}function ky(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}function Ay(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}function Ys(e){return Sl.get(e)||1}function El(e){if(e!==Ln)throw new Error("invalid wNAF")}function Pl(e,t,r,n){let o=t,i=e.ZERO,a=e.ZERO;for(;r>Ln||n>Ln;)r&tn&&(i=i.add(o)),n&tn&&(a=a.add(o)),o=o.double(),r>>=tn,n>>=tn;return{p1:i,p2:a}}function kl(e,t,r){let n=e.Fn;ky(t,e),Ay(r,n);let o=t.length,i=r.length;if(o!==i)throw new Error("arrays of points and scalars must have equal length");let a=e.ZERO,s=ji(BigInt(o)),c=1;s>12?c=s-3:s>4?c=s-2:s>0&&(c=2);let d=An(c),l=new Array(Number(d)+1).fill(a),p=Math.floor((n.BITS-1)/c)*c,w=a;for(let h=p;h>=0;h-=c){l.fill(a);for(let L=0;L<i;L++){let E=r[L],v=Number(E>>BigInt(h)&d);l[v]=l[v].add(t[L])}let b=a;for(let L=l.length-1,E=a;L>0;L--)E=E.add(l[L]),b=b.add(E);if(w=w.add(b),h!==0)for(let L=0;L<c;L++)w=w.double()}return w}function vl(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Gi(t),t}else return At(e,{isLE:r})}function qi(e,t,r={},n){if(n===void 0&&(n=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let c of["p","n","h"]){let d=t[c];if(!(typeof d=="bigint"&&d>Ln))throw new Error(`CURVE.${c} must be positive bigint`)}let o=vl(t.p,r.Fp,n),i=vl(t.n,r.Fn,n),s=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let c of s)if(!o.isValid(t[c]))throw new Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:i}}function In(e,t){return function(n){let o=e(n);return{secretKey:o,publicKey:t(o)}}}var Ln,tn,Xs,Sl,Kn,vo=Ke(()=>{Rt();ur();Ln=BigInt(0),tn=BigInt(1);Xs=new WeakMap,Sl=new WeakMap;Kn=class{BASE;ZERO;Fn;bits;constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,n=this.ZERO){let o=t;for(;r>Ln;)r&tn&&(n=n.add(o)),o=o.double(),r>>=tn;return n}precomputeWindow(t,r){let{windows:n,windowSize:o}=Zs(r,this.bits),i=[],a=t,s=a;for(let c=0;c<n;c++){s=a,i.push(s);for(let d=1;d<o;d++)s=s.add(a),i.push(s);a=s.double()}return i}wNAF(t,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let o=this.ZERO,i=this.BASE,a=Zs(t,this.bits);for(let s=0;s<a.windows;s++){let{nextN:c,offset:d,isZero:l,isNeg:p,isNegF:w,offsetF:h}=gl(n,s,a);n=c,l?i=i.add(Eo(w,r[h])):o=o.add(Eo(p,r[d]))}return El(n),{p:o,f:i}}wNAFUnsafe(t,r,n,o=this.ZERO){let i=Zs(t,this.bits);for(let a=0;a<i.windows&&n!==Ln;a++){let{nextN:s,offset:c,isZero:d,isNeg:l}=gl(n,a,i);if(n=s,!d){let p=r[c];o=o.add(l?p.negate():p)}}return El(n),o}getPrecomputes(t,r,n){let o=Xs.get(r);return o||(o=this.precomputeWindow(r,t),t!==1&&(typeof n=="function"&&(o=n(o)),Xs.set(r,o))),o}cached(t,r,n){let o=Ys(t);return this.wNAF(o,this.getPrecomputes(o,t,n),r)}unsafe(t,r,n,o){let i=Ys(t);return i===1?this._unsafeLadder(t,r,o):this.wNAFUnsafe(i,this.getPrecomputes(i,t,n),r,o)}createCache(t,r){_l(r,this.bits),Sl.set(t,r),Xs.delete(t)}hasCache(t){return Ys(t)!==1}}});function Ly(e,t,r,n){let o=e.sqr(r),i=e.sqr(n),a=e.add(e.mul(t.a,o),i),s=e.add(e.ONE,e.mul(t.d,e.mul(o,i)));return e.eql(a,s)}function _o(e,t={}){let r=qi("edwards",e,t,t.FpFnLE),{Fp:n,Fn:o}=r,i=r.CURVE,{h:a}=i;ut(t,{},{uvRatio:"function"});let s=$s<<BigInt(o.BYTES*8)-Ue,c=E=>n.create(E),d=t.uvRatio||((E,v)=>{try{return{isValid:!0,value:n.sqrt(n.div(E,v))}}catch{return{isValid:!1,value:Sr}}});if(!Ly(n,i,i.Gx,i.Gy))throw new Error("bad curve params: generator point");function l(E,v,T=!1){let S=T?Ue:Sr;return _r("coordinate "+E,v,S,s),v}function p(E){if(!(E instanceof b))throw new Error("EdwardsPoint expected")}let w=Tn((E,v)=>{let{X:T,Y:S,Z:D}=E,G=E.is0();v==null&&(v=G?Ty:n.inv(D));let R=c(T*v),q=c(S*v),C=n.mul(D,v);if(G)return{x:Sr,y:Ue};if(C!==Ue)throw new Error("invZ was invalid");return{x:R,y:q}}),h=Tn(E=>{let{a:v,d:T}=i;if(E.is0())throw new Error("bad point: ZERO");let{X:S,Y:D,Z:G,T:R}=E,q=c(S*S),C=c(D*D),I=c(G*G),z=c(I*I),Z=c(q*v),P=c(I*c(Z+C)),y=c(z+c(T*c(q*C)));if(P!==y)throw new Error("bad point: equation left != right (1)");let g=c(S*D),x=c(G*R);if(g!==x)throw new Error("bad point: equation left != right (2)");return!0});class b{static BASE=new b(i.Gx,i.Gy,Ue,c(i.Gx*i.Gy));static ZERO=new b(Sr,Ue,Ue,Sr);static Fp=n;static Fn=o;X;Y;Z;T;constructor(v,T,S,D){this.X=l("x",v),this.Y=l("y",T),this.Z=l("z",S,!0),this.T=l("t",D),Object.freeze(this)}static CURVE(){return i}static fromAffine(v){if(v instanceof b)throw new Error("extended point not allowed");let{x:T,y:S}=v||{};return l("x",T),l("y",S),new b(T,S,Ue,c(T*S))}static fromBytes(v,T=!1){let S=n.BYTES,{a:D,d:G}=i;v=Jr(J(v,S,"point")),fr(T,"zip215");let R=Jr(v),q=v[S-1];R[S-1]=q&-129;let C=Ve(R),I=T?s:n.ORDER;_r("point.y",C,Sr,I);let z=c(C*C),Z=c(z-Ue),P=c(G*z-D),{isValid:y,value:g}=d(Z,P);if(!y)throw new Error("bad point: invalid y coordinate");let x=(g&Ue)===Ue,_=(q&128)!==0;if(!T&&g===Sr&&_)throw new Error("bad point: x=0 and x_0=1");return _!==x&&(g=c(-g)),b.fromAffine({x:g,y:C})}static fromHex(v,T=!1){return b.fromBytes(xt(v),T)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(v=8,T=!0){return L.createCache(this,v),T||this.multiply($s),this}assertValidity(){h(this)}equals(v){p(v);let{X:T,Y:S,Z:D}=this,{X:G,Y:R,Z:q}=v,C=c(T*q),I=c(G*D),z=c(S*q),Z=c(R*D);return C===I&&z===Z}is0(){return this.equals(b.ZERO)}negate(){return new b(c(-this.X),this.Y,this.Z,c(-this.T))}double(){let{a:v}=i,{X:T,Y:S,Z:D}=this,G=c(T*T),R=c(S*S),q=c($s*c(D*D)),C=c(v*G),I=T+S,z=c(c(I*I)-G-R),Z=C+R,P=Z-q,y=C-R,g=c(z*P),x=c(Z*y),_=c(z*y),B=c(P*Z);return new b(g,x,B,_)}add(v){p(v);let{a:T,d:S}=i,{X:D,Y:G,Z:R,T:q}=this,{X:C,Y:I,Z:z,T:Z}=v,P=c(D*C),y=c(G*I),g=c(q*S*Z),x=c(R*z),_=c((D+G)*(C+I)-P-y),B=x-g,K=x+g,k=c(y-T*P),O=c(_*B),N=c(K*k),j=c(_*k),ne=c(B*K);return new b(O,N,ne,j)}subtract(v){return this.add(v.negate())}multiply(v){if(!o.isValidNot0(v))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:T,f:S}=L.cached(this,v,D=>rn(b,D));return rn(b,[T,S])[0]}multiplyUnsafe(v,T=b.ZERO){if(!o.isValid(v))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return v===Sr?b.ZERO:this.is0()||v===Ue?this:L.unsafe(this,v,S=>rn(b,S),T)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return L.unsafe(this,i.n).is0()}toAffine(v){return w(this,v)}clearCofactor(){return a===Ue?this:this.multiplyUnsafe(a)}toBytes(){let{x:v,y:T}=this.toAffine(),S=n.toBytes(T);return S[S.length-1]|=v&Ue?128:0,S}toHex(){return Ot(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}let L=new Kn(b,o.BITS);return b.BASE.precompute(8),b}function Vi(e,t,r={}){if(typeof t!="function")throw new Error('"hash" function param is required');ut(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:n}=r,{BASE:o,Fp:i,Fn:a}=e,s=r.randomBytes||Oe,c=r.adjustScalarBytes||(C=>C),d=r.domain||((C,I,z)=>{if(fr(z,"phflag"),I.length||z)throw new Error("Contexts/pre-hash are not supported");return C});function l(C){return a.create(Ve(C))}function p(C){let I=S.secretKey;J(C,S.secretKey,"secretKey");let z=J(t(C),2*I,"hashedSecretKey"),Z=c(z.slice(0,I)),P=z.slice(I,2*I),y=l(Z);return{head:Z,prefix:P,scalar:y}}function w(C){let{head:I,prefix:z,scalar:Z}=p(C),P=o.multiply(Z),y=P.toBytes();return{head:I,prefix:z,scalar:Z,point:P,pointBytes:y}}function h(C){return w(C).pointBytes}function b(C=Uint8Array.of(),...I){let z=ue(...I);return l(t(d(z,J(C,void 0,"context"),!!n)))}function L(C,I,z={}){C=J(C,void 0,"message"),n&&(C=n(C));let{prefix:Z,scalar:P,pointBytes:y}=w(I),g=b(z.context,Z,C),x=o.multiply(g).toBytes(),_=b(z.context,x,y,C),B=a.create(g+_*P);if(!a.isValid(B))throw new Error("sign failed: invalid s");let K=ue(x,a.toBytes(B));return J(K,S.signature,"result")}let E={zip215:!0};function v(C,I,z,Z=E){let{context:P,zip215:y}=Z,g=S.signature;C=J(C,g,"signature"),I=J(I,void 0,"message"),z=J(z,S.publicKey,"publicKey"),y!==void 0&&fr(y,"zip215"),n&&(I=n(I));let x=g/2,_=C.subarray(0,x),B=Ve(C.subarray(x,g)),K,k,O;try{K=e.fromBytes(z,y),k=e.fromBytes(_,y),O=o.multiplyUnsafe(B)}catch{return!1}if(!y&&K.isSmallOrder())return!1;let N=b(P,k.toBytes(),K.toBytes(),I);return k.add(K.multiplyUnsafe(N)).subtract(O).clearCofactor().is0()}let T=i.BYTES,S={secretKey:T,publicKey:T,signature:2*T,seed:T};function D(C=s(S.seed)){return J(C,S.seed,"seed")}function G(C){return ir(C)&&C.length===a.BYTES}function R(C,I){try{return!!e.fromBytes(C,I)}catch{return!1}}let q={getExtendedPublicKey:w,randomSecretKey:D,isValidSecretKey:G,isValidPublicKey:R,toMontgomery(C){let{y:I}=e.fromBytes(C),z=S.publicKey,Z=z===32;if(!Z&&z!==57)throw new Error("only defined for 25519 and 448");let P=Z?i.div(Ue+I,Ue-I):i.div(I-Ue,I+Ue);return i.toBytes(P)},toMontgomerySecret(C){let I=S.secretKey;J(C,I);let z=t(C.subarray(0,I));return c(z).subarray(0,I)}};return Object.freeze({keygen:In(D,h),getPublicKey:h,sign:L,verify:v,utils:q,Point:e,lengths:S})}var Sr,Ue,$s,Ty,Bn,Qs=Ke(()=>{Rt();vo();Sr=BigInt(0),Ue=BigInt(1),$s=BigInt(2),Ty=BigInt(8);Bn=class{static BASE;static ZERO;static Fp;static Fn;ep;constructor(t){this.ep=t}static fromBytes(t){Vs()}static fromHex(t){Vs()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(t){return this.ep.toAffine(t)}toHex(){return Ot(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(t){return this.assertSame(t),this.init(this.ep.add(t.ep))}subtract(t){return this.assertSame(t),this.init(this.ep.subtract(t.ep))}multiply(t){return this.init(this.ep.multiply(t))}multiplyUnsafe(t){return this.init(this.ep.multiplyUnsafe(t))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(t,r){return this.init(this.ep.precompute(t,r))}}});function Pr(e,t){if($r(e),$r(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}function Iy(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}function Al(e){if(!ir(e)&&typeof e!="string")throw new Error("DST must be Uint8Array or ascii string");return typeof e=="string"?Ze(e):e}function Fi(e,t,r,n){J(e),$r(r),t=Al(t),t.length>255&&(t=n(ue(Ze("H2C-OVERSIZE-DST-"),t)));let{outputLen:o,blockLen:i}=n,a=Math.ceil(r/o);if(r>65535||a>255)throw new Error("expand_message_xmd: invalid lenInBytes");let s=ue(t,Pr(t.length,1)),c=Pr(0,i),d=Pr(r,2),l=new Array(a),p=n(ue(c,e,d,Pr(0,1),s));l[0]=n(ue(p,Pr(1,1),s));for(let h=1;h<=a;h++){let b=[Iy(p,l[h-1]),Pr(h+1,1),s];l[h]=n(ue(...b))}return ue(...l).slice(0,r)}function Wi(e,t,r,n,o){if(J(e),$r(r),t=Al(t),t.length>255){let i=Math.ceil(2*n/8);t=o.create({dkLen:i}).update(Ze("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return o.create({dkLen:r}).update(e).update(Pr(r,2)).update(t).update(Pr(t.length,1)).digest()}function Js(e,t,r){ut(r,{p:"bigint",m:"number",k:"number",hash:"function"});let{p:n,k:o,m:i,hash:a,expand:s,DST:c}=r;$r(a.outputLen,"valid hash"),J(e),$r(t);let d=n.toString(2).length,l=Math.ceil((d+o)/8),p=t*i*l,w;if(s==="xmd")w=Fi(e,c,p,a);else if(s==="xof")w=Wi(e,c,p,o,a);else if(s==="_internal_pass")w=e;else throw new Error('expand must be "xmd" or "xof"');let h=new Array(t);for(let b=0;b<t;b++){let L=new Array(i);for(let E=0;E<i;E++){let v=l*(E+b*i),T=w.subarray(v,v+l);L[E]=de(Ky(T),n)}h[b]=L}return h}function kr(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");function n(i){return e.fromAffine(t(i))}function o(i){let a=i.clearCofactor();return a.equals(e.ZERO)?e.ZERO:(a.assertValidity(),a)}return{defaults:Object.freeze(r),Point:e,hashToCurve(i,a){let s=Object.assign({},r,a),c=Js(i,2,s),d=n(c[0]),l=n(c[1]);return o(d.add(l))},encodeToCurve(i,a){let s=r.encodeDST?{DST:r.encodeDST}:{},c=Object.assign({},r,s,a),d=Js(i,1,c),l=n(d[0]);return o(l)},mapToCurve(i){if(r.m===1){if(typeof i!="bigint")throw new Error("expected bigint (m=1)");return o(n([i]))}if(!Array.isArray(i))throw new Error("expected array of bigints");for(let a of i)if(typeof a!="bigint")throw new Error("expected array of bigints");return o(n(i))},hashToScalar(i,a){let s=e.Fn.ORDER,c=Object.assign({},r,{p:s,m:1,DST:nn},a);return Js(i,1,c)[0][0]}}}var Ky,nn,So=Ke(()=>{Rt();ur();Ky=Mt;nn=Ze("HashToScalar-")});function By(e){return ut(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}function Xi(e){let t=By(e),{P:r,type:n,adjustScalarBytes:o,powPminus2:i,randomBytes:a}=t,s=n==="x25519";if(!s&&n!=="x448")throw new Error("invalid type");let c=a||Oe,d=s?255:448,l=s?32:56,p=BigInt(s?9:5),w=BigInt(s?121665:39081),h=s?Zi**BigInt(254):Zi**BigInt(447),b=s?BigInt(8)*Zi**BigInt(251)-Cn:BigInt(4)*Zi**BigInt(445)-Cn,L=h+b+Cn,E=g=>de(g,r),v=T(p);function T(g){return bo(E(g),l)}function S(g){let x=Jr(J(g,l,"uCoordinate"));return s&&(x[31]&=127),E(Ve(x))}function D(g){return Ve(o(Jr(J(g,l,"scalar"))))}function G(g,x){let _=z(S(x),D(g));if(_===Po)throw new Error("invalid private or public key received");return T(_)}function R(g){return G(g,v)}let q=R,C=G;function I(g,x,_){let B=E(g*(x-_));return x=E(x-B),_=E(_+B),{x_2:x,x_3:_}}function z(g,x){_r("u",g,Po,r),_r("scalar",x,h,L);let _=x,B=g,K=Cn,k=Po,O=g,N=Cn,j=Po;for(let oe=BigInt(d-1);oe>=Po;oe--){let te=_>>oe&Cn;j^=te,{x_2:K,x_3:O}=I(j,K,O),{x_2:k,x_3:N}=I(j,k,N),j=te;let ce=K+k,pe=E(ce*ce),_e=K-k,fe=E(_e*_e),Pe=pe-fe,Vt=O+N,lr=O-N,Ft=E(lr*ce),Bo=E(Vt*_e),pr=Ft+Bo,u=Ft-Bo;O=E(pr*pr),N=E(B*E(u*u)),K=E(pe*fe),k=E(Pe*(pe+E(w*Pe)))}({x_2:K,x_3:O}=I(j,K,O)),{x_2:k,x_3:N}=I(j,k,N);let ne=i(k);return E(K*ne)}let Z={secretKey:l,publicKey:l,seed:l},P=(g=c(l))=>(J(g,Z.seed,"seed"),g),y={randomSecretKey:P};return Object.freeze({keygen:In(P,q),getSharedSecret:C,getPublicKey:q,scalarMult:G,scalarMultBase:R,utils:y,GuBytes:v.slice(),lengths:Z})}var Po,Cn,Zi,ec=Ke(()=>{Rt();vo();ur();Po=BigInt(0),Cn=BigInt(1),Zi=BigInt(2)});function Ar(e){ut(e,{name:"string",hash:"function",hashToScalar:"function",hashToGroup:"function"});let{name:t,Point:r,hash:n}=e,{Fn:o}=r,i=(P,y)=>e.hashToGroup(P,{DST:ue(Ze("HashToGroup-"),y)}),a=(P,y)=>e.hashToScalar(P,{DST:ue(nn,y)}),s=(P=Oe)=>{let y=zi(P(go(o.ORDER)),o.ORDER,o.isLE);return o.isLE?Ve(y):Mt(y)},c=(P,y)=>kl(r,P,y),d=P=>ue(Ze("OPRFV1-"),new Uint8Array([P]),Ze("-"+t)),l=d(0),p=d(1),w=d(2);function h(...P){let y=[];for(let g of P)typeof g=="number"?y.push(Qr(g,2)):typeof g=="string"?y.push(Ze(g)):(J(g),y.push(Qr(g.length,2),g));return ue(...y)}let b=(...P)=>n(h(...P,"Finalize"));function L(P,y,g,x){let _=P.toBytes(),B=n(h(_,ue(Ze("Seed-"),x))),K=[];for(let k=0;k<y.length;k++){let O=y[k].toBytes(),N=g[k].toBytes(),j=a(h(B,k,O,N,"Composite"),x);K.push(j)}return K}function E(P,y,g,x){let _=L(P,y,g,x),B=c(y,_),K=c(g,_);return{M:B,Z:K}}function v(P,y,g,x,_){let B=L(y,g,x,_),K=c(g,B),k=K.multiply(P);return{M:K,Z:k}}function T(P,y,g,x,_,B){let[K,k,O,N,j]=[P,y,g,x,_].map(ne=>ne.toBytes());return a(h(K,k,O,N,j,"Challenge"),B)}function S(P,y,g,x,_,B){let{M:K,Z:k}=v(y,g,x,_,P),O=s(B),N=r.BASE.multiply(O),j=K.multiply(O),ne=T(g,K,k,N,j,P),oe=o.sub(O,o.mul(ne,y));return ue(...[ne,oe].map(te=>o.toBytes(te)))}function D(P,y,g,x,_){J(_,2*o.BYTES);let{M:B,Z:K}=E(y,g,x,P),[k,O]=[_.subarray(0,o.BYTES),_.subarray(o.BYTES)].map(oe=>o.fromBytes(oe)),N=r.BASE.multiply(O).add(y.multiply(k)),j=B.multiply(O).add(K.multiply(k)),ne=T(y,B,K,N,j,P);if(!o.eql(k,ne))throw new Error("proof verification failed")}function G(){let P=s(),y=r.BASE.multiply(P);return{secretKey:o.toBytes(P),publicKey:y.toBytes()}}function R(P,y,g){let x=ue(Ze("DeriveKeyPair"),P),_=ue(y,h(g),Uint8Array.of(0));for(let B=0;B<=255;B++){_[_.length-1]=B;let K=e.hashToScalar(_,{DST:x});if(!o.is0(K))return{secretKey:o.toBytes(K),publicKey:r.BASE.multiply(K).toBytes()}}throw new Error("Cannot derive key")}function q(P,y,g=Oe){let x=s(g),_=i(y,P);if(_.equals(r.ZERO))throw new Error("Input point at infinity");let B=_.multiply(x);return{blind:o.toBytes(x),blinded:B.toBytes()}}function C(P,y,g){let x=o.fromBytes(y),_=i(g,P);if(_.equals(r.ZERO))throw new Error("Input point at infinity");let B=_.multiply(x).toBytes();return b(g,B)}let I={generateKeyPair:G,deriveKeyPair:(P,y)=>R(l,P,y),blind:(P,y=Oe)=>q(l,P,y),blindEvaluate(P,y){let g=o.fromBytes(P);return r.fromBytes(y).multiply(g).toBytes()},finalize(P,y,g){let x=o.fromBytes(y),B=r.fromBytes(g).multiply(o.inv(x)).toBytes();return b(P,B)},evaluate:(P,y)=>C(l,P,y)};return Object.freeze({name:t,oprf:I,voprf:{generateKeyPair:G,deriveKeyPair:(P,y)=>R(p,P,y),blind:(P,y=Oe)=>q(p,P,y),blindEvaluateBatch(P,y,g,x=Oe){if(!Array.isArray(g))throw new Error("expected array");let _=o.fromBytes(P),B=r.fromBytes(y),K=g.map(r.fromBytes),k=K.map(N=>N.multiply(_)),O=S(p,_,B,K,k,x);return{evaluated:k.map(N=>N.toBytes()),proof:O}},blindEvaluate(P,y,g,x=Oe){let _=this.blindEvaluateBatch(P,y,[g],x);return{evaluated:_.evaluated[0],proof:_.proof}},finalizeBatch(P,y,g){if(!Array.isArray(P))throw new Error("expected array");let x=r.fromBytes(y),_=P.map(K=>K.blinded).map(r.fromBytes),B=P.map(K=>K.evaluated).map(r.fromBytes);return D(p,x,_,B,g),P.map(K=>I.finalize(K.input,K.blind,K.evaluated))},finalize(P,y,g,x,_,B){return this.finalizeBatch([{input:P,blind:y,evaluated:g,blinded:x}],_,B)[0]},evaluate:(P,y)=>C(p,P,y)},poprf:P=>{let y=a(h("Info",P),w),g=r.BASE.multiply(y);return{generateKeyPair:G,deriveKeyPair:(x,_)=>R(w,x,_),blind(x,_,B=Oe){let K=r.fromBytes(_),k=g.add(K);if(k.equals(r.ZERO))throw new Error("tweakedKey point at infinity");let O=s(B),N=i(x,w);if(N.equals(r.ZERO))throw new Error("Input point at infinity");let j=N.multiply(O);return{blind:o.toBytes(O),blinded:j.toBytes(),tweakedKey:k.toBytes()}},blindEvaluateBatch(x,_,B=Oe){if(!Array.isArray(_))throw new Error("expected array");let K=o.fromBytes(x),k=o.add(K,y),O=o.inv(k),N=_.map(r.fromBytes),j=N.map(te=>te.multiply(O)),ne=r.BASE.multiply(k),oe=S(w,k,ne,j,N,B);return{evaluated:j.map(te=>te.toBytes()),proof:oe}},blindEvaluate(x,_,B=Oe){let K=this.blindEvaluateBatch(x,[_],B);return{evaluated:K.evaluated[0],proof:K.proof}},finalizeBatch(x,_,B){if(!Array.isArray(x))throw new Error("expected array");let K=x.map(k=>k.evaluated).map(r.fromBytes);return D(w,r.fromBytes(B),K,x.map(k=>k.blinded).map(r.fromBytes),_),x.map((k,O)=>{let N=o.fromBytes(k.blind),j=K[O].multiply(o.inv(N)).toBytes();return b(k.input,P,j)})},finalize(x,_,B,K,k,O){return this.finalizeBatch([{input:x,blind:_,evaluated:B,blinded:K}],k,O)[0]},evaluate(x,_){let B=o.fromBytes(x),K=i(_,w);if(K.equals(r.ZERO))throw new Error("Input point at infinity");let k=o.add(B,y),O=o.inv(k),N=K.multiply(O).toBytes();return b(_,P,N)}}},__tests:{Fn:o}})}var Yi=Ke(()=>{Rt();vo();So();ur();});var Ul={};Ho(Ul,{ED25519_TORSION_SUBGROUP:()=>Yy,_map_to_curve_elligator2_curve25519:()=>Nl,ed25519:()=>Hy,ed25519_hasher:()=>Gy,ed25519ctx:()=>Dy,ed25519ph:()=>Oy,ristretto255:()=>Zy,ristretto255_hasher:()=>Qi,ristretto255_oprf:()=>Xy,x25519:()=>Ny});function Cl(e){let t=BigInt(10),r=BigInt(20),n=BigInt(40),o=BigInt(80),i=zt,s=e*e%i*e%i,c=ve(s,$i,i)*s%i,d=ve(c,Gt,i)*e%i,l=ve(d,Bl,i)*d%i,p=ve(l,t,i)*l%i,w=ve(p,r,i)*p%i,h=ve(w,n,i)*w%i,b=ve(h,o,i)*h%i,L=ve(b,o,i)*h%i,E=ve(L,t,i)*l%i;return{pow_p_5_8:ve(E,$i,i)*e%i,b2:s}}function Hl(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function ac(e,t){let r=zt,n=de(t*t*t,r),o=de(n*n*t,r),i=Cl(e*o).pow_p_5_8,a=de(e*n*i,r),s=de(t*a*a,r),c=a,d=de(a*tc,r),l=s===e,p=s===de(-e,r),w=s===de(-e*tc,r);return l&&(a=c),(p||w)&&(a=d),ot(a,r)&&(a=de(-a,r)),{isValid:l||p,value:a}}function Ol(e,t,r){if(t.length>255)throw new Error("Context is too big");return ue(Ze("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}function sc(e){return Vi(dr,kt,Object.assign({adjustScalarBytes:Hl},e))}function Nl(e){let t=(zt-Bl)/oc,r=BigInt(486662),n=Y.sqr(e);n=Y.mul(n,$i);let o=Y.add(n,Y.ONE),i=Y.neg(r),a=Y.sqr(o),s=Y.mul(a,o),c=Y.mul(n,r);c=Y.mul(c,i),c=Y.add(c,a),c=Y.mul(c,i);let d=Y.sqr(s);a=Y.sqr(d),d=Y.mul(d,s),d=Y.mul(d,c),a=Y.mul(a,d);let l=Y.pow(a,t);l=Y.mul(l,d);let p=Y.mul(l,Tl);a=Y.sqr(l),a=Y.mul(a,s);let w=Y.eql(a,c),h=Y.cmov(p,l,w),b=Y.mul(i,n),L=Y.mul(l,e);L=Y.mul(L,My);let E=Y.mul(L,Tl),v=Y.mul(c,n);a=Y.sqr(L),a=Y.mul(a,s);let T=Y.eql(a,v),S=Y.cmov(E,L,T);a=Y.sqr(h),a=Y.mul(a,s);let D=Y.eql(a,c),G=Y.cmov(b,i,D),R=Y.cmov(S,h,D),q=Y.isOdd(R);return R=Y.cmov(R,Y.neg(R),D!==q),{xMn:G,xMd:o,yMn:R,yMd:Gt}}function jy(e){let{xMn:t,xMd:r,yMn:n,yMd:o}=Nl(e),i=Y.mul(t,o);i=Y.mul(i,Ry);let a=Y.mul(r,n),s=Y.sub(t,r),c=Y.add(t,r),d=Y.mul(a,c),l=Y.eql(d,Y.ZERO);i=Y.cmov(i,Y.ZERO,l),a=Y.cmov(a,Y.ONE,l),s=Y.cmov(s,Y.ONE,l),c=Y.cmov(c,Y.ONE,l);let[p,w]=jt(Y,[a,c],!0);return{x:Y.mul(i,p),y:Y.mul(s,w)}}function Kl(e){let{d:t}=ic,r=zt,n=v=>Y.create(v),o=n(rc*e*e),i=n((o+Gt)*Vy),a=BigInt(-1),s=n((a-t*o)*n(o+t)),{isValid:c,value:d}=ac(i,s),l=n(d*e);ot(l,r)||(l=n(-l)),c||(d=l),c||(a=o);let p=n(a*(o-Gt)*Fy-s),w=d*d,h=n((d+d)*s),b=n(p*zy),L=n(Gt-w),E=n(Gt+w);return new dr(n(h*E),n(L*b),n(b*E),n(h*L))}var Cy,Gt,$i,Il,Bl,oc,zt,ic,tc,dr,Y,Dl,Hy,Dy,Oy,Ny,Uy,My,Tl,Ry,Gy,rc,zy,qy,Vy,Fy,Ll,Wy,nc,Hn,Zy,Qi,Xy,Yy,Ml=Ke(()=>{Gs();Nt();Qs();So();ur();ec();Yi();Rt();Cy=BigInt(0),Gt=BigInt(1),$i=BigInt(2),Il=BigInt(3),Bl=BigInt(5),oc=BigInt(8),zt=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),ic={p:zt,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:oc,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};tc=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");dr=_o(ic,{uvRatio:ac}),Y=dr.Fp,Dl=dr.Fn;Hy=sc({}),Dy=sc({domain:Ol}),Oy=sc({domain:Ol,prehash:kt}),Ny=(()=>{let e=zt;return Xi({P:e,type:"x25519",powPminus2:t=>{let{pow_p_5_8:r,b2:n}=Cl(t);return de(ve(r,Il,e)*n,e)},adjustScalarBytes:Hl})})(),Uy=(zt+Il)/oc,My=Y.pow($i,Uy),Tl=Y.sqrt(Y.neg(Y.ONE));Ry=wl(Y,Y.neg(BigInt(486664)));Gy=kr(dr,e=>jy(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:zt,m:1,k:128,expand:"xmd",hash:kt}),rc=tc,zy=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),qy=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Vy=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Fy=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Ll=e=>ac(Gt,e),Wy=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),nc=e=>Y.create(Ve(e)&Wy);Hn=class e extends Bn{static BASE=new e(dr.BASE);static ZERO=new e(dr.ZERO);static Fp=Y;static Fn=Dl;constructor(t){super(t)}static fromAffine(t){return new e(dr.fromAffine(t))}assertSame(t){if(!(t instanceof e))throw new Error("RistrettoPoint expected")}init(t){return new e(t)}static fromBytes(t){J(t,32);let{a:r,d:n}=ic,o=zt,i=D=>Y.create(D),a=nc(t);if(!Ri(Y.toBytes(a),t)||ot(a,o))throw new Error("invalid ristretto255 encoding 1");let s=i(a*a),c=i(Gt+r*s),d=i(Gt-r*s),l=i(c*c),p=i(d*d),w=i(r*n*l-p),{isValid:h,value:b}=Ll(i(w*p)),L=i(b*d),E=i(b*L*w),v=i((a+a)*L);ot(v,o)&&(v=i(-v));let T=i(c*E),S=i(v*T);if(!h||ot(S,o)||T===Cy)throw new Error("invalid ristretto255 encoding 2");return new e(new dr(v,T,Gt,S))}static fromHex(t){return e.fromBytes(xt(t))}toBytes(){let{X:t,Y:r,Z:n,T:o}=this.ep,i=zt,a=E=>Y.create(E),s=a(a(n+r)*a(n-r)),c=a(t*r),d=a(c*c),{value:l}=Ll(a(s*d)),p=a(l*s),w=a(l*c),h=a(p*w*o),b;if(ot(o*h,i)){let E=a(r*rc),v=a(t*rc);t=E,r=v,b=a(p*qy)}else b=w;ot(t*h,i)&&(r=a(-r));let L=a((n-r)*b);return ot(L,i)&&(L=a(-L)),Y.toBytes(L)}equals(t){this.assertSame(t);let{X:r,Y:n}=this.ep,{X:o,Y:i}=t.ep,a=d=>Y.create(d),s=a(r*i)===a(n*o),c=a(n*i)===a(r*o);return s||c}is0(){return this.equals(e.ZERO)}},Zy={Point:Hn},Qi={Point:Hn,hashToCurve(e,t){let r=t?.DST||"ristretto255_XMD:SHA-512_R255MAP_RO_",n=Fi(e,r,64,kt);return Qi.deriveToCurve(n)},hashToScalar(e,t={DST:nn}){let r=Fi(e,t.DST,64,kt);return Dl.create(Ve(r))},deriveToCurve(e){J(e,64);let t=nc(e.subarray(0,32)),r=Kl(t),n=nc(e.subarray(32,64)),o=Kl(n);return new Hn(r.add(o))}},Xy=Ar({name:"ristretto255-SHA512",Point:Hn,hash:kt,hashToGroup:Qi.hashToCurve,hashToScalar:Qi.hashToScalar}),Yy=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"]});function ox(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let a=0;a<10;a++)r[a]=e[a]^e[a+10]^e[a+20]^e[a+30]^e[a+40];for(let a=0;a<10;a+=2){let s=(a+8)%10,c=(a+2)%10,d=r[c],l=r[c+1],p=Rl(d,l,1)^r[s],w=jl(d,l,1)^r[s+1];for(let h=0;h<50;h+=10)e[a+h]^=p,e[a+h+1]^=w}let o=e[2],i=e[3];for(let a=0;a<24;a++){let s=zl[a],c=Rl(o,i,s),d=jl(o,i,s),l=Gl[a];o=e[l],i=e[l+1],e[l]=c,e[l+1]=d}for(let a=0;a<50;a+=10){for(let s=0;s<10;s++)r[s]=e[a+s];for(let s=0;s<10;s++)e[a+s]^=~r[(s+2)%10]&r[(s+4)%10]}e[0]^=rx[n],e[1]^=nx[n]}gt(r)}var $y,ko,Qy,Jy,ex,tx,Gl,zl,ql,Vl,rx,nx,Rl,jl,cc,ix,on,Fl=Ke(()=>{Ns();Nt();$y=BigInt(0),ko=BigInt(1),Qy=BigInt(2),Jy=BigInt(7),ex=BigInt(256),tx=BigInt(113),Gl=[],zl=[],ql=[];for(let e=0,t=ko,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],Gl.push(2*(5*n+r)),zl.push((e+1)*(e+2)/2%64);let o=$y;for(let i=0;i<7;i++)t=(t<<ko^(t>>Jy)*tx)%ex,t&Qy&&(o^=ko<<(ko<<BigInt(i))-ko);ql.push(o)}Vl=Di(ql,!0),rx=Vl[0],nx=Vl[1],Rl=(e,t,r)=>r>32?$d(e,t,r):Xd(e,t,r),jl=(e,t,r)=>r>32?Qd(e,t,r):Yd(e,t,r);cc=class e{state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor(t,r,n,o=!1,i=24){if(this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=o,this.rounds=i,yt(n,"outputLen"),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=zd(this.state)}clone(){return this._cloneInto()}keccak(){Hs(this.state32),ox(this.state32,this.rounds),Hs(this.state32),this.posOut=0,this.pos=0}update(t){ar(this),J(t);let{blockLen:r,state:n}=this,o=t.length;for(let i=0;i<o;){let a=Math.min(r-this.pos,o-i);for(let s=0;s<a;s++)n[this.pos++]^=t[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:n,blockLen:o}=this;t[n]^=r,(r&128)!==0&&n===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){ar(this,!1),J(t),this.finish();let r=this.state,{blockLen:n}=this;for(let o=0,i=t.length;o<i;){this.posOut>=n&&this.keccak();let a=Math.min(n-this.posOut,i-o);t.set(r.subarray(this.posOut,this.posOut+a),o),this.posOut+=a,o+=a}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return yt(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Bi(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,gt(this.state)}_cloneInto(t){let{blockLen:r,suffix:n,outputLen:o,rounds:i,enableXOF:a}=this;return t||=new e(r,n,o,a,i),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=n,t.outputLen=o,t.enableXOF=a,t.destroyed=this.destroyed,t}},ix=(e,t,r,n={})=>sr((o={})=>new cc(t,e,o.dkLen===void 0?r:o.dkLen,!0),n),on=ix(31,136,32,kn(12))});var ip={};Ho(ip,{E448:()=>xx,ED448_TORSION_SUBGROUP:()=>Px,decaf448:()=>_x,decaf448_hasher:()=>ea,decaf448_oprf:()=>Sx,ed448:()=>mx,ed448_hasher:()=>vx,ed448ph:()=>yx,x448:()=>wx});function rp(e){let t=Tr,r=e*e*e%t,n=r*r*e%t,o=ve(n,Wl,t)*n%t,i=ve(o,Wl,t)*n%t,a=ve(i,Ao,t)*r%t,s=ve(a,fx,t)*a%t,c=ve(s,ux,t)*s%t,d=ve(c,Zl,t)*c%t,l=ve(d,dx,t)*d%t,p=ve(l,Zl,t)*c%t,w=ve(p,Ao,t)*r%t,h=ve(w,dt,t)*e%t;return ve(h,lx,t)*w%t}function np(e){return e[0]&=252,e[55]|=128,e[56]=0,e}function uc(e,t){let r=Tr,n=de(e*e*t,r),o=de(n*e,r),i=de(o*n*t,r),a=rp(i),s=de(o*a,r),c=de(s*s,r);return{isValid:de(c*t,r)===e,value:s}}function hx(e,t,r){if(t.length>255)throw new Error("context must be smaller than 255, got: "+t.length);return ue(Ze("SigEd448"),new Uint8Array([r?1:0,t.length]),t,e)}function op(e){return Vi(an,sx,Object.assign({adjustScalarBytes:np,domain:hx},e))}function gx(e){let t=F.sqr(e),r=F.eql(t,F.ONE);t=F.cmov(t,F.ZERO,r);let n=F.sub(F.ONE,t),o=F.neg(Xl),i=F.sqr(n),a=F.mul(i,n),s=F.mul(t,F.neg(Xl));s=F.mul(s,o),s=F.add(s,i),s=F.mul(s,o);let c=F.sqr(a);i=F.mul(s,a),c=F.mul(c,i);let d=F.pow(c,bx);d=F.mul(d,i);let l=F.mul(o,F.neg(t)),p=F.mul(d,e);p=F.cmov(p,F.ZERO,r),i=F.sqr(d),i=F.mul(i,a);let w=F.eql(i,s),h=F.cmov(l,o,w),b=F.cmov(p,d,w),L=F.isOdd(b);return b=F.cmov(b,F.neg(b),w!==L),{xn:h,xd:n,yn:b,yd:F.ONE}}function Ex(e){let{xn:t,xd:r,yn:n,yd:o}=gx(e),i=F.sqr(t),a=F.sqr(r),s=F.sqr(a),c=F.sqr(n),d=F.sqr(o),l=F.sub(i,a),p=F.sub(l,a);l=F.mul(l,a),l=F.mul(l,o),l=F.mul(l,n),l=F.mul(l,fc),p=F.mul(p,i),p=F.mul(p,d);let w=F.mul(c,fc),h=F.add(w,d);h=F.mul(h,s);let b=F.add(h,p);p=F.mul(p,t);let L=F.mul(t,s),E=F.sub(w,d);E=F.mul(E,L),E=F.sub(E,p),h=F.add(i,a),h=F.mul(h,a),h=F.mul(h,r),h=F.mul(h,c),h=F.mul(h,BigInt(-2));let v=F.add(p,h);L=F.mul(L,d),v=F.add(v,L),h=F.mul(b,v);let T=F.eql(h,F.ZERO);l=F.cmov(l,F.ZERO,T),b=F.cmov(b,F.ONE,T),E=F.cmov(E,F.ONE,T),v=F.cmov(v,F.ONE,T);let S=jt(F,[b,v],!0);return{x:F.mul(l,S[0]),y:F.mul(E,S[1])}}function tp(e){let{d:t,p:r}=sn,n=T=>Tt.create(T),o=n(-(e*e)),i=n(t*(o-dt)),a=n((i+dt)*(i-o)),{isValid:s,value:c}=uc($l,n((o+dt)*a)),d=c;s||(d=n(e*c));let l=dt;s||(l=n(-dt));let p=n(d*(o+dt)),w=p;ot(p,r)&&(w=n(-p));let h=p*p,b=n(w*Ao),L=n(h+dt),E=n(h-dt),v=n(d*p*(o-dt)*$l+l);return new an(n(b*v),n(E*L),n(L*v),n(b*E))}var Tr,sn,ax,sx,cx,dt,Ao,Wl,fc,fx,ux,Zl,dx,lx,F,px,Tt,Ji,an,mx,yx,xx,wx,bx,Xl,vx,Yl,$l,Ql,Jl,ep,Dn,_x,ea,Sx,Px,ap=Ke(()=>{Fl();Nt();Qs();So();ur();ec();Yi();Rt();Tr=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),sn={p:Tr,n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},ax=Object.assign({},sn,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),sx=sr(()=>on.create({dkLen:114})),cx=sr(()=>on.create({dkLen:64})),dt=BigInt(1),Ao=BigInt(2),Wl=BigInt(3),fc=BigInt(4),fx=BigInt(11),ux=BigInt(22),Zl=BigInt(44),dx=BigInt(88),lx=BigInt(223);F=At(Tr,{BITS:456,isLE:!0}),px=At(sn.n,{BITS:456,isLE:!0}),Tt=At(Tr,{BITS:448,isLE:!0}),Ji=At(sn.n,{BITS:448,isLE:!0});an=_o(sn,{Fp:F,Fn:px,uvRatio:uc});mx=op({}),yx=op({prehash:cx}),xx=_o(ax),wx=(()=>{let e=Tr;return Xi({P:e,type:"x448",powPminus2:t=>{let r=rp(t),n=ve(r,Ao,e);return de(n*t,e)},adjustScalarBytes:np})})(),bx=(Tr-BigInt(3))/BigInt(4),Xl=BigInt(156326);vx=kr(an,e=>Ex(e[0]),{DST:"edwards448_XOF:SHAKE256_ELL2_RO_",encodeDST:"edwards448_XOF:SHAKE256_ELL2_NU_",p:Tr,m:1,k:224,expand:"xof",hash:on}),Yl=BigInt("39082"),$l=BigInt("78163"),Ql=BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),Jl=BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),ep=e=>uc(dt,e);Dn=class e extends Bn{static BASE=new e(an.BASE).multiplyUnsafe(Ao);static ZERO=new e(an.ZERO);static Fp=Tt;static Fn=Ji;constructor(t){super(t)}static fromAffine(t){return new e(an.fromAffine(t))}assertSame(t){if(!(t instanceof e))throw new Error("DecafPoint expected")}init(t){return new e(t)}static fromBytes(t){J(t,56);let{d:r,p:n}=sn,o=E=>Tt.create(E),i=Tt.fromBytes(t);if(!Ri(Ji.toBytes(i),t)||ot(i,n))throw new Error("invalid decaf448 encoding 1");let a=o(i*i),s=o(dt+a),c=o(s*s),d=o(c-fc*r*a),{isValid:l,value:p}=ep(o(d*c)),w=o((i+i)*p*s*Ql);ot(w,n)&&(w=o(-w));let h=o(w*p*d*Jl),b=o((dt-a)*p*s),L=o(h*b);if(!l)throw new Error("invalid decaf448 encoding 2");return new e(new an(h,b,dt,L))}static fromHex(t){return e.fromBytes(xt(t))}toBytes(){let{X:t,Z:r,T:n}=this.ep,o=sn.p,i=w=>Tt.create(w),a=i(i(t+n)*i(t-n)),s=i(t*t),{value:c}=ep(i(a*Yl*s)),d=i(c*a*Ql);ot(d,o)&&(d=i(-d));let l=i(Jl*d*r-n),p=i(Yl*c*t*l);return ot(p,o)&&(p=i(-p)),Ji.toBytes(p)}equals(t){this.assertSame(t);let{X:r,Y:n}=this.ep,{X:o,Y:i}=t.ep;return Tt.create(r*i)===Tt.create(n*o)}is0(){return this.equals(e.ZERO)}},_x={Point:Dn},ea={Point:Dn,hashToCurve(e,t){let r=t?.DST||"decaf448_XOF:SHAKE256_D448MAP_RO_";return ea.deriveToCurve(Wi(e,r,112,224,on))},hashToScalar(e,t={DST:nn}){let r=Wi(e,t.DST,64,256,on);return Ji.create(Ve(r))},deriveToCurve(e){J(e,112);let t=!0,r=Tt.create(Tt.fromBytes(e.subarray(0,56),t)),n=tp(r),o=Tt.create(Tt.fromBytes(e.subarray(56,112),t)),i=tp(o);return new Dn(n.add(i))}},Sx=Ar({name:"decaf448-SHAKE256",Point:Dn,hash:e=>on(e,{dkLen:64}),hashToGroup:ea.hashToCurve,hashToScalar:ea.hashToScalar}),Px=["010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","fefffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffff00","000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080"]});var ta,dc,sp=Ke(()=>{Nt();ta=class{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,r){if(Ii(t),J(r,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,o=new Uint8Array(n);o.set(r.length>n?t.create().update(r).digest():r);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),gt(o)}update(t){return ar(this),this.iHash.update(t),this}digestInto(t){ar(this),J(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});let{oHash:r,iHash:n,finished:o,destroyed:i,blockLen:a,outputLen:s}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=a,t.outputLen=s,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},dc=(e,t,r)=>new ta(e,t).update(r).digest();dc.create=(e,t)=>new ta(e,t)});function kx(e,t,r){let[[n,o],[i,a]]=t,s=cp(a*e,r),c=cp(-o*e,r),d=e-s*n-c*i,l=-s*o-c*a,p=d<Lt,w=l<Lt;p&&(d=-d),w&&(l=-l);let h=An(Math.ceil(ji(r)/2))+Xe;if(d<Lt||d>=h||l<Lt||l>=h)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:p,k1:d,k2neg:w,k2:l}}function pc(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function lc(e,t){let r={};for(let n of Object.keys(t))r[n]=e[n]===void 0?t[n]:e[n];return fr(r.lowS,"lowS"),fr(r.prehash,"prehash"),r.format!==void 0&&pc(r.format),r}function ra(e,t={}){let r=qi("weierstrass",e,t),{Fp:n,Fn:o}=r,i=r.CURVE,{h:a,n:s}=i;ut(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});let{endo:c}=t;if(c&&(!n.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let d=dp(n,o);function l(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function p(P,y,g){let{x,y:_}=y.toAffine(),B=n.toBytes(x);if(fr(g,"isCompressed"),g){l();let K=!n.isOdd(_);return ue(fp(K),B)}else return ue(Uint8Array.of(4),B,n.toBytes(_))}function w(P){J(P,void 0,"Point");let{publicKey:y,publicKeyUncompressed:g}=d,x=P.length,_=P[0],B=P.subarray(1);if(x===y&&(_===2||_===3)){let K=n.fromBytes(B);if(!n.isValid(K))throw new Error("bad point: is not on curve, wrong x");let k=L(K),O;try{O=n.sqrt(k)}catch(ne){let oe=ne instanceof Error?": "+ne.message:"";throw new Error("bad point: is not on curve, sqrt error"+oe)}l();let N=n.isOdd(O);return(_&1)===1!==N&&(O=n.neg(O)),{x:K,y:O}}else if(x===g&&_===4){let K=n.BYTES,k=n.fromBytes(B.subarray(0,K)),O=n.fromBytes(B.subarray(K,K*2));if(!E(k,O))throw new Error("bad point: is not on curve");return{x:k,y:O}}else throw new Error(`bad point: got length ${x}, expected compressed=${y} or uncompressed=${g}`)}let h=t.toBytes||p,b=t.fromBytes||w;function L(P){let y=n.sqr(P),g=n.mul(y,P);return n.add(n.add(g,n.mul(P,i.a)),i.b)}function E(P,y){let g=n.sqr(y),x=L(P);return n.eql(g,x)}if(!E(i.Gx,i.Gy))throw new Error("bad curve params: generator point");let v=n.mul(n.pow(i.a,On),mc),T=n.mul(n.sqr(i.b),BigInt(27));if(n.is0(n.add(v,T)))throw new Error("bad curve params: a or b");function S(P,y,g=!1){if(!n.isValid(y)||g&&n.is0(y))throw new Error(`bad point coordinate ${P}`);return y}function D(P){if(!(P instanceof I))throw new Error("Weierstrass Point expected")}function G(P){if(!c||!c.basises)throw new Error("no endo");return kx(P,c.basises,o.ORDER)}let R=Tn((P,y)=>{let{X:g,Y:x,Z:_}=P;if(n.eql(_,n.ONE))return{x:g,y:x};let B=P.is0();y==null&&(y=B?n.ONE:n.inv(_));let K=n.mul(g,y),k=n.mul(x,y),O=n.mul(_,y);if(B)return{x:n.ZERO,y:n.ZERO};if(!n.eql(O,n.ONE))throw new Error("invZ was invalid");return{x:K,y:k}}),q=Tn(P=>{if(P.is0()){if(t.allowInfinityPoint&&!n.is0(P.Y))return;throw new Error("bad point: ZERO")}let{x:y,y:g}=P.toAffine();if(!n.isValid(y)||!n.isValid(g))throw new Error("bad point: x or y not field elements");if(!E(y,g))throw new Error("bad point: equation left != right");if(!P.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function C(P,y,g,x,_){return g=new I(n.mul(g.X,P),g.Y,g.Z),y=Eo(x,y),g=Eo(_,g),y.add(g)}class I{static BASE=new I(i.Gx,i.Gy,n.ONE);static ZERO=new I(n.ZERO,n.ONE,n.ZERO);static Fp=n;static Fn=o;X;Y;Z;constructor(y,g,x){this.X=S("x",y),this.Y=S("y",g,!0),this.Z=S("z",x),Object.freeze(this)}static CURVE(){return i}static fromAffine(y){let{x:g,y:x}=y||{};if(!y||!n.isValid(g)||!n.isValid(x))throw new Error("invalid affine point");if(y instanceof I)throw new Error("projective point not allowed");return n.is0(g)&&n.is0(x)?I.ZERO:new I(g,x,n.ONE)}static fromBytes(y){let g=I.fromAffine(b(J(y,void 0,"point")));return g.assertValidity(),g}static fromHex(y){return I.fromBytes(xt(y))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(y=8,g=!0){return Z.createCache(this,y),g||this.multiply(On),this}assertValidity(){q(this)}hasEvenY(){let{y}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(y)}equals(y){D(y);let{X:g,Y:x,Z:_}=this,{X:B,Y:K,Z:k}=y,O=n.eql(n.mul(g,k),n.mul(B,_)),N=n.eql(n.mul(x,k),n.mul(K,_));return O&&N}negate(){return new I(this.X,n.neg(this.Y),this.Z)}double(){let{a:y,b:g}=i,x=n.mul(g,On),{X:_,Y:B,Z:K}=this,k=n.ZERO,O=n.ZERO,N=n.ZERO,j=n.mul(_,_),ne=n.mul(B,B),oe=n.mul(K,K),te=n.mul(_,B);return te=n.add(te,te),N=n.mul(_,K),N=n.add(N,N),k=n.mul(y,N),O=n.mul(x,oe),O=n.add(k,O),k=n.sub(ne,O),O=n.add(ne,O),O=n.mul(k,O),k=n.mul(te,k),N=n.mul(x,N),oe=n.mul(y,oe),te=n.sub(j,oe),te=n.mul(y,te),te=n.add(te,N),N=n.add(j,j),j=n.add(N,j),j=n.add(j,oe),j=n.mul(j,te),O=n.add(O,j),oe=n.mul(B,K),oe=n.add(oe,oe),j=n.mul(oe,te),k=n.sub(k,j),N=n.mul(oe,ne),N=n.add(N,N),N=n.add(N,N),new I(k,O,N)}add(y){D(y);let{X:g,Y:x,Z:_}=this,{X:B,Y:K,Z:k}=y,O=n.ZERO,N=n.ZERO,j=n.ZERO,ne=i.a,oe=n.mul(i.b,On),te=n.mul(g,B),ce=n.mul(x,K),pe=n.mul(_,k),_e=n.add(g,x),fe=n.add(B,K);_e=n.mul(_e,fe),fe=n.add(te,ce),_e=n.sub(_e,fe),fe=n.add(g,_);let Pe=n.add(B,k);return fe=n.mul(fe,Pe),Pe=n.add(te,pe),fe=n.sub(fe,Pe),Pe=n.add(x,_),O=n.add(K,k),Pe=n.mul(Pe,O),O=n.add(ce,pe),Pe=n.sub(Pe,O),j=n.mul(ne,fe),O=n.mul(oe,pe),j=n.add(O,j),O=n.sub(ce,j),j=n.add(ce,j),N=n.mul(O,j),ce=n.add(te,te),ce=n.add(ce,te),pe=n.mul(ne,pe),fe=n.mul(oe,fe),ce=n.add(ce,pe),pe=n.sub(te,pe),pe=n.mul(ne,pe),fe=n.add(fe,pe),te=n.mul(ce,fe),N=n.add(N,te),te=n.mul(Pe,fe),O=n.mul(_e,O),O=n.sub(O,te),te=n.mul(_e,ce),j=n.mul(Pe,j),j=n.add(j,te),new I(O,N,j)}subtract(y){return this.add(y.negate())}is0(){return this.equals(I.ZERO)}multiply(y){let{endo:g}=t;if(!o.isValidNot0(y))throw new Error("invalid scalar: out of range");let x,_,B=K=>Z.cached(this,K,k=>rn(I,k));if(g){let{k1neg:K,k1:k,k2neg:O,k2:N}=G(y),{p:j,f:ne}=B(k),{p:oe,f:te}=B(N);_=ne.add(te),x=C(g.beta,j,oe,K,O)}else{let{p:K,f:k}=B(y);x=K,_=k}return rn(I,[x,_])[0]}multiplyUnsafe(y){let{endo:g}=t,x=this;if(!o.isValid(y))throw new Error("invalid scalar: out of range");if(y===Lt||x.is0())return I.ZERO;if(y===Xe)return x;if(Z.hasCache(this))return this.multiply(y);if(g){let{k1neg:_,k1:B,k2neg:K,k2:k}=G(y),{p1:O,p2:N}=Pl(I,x,B,k);return C(g.beta,O,N,_,K)}else return Z.unsafe(x,y)}toAffine(y){return R(this,y)}isTorsionFree(){let{isTorsionFree:y}=t;return a===Xe?!0:y?y(I,this):Z.unsafe(this,s).is0()}clearCofactor(){let{clearCofactor:y}=t;return a===Xe?this:y?y(I,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(y=!0){return fr(y,"isCompressed"),this.assertValidity(),h(I,this,y)}toHex(y=!0){return Ot(this.toBytes(y))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}let z=o.BITS,Z=new Kn(I,t.endo?Math.ceil(z/2):z);return I.BASE.precompute(8),I}function fp(e){return Uint8Array.of(e?2:3)}function Ax(e,t){let r=e.ORDER,n=Lt;for(let b=r-Xe;b%qt===Lt;b/=qt)n+=Xe;let o=n,i=qt<<o-Xe-Xe,a=i*qt,s=(r-Xe)/a,c=(s-Xe)/qt,d=a-Xe,l=i,p=e.pow(t,s),w=e.pow(t,(s+Xe)/qt),h=(b,L)=>{let E=p,v=e.pow(L,d),T=e.sqr(v);T=e.mul(T,L);let S=e.mul(b,T);S=e.pow(S,c),S=e.mul(S,v),v=e.mul(S,L),T=e.mul(S,b);let D=e.mul(T,v);S=e.pow(D,l);let G=e.eql(S,e.ONE);v=e.mul(T,w),S=e.mul(D,E),T=e.cmov(v,T,G),D=e.cmov(S,D,G);for(let R=o;R>Xe;R--){let q=R-qt;q=qt<<q-Xe;let C=e.pow(D,q),I=e.eql(C,e.ONE);v=e.mul(T,E),E=e.mul(E,E),C=e.mul(D,E),T=e.cmov(v,T,I),D=e.cmov(C,D,I)}return{isValid:G,value:T}};if(e.ORDER%mc===On){let b=(e.ORDER-On)/mc,L=e.sqrt(e.neg(t));h=(E,v)=>{let T=e.sqr(v),S=e.mul(E,v);T=e.mul(T,S);let D=e.pow(T,b);D=e.mul(D,S);let G=e.mul(D,L),R=e.mul(e.sqr(D),v),q=e.eql(R,E),C=e.cmov(G,D,q);return{isValid:q,value:C}}}return h}function up(e,t){Gi(e);let{A:r,B:n,Z:o}=t;if(!e.isValid(r)||!e.isValid(n)||!e.isValid(o))throw new Error("mapToCurveSimpleSWU: invalid opts");let i=Ax(e,o);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return a=>{let s,c,d,l,p,w,h,b;s=e.sqr(a),s=e.mul(s,o),c=e.sqr(s),c=e.add(c,s),d=e.add(c,e.ONE),d=e.mul(d,n),l=e.cmov(o,e.neg(c),!e.eql(c,e.ZERO)),l=e.mul(l,r),c=e.sqr(d),w=e.sqr(l),p=e.mul(w,r),c=e.add(c,p),c=e.mul(c,d),w=e.mul(w,l),p=e.mul(w,n),c=e.add(c,p),h=e.mul(s,d);let{isValid:L,value:E}=i(c,w);b=e.mul(s,a),b=e.mul(b,E),h=e.cmov(h,d,L),b=e.cmov(b,E,L);let v=e.isOdd(a)===e.isOdd(b);b=e.cmov(e.neg(b),b,v);let T=jt(e,[l],!0)[0];return h=e.mul(h,T),{x:h,y:b}}}function dp(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function Tx(e,t={}){let{Fn:r}=e,n=t.randomBytes||Oe,o=Object.assign(dp(e.Fp,r),{seed:go(r.ORDER)});function i(h){try{let b=r.fromBytes(h);return r.isValidNot0(b)}catch{return!1}}function a(h,b){let{publicKey:L,publicKeyUncompressed:E}=o;try{let v=h.length;return b===!0&&v!==L||b===!1&&v!==E?!1:!!e.fromBytes(h)}catch{return!1}}function s(h=n(o.seed)){return zi(J(h,o.seed,"seed"),r.ORDER)}function c(h,b=!0){return e.BASE.multiply(r.fromBytes(h)).toBytes(b)}function d(h){let{secretKey:b,publicKey:L,publicKeyUncompressed:E}=o;if(!ir(h)||"_lengths"in r&&r._lengths||b===L)return;let v=J(h,void 0,"key").length;return v===L||v===E}function l(h,b,L=!0){if(d(h)===!0)throw new Error("first arg must be private key");if(d(b)===!1)throw new Error("second arg must be public key");let E=r.fromBytes(h);return e.fromBytes(b).multiply(E).toBytes(L)}let p={isValidSecretKey:i,isValidPublicKey:a,randomSecretKey:s},w=In(s,c);return Object.freeze({getPublicKey:c,getSharedSecret:l,keygen:w,Point:e,utils:p,lengths:o})}function na(e,t,r={}){Ii(t),ut(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),r=Object.assign({},r);let n=r.randomBytes||Oe,o=r.hmac||((g,x)=>dc(t,g,x)),{Fp:i,Fn:a}=e,{ORDER:s,BITS:c}=a,{keygen:d,getPublicKey:l,getSharedSecret:p,utils:w,lengths:h}=Tx(e,r),b={prehash:!0,lowS:typeof r.lowS=="boolean"?r.lowS:!0,format:"compact",extraEntropy:!1},L=s*qt<i.ORDER;function E(g){let x=s>>Xe;return g>x}function v(g,x){if(!a.isValidNot0(x))throw new Error(`invalid signature ${g}: out of range 1..Point.Fn.ORDER`);return x}function T(){if(L)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function S(g,x){pc(x);let _=h.signature,B=x==="compact"?_:x==="recovered"?_+1:void 0;return J(g,B)}class D{r;s;recovery;constructor(x,_,B){if(this.r=v("r",x),this.s=v("s",_),B!=null){if(T(),![0,1,2,3].includes(B))throw new Error("invalid recovery id");this.recovery=B}Object.freeze(this)}static fromBytes(x,_=b.format){S(x,_);let B;if(_==="der"){let{r:N,s:j}=Lr.toSig(J(x));return new D(N,j)}_==="recovered"&&(B=x[0],_="compact",x=x.subarray(1));let K=h.signature/2,k=x.subarray(0,K),O=x.subarray(K,K*2);return new D(a.fromBytes(k),a.fromBytes(O),B)}static fromHex(x,_){return this.fromBytes(xt(x),_)}assertRecovery(){let{recovery:x}=this;if(x==null)throw new Error("invalid recovery id: must be present");return x}addRecoveryBit(x){return new D(this.r,this.s,x)}recoverPublicKey(x){let{r:_,s:B}=this,K=this.assertRecovery(),k=K===2||K===3?_+s:_;if(!i.isValid(k))throw new Error("invalid recovery id: sig.r+curve.n != R.x");let O=i.toBytes(k),N=e.fromBytes(ue(fp((K&1)===0),O)),j=a.inv(k),ne=R(J(x,void 0,"msgHash")),oe=a.create(-ne*j),te=a.create(B*j),ce=e.BASE.multiplyUnsafe(oe).add(N.multiplyUnsafe(te));if(ce.is0())throw new Error("invalid recovery: point at infinify");return ce.assertValidity(),ce}hasHighS(){return E(this.s)}toBytes(x=b.format){if(pc(x),x==="der")return xt(Lr.hexFromSig(this));let{r:_,s:B}=this,K=a.toBytes(_),k=a.toBytes(B);return x==="recovered"?(T(),ue(Uint8Array.of(this.assertRecovery()),K,k)):ue(K,k)}toHex(x){return Ot(this.toBytes(x))}}let G=r.bits2int||function(x){if(x.length>8192)throw new Error("input is too large");let _=Mt(x),B=x.length*8-c;return B>0?_>>BigInt(B):_},R=r.bits2int_modN||function(x){return a.create(G(x))},q=An(c);function C(g){return _r("num < 2^"+c,g,Lt,q),a.toBytes(g)}function I(g,x){return J(g,void 0,"message"),x?J(t(g),void 0,"prehashed message"):g}function z(g,x,_){let{lowS:B,prehash:K,extraEntropy:k}=lc(_,b);g=I(g,K);let O=R(g),N=a.fromBytes(x);if(!a.isValidNot0(N))throw new Error("invalid private key");let j=[C(N),C(O)];if(k!=null&&k!==!1){let ce=k===!0?n(h.secretKey):k;j.push(J(ce,void 0,"extraEntropy"))}let ne=ue(...j),oe=O;function te(ce){let pe=G(ce);if(!a.isValidNot0(pe))return;let _e=a.inv(pe),fe=e.BASE.multiply(pe).toAffine(),Pe=a.create(fe.x);if(Pe===Lt)return;let Vt=a.create(_e*a.create(oe+Pe*N));if(Vt===Lt)return;let lr=(fe.x===Pe?0:2)|Number(fe.y&Xe),Ft=Vt;return B&&E(Vt)&&(Ft=a.neg(Vt),lr^=1),new D(Pe,Ft,L?void 0:lr)}return{seed:ne,k2sig:te}}function Z(g,x,_={}){let{seed:B,k2sig:K}=z(g,x,_);return cl(t.outputLen,a.BYTES,o)(B,K).toBytes(_.format)}function P(g,x,_,B={}){let{lowS:K,prehash:k,format:O}=lc(B,b);if(_=J(_,void 0,"publicKey"),x=I(x,k),!ir(g)){let N=g instanceof D?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+N)}S(g,O);try{let N=D.fromBytes(g,O),j=e.fromBytes(_);if(K&&N.hasHighS())return!1;let{r:ne,s:oe}=N,te=R(x),ce=a.inv(oe),pe=a.create(te*ce),_e=a.create(ne*ce),fe=e.BASE.multiplyUnsafe(pe).add(j.multiplyUnsafe(_e));return fe.is0()?!1:a.create(fe.x)===ne}catch{return!1}}function y(g,x,_={}){let{prehash:B}=lc(_,b);return x=I(x,B),D.fromBytes(g,"recovered").recoverPublicKey(x).toBytes()}return Object.freeze({keygen:d,getPublicKey:l,getSharedSecret:p,utils:w,lengths:h,Point:e,sign:Z,verify:P,recoverPublicKey:y,Signature:D,hash:t})}var cp,hc,Lr,Lt,Xe,qt,On,mc,lp=Ke(()=>{sp();Nt();Rt();vo();ur();cp=(e,t)=>(e+(e>=0?t:-t)/qt)/t;hc=class extends Error{constructor(t=""){super(t)}},Lr={Err:hc,_tlv:{encode:(e,t)=>{let{Err:r}=Lr;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let n=t.length/2,o=wo(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");let i=n>127?wo(o.length/2|128):"";return wo(e)+i+o+t},decode(e,t){let{Err:r}=Lr,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");let o=t[n++],i=!!(o&128),a=0;if(!i)a=o;else{let c=o&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");let d=t.subarray(n,n+c);if(d.length!==c)throw new r("tlv.decode: length bytes not complete");if(d[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let l of d)a=a<<8|l;if(n+=c,a<128)throw new r("tlv.decode(long): not minimal encoding")}let s=t.subarray(n,n+a);if(s.length!==a)throw new r("tlv.decode: wrong value length");return{v:s,l:t.subarray(n+a)}}},_int:{encode(e){let{Err:t}=Lr;if(e<Lt)throw new t("integer: negative integers are not allowed");let r=wo(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=Lr;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Mt(e)}},toSig(e){let{Err:t,_int:r,_tlv:n}=Lr,o=J(e,void 0,"signature"),{v:i,l:a}=n.decode(48,o);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:s,l:c}=n.decode(2,i),{v:d,l}=n.decode(2,c);if(l.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(s),s:r.decode(d)}},hexFromSig(e){let{_tlv:t,_int:r}=Lr,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),i=n+o;return t.encode(48,i)}},Lt=BigInt(0),Xe=BigInt(1),qt=BigInt(2),On=BigInt(3),mc=BigInt(4)});var aa={};Ho(aa,{p256:()=>Lx,p256_hasher:()=>yc,p256_oprf:()=>Kx,p384:()=>Ix,p384_hasher:()=>xc,p384_oprf:()=>Bx,p521:()=>Hx,p521_hasher:()=>wc,p521_oprf:()=>Dx});function bc(e,t){let r=up(e.Fp,t);return n=>r(n[0])}var oa,ia,To,Lo,Lx,yc,Kx,Ko,Ix,xc,Bx,Cx,Io,Hx,wc,Dx,sa=Ke(()=>{Gs();So();ur();Yi();lp();oa={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},ia={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},To={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")};Lo=ra(oa),Lx=na(Lo,Ni),yc=kr(Lo,bc(Lo,{A:oa.a,B:oa.b,Z:Lo.Fp.create(BigInt("-10"))}),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:oa.p,m:1,k:128,expand:"xmd",hash:Ni}),Kx=Ar({name:"P256-SHA256",Point:Lo,hash:Ni,hashToGroup:yc.hashToCurve,hashToScalar:yc.hashToScalar}),Ko=ra(ia),Ix=na(Ko,Ui),xc=kr(Ko,bc(Ko,{A:ia.a,B:ia.b,Z:Ko.Fp.create(BigInt("-12"))}),{DST:"P384_XMD:SHA-384_SSWU_RO_",encodeDST:"P384_XMD:SHA-384_SSWU_NU_",p:ia.p,m:1,k:192,expand:"xmd",hash:Ui}),Bx=Ar({name:"P384-SHA384",Point:Ko,hash:Ui,hashToGroup:xc.hashToCurve,hashToScalar:xc.hashToScalar}),Cx=At(To.n,{allowedLengths:[65,66]}),Io=ra(To,{Fn:Cx}),Hx=na(Io,kt),wc=kr(Io,bc(Io,{A:To.a,B:To.b,Z:Io.Fp.create(BigInt("-4"))}),{DST:"P521_XMD:SHA-512_SSWU_RO_",encodeDST:"P521_XMD:SHA-512_SSWU_NU_",p:To.p,m:1,k:256,expand:"xmd",hash:kt}),Dx=Ar({name:"P521-SHA512",Point:Io,hash:kt,hashToGroup:wc.hashToCurve,hashToScalar:wc.hashToScalar})});var vp=Wt(Oa(),1);var Ro=class{#e="";async start(t){this.#e=t}async createObject(t){let[r,n]=await this.sendActivity({"@context":"",id:"",type:"Create",actor:this.#e,object:t});return[r,n]}async deleteObject(t){let[r,n]=await this.sendActivity({"@context":"",id:"",type:"Delete",actor:this.#e,object:t});return n}async sendActivity(t){try{return[await(await fetch("http://localhost/@me/outbox",{method:"POST",body:JSON.stringify(t),credentials:"include"})).json(),""]}catch(r){return[{},String(r)]}}};var Ma=(e,t)=>t.some(r=>e instanceof r),gf,Ef;function sh(){return gf||(gf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ch(){return Ef||(Ef=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Ra=new WeakMap,Na=new WeakMap,jo=new WeakMap;function fh(e){let t=new Promise((r,n)=>{let o=()=>{e.removeEventListener("success",i),e.removeEventListener("error",a)},i=()=>{r(Br(e.result)),o()},a=()=>{n(e.error),o()};e.addEventListener("success",i),e.addEventListener("error",a)});return jo.set(t,e),t}function uh(e){if(Ra.has(e))return;let t=new Promise((r,n)=>{let o=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=()=>{r(),o()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)});Ra.set(e,t)}var ja={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return Ra.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Br(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function Pf(e){ja=e(ja)}function dh(e){return ch().includes(e)?function(...t){return e.apply(Ga(this),t),Br(this.request)}:function(...t){return Br(e.apply(Ga(this),t))}}function lh(e){return typeof e=="function"?dh(e):(e instanceof IDBTransaction&&uh(e),Ma(e,sh())?new Proxy(e,ja):e)}function Br(e){if(e instanceof IDBRequest)return fh(e);if(Na.has(e))return Na.get(e);let t=lh(e);return t!==e&&(Na.set(e,t),jo.set(t,e)),t}var Ga=e=>jo.get(e);function kf(e,t,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){let a=indexedDB.open(e,t),s=Br(a);return n&&a.addEventListener("upgradeneeded",c=>{n(Br(a.result),c.oldVersion,c.newVersion,Br(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),s.then(c=>{i&&c.addEventListener("close",()=>i()),o&&c.addEventListener("versionchange",d=>o(d.oldVersion,d.newVersion,d))}).catch(()=>{}),s}var ph=["get","getKey","getAll","getAllKeys","count"],hh=["put","add","delete","clear"],Ua=new Map;function vf(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Ua.get(t))return Ua.get(t);let r=t.replace(/FromIndex$/,""),n=t!==r,o=hh.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(o||ph.includes(r)))return;let i=async function(a,...s){let c=this.transaction(a,o?"readwrite":"readonly"),d=c.store;return n&&(d=d.index(s.shift())),(await Promise.all([d[r](...s),o&&c.done]))[0]};return Ua.set(t,i),i}Pf(e=>({...e,get:(t,r,n)=>vf(t,r)||e.get(t,r,n),has:(t,r)=>!!vf(t,r)||e.has(t,r)}));var mh=["continue","continuePrimaryKey","advance"],_f={},za=new WeakMap,Af=new WeakMap,yh={get(e,t){if(!mh.includes(t))return e[t];let r=_f[t];return r||(r=_f[t]=function(...n){za.set(this,Af.get(this)[t](...n))}),r}};async function*xh(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;let r=new Proxy(t,yh);for(Af.set(r,t),jo.set(r,Ga(t));t;)yield r,t=await(za.get(r)||t.continue()),za.delete(r)}function Sf(e,t){return t===Symbol.asyncIterator&&Ma(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&Ma(e,[IDBIndex,IDBObjectStore])}Pf(e=>({...e,get(t,r,n){return Sf(t,r)?xh:e.get(t,r,n)},has(t,r){return Sf(t,r)||e.has(t,r)}}));function Tf(e,t){return{id:"",type:"KeyPackage",to:"as:Public",attributedTo:e,mediaType:"message/mls",encoding:"base64",summary:"",generator:"Emissary MLS",content:btoa(t.signature.toString())}}function A(e){return t=>{let[r,n]=e(t),o=new ArrayBuffer(r);return n(0,o),new Uint8Array(o)}}function ie(e,t){return r=>e(t(r))}function M(e,t){return r=>{let n=t(r),o=0,i=(a,s)=>{};for(let a=0;a<e.length;a++){let[s,c]=e[a](n[a]),d=i,l=o;i=(p,w)=>{d(p,w),c(p+l,w)},o+=s}return[o,i]}}function Un(e){return t=>M(e,r=>r)(t)}var Cr=[0,()=>{}];var it=e=>[1,(t,r)=>{new DataView(r).setUint8(t,e)}],Pw=A(it),Qe=(e,t)=>{let r=e.at(t);return r!==void 0?[r,1]:void 0},be=e=>[2,(t,r)=>{new DataView(r).setUint16(t,e)}],kw=A(be),ge=(e,t)=>{let r=new DataView(e.buffer,e.byteOffset,e.byteLength);try{return[r.getUint16(t),2]}catch{return}},Re=e=>[4,(t,r)=>{new DataView(r).setUint32(t,e)}],Aw=A(Re),lt=(e,t)=>{let r=new DataView(e.buffer,e.byteOffset,e.byteLength);try{return[r.getUint32(t),4]}catch{return}},Je=e=>[8,(t,r)=>{new DataView(r).setBigUint64(t,e)}],Tw=A(Je),at=(e,t)=>{let r=new DataView(e.buffer,e.byteOffset,e.byteLength);try{return[r.getBigUint64(t),8]}catch{return}};function ee(e,t){return(r,n)=>{let o=e(r,n);if(o!==void 0){let[i,a]=o;return[t(i),a]}}}function Lf(e,t){return(r,n)=>{let o=Q(e,t)(r,n);if(o!==void 0){let[i,a]=o;return i!==void 0?[i,a]:void 0}}}function Q(e,t){return(r,n)=>{let o=e.reduce((i,a)=>{if(!i)return;let s=a(r,i.offset);if(!s)return;let[c,d]=s;return{values:[...i.values,c],offset:i.offset+d,totalLength:i.totalLength+d}},{values:[],offset:n,totalLength:0});if(o)return[t(...o.values),o.totalLength]}}function ye(e,t){return(r,n)=>{let o=e(r,n);if(o!==void 0){let[i,a]=o,s=t(i);return s!==void 0?[s,a]:void 0}}}function Ee(e,t){return wh(e,t,(r,n)=>n)}function Go(e,t){return(r,n)=>{let o=e(r,n);return o||t(r,n)}}function wh(e,t,r){return(n,o)=>{let i=e(n,o);if(i!==void 0){let[a,s]=i,d=t(a)(n,o+s);if(d!==void 0){let[l,p]=d;return[r(a,l),s+p]}}}}function zo(e){return()=>[e,0]}function Te(e){return t=>Object.values(e).includes(t)?Kf(e)[t]:void 0}function Kf(e){return Object.entries(e).reduce((t,[r,n])=>({...t,[n]:r}),{})}function qo(e){return t=>{let r=Te(e)(t);return r===void 0?t.toString():r}}function Vo(e){return t=>{let r=e[t];return r===void 0?Number(t):r}}var qa={add:1,update:2,remove:3,psk:4,reinit:5,external_init:6,group_context_extensions:7},Xt=ie(be,e=>qa[e]),Ow=A(Xt),If=ye(ge,Te(qa));var Fo={application_id:1,ratchet_tree:2,required_capabilities:3,external_pub:4,external_senders:5},Va=ie(be,e=>Fo[e]),Gw=A(Va),Bf=ye(ge,Te(Fo));var fn=class extends Error{constructor(t){super(t),this.name="MlsError"}};var st=class extends fn{constructor(t){super(t),this.name="CodecError"}};var je=class extends fn{constructor(t){super(t),this.name="DependencyError"}};var hr=class extends fn{constructor(t){super(t),this.name="CryptoError"}},ct=class extends fn{constructor(t){super(`This error should never occur, if you see this please submit a bug report. Message: ${t}`),this.name="InternalError"}};var V=e=>{let[t,r]=Cf(e.length);return[t+e.length,(n,o)=>{r(n,o),new Uint8Array(o).set(e,n+t)}]};function Cf(e){if(e<64)return[1,(t,r)=>{new DataView(r).setUint8(t,e&63)}];if(e<16384)return[2,(t,r)=>{let n=new DataView(r);n.setUint8(t,e>>8&63|64),n.setUint8(t+1,e&255)}];if(e<1073741824)return[4,(t,r)=>{let n=new DataView(r);n.setUint8(t,e>>24&63|128),n.setUint8(t+1,e>>16&255),n.setUint8(t+2,e>>8&255),n.setUint8(t+3,e&255)}];throw new st("Length too large to encode (max is 2^30 - 1)")}function bh(e,t=0){if(t>=e.length)throw new st("Offset beyond buffer");let r=e[t],n=r>>6;if(n===0)return{length:r&63,lengthFieldSize:1};if(n===1){if(t+2>e.length)throw new st("Incomplete 2-byte length");return{length:(r&63)<<8|e[t+1],lengthFieldSize:2}}else if(n===2){if(t+4>e.length)throw new st("Incomplete 4-byte length");return{length:(r&63)<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],lengthFieldSize:4}}else throw new st("8-byte length not supported in this implementation")}var W=(e,t)=>{if(t>=e.length)throw new st("Offset beyond buffer");let{length:r,lengthFieldSize:n}=bh(e,t),o=n+r;if(t+o>e.length)throw new st("Data length exceeds buffer");return[e.subarray(t+n,t+o),o]};function ae(e){return t=>{let r=0,n=(a,s)=>{};for(let a=0;a<t.length;a++){let[s,c]=e(t[a]),d=n,l=r;n=(p,w)=>{d(p,w),c(p+l,w)},r+=s}let[o,i]=Cf(r);return[o+r,(a,s)=>{i(a,s),n(a+o,s)}]}}function se(e){return(t,r)=>{let n=W(t,r);if(n===void 0)return;let[o,i]=n,a=0,s=[];for(;a<o.length;){let c=e(o,a);if(c===void 0)return;let[d,l]=c;s.push(d),a+=l}return[s,i]}}var Hf=e=>typeof e=="number"?be(e):Va(e),tb=A(Hf),gh=Go(Bf,ge),wt=M([Hf,V],e=>[e.extensionType,e.extensionData]),rb=A(wt),Et=Q([gh,W],(e,t)=>({extensionType:e,extensionData:t}));var Df={basic:1,x509:2},Yt=ie(be,Vo(Df)),cb=A(Yt),un=ye(ge,qo(Df));var Of=M([Yt,V],e=>[e.credentialType,e.identity]),hb=A(Of),Nf=M([Yt,ae(V)],e=>[e.credentialType,e.certificates]),mb=A(Nf),Uf=M([Yt,V],e=>[e.credentialType,e.data]),yb=A(Uf),Mn=e=>{switch(e.credentialType){case"basic":return Of(e);case"x509":return Nf(e);default:return Uf(e)}},xb=A(Mn),Eh=ee(W,e=>({credentialType:"basic",identity:e})),vh=ee(se(W),e=>({credentialType:"x509",certificates:e})),Wo=Ee(un,e=>{switch(e){case"basic":return Eh;case"x509":return vh}});var _h=M([V,Mn],e=>[e.signaturePublicKey,e.credential]),Sh=A(_h),Zo=Q([W,Wo],(e,t)=>({signaturePublicKey:e,credential:t}));function $t(e){return t=>{if(t){let[r,n]=e(t);return[r+1,(o,i)=>{new DataView(i).setUint8(o,1),n(o+1,i)}]}else return[1,(r,n)=>{new DataView(n).setUint8(r,0)}]}}function Qt(e){return(t,r)=>{if(Qe(t,r)?.[0]==1){let o=e(t,r+1);return o===void 0?void 0:[o[0],o[1]+1]}else return[void 0,1]}}var dn={MLS_128_DHKEMX25519_AES128GCM_SHA256_Ed25519:1,MLS_128_DHKEMP256_AES128GCM_SHA256_P256:2,MLS_128_DHKEMX25519_CHACHA20POLY1305_SHA256_Ed25519:3,MLS_256_DHKEMX448_AES256GCM_SHA512_Ed448:4,MLS_256_DHKEMP521_AES256GCM_SHA512_P521:5,MLS_256_DHKEMX448_CHACHA20POLY1305_SHA512_Ed448:6,MLS_256_DHKEMP384_AES256GCM_SHA384_P384:7,MLS_128_MLKEM512_AES128GCM_SHA256_Ed25519:77,MLS_128_MLKEM512_CHACHA20POLY1305_SHA256_Ed25519:78,MLS_256_MLKEM768_AES256GCM_SHA384_Ed25519:79,MLS_256_MLKEM768_CHACHA20POLY1305_SHA384_Ed25519:80,MLS_256_MLKEM1024_AES256GCM_SHA512_Ed25519:81,MLS_256_MLKEM1024_CHACHA20POLY1305_SHA512_Ed25519:82,MLS_256_XWING_AES256GCM_SHA512_Ed25519:83,MLS_256_XWING_CHACHA20POLY1305_SHA512_Ed25519:84,MLS_256_MLKEM1024_AES256GCM_SHA512_MLDSA87:85,MLS_256_MLKEM1024_CHACHA20POLY1305_SHA512_MLDSA87:86,MLS_256_XWING_AES256GCM_SHA512_MLDSA87:87,MLS_256_XWING_CHACHA20POLY1305_SHA512_MLDSA87:88},vt=ie(be,Vo(dn)),Cb=A(vt),It=ye(ge,qo(dn));function Xo(e){return Ph[dn[e]]}var Ph={1:{hash:"SHA-256",hpke:{kem:"DHKEM-X25519-HKDF-SHA256",aead:"AES128GCM",kdf:"HKDF-SHA256"},signature:"Ed25519",name:"MLS_128_DHKEMX25519_AES128GCM_SHA256_Ed25519"},2:{hash:"SHA-256",hpke:{kem:"DHKEM-P256-HKDF-SHA256",aead:"AES128GCM",kdf:"HKDF-SHA256"},signature:"P256",name:"MLS_128_DHKEMP256_AES128GCM_SHA256_P256"},3:{hash:"SHA-256",hpke:{kem:"DHKEM-X25519-HKDF-SHA256",aead:"CHACHA20POLY1305",kdf:"HKDF-SHA256"},signature:"Ed25519",name:"MLS_128_DHKEMX25519_CHACHA20POLY1305_SHA256_Ed25519"},4:{hash:"SHA-512",hpke:{kem:"DHKEM-X448-HKDF-SHA512",aead:"AES256GCM",kdf:"HKDF-SHA512"},signature:"Ed448",name:"MLS_256_DHKEMX448_AES256GCM_SHA512_Ed448"},5:{hash:"SHA-512",hpke:{kem:"DHKEM-P521-HKDF-SHA512",aead:"AES256GCM",kdf:"HKDF-SHA512"},signature:"P521",name:"MLS_256_DHKEMP521_AES256GCM_SHA512_P521"},6:{hash:"SHA-512",hpke:{kem:"DHKEM-X448-HKDF-SHA512",aead:"CHACHA20POLY1305",kdf:"HKDF-SHA512"},signature:"Ed448",name:"MLS_256_DHKEMX448_CHACHA20POLY1305_SHA512_Ed448"},7:{hash:"SHA-384",hpke:{kem:"DHKEM-P384-HKDF-SHA384",aead:"AES256GCM",kdf:"HKDF-SHA384"},signature:"P384",name:"MLS_256_DHKEMP384_AES256GCM_SHA384_P384"},77:{hash:"SHA-256",hpke:{kem:"ML-KEM-512",aead:"AES256GCM",kdf:"HKDF-SHA512"},signature:"Ed25519",name:"MLS_128_MLKEM512_AES128GCM_SHA256_Ed25519"},78:{hash:"SHA-256",hpke:{kem:"ML-KEM-512",aead:"CHACHA20POLY1305",kdf:"HKDF-SHA512"},signature:"Ed25519",name:"MLS_128_MLKEM512_CHACHA20POLY1305_SHA256_Ed25519"},79:{hash:"SHA-384",hpke:{kem:"ML-KEM-768",aead:"AES256GCM",kdf:"HKDF-SHA512"},signature:"Ed25519",name:"MLS_256_MLKEM768_AES256GCM_SHA384_Ed25519"},80:{hash:"SHA-384",hpke:{kem:"ML-KEM-768",aead:"CHACHA20POLY1305",kdf:"HKDF-SHA512"},signature:"Ed25519",name:"MLS_256_MLKEM768_CHACHA20POLY1305_SHA384_Ed25519"},81:{hash:"SHA-512",hpke:{kem:"ML-KEM-1024",aead:"AES256GCM",kdf:"HKDF-SHA512"},signature:"Ed25519",name:"MLS_256_MLKEM1024_AES256GCM_SHA512_Ed25519"},82:{hash:"SHA-512",hpke:{kem:"ML-KEM-1024",aead:"CHACHA20POLY1305",kdf:"HKDF-SHA512"},signature:"Ed25519",name:"MLS_256_MLKEM1024_CHACHA20POLY1305_SHA512_Ed25519"},83:{hash:"SHA-512",hpke:{kem:"X-Wing",aead:"AES256GCM",kdf:"HKDF-SHA512"},signature:"Ed25519",name:"MLS_256_XWING_AES256GCM_SHA512_Ed25519"},84:{hash:"SHA-512",hpke:{kem:"X-Wing",aead:"CHACHA20POLY1305",kdf:"HKDF-SHA512"},signature:"Ed25519",name:"MLS_256_XWING_CHACHA20POLY1305_SHA512_Ed25519"},85:{hash:"SHA-512",hpke:{kem:"ML-KEM-1024",aead:"AES256GCM",kdf:"HKDF-SHA512"},signature:"ML-DSA-87",name:"MLS_256_MLKEM1024_AES256GCM_SHA512_MLDSA87"},86:{hash:"SHA-512",hpke:{kem:"ML-KEM-1024",aead:"CHACHA20POLY1305",kdf:"HKDF-SHA512"},signature:"ML-DSA-87",name:"MLS_256_MLKEM1024_CHACHA20POLY1305_SHA512_MLDSA87"},87:{hash:"SHA-512",hpke:{kem:"X-Wing",aead:"AES256GCM",kdf:"HKDF-SHA512"},signature:"ML-DSA-87",name:"MLS_256_XWING_AES256GCM_SHA512_MLDSA87"},88:{hash:"SHA-512",hpke:{kem:"X-Wing",aead:"CHACHA20POLY1305",kdf:"HKDF-SHA512"},signature:"ML-DSA-87",name:"MLS_256_XWING_CHACHA20POLY1305_SHA512_MLDSA87"}};async function ln(e,t,r,n){return n.sign(e,A(Un([V,V]))([new TextEncoder().encode(`MLS 1.0 ${t}`),r]))}var Fa={mls10:1},pt=ie(be,e=>Fa[e]),Gb=A(pt),Bt=ye(ge,Te(Fa));var Wa=M([ae(pt),ae(vt),ae(be),ae(be),ae(Yt)],e=>[e.versions,e.ciphersuites,e.extensions,e.proposals,e.credentials]),$b=A(Wa),Mf=Q([se(Bt),se(It),se(ge),se(ge),se(un)],(e,t,r,n,o)=>({versions:e,ciphersuites:t,extensions:r,proposals:n,credentials:o}));var Rf={key_package:1,update:2,commit:3},Rn=ie(it,e=>Rf[e]),ng=A(Rn),jf=ye(Qe,Te(Rf));var Za=M([Je,Je],e=>[e.notBefore,e.notAfter]),cg=A(Za),Gf=Q([at,at],(e,t)=>({notBefore:e,notAfter:t})),Xa={notBefore:0n,notAfter:9223372036854775807n};var $a=M([V,V,Mn,Wa],e=>[e.hpkePublicKey,e.signaturePublicKey,e.credential,e.capabilities]),gg=A($a),kh=Q([W,W,Wo,Mf],(e,t,r,n)=>({hpkePublicKey:e,signaturePublicKey:t,credential:r,capabilities:n})),zf=M([Rn,Za],e=>["key_package",e.lifetime]),Eg=A(zf),qf=ie(Rn,e=>e.leafNodeSource),vg=A(qf),Vf=M([Rn,V],e=>["commit",e.parentHash]),_g=A(Vf),Qa=e=>{switch(e.leafNodeSource){case"key_package":return zf(e);case"update":return qf(e);case"commit":return Vf(e)}},Sg=A(Qa),Ah=ee(Gf,e=>({leafNodeSource:"key_package",lifetime:e})),Th=Q([W],e=>({leafNodeSource:"commit",parentHash:e})),Lh=Ee(jf,e=>{switch(e){case"key_package":return Ah;case"update":return zo({leafNodeSource:e});case"commit":return Th}}),Ja=ie(ae(wt),e=>e.extensions),Pg=A(Ja),Kh=ee(se(Et),e=>({extensions:e})),Ff=M([V,Re],e=>[e.groupId,e.leafIndex]),kg=A(Ff),Wf=e=>{switch(e.leafNodeSource){case"key_package":return Cr;case"update":case"commit":return Ff(e)}},Ag=A(Wf),Zf=M([$a,Qa,Ja,Wf],e=>[e,e,e,e.info]),Tg=A(Zf),_t=M([$a,Qa,Ja,V],e=>[e,e,e,e.signature]),Lg=A(_t),Dr=Q([kh,Lh,Kh,W],(e,t,r,n)=>({...e,...t,...r,signature:n})),Xf=ye(Dr,e=>e.leafNodeSource==="key_package"?e:void 0),Yf=ye(Dr,e=>e.leafNodeSource==="commit"?e:void 0),$f=ye(Dr,e=>e.leafNodeSource==="update"?e:void 0);async function Qf(e,t,r){return{...e,signature:await ln(t,"LeafNodeTBS",A(Zf)(e),r)}}var es=M([pt,vt,V,_t,ae(wt)],e=>[e.version,e.cipherSuite,e.initKey,e.leafNode,e.extensions]),Rg=A(es),Bh=Q([Bt,It,W,Xf,se(Et)],(e,t,r,n,o)=>({version:e,cipherSuite:t,initKey:r,leafNode:n,extensions:o})),jn=M([es,V],e=>[e,e.signature]),jg=A(jn),Yo=Q([Bh,W],(e,t)=>({...e,signature:t}));async function Ch(e,t,r){return{...e,signature:await ln(t,"KeyPackageTBS",A(es)(e),r)}}async function Jf(e,t,r,n,o,i,a){let s=await i.hpke.generateKeyPair(),c=await i.hpke.generateKeyPair(),d={initPrivateKey:await i.hpke.exportPrivateKey(s.privateKey),hpkePrivateKey:await i.hpke.exportPrivateKey(c.privateKey),signaturePrivateKey:o.signKey},l={leafNodeSource:"key_package",hpkePublicKey:await i.hpke.exportPublicKey(c.publicKey),signaturePublicKey:o.publicKey,info:{leafNodeSource:"key_package"},extensions:a??[],credential:e,capabilities:t,lifetime:r},p={version:"mls10",cipherSuite:i.name,initKey:await i.hpke.exportPublicKey(s.publicKey),leafNode:await Qf(l,o.signKey,i.signature),extensions:n};return{publicPackage:await Ch(p,o.signKey,i.signature),privatePackage:d}}async function ts(e,t,r,n,o,i){let a=await o.signature.keygen();return Jf(e,t,r,n,a,o,i)}var eu={external:1,resumption:2},rs=ie(it,e=>eu[e]),Jg=A(rs),Hh=ye(Qe,Te(eu)),tu={application:1,reinit:2,branch:3},ru=ie(it,e=>tu[e]),e1=A(ru),Dh=ye(Qe,Te(tu)),Oh=M([rs,V],e=>[e.psktype,e.pskId]),Nh=M([rs,ru,V,Je],e=>[e.psktype,e.usage,e.pskGroupId,e.pskEpoch]),Uh=Q([Dh,W,at],(e,t,r)=>({usage:e,pskGroupId:t,pskEpoch:r})),nu=e=>{switch(e.psktype){case"external":return Oh(e);case"resumption":return Nh(e)}},t1=A(nu),Mh=Ee(Hh,e=>{switch(e){case"external":return ee(W,t=>({psktype:e,pskId:t}));case"resumption":return ee(Uh,t=>({psktype:e,...t}))}}),Or=M([nu,V],e=>[e,e.pskNonce]),r1=A(Or),zn=Q([Mh,W],(e,t)=>({...e,pskNonce:t})),Rh=M([Or,be,be],e=>[e.id,e.index,e.count]),n1=A(Rh),o1=Q([zn,ge,ge],(e,t,r)=>({id:e,index:t,count:r}));var ou=ie(jn,e=>e.keyPackage),x1=A(ou),jh=ee(Yo,e=>({keyPackage:e})),iu=ie(_t,e=>e.leafNode),w1=A(iu),Gh=ee($f,e=>({leafNode:e})),au=ie(Re,e=>e.removed),b1=A(au),zh=ee(lt,e=>({removed:e})),su=ie(Or,e=>e.preSharedKeyId),g1=A(su),qh=ee(zn,e=>({preSharedKeyId:e})),cu=M([V,pt,vt,ae(wt)],e=>[e.groupId,e.version,e.cipherSuite,e.extensions]),E1=A(cu),Vh=Q([W,Bt,It,se(Et)],(e,t,r,n)=>({groupId:e,version:t,cipherSuite:r,extensions:n})),fu=ie(V,e=>e.kemOutput),v1=A(fu),Fh=ee(W,e=>({kemOutput:e})),uu=ie(ae(wt),e=>e.extensions),_1=A(uu),Wh=ee(se(Et),e=>({extensions:e})),du=M([Xt,ou],e=>[e.proposalType,e.add]),S1=A(du),lu=M([Xt,iu],e=>[e.proposalType,e.update]),P1=A(lu),pu=M([Xt,au],e=>[e.proposalType,e.remove]),k1=A(pu),hu=M([Xt,su],e=>[e.proposalType,e.psk]),A1=A(hu),mu=M([Xt,cu],e=>[e.proposalType,e.reinit]),T1=A(mu),yu=M([Xt,fu],e=>[e.proposalType,e.externalInit]),L1=A(yu),xu=M([Xt,uu],e=>[e.proposalType,e.groupContextExtensions]),K1=A(xu),wu=M([be,V],e=>[e.proposalType,e.proposalData]),I1=A(wu),pn=e=>{switch(e.proposalType){case"add":return du(e);case"update":return lu(e);case"remove":return pu(e);case"psk":return hu(e);case"reinit":return mu(e);case"external_init":return yu(e);case"group_context_extensions":return xu(e);default:return wu(e)}},B1=A(pn),Zh=ee(jh,e=>({proposalType:"add",add:e})),Xh=ee(Gh,e=>({proposalType:"update",update:e})),Yh=ee(zh,e=>({proposalType:"remove",remove:e})),$h=ee(qh,e=>({proposalType:"psk",psk:e})),Qh=ee(Vh,e=>({proposalType:"reinit",reinit:e})),Jh=ee(Fh,e=>({proposalType:"external_init",externalInit:e})),em=ee(Wh,e=>({proposalType:"group_context_extensions",groupContextExtensions:e}));function tm(e){return ee(W,t=>({proposalType:e,proposalData:t}))}var qn=Go(Ee(If,e=>{switch(e){case"add":return Zh;case"update":return Xh;case"remove":return Yh;case"psk":return $h;case"reinit":return Qh;case"external_init":return Jh;case"group_context_extensions":return em}}),Ee(ge,e=>tm(e)));var bu={proposal:1,reference:2},ns=ie(it,e=>bu[e]),R1=A(ns),rm=ye(Qe,Te(bu)),gu=M([ns,pn],e=>[e.proposalOrRefType,e.proposal]),j1=A(gu),Eu=M([ns,V],e=>[e.proposalOrRefType,e.reference]),G1=A(Eu),os=e=>{switch(e.proposalOrRefType){case"proposal":return gu(e);case"reference":return Eu(e)}},z1=A(os),vu=Ee(rm,e=>{switch(e){case"proposal":return ee(qn,t=>({proposalOrRefType:e,proposal:t}));case"reference":return ee(W,t=>({proposalOrRefType:e,reference:t}))}});var Nr=M([pt,vt,V,Je,V,V,ae(wt)],e=>[e.version,e.cipherSuite,e.groupId,e.epoch,e.treeHash,e.confirmedTranscriptHash,e.extensions]),r2=A(Nr),_u=Q([Bt,It,W,at,W,W,se(Et)],(e,t,r,n,o,i,a)=>({version:e,cipherSuite:t,groupId:r,epoch:n,treeHash:o,confirmedTranscriptHash:i,extensions:a}));var Su={leaf:1,parent:2},Ur=ie(it,e=>Su[e]),c2=A(Ur),$o=ye(Qe,Te(Su));var Vn=M([V,V,ae(Re)],e=>[e.hpkePublicKey,e.parentHash,e.unmergedLeaves]),h2=A(Vn),Qo=Q([W,W,se(lt)],(e,t,r)=>({hpkePublicKey:e,parentHash:t,unmergedLeaves:r}));var Pu=e=>{switch(e.nodeType){case"parent":return M([Ur,Vn],t=>[t.nodeType,t.parent])(e);case"leaf":return M([Ur,_t],t=>[t.nodeType,t.leaf])(e)}},K2=A(Pu),om=Ee($o,e=>{switch(e){case"parent":return ee(Qo,t=>({nodeType:e,parent:t}));case"leaf":return ee(Dr,t=>({nodeType:e,leaf:t}))}});function im(e){let t=e.length-1;if(e[t]===void 0)throw new ct("The last node in the ratchet tree must be non-blank.");let r=am(e.length),n=e.slice();for(;n.length<r;)n.push(void 0);return n}function am(e){let t=0;for(;(1<<t+1)-1<e;)t++;return(1<<t+1)-1}function sm(e){let t=e.length-1;for(;t>=0&&e[t]===void 0;)t--;return e.slice(0,t+1)}var ku=ie(ae($t(Pu)),sm),I2=A(ku),cm=ee(se(Qt(om)),im);var Au=M([Ur,Re,$t(_t)],e=>[e.nodeType,e.leafIndex,e.leafNode]),q2=A(Au),fm=Q([lt,Qt(Dr)],(e,t)=>({nodeType:"leaf",leafIndex:e,leafNode:t})),Tu=M([Ur,$t(Vn),V,V],e=>[e.nodeType,e.parentNode,e.leftHash,e.rightHash]),V2=A(Tu),um=Q([Qt(Qo),W,W],(e,t,r)=>({nodeType:"parent",parentNode:e,leftHash:t,rightHash:r})),dm=e=>{switch(e.nodeType){case"leaf":return Au(e);case"parent":return Tu(e)}},F2=A(dm),W2=Ee($o,e=>{switch(e){case"leaf":return fm;case"parent":return um}});var pm=M([V,V,V],e=>[e.encryptionKey,e.parentHash,e.originalSiblingTreeHash]),iE=A(pm),aE=Q([W,W,W],(e,t,r)=>({encryptionKey:e,parentHash:t,originalSiblingTreeHash:r}));var Wn=M([V,V],e=>[e.kemOutput,e.ciphertext]),lE=A(Wn),ni=Q([W,W],(e,t)=>({kemOutput:e,ciphertext:t}));var Lu=M([V,ae(Wn)],e=>[e.hpkePublicKey,e.encryptedPathSecret]),DE=A(Lu),ym=Q([W,se(ni)],(e,t)=>({hpkePublicKey:e,encryptedPathSecret:t})),cs=M([_t,ae(Lu)],e=>[e.leafNode,e.nodes]),OE=A(cs),Ku=Q([Yf,se(ym)],(e,t)=>({leafNode:e,nodes:t}));var oi=M([ae(os),$t(cs)],e=>[e.proposals,e.path]),qE=A(oi),fs=Q([se(vu),Qt(Ku)],(e,t)=>({proposals:e,path:t}));var Iu={application:1,proposal:2,commit:3},Ht=ie(it,e=>Iu[e]),YE=A(Ht),Rr=ye(Qe,Te(Iu));var Bu={mls_public_message:1,mls_private_message:2,mls_welcome:3,mls_group_info:4,mls_key_package:5},ht=e=>ie(be,t=>Bu[t])(e),rv=A(ht),mn=ye(ge,Te(Bu));var Cu={member:1,external:2,new_member_proposal:3,new_member_commit:4},ii=ie(it,e=>Cu[e]),dv=A(ii),xm=ye(Qe,Te(Cu)),us=e=>{switch(e.senderType){case"member":return M([ii,Re],t=>[t.senderType,t.leafIndex])(e);case"external":return M([ii,Re],t=>[t.senderType,t.senderIndex])(e);case"new_member_proposal":case"new_member_commit":return ii(e.senderType)}},lv=A(us),Hu=Ee(xm,e=>{switch(e){case"member":return ee(lt,t=>({senderType:e,leafIndex:t}));case"external":return ee(lt,t=>({senderType:e,senderIndex:t}));case"new_member_proposal":return ee(()=>[void 0,0],()=>({senderType:e}));case"new_member_commit":return ee(()=>[void 0,0],()=>({senderType:e}))}});var Du=e=>[4,(t,r)=>{new Uint8Array(r,t,4).set(e,0)}],pv=A(Du),wm=(e,t)=>[e.subarray(t,t+4),4],Ou=M([Re,Re,Du],e=>[e.leafIndex,e.generation,e.reuseGuard]),hv=A(Ou),bm=Q([lt,lt,wm],(e,t,r)=>({leafIndex:e,generation:t,reuseGuard:r})),Nu=M([V,Je,Ht],e=>[e.groupId,e.epoch,e.contentType]),mv=A(Nu),yv=Q([W,at,Rr],(e,t,r)=>({groupId:e,epoch:t,contentType:r}));var Uu=M([Ht,V],e=>[e.contentType,e.applicationData]),Kv=A(Uu),Mu=M([Ht,pn],e=>[e.contentType,e.proposal]),Iv=A(Mu),Ru=M([Ht,oi],e=>[e.contentType,e.commit]),Bv=A(Ru),ju=e=>{switch(e.contentType){case"application":return Uu(e);case"proposal":return Mu(e);case"commit":return Ru(e)}},Cv=A(ju),gm=ee(W,e=>({contentType:"application",applicationData:e})),Em=ee(qn,e=>({contentType:"proposal",proposal:e})),vm=ee(fs,e=>({contentType:"commit",commit:e})),_m=Ee(Rr,e=>{switch(e){case"application":return gm;case"proposal":return Em;case"commit":return vm}});var yr=M([V,Je,us,V,ju],e=>[e.groupId,e.epoch,e.sender,e.authenticatedData,e]),Hv=A(yr),yn=Q([W,at,Hu,W,_m],(e,t,r,n,o)=>({groupId:e,epoch:t,sender:r,authenticatedData:n,...o})),Gu=e=>{switch(e.senderType){case"member":case"new_member_commit":return Nr(e.context);case"external":case"new_member_proposal":return Cr}},Dv=A(Gu),ds=M([pt,ht,yr,Gu],e=>[e.protocolVersion,e.wireformat,e.content,e]),Ov=A(ds),Sm=e=>{switch(e.contentType){case"commit":return Pm(e);case"application":case"proposal":return Cr}},Pm=ie(V,e=>e.confirmationTag),jr=M([V,Sm],e=>[e.signature,e]),Nv=A(jr),zu=ee(W,e=>({contentType:"commit",confirmationTag:e}));function ai(e){switch(e){case"commit":return Q([W,zu],(t,r)=>({signature:t,...r}));case"application":case"proposal":return ee(W,t=>({signature:t,contentType:e}))}}var km=M([ht,yr,jr],e=>[e.wireformat,e.content,e.auth]),qv=A(km),Vv=Q([mn,Ee(yn,e=>ee(ai(e.contentType),t=>({content:e,auth:t})))],(e,t)=>({wireformat:e,...t})),Am=M([ds,jr],e=>[e.contentTbs,e.auth]),Fv=A(Am);var Vu=e=>{switch(e.senderType){case"member":return V(e.membershipTag);case"external":case"new_member_proposal":case"new_member_commit":return Cr}},r_=A(Vu);function Tm(e){switch(e){case"member":return ee(W,t=>({senderType:e,membershipTag:t}));case"external":case"new_member_proposal":case"new_member_commit":return zo({senderType:e})}}var ls=M([yr,jr,Vu],e=>[e.content,e.auth,e]),n_=A(ls),Fu=Ee(yn,e=>Q([ai(e.contentType),Tm(e.sender.senderType)],(t,r)=>({...r,content:e,auth:t})));var Im=M([ae(be),ae(be),ae(Yt)],e=>[e.extensionTypes,e.proposalTypes,e.credentialTypes]),Bm=A(Im),Zu=Q([se(ge),se(ge),se(un)],(e,t,r)=>({extensionTypes:e,proposalTypes:t,credentialTypes:r}));var Xu=M([Nr,ae(wt),V,Re],e=>[e.groupContext,e.extensions,e.confirmationTag,e.signer]),z_=A(Xu),Hm=Q([_u,se(Et),W,lt],(e,t,r,n)=>({groupContext:e,extensions:t,confirmationTag:r,signer:n})),fi=M([Xu,V],e=>[e,e.signature]),q_=A(fi),ps=Q([Hm,W],(e,t)=>({...e,signature:t}));var Om=M([ht,yr,V],e=>[e.wireformat,e.content,e.signature]),lS=A(Om),pS=Lf([mn,yn,W],(e,t,r)=>{if(t.contentType==="commit")return{wireformat:e,content:t,signature:r}});function Ie(e){if(e.buffer instanceof ArrayBuffer)return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);{let t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(e,0),t}}function et(e){if(e.buffer instanceof ArrayBuffer)return e;let t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(e,0),t}function Yu(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e,0),r.set(t,e.length),r}var $u=M([V,$t(V),ae(Or)],e=>[e.joinerSecret,e.pathSecret,e.psks]),ES=A($u),Nm=Q([W,Qt(W),se(zn)],(e,t,r)=>({joinerSecret:e,pathSecret:t,psks:r}));var Qu=M([V,Wn],e=>[e.newMember,e.encryptedGroupSecrets]),HS=A(Qu),Mm=Q([W,ni],(e,t)=>({newMember:e,encryptedGroupSecrets:t})),hs=M([vt,ae(Qu),V],e=>[e.cipherSuite,e.secrets,e.encryptedGroupInfo]),DS=A(hs),Ju=Q([It,se(Mm),W],(e,t,r)=>({cipherSuite:e,secrets:t,encryptedGroupInfo:r}));var ms=M([V,Je,Ht,V,V,V],e=>[e.groupId,e.epoch,e.contentType,e.authenticatedData,e.encryptedSenderData,e.ciphertext]),l8=A(ms),id=Q([W,at,Rr,W,W,W],(e,t,r,n,o,i)=>({groupId:e,epoch:t,contentType:r,authenticatedData:n,encryptedSenderData:o,ciphertext:i})),ad=M([V,Je,Ht,V],e=>[e.groupId,e.epoch,e.contentType,e.authenticatedData]),p8=A(ad),h8=Q([W,at,Rr,W],(e,t,r,n)=>({groupId:e,epoch:t,contentType:r,authenticatedData:n}));function fd(e,t){return{async digest(r){let n=await e.digest(t,et(r));return new Uint8Array(n)},async mac(r,n){let o=await e.sign("HMAC",await cd(r,t),et(n));return new Uint8Array(o)},async verifyMac(r,n,o){return e.verify("HMAC",await cd(r,t),et(n),et(o))}}}function cd(e,t){return crypto.subtle.importKey("raw",et(e),{name:"HMAC",hash:{name:t}},!1,["sign","verify"])}var ft=class extends Error{constructor(t){let r;t instanceof Error?r=t.message:typeof t=="string"?r=t:r="",super(r),this.name=this.constructor.name}},De=class extends ft{};var We=class extends ft{},Be=class extends ft{},Zn=class extends ft{},Xn=class extends ft{},Yn=class extends ft{},$n=class extends ft{},Qn=class extends ft{},Jn=class extends ft{},Jt=class extends ft{},tt=class extends ft{};var d0={},ys=l0(globalThis,d0);function l0(e,t){return new Proxy(e,{get(r,n,o){return n in t?t[n]:e[n]},set(r,n,o){return n in t&&delete t[n],e[n]=o,!0},deleteProperty(r,n){let o=!1;return n in t&&(delete t[n],o=!0),n in e&&(delete e[n],o=!0),o},ownKeys(r){let n=Reflect.ownKeys(e),o=Reflect.ownKeys(t),i=new Set(o);return[...n.filter(a=>!i.has(a)),...o]},defineProperty(r,n,o){return n in t&&delete t[n],Reflect.defineProperty(e,n,o),!0},getOwnPropertyDescriptor(r,n){return n in t?Reflect.getOwnPropertyDescriptor(t,n):Reflect.getOwnPropertyDescriptor(e,n)},has(r,n){return n in t||n in e}})}async function p0(){if(ys!==void 0&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:e}=await import("crypto");return e.subtle}catch(e){throw new tt(e)}}var rt=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async _setup(){this._api===void 0&&(this._api=await p0())}};var Dt={Base:0,Psk:1,Auth:2,AuthPsk:3},ke={NotAssigned:0,DhkemP256HkdfSha256:16,DhkemP384HkdfSha384:17,DhkemP521HkdfSha512:18,DhkemSecp256k1HkdfSha256:19,DhkemX25519HkdfSha256:32,DhkemX448HkdfSha512:33,HybridkemX25519Kyber768:48,MlKem512:64,MlKem768:65,MlKem1024:66,XWing:25722},Gr={HkdfSha256:1,HkdfSha384:2,HkdfSha512:3},xr={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535};var xe=new Uint8Array(0);var ui=new Uint8Array([75,69,77,0,0]);var wr=e=>typeof e=="object"&&e!==null&&typeof e.privateKey=="object"&&typeof e.publicKey=="object";function bt(e,t){if(t<=0)throw new Error("i2Osp: too small size");if(e>=256**t)throw new Error("i2Osp: too large integer");let r=new Uint8Array(t);for(let n=0;n<t&&e;n++)r[t-(n+1)]=e%256,e=e>>8;return r}function zr(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e,0),r.set(t,e.length),r}function qr(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=atob(t),n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return n}function xs(e,t){if(e.byteLength!==t.byteLength)throw new Error("xor: different length inputs");let r=new Uint8Array(e.byteLength);for(let n=0;n<e.byteLength;n++)r[n]=e[n]^t[n];return r}var h0=new Uint8Array([101,97,101,95,112,114,107]),m0=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);function y0(e,t,r){let n=new Uint8Array(e.length+t.length+r.length);return n.set(e,0),n.set(t,e.length),n.set(r,e.length+t.length),n}var St=class{constructor(t,r,n){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=t,this._prim=r,this._kdf=n;let o=new Uint8Array(ui);o.set(bt(this.id,2),3),this._kdf.init(o)}async serializePublicKey(t){return await this._prim.serializePublicKey(t)}async deserializePublicKey(t){return await this._prim.deserializePublicKey(t)}async serializePrivateKey(t){return await this._prim.serializePrivateKey(t)}async deserializePrivateKey(t){return await this._prim.deserializePrivateKey(t)}async importKey(t,r,n=!0){return await this._prim.importKey(t,r,n)}async generateKeyPair(){return await this._prim.generateKeyPair()}async deriveKeyPair(t){if(t.byteLength>8192)throw new De("Too long ikm");return await this._prim.deriveKeyPair(t)}async encap(t){let r;t.ekm===void 0?r=await this.generateKeyPair():wr(t.ekm)?r=t.ekm:r=await this.deriveKeyPair(t.ekm);let n=await this._prim.serializePublicKey(r.publicKey),o=await this._prim.serializePublicKey(t.recipientPublicKey);try{let i;if(t.senderKey===void 0)i=new Uint8Array(await this._prim.dh(r.privateKey,t.recipientPublicKey));else{let c=wr(t.senderKey)?t.senderKey.privateKey:t.senderKey,d=new Uint8Array(await this._prim.dh(r.privateKey,t.recipientPublicKey)),l=new Uint8Array(await this._prim.dh(c,t.recipientPublicKey));i=zr(d,l)}let a;if(t.senderKey===void 0)a=zr(new Uint8Array(n),new Uint8Array(o));else{let c=wr(t.senderKey)?t.senderKey.publicKey:await this._prim.derivePublicKey(t.senderKey),d=await this._prim.serializePublicKey(c);a=y0(new Uint8Array(n),new Uint8Array(o),new Uint8Array(d))}let s=await this._generateSharedSecret(i,a);return{enc:n,sharedSecret:s}}catch(i){throw new Zn(i)}}async decap(t){let r=await this._prim.deserializePublicKey(t.enc),n=wr(t.recipientKey)?t.recipientKey.privateKey:t.recipientKey,o=wr(t.recipientKey)?t.recipientKey.publicKey:await this._prim.derivePublicKey(t.recipientKey),i=await this._prim.serializePublicKey(o);try{let a;if(t.senderPublicKey===void 0)a=new Uint8Array(await this._prim.dh(n,r));else{let c=new Uint8Array(await this._prim.dh(n,r)),d=new Uint8Array(await this._prim.dh(n,t.senderPublicKey));a=zr(c,d)}let s;if(t.senderPublicKey===void 0)s=zr(new Uint8Array(t.enc),new Uint8Array(i));else{let c=await this._prim.serializePublicKey(t.senderPublicKey);s=new Uint8Array(t.enc.byteLength+i.byteLength+c.byteLength),s.set(new Uint8Array(t.enc),0),s.set(new Uint8Array(i),t.enc.byteLength),s.set(new Uint8Array(c),t.enc.byteLength+i.byteLength)}return await this._generateSharedSecret(a,s)}catch(a){throw new Xn(a)}}async _generateSharedSecret(t,r){let n=this._kdf.buildLabeledIkm(h0,t),o=this._kdf.buildLabeledInfo(m0,r,this.secretSize);return await this._kdf.extractAndExpand(xe.buffer,n.buffer,o.buffer,this.secretSize)}};var mt=["deriveBits"],br=new Uint8Array([100,107,112,95,112,114,107]),xn=new Uint8Array([115,107]);var di=class{constructor(t){Object.defineProperty(this,"_num",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._num=new Uint8Array(t)}val(){return this._num}reset(){this._num.fill(0)}set(t){if(t.length!==this._num.length)throw new Error("Bignum.set: invalid argument");this._num.set(t)}isZero(){for(let t=0;t<this._num.length;t++)if(this._num[t]!==0)return!1;return!0}lessThan(t){if(t.length!==this._num.length)throw new Error("Bignum.lessThan: invalid argument");for(let r=0;r<this._num.length;r++){if(this._num[r]<t[r])return!0;if(this._num[r]>t[r])return!1}return!1}};var x0=new Uint8Array([99,97,110,100,105,100,97,116,101]),w0=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),b0=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),g0=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),E0=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),v0=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),_0=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]),Fr=class extends rt{constructor(t,r){switch(super(),Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bitmask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=r,t){case ke.DhkemP256HkdfSha256:this._alg={name:"ECDH",namedCurve:"P-256"},this._nPk=65,this._nSk=32,this._nDh=32,this._order=w0,this._bitmask=255,this._pkcs8AlgId=E0;break;case ke.DhkemP384HkdfSha384:this._alg={name:"ECDH",namedCurve:"P-384"},this._nPk=97,this._nSk=48,this._nDh=48,this._order=b0,this._bitmask=255,this._pkcs8AlgId=v0;break;default:this._alg={name:"ECDH",namedCurve:"P-521"},this._nPk=133,this._nSk=66,this._nDh=66,this._order=g0,this._bitmask=1,this._pkcs8AlgId=_0;break}}async serializePublicKey(t){await this._setup();try{return await this._api.exportKey("raw",t)}catch(r){throw new We(r)}}async deserializePublicKey(t){await this._setup();try{return await this._importRawKey(t,!0)}catch(r){throw new Be(r)}}async serializePrivateKey(t){await this._setup();try{let r=await this._api.exportKey("jwk",t);if(!("d"in r))throw new Error("Not private key");return qr(r.d).buffer}catch(r){throw new We(r)}}async deserializePrivateKey(t){await this._setup();try{return await this._importRawKey(t,!1)}catch(r){throw new Be(r)}}async importKey(t,r,n){await this._setup();try{if(t==="raw")return await this._importRawKey(r,n);if(r instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(r,n)}catch(o){throw new Be(o)}}async generateKeyPair(){await this._setup();try{return await this._api.generateKey(this._alg,!0,mt)}catch(t){throw new tt(t)}}async deriveKeyPair(t){await this._setup();try{let r=await this._hkdf.labeledExtract(xe.buffer,br,new Uint8Array(t)),n=new di(this._nSk);for(let i=0;n.isZero()||!n.lessThan(this._order);i++){if(i>255)throw new Error("Faild to derive a key pair");let a=new Uint8Array(await this._hkdf.labeledExpand(r,x0,bt(i,1),this._nSk));a[0]=a[0]&this._bitmask,n.set(a)}let o=await this._deserializePkcs8Key(n.val());return n.reset(),{privateKey:o,publicKey:await this.derivePublicKey(o)}}catch(r){throw new Jt(r)}}async derivePublicKey(t){await this._setup();try{let r=await this._api.exportKey("jwk",t);return delete r.d,delete r.key_ops,await this._api.importKey("jwk",r,this._alg,!0,[])}catch(r){throw new Be(r)}}async dh(t,r){try{return await this._setup(),await this._api.deriveBits({name:"ECDH",public:r},t,this._nDh*8)}catch(n){throw new We(n)}}async _importRawKey(t,r){if(r&&t.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");if(!r&&t.byteLength!==this._nSk)throw new Error("Invalid private key for the ciphersuite");return r?await this._api.importKey("raw",t,this._alg,!0,[]):await this._deserializePkcs8Key(new Uint8Array(t))}async _importJWK(t,r){if(typeof t.crv>"u"||t.crv!==this._alg.namedCurve)throw new Error(`Invalid crv: ${t.crv}`);if(r){if(typeof t.d<"u")throw new Error("Invalid key: `d` should not be set");return await this._api.importKey("jwk",t,this._alg,!0,[])}if(typeof t.d>"u")throw new Error("Invalid key: `d` not found");return await this._api.importKey("jwk",t,this._alg,!0,mt)}async _deserializePkcs8Key(t){let r=new Uint8Array(this._pkcs8AlgId.length+t.length);return r.set(this._pkcs8AlgId,0),r.set(t,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",r,this._alg,!0,mt)}};var dd=new Uint8Array([72,80,75,69,45,118,49]),eo=class extends rt{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Gr.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:xe}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}init(t){this._suiteId=t}buildLabeledIkm(t,r){this._checkInit();let n=new Uint8Array(7+this._suiteId.byteLength+t.byteLength+r.byteLength);return n.set(dd,0),n.set(this._suiteId,7),n.set(t,7+this._suiteId.byteLength),n.set(r,7+this._suiteId.byteLength+t.byteLength),n}buildLabeledInfo(t,r,n){this._checkInit();let o=new Uint8Array(9+this._suiteId.byteLength+t.byteLength+r.byteLength);return o.set(new Uint8Array([0,n]),0),o.set(dd,2),o.set(this._suiteId,9),o.set(t,9+this._suiteId.byteLength),o.set(r,9+this._suiteId.byteLength+t.byteLength),o}async extract(t,r){if(await this._setup(),t.byteLength===0&&(t=new ArrayBuffer(this.hashSize)),t.byteLength!==this.hashSize)throw new De("The salt length must be the same as the hashSize");let n=await this._api.importKey("raw",t,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",n,r)}async expand(t,r,n){await this._setup();let o=await this._api.importKey("raw",t,this.algHash,!1,["sign"]),i=new ArrayBuffer(n),a=new Uint8Array(i),s=xe,c=new Uint8Array(r),d=new Uint8Array(1);if(n>255*this.hashSize)throw new Error("Entropy limit reached");let l=new Uint8Array(this.hashSize+c.length+1);for(let p=1,w=0;w<a.length;p++)d[0]=p,l.set(s,0),l.set(c,s.length),l.set(d,s.length+c.length),s=new Uint8Array(await this._api.sign("HMAC",o,l.slice(0,s.length+c.length+1))),a.length-w>=s.length?(a.set(s,w),w+=s.length):(a.set(s.slice(0,a.length-w),w),w+=a.length-w);return i}async extractAndExpand(t,r,n,o){await this._setup();let i=await this._api.importKey("raw",r,"HKDF",!1,["deriveBits"]);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:t,info:n},i,o*8)}async labeledExtract(t,r,n){return await this.extract(t,this.buildLabeledIkm(r,n).buffer)}async labeledExpand(t,r,n,o){return await this.expand(t,this.buildLabeledInfo(r,n,o).buffer,o)}_checkInit(){if(this._suiteId===xe)throw new Error("Not initialized. Call init()")}},er=class extends eo{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Gr.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}},Wr=class extends eo{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Gr.HkdfSha384}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-384",length:384}})}},tr=class extends eo{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Gr.HkdfSha512}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-512",length:512}})}};var ws=["encrypt","decrypt"];function k0(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function to(e,t,r=""){let n=k0(e),o=e?.length,i=t!==void 0;if(!n||i&&o!==t){let a=r&&`"${r}" `,s=i?` of length ${t}`:"",c=n?`length=${o}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+s+", got "+c)}return e}function pd(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");ld(e.outputLen),ld(e.blockLen)}function li(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ld(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function pi(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}var hi=class{constructor(t,r){if(Object.defineProperty(this,"oHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"iHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"destroyed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),pd(t),to(r,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,o=new Uint8Array(n);o.set(r.length>n?t.create().update(r).digest():r);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),pi(o)}update(t){return li(this),this.iHash.update(t),this}digestInto(t){li(this),to(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});let{oHash:r,iHash:n,finished:o,destroyed:i,blockLen:a,outputLen:s}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=a,t.outputLen=s,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},hd=(e,t,r)=>new hi(e,t).update(r).digest();hd.create=(e,t)=>new hi(e,t);var Ck=BigInt(0),Hk=BigInt(1),Dk=BigInt(2);var gs=class extends rt{constructor(t){super(),Object.defineProperty(this,"_rawKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._rawKey=t}async seal(t,r,n){await this._setupKey();let o={name:"AES-GCM",iv:t,additionalData:n};return await this._api.encrypt(o,this._key,r)}async open(t,r,n){await this._setupKey();let o={name:"AES-GCM",iv:t,additionalData:n};return await this._api.decrypt(o,this._key,r)}async _setupKey(){if(this._key!==void 0)return;await this._setup();let t=await this._importKey(this._rawKey);new Uint8Array(this._rawKey).fill(0),this._key=t}async _importKey(t){return await this._api.importKey("raw",t,{name:"AES-GCM"},!0,ws)}},Zr=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:xr.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(t){return new gs(t)}},wn=class extends Zr{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:xr.Aes256Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}};function Es(){return new Promise((e,t)=>{t(new tt("Not supported"))})}var L0=new Uint8Array([115,101,99]),bn=class{constructor(t,r,n){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exporterSecret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._api=t,this._kdf=r,this.exporterSecret=n}async seal(t,r){return await Es()}async open(t,r){return await Es()}async export(t,r){if(t.byteLength>8192)throw new De("Too long exporter context");try{return await this._kdf.labeledExpand(this.exporterSecret,L0,new Uint8Array(t),r)}catch(n){throw new Yn(n)}}},mi=class extends bn{},yi=class extends bn{constructor(t,r,n,o){super(t,r,n),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=o}};var gn=class extends bn{constructor(t,r,n){if(super(t,r,n.exporterSecret),Object.defineProperty(this,"_aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nT",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_ctx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.key===void 0||n.baseNonce===void 0||n.seq===void 0)throw new Error("Required parameters are missing");this._aead=n.aead,this._nK=this._aead.keySize,this._nN=this._aead.nonceSize,this._nT=this._aead.tagSize;let o=this._aead.createEncryptionContext(n.key);this._ctx={key:o,baseNonce:n.baseNonce,seq:n.seq}}computeNonce(t){let r=bt(t.seq,t.baseNonce.byteLength);return xs(t.baseNonce,r).buffer}incrementSeq(t){if(t.seq>Number.MAX_SAFE_INTEGER)throw new Jn("Message limit reached");t.seq+=1}};var K0=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},I0=function(e,t,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(e,r):o?o.value=r:t.set(e,r),r},xi,En=class{constructor(){xi.set(this,Promise.resolve())}async lock(){let t,r=new Promise(o=>{t=o}),n=K0(this,xi,"f");return I0(this,xi,r,"f"),await n,t}};xi=new WeakMap;var yd=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},B0=function(e,t,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(e,r):o?o.value=r:t.set(e,r),r},ro,wi=class extends gn{constructor(){super(...arguments),ro.set(this,void 0)}async open(t,r=xe.buffer){B0(this,ro,yd(this,ro,"f")??new En,"f");let n=await yd(this,ro,"f").lock(),o;try{o=await this._ctx.key.open(this.computeNonce(this._ctx),t,r)}catch(i){throw new Qn(i)}finally{n()}return this.incrementSeq(this._ctx),o}};ro=new WeakMap;var xd=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},C0=function(e,t,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(e,r):o?o.value=r:t.set(e,r),r},no,bi=class extends gn{constructor(t,r,n,o){super(t,r,n),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),no.set(this,void 0),this.enc=o}async seal(t,r=xe.buffer){C0(this,no,xd(this,no,"f")??new En,"f");let n=await xd(this,no,"f").lock(),o;try{o=await this._ctx.key.seal(this.computeNonce(this._ctx),t,r)}catch(i){throw new $n(i)}finally{n()}return this.incrementSeq(this._ctx),o}};no=new WeakMap;var H0=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),D0=new Uint8Array([101,120,112]),O0=new Uint8Array([105,110,102,111,95,104,97,115,104]),N0=new Uint8Array([107,101,121]),U0=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),M0=new Uint8Array([115,101,99,114,101,116]),R0=new Uint8Array([72,80,75,69,0,0,0,0,0,0]),gi=class extends rt{constructor(t){if(super(),Object.defineProperty(this,"_kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof t.kem=="number")throw new De("KemId cannot be used");if(this._kem=t.kem,typeof t.kdf=="number")throw new De("KdfId cannot be used");if(this._kdf=t.kdf,typeof t.aead=="number")throw new De("AeadId cannot be used");this._aead=t.aead,this._suiteId=new Uint8Array(R0),this._suiteId.set(bt(this._kem.id,2),4),this._suiteId.set(bt(this._kdf.id,2),6),this._suiteId.set(bt(this._aead.id,2),8),this._kdf.init(this._suiteId)}get kem(){return this._kem}get kdf(){return this._kdf}get aead(){return this._aead}async createSenderContext(t){this._validateInputLength(t),await this._setup();let r=await this._kem.encap(t),n;return t.psk!==void 0?n=t.senderKey!==void 0?Dt.AuthPsk:Dt.Psk:n=t.senderKey!==void 0?Dt.Auth:Dt.Base,await this._keyScheduleS(n,r.sharedSecret,r.enc,t)}async createRecipientContext(t){this._validateInputLength(t),await this._setup();let r=await this._kem.decap(t),n;return t.psk!==void 0?n=t.senderPublicKey!==void 0?Dt.AuthPsk:Dt.Psk:n=t.senderPublicKey!==void 0?Dt.Auth:Dt.Base,await this._keyScheduleR(n,r,t)}async seal(t,r,n=xe.buffer){let o=await this.createSenderContext(t);return{ct:await o.seal(r,n),enc:o.enc}}async open(t,r,n=xe.buffer){return await(await this.createRecipientContext(t)).open(r,n)}async _keySchedule(t,r,n){let o=n.psk===void 0?xe:new Uint8Array(n.psk.id),i=await this._kdf.labeledExtract(xe.buffer,U0,o),a=n.info===void 0?xe:new Uint8Array(n.info),s=await this._kdf.labeledExtract(xe.buffer,O0,a),c=new Uint8Array(1+i.byteLength+s.byteLength);c.set(new Uint8Array([t]),0),c.set(new Uint8Array(i),1),c.set(new Uint8Array(s),1+i.byteLength);let d=n.psk===void 0?xe:new Uint8Array(n.psk.key),l=this._kdf.buildLabeledIkm(M0,d).buffer,p=this._kdf.buildLabeledInfo(D0,c,this._kdf.hashSize).buffer,w=await this._kdf.extractAndExpand(r,l,p,this._kdf.hashSize);if(this._aead.id===xr.ExportOnly)return{aead:this._aead,exporterSecret:w};let h=this._kdf.buildLabeledInfo(N0,c,this._aead.keySize).buffer,b=await this._kdf.extractAndExpand(r,l,h,this._aead.keySize),L=this._kdf.buildLabeledInfo(H0,c,this._aead.nonceSize).buffer,E=await this._kdf.extractAndExpand(r,l,L,this._aead.nonceSize);return{aead:this._aead,exporterSecret:w,key:b,baseNonce:new Uint8Array(E),seq:0}}async _keyScheduleS(t,r,n,o){let i=await this._keySchedule(t,r,o);return i.key===void 0?new yi(this._api,this._kdf,i.exporterSecret,n):new bi(this._api,this._kdf,i,n)}async _keyScheduleR(t,r,n){let o=await this._keySchedule(t,r,n);return o.key===void 0?new mi(this._api,this._kdf,o.exporterSecret):new wi(this._api,this._kdf,o)}_validateInputLength(t){if(t.info!==void 0&&t.info.byteLength>65536)throw new De("Too long info");if(t.psk!==void 0){if(t.psk.key.byteLength<32)throw new De(`PSK must have at least ${32} bytes`);if(t.psk.key.byteLength>8192)throw new De("Too long psk.key");if(t.psk.id.byteLength>8192)throw new De("Too long psk.id")}}};var Ei=class extends St{constructor(){let t=new er,r=new Fr(ke.DhkemP256HkdfSha256,t);super(ke.DhkemP256HkdfSha256,r,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ke.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},vi=class extends St{constructor(){let t=new Wr,r=new Fr(ke.DhkemP384HkdfSha384,t);super(ke.DhkemP384HkdfSha384,r,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ke.DhkemP384HkdfSha384}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:48})}},_i=class extends St{constructor(){let t=new tr,r=new Fr(ke.DhkemP521HkdfSha512,t);super(ke.DhkemP521HkdfSha512,r,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ke.DhkemP521HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64})}};var vn=class extends gi{},oo=class extends Ei{},io=class extends vi{},ao=class extends _i{},so=class extends er{},co=class extends Wr{},fo=class extends tr{};var Si="X25519",j0=new Uint8Array([48,46,2,1,0,48,5,6,3,43,101,110,4,34,4,32]),Pi=class extends rt{constructor(t){super(),Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._alg={name:Si},this._hkdf=t,this._nPk=32,this._nSk=32,this._nDh=32,this._pkcs8AlgId=j0}async serializePublicKey(t){await this._setup();try{return await this._api.exportKey("raw",t)}catch(r){throw new We(r)}}async deserializePublicKey(t){await this._setup();try{return await this._importRawKey(t,!0)}catch(r){throw new Be(r)}}async serializePrivateKey(t){await this._setup();try{let r=await this._api.exportKey("jwk",t);if(!("d"in r))throw new Error("Not private key");return qr(r.d).buffer}catch(r){throw new We(r)}}async deserializePrivateKey(t){await this._setup();try{return await this._importRawKey(t,!1)}catch(r){throw new Be(r)}}async importKey(t,r,n){await this._setup();try{if(t==="raw")return await this._importRawKey(r,n);if(r instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(r,n)}catch(o){throw new Be(o)}}async generateKeyPair(){await this._setup();try{return await this._api.generateKey(Si,!0,mt)}catch(t){throw new tt(t)}}async deriveKeyPair(t){await this._setup();try{let r=await this._hkdf.labeledExtract(xe.buffer,br,new Uint8Array(t)),n=await this._hkdf.labeledExpand(r,xn,xe,this._nSk),o=new Uint8Array(n),i=await this._deserializePkcs8Key(o);return o.fill(0),{privateKey:i,publicKey:await this.derivePublicKey(i)}}catch(r){throw new Jt(r)}}async derivePublicKey(t){await this._setup();try{let r=await this._api.exportKey("jwk",t);return delete r.d,delete r.key_ops,await this._api.importKey("jwk",r,this._alg,!0,[])}catch(r){throw new Be(r)}}async dh(t,r){await this._setup();try{return await this._api.deriveBits({name:Si,public:r},t,this._nDh*8)}catch(n){throw new We(n)}}async _importRawKey(t,r){if(r&&t.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");if(!r&&t.byteLength!==this._nSk)throw new Error("Invalid private key for the ciphersuite");return r?await this._api.importKey("raw",t,this._alg,!0,[]):await this._deserializePkcs8Key(new Uint8Array(t))}async _importJWK(t,r){if(typeof t.kty>"u"||t.kty!=="OKP")throw new Error(`Invalid kty: ${t.crv}`);if(typeof t.crv>"u"||t.crv!==Si)throw new Error(`Invalid crv: ${t.crv}`);if(r){if(typeof t.d<"u")throw new Error("Invalid key: `d` should not be set");return await this._api.importKey("jwk",t,this._alg,!0,[])}if(typeof t.d>"u")throw new Error("Invalid key: `d` not found");return await this._api.importKey("jwk",t,this._alg,!0,mt)}async _deserializePkcs8Key(t){let r=new Uint8Array(this._pkcs8AlgId.length+t.length);return r.set(this._pkcs8AlgId,0),r.set(t,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",r,this._alg,!0,mt)}};var uo=class extends St{constructor(){let t=new er;super(ke.DhkemX25519HkdfSha256,new Pi(t),t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ke.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}};var ki="X448",G0=new Uint8Array([48,70,2,1,0,48,5,6,3,43,101,111,4,58,4,56]),Ai=class extends rt{constructor(t){super(),Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._alg={name:ki},this._hkdf=t,this._nPk=56,this._nSk=56,this._nDh=56,this._pkcs8AlgId=G0}async serializePublicKey(t){await this._setup();try{return await this._api.exportKey("raw",t)}catch(r){throw new We(r)}}async deserializePublicKey(t){await this._setup();try{return await this._importRawKey(t,!0)}catch(r){throw new Be(r)}}async serializePrivateKey(t){await this._setup();try{let r=await this._api.exportKey("jwk",t);if(!("d"in r))throw new Error("Not private key");return qr(r.d).buffer}catch(r){throw new We(r)}}async deserializePrivateKey(t){await this._setup();try{return await this._importRawKey(t,!1)}catch(r){throw new Be(r)}}async importKey(t,r,n){await this._setup();try{if(t==="raw")return await this._importRawKey(r,n);if(r instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(r,n)}catch(o){throw new Be(o)}}async generateKeyPair(){await this._setup();try{return await this._api.generateKey(ki,!0,mt)}catch(t){throw new tt(t)}}async deriveKeyPair(t){await this._setup();try{let r=await this._hkdf.labeledExtract(xe.buffer,br,new Uint8Array(t)),n=await this._hkdf.labeledExpand(r,xn,xe,this._nSk),o=new Uint8Array(n),i=await this._deserializePkcs8Key(o);return o.fill(0),{privateKey:i,publicKey:await this.derivePublicKey(i)}}catch(r){throw new Jt(r)}}async derivePublicKey(t){await this._setup();try{let r=await this._api.exportKey("jwk",t);return delete r.d,delete r.key_ops,await this._api.importKey("jwk",r,this._alg,!0,[])}catch(r){throw new Be(r)}}async dh(t,r){await this._setup();try{return await this._api.deriveBits({name:ki,public:r},t,this._nDh*8)}catch(n){throw new We(n)}}async _importRawKey(t,r){if(r&&t.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");if(!r&&t.byteLength!==this._nSk)throw new Error("Invalid private key for the ciphersuite");return r?await this._api.importKey("raw",t,this._alg,!0,[]):await this._deserializePkcs8Key(new Uint8Array(t))}async _importJWK(t,r){if(typeof t.kty>"u"||t.kty!=="OKP")throw new Error(`Invalid kty: ${t.crv}`);if(typeof t.crv>"u"||t.crv!==ki)throw new Error(`Invalid crv: ${t.crv}`);if(r){if(typeof t.d<"u")throw new Error("Invalid key: `d` should not be set");return await this._api.importKey("jwk",t,this._alg,!0,[])}if(typeof t.d>"u")throw new Error("Invalid key: `d` not found");return await this._api.importKey("jwk",t,this._alg,!0,mt)}async _deserializePkcs8Key(t){let r=new Uint8Array(this._pkcs8AlgId.length+t.length);return r.set(this._pkcs8AlgId,0),r.set(t,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",r,this._alg,!0,mt)}};var lo=class extends St{constructor(){let t=new tr;super(ke.DhkemX448HkdfSha512,new Ai(t),t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ke.DhkemX448HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56})}};async function vs(e,t,r){return{async open(n,o,i,a,s){try{let c=await r.open({recipientKey:n,enc:Ie(o),info:Ie(a)},Ie(i),s?Ie(s):new ArrayBuffer);return new Uint8Array(c)}catch(c){throw new hr(`${c}`)}},async seal(n,o,i,a){let s=await r.seal({recipientPublicKey:n,info:Ie(i)},Ie(o),a?Ie(a):new ArrayBuffer);return{ct:new Uint8Array(s.ct),enc:new Uint8Array(s.enc)}},async exportSecret(n,o,i,a){let s=await r.createSenderContext({recipientPublicKey:n,info:Ie(a)});return{enc:new Uint8Array(s.enc),secret:new Uint8Array(await s.export(Ie(o),i))}},async importSecret(n,o,i,a,s){try{let c=await r.createRecipientContext({recipientKey:n,info:Ie(s),enc:Ie(i)});return new Uint8Array(await c.export(Ie(o),a))}catch(c){throw new hr(`${c}`)}},async importPrivateKey(n){try{let o=e.kem==="DHKEM-P521-HKDF-SHA512"?z0(n):n;return await r.kem.deserializePrivateKey(Ie(o))}catch(o){throw new hr(`${o}`)}},async importPublicKey(n){try{return await r.kem.deserializePublicKey(Ie(n))}catch(o){throw new hr(`${o}`)}},async exportPublicKey(n){return new Uint8Array(await r.kem.serializePublicKey(n))},async exportPrivateKey(n){return new Uint8Array(await r.kem.serializePrivateKey(n))},async encryptAead(n,o,i,a){return t.encrypt(n,o,i||new Uint8Array,a)},async decryptAead(n,o,i,a){try{return await t.decrypt(n,o,i||new Uint8Array,a)}catch(s){throw new hr(`${s}`)}},async deriveKeyPair(n){let o=await r.kem.deriveKeyPair(Ie(n));return{privateKey:o.privateKey,publicKey:o.publicKey}},async generateKeyPair(){let n=await r.kem.generateKeyPair();return{privateKey:n.privateKey,publicKey:n.publicKey}},keyLength:r.aead.keySize,nonceLength:r.aead.nonceSize}}function z0(e){let t=66-e.byteLength;return Yu(new Uint8Array(t),e)}async function Rd(e){switch(e){case"AES128GCM":return[{encrypt(t,r,n,o){return Ud(t,r,n,o)},decrypt(t,r,n,o){return Md(t,r,n,o)}},new Zr];case"AES256GCM":return[{encrypt(t,r,n,o){return Ud(t,r,n,o)},decrypt(t,r,n,o){return Md(t,r,n,o)}},new wn];case"CHACHA20POLY1305":try{let{Chacha20Poly1305:t}=await import("@hpke/chacha20poly1305"),{chacha20poly1305:r}=await Promise.resolve().then(()=>(Nd(),Od));return[{async encrypt(n,o,i,a){return r(n,o,i).encrypt(a)},async decrypt(n,o,i,a){return r(n,o,i).decrypt(a)}},new t]}catch{throw new je("Optional dependency '@hpke/chacha20poly1305' is not installed. Please install it to use this feature.")}}}async function Ud(e,t,r,n){let o=await crypto.subtle.importKey("raw",et(e),{name:"AES-GCM"},!1,["encrypt"]),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:et(t),additionalData:r.length>0?et(r):void 0},o,et(n));return new Uint8Array(i)}async function Md(e,t,r,n){let o=await crypto.subtle.importKey("raw",et(e),{name:"AES-GCM"},!1,["decrypt"]),i=await crypto.subtle.decrypt({name:"AES-GCM",iv:et(t),additionalData:r.length>0?et(r):void 0},o,et(n));return new Uint8Array(i)}function Is(e){return{async extract(t,r){let n=await e.extract(Ie(t),Ie(r));return new Uint8Array(n)},async expand(t,r,n){let o=await e.expand(Ie(t),Ie(r),n);return new Uint8Array(o)},size:e.hashSize}}function Pn(e){switch(e){case"HKDF-SHA256":return new so;case"HKDF-SHA384":return new co;case"HKDF-SHA512":return new fo}}async function Bs(e){switch(e){case"DHKEM-P256-HKDF-SHA256":return new oo;case"DHKEM-X25519-HKDF-SHA256":return new uo;case"DHKEM-X448-HKDF-SHA512":return new lo;case"DHKEM-P521-HKDF-SHA512":return new ao;case"DHKEM-P384-HKDF-SHA384":return new io;case"ML-KEM-512":try{let{MlKem512:t}=await import("@hpke/ml-kem");return new t}catch{throw new je("Optional dependency '@hpke/ml-kem' is not installed. Please install it to use this feature.")}case"ML-KEM-768":try{let{MlKem768:t}=await import("@hpke/ml-kem");return new t}catch{throw new je("Optional dependency '@hpke/ml-kem' is not installed. Please install it to use this feature.")}case"ML-KEM-1024":try{let{MlKem1024:t}=await import("@hpke/ml-kem");return new t}catch{throw new je("Optional dependency '@hpke/ml-kem' is not installed. Please install it to use this feature.")}case"X-Wing":try{let{XWing:t}=await import("@hpke/hybridkem-x-wing");return new t}catch{throw new je("Optional dependency '@hpke/hybridkem-x-wing' is not installed. Please install it to use this feature.")}}}async function jd(e){let[t,r]=await Rd(e.aead),n=new vn({kem:await Bs(e.kem),kdf:Pn(e.kdf),aead:r});return vs(e,t,n)}var Cs={randomBytes(e){return crypto.getRandomValues(new Uint8Array(e))}};async function gc(e){switch(e){case"Ed25519":try{let{ed25519:t}=await Promise.resolve().then(()=>(Ml(),Ul));return{async sign(r,n){return t.sign(n,r)},async verify(r,n,o){return t.verify(o,n,r)},async keygen(){let r=t.utils.randomSecretKey();return{signKey:r,publicKey:t.getPublicKey(r)}}}}catch{throw new je("Optional dependency '@noble/curves' is not installed. Please install it to use this feature.")}case"Ed448":try{let{ed448:t}=await Promise.resolve().then(()=>(ap(),ip));return{async sign(r,n){return t.sign(n,r)},async verify(r,n,o){return t.verify(o,n,r)},async keygen(){let r=t.utils.randomSecretKey();return{signKey:r,publicKey:t.getPublicKey(r)}}}}catch{throw new je("Optional dependency '@noble/curves' is not installed. Please install it to use this feature.")}case"P256":try{let{p256:t}=await Promise.resolve().then(()=>(sa(),aa));return{async sign(r,n){return t.sign(n,r,{prehash:!0,format:"der",lowS:!1})},async verify(r,n,o){return t.verify(o,n,r,{prehash:!0,format:"der",lowS:!1})},async keygen(){let r=t.utils.randomSecretKey();return{signKey:r,publicKey:t.getPublicKey(r)}}}}catch{throw new je("Optional dependency '@noble/curves' is not installed. Please install it to use this feature.")}case"P384":try{let{p384:t}=await Promise.resolve().then(()=>(sa(),aa));return{async sign(r,n){return t.sign(n,r,{prehash:!0,format:"der",lowS:!1})},async verify(r,n,o){return t.verify(o,n,r,{prehash:!0,format:"der",lowS:!1})},async keygen(){let r=t.utils.randomSecretKey();return{signKey:r,publicKey:t.getPublicKey(r)}}}}catch{throw new je("Optional dependency '@noble/curves' is not installed. Please install it to use this feature.")}case"P521":try{let{p521:t}=await Promise.resolve().then(()=>(sa(),aa));return{async sign(r,n){return t.sign(n,r,{prehash:!0,format:"der",lowS:!1})},async verify(r,n,o){return t.verify(o,n,r,{prehash:!0,format:"der",lowS:!1})},async keygen(){let r=t.utils.randomSecretKey();return{signKey:r,publicKey:t.getPublicKey(r)}}}}catch{throw new je("Optional dependency '@noble/curves' is not installed. Please install it to use this feature.")}case"ML-DSA-87":try{let{ml_dsa87:t}=await import("@noble/post-quantum/ml-dsa.js");return{async sign(r,n){return t.sign(n,r)},async verify(r,n,o){return t.verify(o,n,r)},async keygen(){let r=t.keygen(crypto.getRandomValues(new Uint8Array(32)));return{signKey:r.secretKey,publicKey:r.publicKey}}}}catch{throw new je("Optional dependency '@noble/post-quantum' is not installed. Please install it to use this feature.")}}}var ca={async getCiphersuiteImpl(e){let t=crypto.subtle;return{kdf:Is(Pn(e.hpke.kdf)),hash:fd(t,e.hash),signature:await gc(e.signature),hpke:await jd(e.hpke),rng:Cs,name:e.name}}};async function fa(e,t=ca){return t.getCiphersuiteImpl(e)}var pp=M([ht,ls],e=>[e.wireformat,e.publicMessage]),YT=A(pp),hp=M([ht,hs],e=>[e.wireformat,e.welcome]),$T=A(hp),mp=M([ht,ms],e=>[e.wireformat,e.privateMessage]),QT=A(mp),yp=M([ht,fi],e=>[e.wireformat,e.groupInfo]),JT=A(yp),xp=M([ht,jn],e=>[e.wireformat,e.keyPackage]),eL=A(xp),wp=e=>{switch(e.wireformat){case"mls_public_message":return pp(e);case"mls_welcome":return hp(e);case"mls_private_message":return mp(e);case"mls_group_info":return yp(e);case"mls_key_package":return xp(e)}},tL=A(wp),Mx=Ee(mn,e=>{switch(e){case"mls_public_message":return ee(Fu,t=>({wireformat:e,publicMessage:t}));case"mls_welcome":return ee(Ju,t=>({wireformat:e,welcome:t}));case"mls_private_message":return ee(id,t=>({wireformat:e,privateMessage:t}));case"mls_group_info":return ee(ps,t=>({wireformat:e,groupInfo:t}));case"mls_key_package":return ee(Yo,t=>({wireformat:e,keyPackage:t}))}}),Rx=M([pt,wp],e=>[e.version,e]),jx=A(Rx),Gx=Q([Bt,Mx],(e,t)=>({...t,version:e}));var zx=[2570,6682,10794,14906,19018,23130,27242,31354,35466,39578,43690,47802,51914,56026,60138],bp={probabilityPerGreaseValue:.1};function ua(e){return zx.filter(()=>e.probabilityPerGreaseValue>Math.random())}function qx(e){return ua(e).map(t=>t.toString())}function Vx(e){return ua(e).map(t=>t.toString())}function gp(e,t){return{ciphersuites:[...t.ciphersuites,...qx(e)],credentials:[...t.credentials,...Vx(e)],extensions:[...t.extensions,...ua(e)],proposals:[...t.proposals,...ua(e)],versions:t.versions}}function Ec(){return gp(bp,{versions:["mls10"],ciphersuites:Object.keys(dn),extensions:[],proposals:[],credentials:["basic","x509"]})}var da=class{#e;#t;#r=[];#n="";constructor(t){this.#e=t}async start(t){this.#n=t,this.#t=await kf("KeyPackage",1,{upgrade:(n,o,i,a,s)=>{if(o==0){var c=n.createObjectStore("KeyPackage");c.createIndex("KeyPackage_id",["id"])}}});let r=this.#t.transaction("KeyPackage","readwrite");this.#r=await r.store.getAll(),this.#r.length==0&&this.createKeyPackage()}async createKeyPackage(){if(this.#t==null)return;let t=await fa(Xo("MLS_128_DHKEMX25519_AES128GCM_SHA256_Ed25519")),r={credentialType:"basic",identity:new TextEncoder().encode("alice")};var n=await ts(r,Ec(),Xa,[],t),o=Tf(this.#n,n.publicPackage),[o,i]=await this.#e.createObject(o);if(i!=""){console.log(i);return}console.log(o);let a={id:o.id,privatePackage:n.privatePackage,publicPackage:n.publicPackage};console.log(a),this.#t.add("KeyPackage",a,a.id)}};var la=class{#e={};#t;#r;constructor(){this.#t=new Ro,this.#r=new da(this.#t)}async start(){let t=await this.loadActor();this.#e=t,await this.#t.start(t.id),await this.#r.start(t.id)}async loadActor(){let r=await(await fetch("http://localhost/@me",{headers:[["Accept","application/json"]],credentials:"same-origin"})).json();return typeof r=="object"?r:{id:"",name:"",inbox:"",keyPackages:{type:"Collection",id:"",items:[]}}}};var Kt=Wt(Oa(),1);var pa=class{#e;constructor(t){console.log(t),this.#e=t}view(){return(0,Kt.default)("div",{class:"flex-row"},(0,Kt.default)("div",{class:"table no-top-border width-25% flex-shrink-0 scroll-vertical",style:"background-color:var(--gray10); view-transition-name:second-sidebar;"},(0,Kt.default)("div",{role:"button",class:"link conversation-selector pos-relative padding-horizontal-sm flex-row flex-align-center"},(0,Kt.default)("div",{class:"width-32 flex-shrink-0 flex-center"},(0,Kt.default)("div",{class:"circle width-32 flex-shrink-0 flex-center",style:"font-size:24px;background-color:var(--blue50);color:var(--white);"},"+")),(0,Kt.default)("div",{class:"ellipsis-block",style:"max-height:3em;"},"New Conversation")),(0,Kt.default)("div",null,"Convo 1"),(0,Kt.default)("div",null,"Convo 2"),(0,Kt.default)("div",null,"Convo 3")),(0,Kt.default)("div",{class:"width-75%"},"Here be details..."))}};var vc=class{constructor(t){this.start(t)}async start(t){var r=new la;await r.start();var n=new pa(r);vp.default.mount(t,n)}};var Ep=document.getElementById("mls");if(Ep!=null){let e=new vc(Ep)}else console.log("Can't mount Mithril app. Please verify that <div id=mls> exists.");})();
/*! Bundled license information:

@noble/ciphers/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/utils.js:
@noble/curves/abstract/modular.js:
@noble/curves/abstract/curve.js:
@noble/curves/abstract/edwards.js:
@noble/curves/abstract/montgomery.js:
@noble/curves/abstract/oprf.js:
@noble/curves/ed25519.js:
@noble/curves/ed448.js:
@noble/curves/abstract/weierstrass.js:
@noble/curves/nist.js:
@hpke/common/esm/src/curve/modular.js:
@hpke/common/esm/src/curve/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=app.js.map
