{{- $circles := .Circles.ByName.Slice -}}

<div class="page app flex-row" script="on load take .selected from .nav-item for #nav-settings">
	<title>{{.RuleCount}} Circles | {{.DisplayName}}</title>
	<link rel="stylesheet" href="/.templates/user-settings/stylesheet">

	<div id="app-sidebar" class="app-sidebar" hx-swap="innerHTML show:window:top">

		<div class="pos-sticky" style="top:96px;">
	
			<div class="bold text-xl margin-none margin-bottom">Settings</div>

			<a href="/@me/settings/following" hx-boost="true" class="turboclick menu-item ellipsis">{{icon "star"}} Following</a>
			<a href="/@me/settings/followers" hx-boost="true" class="turboclick menu-item ellipsis">{{icon "person"}} Followers</a>
			<a href="/@me/settings/circles" hx-boost="true" class="turboclick menu-item ellipsis selected">{{icon "circle-fill"}} Circles</a>
			<a href="/@me/settings/payments" hx-boost="true" class="turboclick menu-item ellipsis">{{icon "credit-card"}} Payments</a>
			<a href="/@me/settings/rules" hx-boost="true" class="turboclick menu-item ellipsis">{{icon "rule"}} Rules</a>
			<hr>
			<a href="/@guest" class="turboclick menu-item ellipsis">{{icon "person-circle"}} My Guest Profile</a>
		</div>
	
	</div>
	
	<div class="app-content">

		<div class="flex-row flex-align-center margin-bottom-lg">
			<h1 class="text-xl bold margin-none flex-grow">All Circles</h1>
			<a href="https://emissary.dev/circles" target="_blank">{{icon "help"}} Help with Circles</a>
		</div>

		<div class="table">

			<div hx-get="/@me/settings/circle-add" role="button" class="link">
				{{icon "add"}} Add a Circle
			</div>

			{{- range $index, $circle := $circles -}}
				<div class="flex-row" role="button">
					<a href="/@me/settings/circle-members?circleId={{$circle.ID}}" role="button" class="flex-grow text-nocolor ellipsis">
						{{icon "circle"}} {{$circle.Name}} 
						{{- if ne "" $circle.Description -}}
							<span class="margin-left text-sm text-gray">{{$circle.Description}}</span>
						{{- end -}}
					</a>
					<div>
						<button hx-get="/@me/settings/circle-edit?circleId={{$circle.ID}}" role="button" class="text-xs">Edit Settings</button>
					</div>
				</div>
			{{- end -}}
		</div>
	
	</div>

	<div hx-get="{{.URL}}" hx-trigger="refreshPage from:window" hx-push-url="false"></div>

</div>