{{- $inbox := .Inbox.Top12.ByCreateDate.Reverse.Slice.Reverse -}}

{{- if gt (len  $inbox) 0 -}}

	{{- $firstMessage := $inbox.First -}}
	{{- $folders := .FoldersWithSelection}}
	{{- $folder := $folders.Selected}}
	{{- $folderID := $folder.FolderID.Hex -}}

	{{- $internalID := .QueryParam "origin.followingId" -}}
	{{- $layout := $folder.Layout | lowerCase -}}
	{{- $inboxRenderer := . -}}

	<div 
		hx-get="/@me/inbox/list-before?folderId={{$folderID}}&origin.followingId={{$internalID}}&readDate=LT:{{$firstMessage.ReadDate}}"
		hx-target="this"
		hx-swap="outerHTML"
		hx-push-url="false"
		role="button"
		class="turboclick margin-bottom">
		<button class="text-xs">&uarr; Older than {{ $firstMessage.ReadDate | longDate}}</button>
		<div style="border-top:solid 3px var(--gray30);"></div>
	</div>

	{{- range $index, $message := $inbox -}}

		<div 
			id="item_{{.MessageID.Hex}}" 
			role="button"
			class="message" 
			style="max-width:640px;"
			hx-get="/@me/inbox/message?messageId={{.MessageID.Hex}}&uri={{$message.URL}}&folderID={{$folderID}}&origin.followingId={{$internalID}}"
			hx-push-url="false"
			tabIndex="0">

			{{- if eq "SOCIAL" $folder.Layout -}}
				{{- template "list-social" (array $inboxRenderer $message) -}}
			{{- else if eq "CHAT" $folder.Layout -}}
				{{- template "list-chat" (array $inboxRenderer $message) -}}
			{{- else if eq "NEWSPAPER" $folder.Layout -}}
				{{- template "list-newspaper" (array $inboxRenderer $message) -}}
			{{- else if eq "MAGAZINE" $folder.Layout -}}
				{{- template "list-magazine" (array $inboxRenderer $message) -}}
			{{- else -}}
				{{- template "list-social" (array $inboxRenderer $message) -}}
			{{- end -}}
		</div>

		<hr>

	{{- end -}}

{{- end -}}