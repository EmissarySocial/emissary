<div class="page">

	<script src="/.themes/global/resources/sortable-1.15.0/Sortable.min.js"></script>

	{{template "menubar" .}}

	{{- $builder := . -}}
	{{- $connections := $builder.AllConnections -}}
	{{- $providers := .Providers -}}
	{{- $groupBy := $providers.GroupBy "group" -}}

	{{- range $index, $provider := $providers -}}

		{{- if $groupBy.IsHeader $index -}}
			<h2>{{icon $provider.Icon}} {{$provider.Group}}</h2>
			<div class="table margin-bottom-xl">
		{{- end -}}

		{{ $connection := index $connections .Value }}
		<div hx-get="/admin/connections/edit?providerId={{.Value}}" script="install blockselect()" role="link">
			<div class="flex-row">
				<div class="flex-grow">
					<div class="bold">{{.Label}}</div>
					<div class="text-light-gray">{{.Description}}</div>
				</div>
				<div>
					{{- if $connection.Active -}}
						<button class="success">{{icon "check"}} Connected</button>
					{{- else -}}
						<button>Connect Now</button>
					{{- end -}}
				</div>
			</div>
		</div>

		{{- if $groupBy.IsFooter $index -}}
			</div>
		{{- end -}}

	{{- end -}}
	
	<div
		hx-get="/admin/connections/index" 
		hx-trigger="refreshPage from:window"
		hx-target="main"
		hx-swap="innerHTML"
		hx-push-url="false">
	</div>
	
</div>