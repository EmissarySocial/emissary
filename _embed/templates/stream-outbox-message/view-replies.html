{{- $pageSize := 12 -}}
{{- $publishedDate := .QueryParam "publishedDate" -}}
{{- $replies := .RepliesBefore $publishedDate $pageSize -}}

{{- if eq $replies.Length $pageSize -}}
	<div role="button" hx-get="/{{.StreamID}}/view-replies?publishedDate={{$replies.Head.PublishDate}}" hx-target="this" hx-swap="outerHTML" hx-push-url="false">
		Load Previous Replies
	</div>
{{- end -}}

{{- range $replies -}}
	{{- template "activitystream" . -}}
{{- end -}}

{{- if eq "" $publishedDate -}}
	{{- if .UserCan "add-reply" -}}
		{{.View "add-reply"}}
	{{- end -}}
{{- end -}}