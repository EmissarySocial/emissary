{
	"templateId":"outbox-message",
	"templateRole":"outbox-message",
	"socialRole":"Note",
	"extends":["base-social"],
	"model":"stream",
	"icon":"message",
	"label":"Post",
	"description":"Single comment in the comments section of a page.",
	"sort": 0,
	"containedBy": ["outbox"],
	"schema": {
		"type":"object",
		"properties": {
			"summary": {"type":"string", "format":"html"},
			"imageUrl": {"type":"string", "format":"url"}
		}
	},
	"states": {
		"visible": {
			"label":"Visible",
			"description":"Comment is publicly visible"
		}
	},
	"roles": {
		"self": {
			"label":"Myself",
			"decription":"Outbox messages can only be sent by the current user."
		}
	},
	"actions": {
		"create":{
			"steps": [
				{"step":"edit-content", "file":"edit", "format":"HTML"},
				{"step":"save"},
				{"step":"upload-attachments"},
				{"step":"set-thumbnail", "path":"imageUrl"},
				{"step":"publish"}
			]
		},
		"view": {
			"steps":[
				{"step":"set-data", "url-values":{"url":"{{.Permalink}}"}},
				{"step":"view-json"},
				{"step":"view-html"}
			]
		},
		"edit": {
			"roles":["self"],
			"steps": [
				{"step":"as-modal", "steps":[
					{"step":"set-args", "postTo":"/{{.StreamID}}/edit"},
					{"step":"edit-content", "file":"edit", "format":"HTML"},
					{"step":"save"},
					{"step":"publish"},
					{"step":"refresh-page"}
				]}
			]
		},
		"responses-replies":{
			"steps": [
				{"step":"set-args", "path":"/{{.StreamID}}"},
				{"step":"view-html"}
			]
		},
		"responses-announces":{
			"steps": [
				{"step":"set-args", "path":"/{{.StreamID}}"},
				{"step":"view-html"}
			]
		},
		"responses-likes":{
			"steps": [
				{"step":"set-args", "path":"/{{.StreamID}}"},
				{"step":"view-html"}
			]
		},
		"replies":{
			"steps":[
				{"step":"set-args", "path":"/{{.StreamID}}"},
				{"step":"view-html"}
			]
		},

		"reply":{
			"roles":["authenticated"],
			"steps":[
				{"step":"set-args", "path":"/{{.StreamID}}", "replies":"{{.StreamID}}/reply", "postTo":"/{{.StreamID}}/reply"},
				{"step":"add-stream", "location":"outbox", "roles":["outbox-reply"], "as-embed":true, "with-data":{
					"inReplyTo":"{{.Permalink}}"
				}},
				{"step":"set-header", "name":"hx-retarget", "value":"#responses"},
				{"step":"set-header", "name":"hx-reswap", "value":"outerHTML"},
				{"step":"view-html", "method":"post", "file":"responses-replies"}
			]
		},

		"delete": {
			"roles":["self"],
			"steps": [
				{"step":"delete", "title":"Delete this Post?", "message":"If you continue, this post will be permanently removed from your profile.  There is NO UNDO."},
				{"step":"unpublish"},
				{"step":"forward-to", "url":"/@{{.ParentID}}"}
			]
		}
	}
}