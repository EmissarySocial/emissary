{{- $inbox := .Inbox -}}
{{- $selectedfolder := .InboxFolderID -}}

<div class="page" hx-push-url="true">

	<div class="pure-g">

		<!-- Subscription Sidebar -->
		<div class="pure-u-1 pure-u-sm-1-4 pure-u-lg-1-6 pure-u-xl-1-6">

			<div role="link" hx-get="/people/me/inbox" class="{{if eq 0 (len $selectedfolder)}}bold{{end}}">All Folders</div>
			<div role="link" hx-get="/people/me/subscriptions">All Subscriptions</div>
			<div role="button" hx-get="/people/me/add-subscription">Add Subscription</div>
			<br>

			{{- range .InboxFolders -}}
				<div role="link" hx-get="/people/me/inbox?inboxFolderId={{ .InboxFolderID.Hex }}" class="{{if eq .InboxFolderID.Hex $selectedfolder}}bold{{end}}">{{ .Label }}</div>
			{{- end -}}
		</div>
 
		<!-- Content Sidebar -->
		<div class="pure-u-1 pure-u-sm-3-4 pure-u-lg-3-6 pure-u-xl-2-6">

			{{- if eq 0 (len $inbox) -}}

				<h2>There are no posts in this inbox.</h2>
				<button hx-get="/people/me/add-subscription">Add a new subscription</button>

			{{- else -}}

				{{- range $inbox -}}
					<div script="on click go to url '{{.Origin.URL}}' in new window" style="cursor:pointer;">
						{{- if eq .ReadDate 0 -}}
							<span hx-post="/mark-read"
								hx-trigger="revealed"
								hx-swap="outerHTML"
								hx-target="this"
								hx-push-url="false"></span>
						{{- end -}}
						<div class="flex-row" hx-push-url="true">
							<div style="min-width:160px; height:100px;">
								{{- if ne .ImageURL "" -}}
									<img src="{{.ImageURL}}" style="width:150px; height:90px; object-fit:contain; border:solid 1px var(--gray20)"/>
								{{- end -}}
							</div>

							<div style="flex-grow:1; min-width:0px; position:relative; width:100%; max-width:100%;">
								<div class="bold black" style="line-height:1em;">{{.Label}}</div>
								<div class="text-gray text-sm space-below" style="line-height:1em;">{{.Author.Name}} &middot {{.PublishDate | humanizeTime}}</div>
								<div style="text-overflow:ellipsis; overflow:hidden;">{{.Summary}}</div>
							</div>
						
						</div>
					</div>
					<hr style="height:0px; border:none; border-top:solid 1px var(--gray20);">
					<div style="height:30px;"></div>
				{{- end -}}

			{{- end -}}

		</div>
	
	</div>

</div>