<div class="page" hx-get="{{.URL}}" hx-swap="outerHTML" hx-trigger="refreshPage from:body">

	<div class="pure-g">

		{{ .View "inbox-sidebar" }}
 
		<!-- Content Section -->
		<div class="pure-u-1 pure-u-md-2-3 pure-u-lg-3-4 pure-u-xl-4-5" style="min-height:400px;">
			{{ .View "inbox-list"}}
		</div>
	
	</div>

</div>

<script type="text/hyperscript">
	on scroll from window debounced at 500ms
		tell <div.inbox-item[data-status=unread] /> in me
			set offsetBottom to your offsetTop
			increment offsetBottom by your offsetHeight
			if (offsetBottom) - (window.scrollY) > 0 then
				exit
			end

			set url to "/people/me/inbox/" + [@data-inboxItemId] + "/mark-read"
			fetch `${url}` with method:"POST"
			add .read to yourself
		end
	end
</script>